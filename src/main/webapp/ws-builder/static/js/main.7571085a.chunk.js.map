{"version":3,"sources":["WEB-SERVICE/main/moddle/index.js","WEB-SERVICE/main/moddle-xml/index.js","WEB-SERVICE/main/baml-moddle/index.js","WEB-SERVICE/main/baml-js/lib/import/Util.js","WEB-SERVICE/main/baml-js/lib/import/BpmnTreeWalker.js","WEB-SERVICE/main/baml-js/lib/BaseViewer.js","WEB-SERVICE/main/baml-js/lib/import/Importer.js","WEB-SERVICE/main/baml-js/lib/BaseModeler.js","WEB-SERVICE/main/baml-js/lib/util/ModelUtil.js","WEB-SERVICE/main/baml-js/lib/util/DiUtil.js","WEB-SERVICE/main/baml-js/lib/features/label-editing/LabelUtil.js","WEB-SERVICE/main/baml-js/lib/draw/BpmnRenderUtil.js","WEB-SERVICE/main/baml-js/lib/draw/BpmnRenderer.js","WEB-SERVICE/main/baml-js/lib/draw/TextRenderer.js","WEB-SERVICE/main/baml-js/lib/draw/PathMap.js","WEB-SERVICE/main/baml-js/lib/draw/index.js","WEB-SERVICE/main/baml-js/lib/util/LabelUtil.js","WEB-SERVICE/main/baml-js/lib/import/BpmnImporter.js","WEB-SERVICE/main/baml-js/lib/import/index.js","WEB-SERVICE/main/baml-js/lib/core/index.js","WEB-SERVICE/main/baml-js/lib/Viewer.js","WEB-SERVICE/main/baml-js/lib/NavigatedViewer.js","WEB-SERVICE/main/baml-js/lib/features/modeling/util/ModelingUtil.js","WEB-SERVICE/main/baml-js/lib/features/auto-place/AutoPlaceUtil.js","WEB-SERVICE/main/baml-js/lib/features/auto-place/AutoPlace.js","WEB-SERVICE/main/baml-js/lib/features/auto-place/AutoPlaceSelectionBehavior.js","WEB-SERVICE/main/baml-js/lib/features/auto-place/index.js","WEB-SERVICE/main/baml-js/lib/features/auto-resize/BpmnAutoResize.js","WEB-SERVICE/main/baml-js/lib/features/auto-resize/BpmnAutoResizeProvider.js","WEB-SERVICE/main/baml-js/lib/features/auto-resize/index.js","WEB-SERVICE/main/baml-js/lib/features/copy-paste/BpmnCopyPaste.js","WEB-SERVICE/main/baml-js/lib/features/copy-paste/ModdleCopy.js","WEB-SERVICE/main/baml-js/lib/features/copy-paste/index.js","WEB-SERVICE/main/baml-js/lib/features/replace/BpmnReplace.js","WEB-SERVICE/main/baml-js/lib/features/replace/index.js","WEB-SERVICE/main/baml-js/lib/features/popup-menu/util/TypeUtil.js","WEB-SERVICE/main/baml-js/lib/features/replace/ReplaceOptions.js","WEB-SERVICE/main/baml-js/lib/features/popup-menu/ReplaceMenuProvider.js","WEB-SERVICE/main/baml-js/lib/features/popup-menu/index.js","WEB-SERVICE/main/baml-js/lib/features/modeling/util/LaneUtil.js","WEB-SERVICE/main/baml-js/lib/features/context-pad/ContextPadProvider.js","WEB-SERVICE/main/baml-js/lib/features/context-pad/index.js","WEB-SERVICE/main/baml-js/lib/features/distribute-elements/BpmnDistributeElements.js","WEB-SERVICE/main/baml-js/lib/features/distribute-elements/index.js","WEB-SERVICE/main/baml-js/lib/features/editor-actions/BpmnEditorActions.js","WEB-SERVICE/main/baml-js/lib/features/editor-actions/index.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/BpmnGridSnapping.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/behavior/AutoPlaceBehavior.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/behavior/CreateParticipantBehavior.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/behavior/LayoutConnectionBehavior.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/behavior/index.js","WEB-SERVICE/main/baml-js/lib/features/grid-snapping/index.js","WEB-SERVICE/main/baml-js/lib/features/interaction-events/BpmnInteractionEvents.js","WEB-SERVICE/main/baml-js/lib/features/interaction-events/index.js","WEB-SERVICE/main/baml-js/lib/features/keyboard/BpmnKeyboardBindings.js","WEB-SERVICE/main/baml-js/lib/features/keyboard/index.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/CategoryUtil.js","WEB-SERVICE/main/baml-js/lib/features/label-editing/LabelEditingProvider.js","WEB-SERVICE/main/baml-js/lib/features/label-editing/LabelEditingPreview.js","WEB-SERVICE/main/baml-js/lib/features/label-editing/index.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/AdaptiveLabelPositioningBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/AppendBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/AssociationBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/AttachEventBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/BoundaryEventBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/RootElementReferenceBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/CreateBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/FixHoverBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/CreateDataObjectBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/CreateParticipantBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/DataInputAssociationBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/UpdateSemanticParentHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/DataStoreBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/DeleteLaneBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/DetachEventBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/DropOnFlowBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/EventBasedGatewayBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/GroupBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/LineIntersect.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ImportDockingFix.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/IsHorizontalFix.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/GeometricUtil.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/LineAttachmentUtil.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/LabelLayoutUtil.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/LabelBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ModelingFeedback.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ReplaceConnectionBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/RemoveParticipantBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ReplaceElementBehaviour.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/util/ResizeUtil.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ResizeBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ResizeLaneBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/RemoveElementBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/SpaceToolBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/SubProcessStartEventBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/ToggleElementCollapseBehaviour.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/UnclaimIdBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/UpdateFlowNodeRefsBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/UnsetDefaultFlowBehavior.js","WEB-SERVICE/main/baml-js/lib/features/modeling/behavior/index.js","WEB-SERVICE/main/baml-js/lib/features/snapping/BpmnSnappingUtil.js","WEB-SERVICE/main/baml-js/lib/features/rules/BpmnRules.js","WEB-SERVICE/main/baml-js/lib/features/rules/index.js","WEB-SERVICE/main/baml-js/lib/features/di-ordering/BpmnDiOrdering.js","WEB-SERVICE/main/baml-js/lib/features/di-ordering/index.js","WEB-SERVICE/main/baml-js/lib/features/ordering/BpmnOrderingProvider.js","WEB-SERVICE/main/baml-js/lib/features/ordering/index.js","WEB-SERVICE/main/baml-js/lib/features/modeling/BpmnFactory.js","WEB-SERVICE/main/baml-js/lib/features/modeling/BpmnUpdater.js","WEB-SERVICE/main/baml-js/lib/features/modeling/ElementFactory.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/UpdatePropertiesHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/UpdateCanvasRootHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/AddLaneHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/SplitLaneHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/ResizeLaneHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/UpdateFlowNodeRefsHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/IdClaimHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/cmd/SetColorHandler.js","WEB-SERVICE/main/baml-js/lib/features/label-editing/cmd/UpdateLabelHandler.js","WEB-SERVICE/main/baml-js/lib/features/modeling/Modeling.js","WEB-SERVICE/main/baml-js/lib/features/modeling/BpmnLayouter.js","WEB-SERVICE/main/baml-js/lib/features/modeling/index.js","WEB-SERVICE/main/baml-js/lib/features/palette/PaletteProvider.js","WEB-SERVICE/main/baml-js/lib/features/palette/index.js","WEB-SERVICE/main/baml-js/lib/features/replace-preview/BpmnReplacePreview.js","WEB-SERVICE/main/baml-js/lib/features/replace-preview/index.js","WEB-SERVICE/main/baml-js/lib/features/snapping/BpmnConnectSnapping.js","WEB-SERVICE/main/baml-js/lib/features/snapping/BpmnCreateMoveSnapping.js","WEB-SERVICE/main/baml-js/lib/features/snapping/index.js","WEB-SERVICE/main/baml-js/lib/features/search/BpmnSearchProvider.js","WEB-SERVICE/main/baml-js/lib/features/search/index.js","WEB-SERVICE/main/baml-js/lib/Modeler.js","services/Service.js","WEB-SERVICE/constants.js","services/api.js","utils.js","WEB-SERVICE/components/Description.js","WEB-SERVICE/components/Textbox.js","WEB-SERVICE/components/TextField.js","WEB-SERVICE/components/SelectBox.js","WEB-SERVICE/components/Checkbox.js","WEB-SERVICE/components/Select.js","WEB-SERVICE/components/Selection.js","WEB-SERVICE/components/SelectionField.js","WEB-SERVICE/components/ExtensionElementTable.js","WEB-SERVICE/components/NewSelect.js","WEB-SERVICE/expression-builder/components/select.js","WEB-SERVICE/expression-builder/components/input.js","WEB-SERVICE/expression-builder/components/button.js","WEB-SERVICE/expression-builder/components/number.js","WEB-SERVICE/expression-builder/extra/data.js","WEB-SERVICE/expression-builder/components/datetime-picker.js","WEB-SERVICE/expression-builder/components/auto-complete.js","WEB-SERVICE/expression-builder/components/Timeline.js","WEB-SERVICE/expression-builder/services/axelor.rest.js","WEB-SERVICE/expression-builder/services/api.js","WEB-SERVICE/expression-builder/extra/util.js","WEB-SERVICE/expression-builder/constants.js","WEB-SERVICE/expression-builder/field-editor.js","WEB-SERVICE/expression-builder/editor.js","WEB-SERVICE/expression-builder/expression-builder.js","WEB-SERVICE/expression-builder/index.js","WEB-SERVICE/views/ScriptBox.js","WEB-SERVICE/custom/custom request/CustomContextPadProvider.js","WEB-SERVICE/custom/custom request/CustomRules.js","WEB-SERVICE/custom/custom request/index.js","WEB-SERVICE/custom/custom auth/CustomContextPadProvider.js","WEB-SERVICE/custom/custom auth/CustomRules.js","WEB-SERVICE/custom/custom auth/index.js","WEB-SERVICE/ModelUtil.js","WEB-SERVICE/views/ParameterProps.js","WEB-SERVICE/tabProperty.js","WEB-SERVICE/views/JsonView.js","WEB-SERVICE/components/Table.js","WEB-SERVICE/components/Line.js","WEB-SERVICE/transformation-builder/ParameterBuilder.js","WEB-SERVICE/transformation-builder/transformation-builder.js","WEB-SERVICE/transformation-builder/index.js","WEB-SERVICE/request-builder/components/Parameter.js","WEB-SERVICE/request-builder/components/ModelParameter.js","WEB-SERVICE/request-builder/features/requestReducer.js","WEB-SERVICE/request-builder/request-builder.js","WEB-SERVICE/header-builder/components/Header.js","WEB-SERVICE/header-builder/features/headerReducer.js","WEB-SERVICE/header-builder/header-builder.js","WEB-SERVICE/payloads-builder/components/Payload.js","WEB-SERVICE/payloads-builder/components/ModelPayload.js","WEB-SERVICE/payloads-builder/payload-builder.js","WEB-SERVICE/payloads-builder/features/payloadReducer.js","WEB-SERVICE/views/Expression.js","WEB-SERVICE/components/CheckBoxs.js","WEB-SERVICE/context-builder/features/contextReducer.js","WEB-SERVICE/store.js","WEB-SERVICE/tabPropertyAuth.js","WEB-SERVICE/tabPropertyConnector.js","WEB-SERVICE/views/AuthentificationField.js","WEB-SERVICE/components/TestConnector.js","WEB-SERVICE/payloads-builder/services/api.js","WEB-SERVICE/components/textBoxMapper.js","WEB-SERVICE/components/AuthentificationAction.js","WEB-SERVICE/context-builder/components/ModelTarget.js","WEB-SERVICE/context-builder/context-builder.js","WEB-SERVICE/index.js","App.js","index.js"],"names":["Base","Factory","model","properties","this","prototype","get","name","$model","set","value","createType","descriptor","props","Object","create","forEach","p","isMany","undefined","default","defineModel","defineDescriptor","ns","ModdleElement","attrs","define","enumerable","writable","bind","val","key","hasType","$instanceOf","BUILTINS","String","Boolean","Integer","Real","Element","TYPE_CONVERTERS","s","parseInt","parseFloat","coerceType","type","converter","isBuiltIn","isSimple","parseName","defaultPrefix","localName","prefix","parts","split","length","Error","DescriptorBuilder","nameNs","allTypes","allTypesByName","propertiesByName","Registry","packages","packageMap","typeMap","registerPackage","ensureAvailable","pkg","identifierKey","Properties","defineProperty","target","property","isReference","configurable","Moddle","factory","registry","typeCache","build","pick","addProperty","idx","validate","addNamedProperty","splice","push","replaceProperty","oldProperty","newProperty","replace","oldNameNs","rename","isId","setIdProperty","isBody","setBodyProperty","indexOf","redefineProperty","targetPropertyName","nsPrefix","attrName","redefinedProperty","redefines","propsByName","assertNotDefined","removeNamedProperty","bodyProperty","idProperty","propertyName","definedProperty","definedBy","hasProperty","addTrait","t","inherited","typesByName","types","typeName","assign","replaces","getPackage","uriOrPrefix","getPackages","pkgMap","registerType","uri","superClass","slice","extends","meta","propertyNs","extendsName","extended","traits","definePackage","mapTypes","nsName","iterator","trait","self","traverseTrait","cls","traverseSuper","parentNs","getEffectiveDescriptor","builder","$pkg","getPropertyDescriptor","$attrs","options","Type","getType","cache","isString","createAny","nsUri","element","$type","isGeneric","a","isObject","getElementDescriptor","$descriptor","getTypeDescriptor","hasLowerCaseAlias","xml","tagAlias","DEFAULT_NS_MAP","xsi","XSI_TYPE","serializeFormat","serialize","serializeAsType","aliasToName","aliasNs","str","charAt","toUpperCase","error","message","getModdleDescriptor","Context","elementsById","references","warnings","addReference","reference","addElement","id","test","addWarning","warning","BaseHandler","NoopHandler","BodyHandler","ReferenceHandler","context","ValueHandler","propertyDesc","BaseElementHandler","ElementHandler","RootElementHandler","call","GenericElementHandler","Reader","lax","handleEnd","handleText","handleNode","text","body","node","createReference","parser","handleChild","createElement","propNameNs","attributes","instance","values","prop","v","parseNameNS","getPropertyForNode","elementTypeName","elementType","isAttr","typePrefix","prefixedToName","normalizeXsiTypeName","effectiveType","find","isVirtual","isAttribute","toString","valueHandler","referenceHandler","handler","childHandler","isSimpleType","newElement","$parent","originalName","$children","$body","fromXML","done","rootHandler","Parser","proxy","stack","createStack","handleError","err","getContext","ctx","line","column","data","handleWarning","PREAMBLE_START_PATTERN","ENCODING_PATTERN","UTF_8_PATTERN","handleCData","peek","uriMap","reduce","on","obj","decodeStr","selfClosing","decodedAttrs","keys","d","handleOpen","question","match","exec","encoding","pop","decodeEntities","trim","setTimeout","parse","i","r","collection","resolveReferences","e","ESCAPE_ATTR_CHARS","ESCAPE_CHARS","Namespaces","parent","prefixMap","used","wellknown","custom","byUri","add","isWellknown","mapPrefix","uriByPrefix","logUsed","getUsed","concat","filter","nameToAlias","string","toLowerCase","inherits","ctor","superCtor","super_","constructor","ESCAPE_ATTR_MAP","ESCAPE_MAP","escape","charPattern","replaceMap","ReferenceSerializer","tagName","BodySerializer","ValueSerializer","ElementSerializer","propertyDescriptor","TypeSerializer","SavingWriter","write","FormatingWriter","out","format","indent","append","appendNewLine","appendIndent","join","unindent","Writer","preamble","toXML","tree","writer","internalWriter","formatingWriter","serializeTo","BpmnModdle","serializeValue","search","otherAttrs","elementDescriptor","parseGeneric","parseNsAttributes","nsPropertyTagName","nsTagName","addTagName","hasOwnProperty","getSerializableProperties","parseAttributes","parseContainments","filterContained","parseGenericAttributes","getElementNs","logNamespaceUsed","getPropertyNs","isLocalNs","nsAttributeName","effectiveNs","getNamespaces","child","parseNsAttribute","logNamespace","actualNs","genericAttrs","nonNsAttr","attr","addAttribute","console","warn","asType","asProperty","serializeAsProperty","serializer","local","parentNamespaces","namespaces","newPrefix","wellknownUri","serializeAttributes","map","getNsAttrs","firstBody","b","typeNs","xmlStr","isFunction","reader","result","bpmn","associations","isAbstract","allowedIn","enumerations","literalValues","bpmndi","dc","di","isReadOnly","isUnique","subsettedProperty","bioc","simple","additionalPackages","elementToString","diRefs","Refs","is","BpmnTreeWalker","translate","handledElements","deferred","contextual","fn","handled","visitIfDi","gfx","visit","logError","registerDi","bpmnElement","handleDiagram","diagram","plane","planeElement","handlePlaneElement","handleDeferred","shift","handleProcess","process","handleFlowElementsContainer","handleIoSpecification","ioSpecification","handleArtifacts","artifacts","handleMessageFlow","messageFlow","handleDataAssociation","association","handleDataInput","dataInput","handleDataOutput","dataOutput","handleArtifact","artifact","dataInputs","dataOutputs","handleLoop","loop","handleFlowNode","flowNode","childCtx","dataInputAssociations","dataOutputAssociations","handleDataElement","dataObject","handleLane","lane","newContext","childLaneSet","handleLaneSet","flowNodeRef","lanes","wireFlowNodeRefs","laneSet","container","flowElements","sequenceFlow","handleSequenceFlow","unshift","businessObject","handleFlowElements","laneSets","handleLaneSets","handleParticipant","participant","newCtx","processRef","handleDefinitions","definitions","diagrams","rootElement","rootElements","findDisplayCandidate","collaboration","root","visitRoot","participants","messageFlows","handleUnhandledProcesses","BaseViewer","DEFAULT_OPTIONS","_moddle","_createModdle","_container","_createContainer","_init","Diagram","importXML","bpmnDiagram","_emit","parseWarnings","checkValidationError","importDefinitions","importWarnings","allWarnings","_setDefinitions","open","bpmnDiagramOrId","_definitions","diagramId","findBPMNDiagram","clear","importer","eventBus","fire","parentShape","render","importBpmnDiagram","saveXML","saveSVG","svg","canvas","contentNode","getDefaultLayer","defsNode","domQuery","_svg","contents","innerSVG","defs","bbox","getBBox","width","height","x","y","getModules","_modules","getDefinitions","bo","destroy","domRemove","event","priority","callback","off","attachTo","parentNode","detach","jquery","appendChild","resized","removeChild","moddle","baseModules","modules","additionalModules","diagramModules","bpmnjs","diagramOptions","omit","domify","style","ensureUnit","position","moddleOptions","_moddleExtensions","moddleExtensions","isNumber","BaseModeler","_collectIds","ids","Ids","claim","getBusinessObject","isExpanded","isEventLoop","triggeredByEvent","hasEventDefinition","eventType","eventDefinitions","getLabelAttr","semantic","getLabel","categoryValueRef","getCategoryValue","isTypedEvent","eventDefinitionType","some","definition","every","matches","getDi","getSemantic","getFillColor","defaultColor","getStrokeColor","RENDERER_IDS","DEFAULT_FILL_OPACITY","BpmnRenderer","config","styles","pathMap","textRenderer","BaseRenderer","defaultFillColor","defaultStrokeColor","rendererId","next","markers","computeStyle","addMarker","fill","strokeWidth","strokeLinecap","strokeDasharray","ref","scale","marker","svgCreate","svgAttr","svgAppend","viewBox","refX","refY","markerWidth","markerHeight","orient","colorEscape","stroke","sequenceflowEnd","messageflowStart","cx","cy","messageflowEnd","associationStart","associationEnd","conditionalflowMarker","conditionaldefaultflowMarker","createMarker","drawCircle","parentGfx","offset","fillOpacity","circle","Math","round","drawRect","rect","rx","ry","drawLine","waypoints","createLine","drawPath","path","drawMarker","as","handlers","renderer","renderEventContent","isThrowing","isThrowEvent","parallelMultiple","renderLabel","label","size","createText","svgClasses","renderEmbeddedLabel","align","box","padding","renderLaneLabel","textBox","top","transform","createPathFromConnection","connection","pathData","isInterrupting","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","mx","my","linePathData","rotate","outer","attachTaskMarkers","task","abspos","instantiate","businessHeaderPath","businessPath","innerAttrs","TASK_BORDER_RADIUS","participantMultiplicity","diamond","isMarkerVisible","eventGatewayType","parallelPath","innerCircle","drawEvent","x_2","y_2","pointsString","point","polygon","points","drawDiamond","source","strokeLinejoin","markerEnd","conditionExpression","markerStart","associationDirection","messageRef","midPoint","getPointAtLength","getTotalLength","markerPathData","messageAttrs","messageVisibleKind","elementObject","dataObjectRef","isCollection","yPosition","renderDataItemCollection","arrowPathData","getRawPath","cancel","cancelActivity","outerAttrs","pointerEvents","fitBox","getExternalStyle","renderExternalLabel","textElement","ParticipantMultiplicityMarker","SubProcessMarker","markerRect","ConditionalMarker","LoopProcessMarker","strokeMiterlimit","ParallelMarker","parallel","SequentialMarker","seq","CompensationMarker","compensation","LoopMarker","AdhocMarker","adhoc","taskMarkers","isForCompensation","loopCharacteristics","isSequential","_drawPath","$inject","canRender","drawShape","h","drawConnection","getShapePath","shape","radius","circlePath","componentsToPath","getCirclePath","borderRadius","roundRectPath","getRoundRectPath","halfWidth","halfHeight","diamondPath","getDiamondPath","rectPath","getRectPath","TextRenderer","defaultStyle","fontFamily","fontSize","fontWeight","lineHeight","externalStyle","textUtil","TextUtil","getExternalLabelBounds","bounds","layoutedDimensions","getDimensions","ceil","getTextAnnotationBounds","max","getDefaultStyle","tokenRegex","objNotationRegex","__init__","bpmnRenderer","EVENT_MESSAGE","heightElements","widthElements","EVENT_SIGNAL","EVENT_ESCALATION","EVENT_CONDITIONAL","EVENT_LINK","EVENT_ERROR","EVENT_CANCEL_45","EVENT_COMPENSATION","EVENT_TIMER_WH","EVENT_TIMER_LINE","EVENT_MULTIPLE","EVENT_PARALLEL_MULTIPLE","GATEWAY_EXCLUSIVE","GATEWAY_PARALLEL","GATEWAY_EVENT_BASED","GATEWAY_COMPLEX","DATA_OBJECT_PATH","DATA_OBJECT_COLLECTION_PATH","DATA_ARROW","DATA_STORE","TEXT_ANNOTATION","MARKER_SUB_PROCESS","MARKER_CONDITIONAL","MARKER_PARALLEL","MARKER_SEQUENTIAL","MARKER_COMPENSATION","MARKER_LOOP","MARKER_ADHOC","TASK_TYPE_SEND","TASK_TYPE_SCRIPT","TASK_TYPE_USER_1","TASK_TYPE_USER_2","TASK_TYPE_USER_3","TASK_TYPE_MANUAL","TASK_TYPE_INSTANTIATING_SEND","TASK_TYPE_SERVICE","TASK_TYPE_SERVICE_FILL","TASK_TYPE_BUSINESS_RULE_HEADER","TASK_TYPE_BUSINESS_RULE_MAIN","MESSAGE_FLOW_MARKER","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","all","res","quote","quotedName","isFunc","replacer","DEFAULT_LABEL_SIZE","isLabelExternal","hasExternalLabel","isLabel","getFlowLabelPosition","mid","first","floor","second","getWaypointsMid","angle","atan","abs","PI","getExternalLabelMid","labelTarget","elementData","getWaypoints","waypoint","getMid","notYetDrawn","refSemantic","referenced","BpmnImporter","elementFactory","elementRegistry","_eventBus","_canvas","_elementFactory","_elementRegistry","_translate","_textRenderer","parentElement","hidden","parentIndex","createRoot","setRootElement","collapsed","isFrame","isFrameElement","createShape","_attachBoundary","isPointInsideBBox","getRootElement","addShape","_getSource","_getTarget","createConnection","addConnection","addLabel","boundarySemantic","boundaryElement","hostSemantic","attachedToRef","host","attachers","createLabel","_getEnd","side","_getElement","__depends__","DrawModule","bpmnImporter","Viewer","CoreModule","TranslateModule","SelectionModule","OverlaysModule","NavigatedViewer","_navigationModules","KeyboardMoveModule","MoveCanvasModule","ZoomScrollModule","isAny","getParent","anyType","getNewShapePosition","sourceTrbl","asTRBL","right","deconflictPosition","margin","rowSize","getTextAnnotationPosition","bottom","getDataElementPosition","sourceMid","horizontalDistance","c","toTargetNode","weight","distanceTo","left","toSourceNode","shapeTrbl","nodes","getTargets","getSources","distancesGrouped","currentDistance","currentDistanceCount","currentDistanceEntry","fav","count","getFlowNodeDistance","orientation","getOrientation","getVerticalDistance","getFlowNodePosition","getDefaultPosition","getConnectedAtPosition","closure","allConnected","getConnected","shapes","attacher","getAutoPlaceClosure","escapeDelta","nextPosition","existingElement","newPosition","axis","axisDelta","dimension","min","existingTarget","noneFilter","connectionFilter","incoming","outgoing","AutoPlace","modeling","emit","payload","newShape","appendShape","AutoPlaceSelectionBehavior","selection","select","autoPlace","autoPlaceSelectionBehavior","BpmnAutoResize","injector","invoke","AutoResize","resize","newBounds","hints","_modeling","resizeLane","resizeShape","BpmnAutoResizeProvider","AutoResizeProvider","canResize","elements","bpmnAutoResize","bpmnAutoResizeProvider","copyProperties","isArray","isUndefined","BpmnCopyPaste","bpmnFactory","moddleCopy","oldBusinessObject","bpmnProcess","copyElement","newBusinessObject","array","DISALLOWED_PROPERTIES","ModdleCopy","_bpmnFactory","propertyNames","sortBy","parentDescriptor","matchPattern","getPropertyNames","keepDefaultProperties","sourceElement","targetElement","canCopyProperties","sourceProperty","has","copiedProperty","copyProperty","isDefined","childProperties","childProperty","CopyPasteModule","bpmnCopyPaste","CUSTOM_PROPERTIES","BpmnReplace","replaceElement","isLoop","oldCollapsed","toggeling","toggleCollapse","a2","elementProps","newElementProps","copyProps","el","moveChildren","_getDefaultSize","ReplaceModule","bpmnReplace","isDifferentType","entry","eventDefinition","isTypeEqual","isEventDefinitionEqual","isTriggeredByEventEqual","isExpandedEqual","START_EVENT","actionName","className","INTERMEDIATE_EVENT","END_EVENT","GATEWAY","LOOP_EXPANDED","TRANSACTION","EVENT_SUB_PROCESS","TASK","BOUNDARY_EVENT","EVENT_SUB_PROCESS_START_EVENT","SEQUENCE_FLOW","PARTICIPANT","ReplaceMenuProvider","popupMenu","rules","_popupMenu","_bpmnReplace","_rules","register","registerProvider","getEntries","entries","allowed","differentType","replaceOptions","_createEntries","isInterruptingEqual","isCancelActivityEqual","isTargetLoop","isTargetExpanded","_createSequenceFlowEntries","getHeaderEntries","headerEntries","_getLoopEntries","_getAdHocEntry","menuEntries","_createMenuEntry","sourceRef","updateProperties","action","toggleLoopEntry","active","isParallel","title","isAdHoc","autoResize","layoutConnection","PopupMenuModule","replaceMenuProvider","LANE_PARENTS","LANE_INDENTATION","collectLanes","collectedShapes","children","getChildLanes","getLanesRoot","computeLanesResize","allLanes","shapeNewTrbl","trblResize","oldBounds","substractTRBL","getTRBLResize","resizeNeeded","other","topResize","rightResize","bottomResize","leftResize","otherTrbl","resizeTRBL","ContextPadProvider","contextPad","connect","_contextPad","_connect","_create","_autoPlace","hasPrimaryModifier","isOpen","click","isEventType","eventBo","isType","isDefinition","def","getContextPadEntries","actions","startConnect","start","appendAction","appendStart","group","dragstart","splitLaneHandler","splitLane","childLanes","addLane","isEmpty","diagramContainer","getContainer","pad","getPad","html","diagramRect","getBoundingClientRect","padRect","getReplaceMenuPosition","cursor","deleteAllowed","delete","removeElements","DirectEditingModule","ContextPadModule","ConnectModule","CreateModule","contextPadProvider","BpmnDistributeElements","distributeElements","registerFilter","cannotDistribute","DistributeElementsModule","bpmnDistributeElements","BpmnEditorActions","EditorActions","_registerDefaultActions","spaceTool","lassoTool","handTool","globalConnect","alignElements","directEditing","searchPad","_registerAction","toggle","opts","currentSelection","trigger","aligneableElements","setColor","activate","boundingBox","moveElements","EditorActionsModule","editorActions","BpmnGridSnapping","gridSnappingContext","snapLocation","AutoPlaceBehavior","gridSnapping","isHorizontal","snapValue","CreateParticipantBehavior","createConstraints","LayoutConnectionBehavior","CommandInterceptor","_gridSnapping","postExecuted","connectionStart","connectionEnd","createElementsBehavior","hasMiddleSegments","updateWaypoints","snapMiddleSegments","snapSegment","segmentStart","segmentEnd","aligned","pointsAligned","snapped","horizontallyAligned","verticallyAligned","gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior","GridSnappingModule","GridSnappingBehaviorModule","bpmnGridSnapping","BpmnInteractionEvents","interactionEvents","_interactionEvents","createParticipantHit","createDefaultHit","createLoopHit","removeHits","createBoxHit","bpmnInteractionEvents","BpmnKeyboardBindings","KeyboardBindings","registerBindings","keyboard","addListener","isRegistered","keyEvent","isKey","isCmd","hasModifier","KeyboardModule","keyboardBindings","createCategoryValue","categoryValue","category","collectionAdd","LabelEditingProvider","resizeHandles","activateDirectEdit","force","isCollapsedLoop","isActive","complete","removeResizers","canExecute","isTouch","getEditingBBox","centerVertically","resizable","getAbsoluteBBox","zoom","externalFontSize","externalLineHeight","defaultFontSize","defaultLineHeight","isExpandedPool","paddingTop","paddingBottom","paddingLeft","paddingRight","isCollapsedPool","isExpandedLoop","externalLabelMid","absoluteBBox","minWidth","minHeight","textAlign","update","newLabel","activeContextText","updateLabel","MARKER_HIDDEN","MARKER_LABEL_HIDDEN","LabelEditingPreview","absoluteElementBBox","defaultLayer","activeProvider","textPathData","dy","newElementHeight","removeMarker","svgRemove","ChangeSupportModule","ResizeModule","labelEditingProvider","labelEditingPreview","ALIGNMENTS","ELEMENT_LABEL_DISTANCE","AdaptiveLabelPositioningBehavior","checkLabelAdjustment","optimalPosition","labelMid","labelOrientation","getApproximateOrientation","takenAlignments","elementMid","getTakenConnectionAlignments","takenHostAlignments","freeAlignments","hostElement","hostOrientation","alignment","getTakenHostAlignments","getOptimalPosition","newLabelMid","elementTrbl","delta","substract","moveShape","adjustLabelPosition","p0","p1","AppendBehavior","bpmnRules","preExecute","AssociationBehavior","postExecute","newParent","moveConnection","AttachEventBehavior","shouldReplace","index","replaceShape","newHost","BoundaryEventBehavior","getBoundaryEvents","boundaryEvents","oldSource","newSource","attachedboundaryEvents","getEventDefinition","boundaryEvent","RootElementReferenceBehavior","canHaveRootElementReference","hasAnyEventDefinition","hasRootElement","getRootElementReferencePropertyName","executed","addedRootElement","reverted","collectionRemove","referencedRootElement","CreateBehavior","HIGH_PRIORITY","FixHoverBehavior","hover","hoverGfx","getGraphics","CreateDataObjectBehavior","HORIZONTAL_PARTICIPANT_PADDING","VERTICAL_PARTICIPANT_PADDING","ensureCollaboration","makeCollaboration","isConnection","childrenBBox","participantBounds","getParticipantBounds","getParticipantCreateConstraints","rootElementGfx","ensureHoveringProcess","once","execute","oldProcessRef","revert","processChildren","findParticipant","TARGET_REF_PLACEHOLDER_NAME","DataInputAssociationBehavior","getTargetRef","targetRefProp","cleanupTargetRef","targetRef","removedConnection","inputAssociations","usesTargetRef","fixTargetRef","connectionBo","targetBo","newTarget","newTargetBo","oldTarget","oldTargetBo","dataAssociation","ifDataInputAssociation","UpdateSemanticParentHandler","bpmnUpdater","_bpmnUpdater","DataStoreBehavior","commandStack","getDataStores","updateDataStoreParent","dataStore","newDataStoreParent","dataStoreBo","newDataStoreParentBo","newSemanticParent","newDiParent","registerHandler","oldParent","getAncestor","descendant","ancestor","descendantBo","ancestorBo","isDescendant","oldRoot","newRoot","oldSemanticParent","oldDiParent","updateSemanticParent","updateDiParent","DeleteLaneBehavior","nested","topAdjustments","bottomAdjustments","siblings","topAffected","bottomAffected","eachElement","calculateAdjustments","makeSpace","movingShapes","resizingShapes","compensateLaneDelete","DetachEventBehavior","item","intermediateEvent","DropOnFlowBehavior","insertShape","targetFlow","positionOrBounds","waypointsBefore","waypointsAfter","dockingPoint","intersection","getApproxIntersection","bendpoint","copy","duplicateConnections","shapeMid","newShapeMid","canInsert","EventBasedGatewayBehavior","preExecuted","existingIncomingConnections","isSequenceFlow","removeConnection","sequenceFlows","incomingSequenceFlows","GroupBehavior","removeReferencedCategoryValue","removeCategory","groupElements","lineIntersect","l1s","l1e","l2s","l2e","denominator","ImportDockingFix","adjustDocking","startPoint","nextPoint","centerIntersect","elementTop","elementLeft","verticalIntersect","horizontalIntersect","getDistance","original","fixDockings","p2","sqrt","pow","IsHorizontalFix","elementTypesToUpdate","vectorLength","getAngle","perpendicularFoot","bd","system","n","lambda","solveLambaSystem","getDistancePointLine","pfPoint","getDistancePointPoint","point1","point2","sq","getCircleSegmentIntersections","s1","s2","cc","cr","baX","baY","caX","caY","pBy2","disc","tmpSqrt","abScalingFactor1","abScalingFactor2","i1","fenced","isPointInSegment","rangeStart","rangeEnd","EQUAL_THRESHOLD","pointsEqual","getLabelAdjustment","newWaypoints","oldWaypoints","labelPosition","getLabelMid","attachment","segmentStartDistance","segmentEndDistance","attachmentPosition","intersections","attachmentDistance","closestAttachmentDistance","closestAttachment","segmentIndex","bendpointIndex","relativeLocation","getAttachment","oldLabelLineIndex","newLabelLineIndex","segmentMove","oldSegmentStartIndex","segmentStartIndex","newSegmentStartIndex","bendpointMove","newIndex","insert","relativePositionMidWaypoint","findNewLabelLineStartIndex","oldLabelLine","getLine","newLabelLine","oldFoot","relativeFootPosition","foot","lengthToFoot","getRelativeFootPosition","angleDelta","l1","l2","a1","getAngleDelta","oldBendpointIndex","oldBendpoint","newBendpoint","vector","newFoot","newLabelVector","cos","sin","roundPoint","distanceSegment1","DEFAULT_LABEL_DIMENSIONS","NAME_PROPERTY","TEXT_PROPERTY","LabelBehavior","labelCenter","labelDimensions","unsetLabel","removeShape","labelBehavior","labelAdjustment","startChanged","endChanged","getVisibleLabelAdjustment","oldShape","referencePoint","newReferencePoint","getNewAttachPoint","getReferencePointDelta","lines","nearestLine","distances","l","distance","getNearestLine","getReferencePoint","COLLAB_ERR_MSG","ModelingFeedback","tooltips","showError","timeout","ReplaceConnectionBehavior","dragging","fixConnection","replacementType","remove","canConnectSequenceFlow","canConnectMessageFlow","canConnectAssociation","allConnections","replacement","canConnect","oldConnection","newConnection","previousSelection","cleanDraggingSelection","RemoveParticipantBehavior","collaborationRoot","makeProcess","ReplaceElementBehaviour","_selection","topLevel","topLevelElements","canReplace","replaceElements","replacements","unclaimId","newElements","newElementType","oldElement","oldElementId","addToTrbl","trbl","choice","current","addMin","addMax","PARTICIPANT_MIN_DIMENSIONS","SUB_PROCESS_MIN_DIMENSIONS","TEXT_ANNOTATION_MIN_DIMENSIONS","ResizeBehavior","direction","balanced","resizeConstraints","laneShape","resizeDirection","lanesRoot","isFirst","isLast","laneTrbl","maxTrbl","minTrbl","flowElement","flowElementTrbl","getParticipantResizeConstraints","minDimensions","ResizeLaneBehavior","SLIGHTLY_HIGHER_PRIORITY","roundBounds","RemoveElementBehavior","inConnection","outConnection","inWaypoints","outWaypoints","getDocking","getNewWaypoints","reconnectEnd","SpaceToolBehavior","SubProcessStartEventBehavior","ToggleElementCollapseBehaviour","defaultSize","collapsedBounds","visibleElements","visibleBBox","computeChildrenBBox","expandedBounds","UnclaimIdBehavior","shapeBo","unclaim","rootElementBo","UpdateFlowNodeRefsBehavior","laneRefUpdateEvents","UpdateContext","enter","triggerUpdate","leave","updateLaneRefs","flowNodes","releaseContext","updateContext","addFlowNode","counter","DeleteSequenceFlowBehavior","sourceBo","isDefaultFlow","adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","modelingFeedback","replaceConnectionBehavior","removeParticipantBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","removeElementBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","UnsetDefaultFlowBehavior","getBoundaryAttachment","targetBounds","BpmnRules","RuleProvider","nonExistingOrLabel","getOrganizationalParent","isTextAnnotation","isGroup","isCompensationBoundary","getScopeParent","hasEventDefinitionOrNone","isEventBasedTarget","isParent","possibleParent","parents","getParents","connectDataAssociation","canConnectDataAssociation","canDrop","hasNoEventDefinition","hasCommonBoundaryIntermediateEventDefinition","isLane","isBoundaryCandidate","isBoundaryEvent","hasOneOfEventDefinitions","canAttach","Array","isBoundaryAttachment","isReceiveTaskAfterEventBasedGateway","hasErrorEventDefinition","hasEscalationEventDefinition","hasCompensateEventDefinition","canMove","canCreate","sourceTextAnnotation","targetTextAnnotation","isOneTextAnnotation","isMessageFlowTarget","connections","isOutgoingEventBasedGatewayConnection","isSequenceFlowTarget","flow","canCopy","includes","init","addRule","canStartConnection","targetParent","targetAttach","RulesModule","BpmnDiOrdering","diElements","rootDi","selfAndAllChildren","bpmnDiOrdering","BpmnOrderingProvider","OrderingProvider","orders","order","level","containers","getOrder","o","computeOrder","getOrdering","elementOrder","actualParent","findActualParent","currentIndex","insertIndex","findIndex","bpmnOrderingProvider","BpmnFactory","_model","_needsId","_ensureId","nextPrefixed","createDiLabel","createDiBounds","createDiShape","createDiWaypoints","pos","createDiWaypoint","createDiEdge","createDiPlane","BpmnUpdater","connectionDocking","updateRoot","updateParent","updateBounds","updateConnection","updateConnectionWaypoints","updateAttachment","cropped","getCroppedWaypoints","ifBpmn","oldSourceBo","newSourceBo","oldConditionExpression","oldDefault","Label","parentBusinessObject","parentDi","updateFlowNodeRefs","_getLabel","newContainment","oldContainment","oldRefs","newRefs","updateDiConnection","planeElements","getLaneSet","visualParent","containment","diChildren","inverseSet","ElementFactory","BaseElementFactory","applyAttribute","attributeName","baseCreate","createBpmnElement","newEventDefinition","attributeNames","applyAttributes","condition","createParticipantShape","DEFAULT_FLOW","ID","DI","NULL_DIMENSIONS","UpdatePropertiesHandler","isIdChange","setProperties","setDiProperties","changed","unwrappedProps","referencePropertyNames","unwrapBusinessObjects","oldProperties","getDiProperties","getProperties","updateId","newLabelBounds","UpdateCanvasRootHandler","AddLaneHandler","_spaceTool","SplitLaneHandler","ResizeLaneHandler","newRootBusinessObject","oldRootBusinessObject","bpmnDefinitions","diPlane","location","isRoot","laneParent","allAffected","lanePosition","spacePos","adjustments","newLane","newLanesCount","existingLanesCount","laneY","laneHeight","laneBounds","newLaneAttrs","newLanesHeight","resizeBalanced","resizeSpace","change","newTrbl","trblDiff","FLOW_NODE_REFS_ATTR","LANES_ATTR","UpdateFlowNodeRefsHandler","IdClaimHandler","computeUpdates","flowNodeShapes","laneShapes","handledNodes","updates","participantCache","allFlowNodeShapes","addFlowNodeShape","flowNodeShape","getNewLanes","getAllLaneShapes","isInLaneShape","oldLane","claiming","DEFAULT_COLORS","SetColorHandler","_commandStack","colors","UpdateLabelHandler","setText","isExternal","setLabel","isEmptyText","oldLabel","Modeling","BaseModeling","_bpmnRules","getHandlers","targetLaneShape","targetLane","collaborationElement","claimId","moddleElement","oppositeOrientationMapping","orientationDirectionMapping","BpmnLayouter","getMessageFlowPreserveDocking","getConnectionDocking","isCompensationAssociation","isSame","getHorizontalOrientation","getVerticalOrientation","isHorizontalOrientation","getLoopPreferredLayout","getBoundaryEventPreferredLayouts","end","targetMid","attachOrientation","attachedElement","getAttachOrientation","attachedToSide","targetOrientation","targetLayout","sourceLayout","shouldConnectToSameSide","getBoundaryEventLoopLayout","getBoundaryEventSourceLayout","horizontalOrientation","oppositeHorizontalOrientation","isOppositeHorizontalOrientation","verticalOrientation","oppositeVerticalOrientation","isOppositeVerticalOrientation","getBoundaryEventTargetLayout","areCloseOnAxis","threshold","BaseLayouter","manhattanOptions","updatedWaypoints","preferredLayouts","preserveDocking","getMessageFlowManhattanOptions","withoutRedundantPoints","repairConnection","BehaviorModule","DiOrderingModule","OrderingModule","CommandModule","TooltipsModule","LabelSupportModule","AttachSupportModule","SpaceToolModule","layouter","CroppingConnectionDocking","PaletteProvider","palette","_palette","_lassoTool","_handTool","_globalConnect","getPaletteEntries","createAction","createListener","shortType","createLoop","startEvent","autoSelect","createParticipant","activateHand","activateSelection","separator","PaletteModule","LassoToolModule","HandToolModule","GlobalConnectModule","paletteProvider","BpmnReplacePreview","previewSupport","visualReplacements","tempShape","cssEscape","dragGroup","display","dragger","addDragger","replaceVisual","originalGfx","restoreVisual","PreviewSupportModule","bpmnReplacePreview","BOUNDARY_TO_HOST_THRESHOLD","AXES","BpmnConnectSnapping","originalEvent","initialConnectionStart","dimensionForAxis","getDimensionForAxis","setSnapped","snapToShape","getTargetBoundsPadding","snapToPosition","isMid","snapToTargetMid","isReverse","axes","newCoordinate","coordinate","snapBoundaryEventLoop","BpmnCreateMoveSnapping","CreateMoveSnapping","setSnappedIfConstrained","attach","isSnapped","targetTRBL","snapBoundaryEvent","getDockingSnapOrigin","docking","isMove","initSnap","snapContext","setSnapOrigin","setSnapLocations","addSnapTargetPoints","snapPoints","snapTargets","getSnapTargets","snapTarget","isContainer","topLeft","bottomRight","SnappingModule","connectSnapping","createMoveSnapping","BpmnSearchProvider","hasMatched","tokens","matched","matchAndSplit","pattern","originalText","normal","substr","primaryTokens","secondaryTokens","SearchPadModule","bpmnSearch","Modeler","createDiagram","_interactionModules","TouchModule","_modelingModules","AlignElementsModule","AutoPlaceModule","AutoScrollModule","BendpointsModule","AutoResizeModule","ConnectionPreviewModule","InteractionEventsModule","KeyboardMoveSelectionModule","LabelEditingModule","ModelingModule","MoveModule","ReplacePreviewModule","SearchModule","lastCookieString","lastCookies","headers","Headers","cookieString","document","cookie","readCookie","baseURL","url","method","fetch","then","ok","json","catch","credentials","mode","JSON","stringify","request","entity","record","post","log","FILL_COLORS","COLUMNS","HEADERS_KEYS","HEADERS_VALUES","STROKE_COLORS","blue","orange","green","teal","purple","red","pink","cyan","brown","deleteRequest","Service","deleteConnector","deleteAuth","addAuth","criteria","addConnector","autheticate","runTestConnector","getAuthById","fetchRecord","getRequestById","modelFullName","getModels","metaModalType","dmnModels","getMetaModels","models","getCustomModels","metaJsonModels","allModels","getDMNModels","getDMNFields","getResultedFields","responseData","allFields","fields","jsonFields","jsonField","nestedFields","getViews","fieldName","operator","fullName","views","_","getButtons","buttons","metaModeNames","modelNames","formName","getFormName","view","formView","btns","getItemsByType","buttonFields","f","getFormViews","formViewNames","_domain","_domainContext","names","status","defaultForms","arrs","accumulator","Promise","resolve","forms","formData","form","getAllRequest","getApps","getAllConnector","getConnectorById","getAllAuthentication","getkeys","idFields","_field_ids","_archived","limit","getLabraries","libraryId","getParams","transformationId","sort","getGroovyBasicPayload","transformations","wsValue","params","operation","parameters","groovy","groovyTemplate","newGroovy","multiArg","replaceAll","trans","gr","fromPayloadsToPayloads","listPayloads","list","isList","subWsKeyValueList","wsKey","pays","payloads","subKeyValues","payModel","pay","getGroovyListPayload","object","useDebounce","cb","duration","timer","React","useRef","clearTimer","clearTimeout","setTimer","useEffect","args","collectItems","items","formString","window","_t","useStyles","makeStyles","desciption","color","input","outline","Description","classes","useState","desc","setDesc","description","classnames","onChange","onBlur","flexDirection","marginTop","verticalAlign","marginBottom","textarea","boxShadow","borderColor","readOnly","Textbox","rows","bpmnModeler","setValue","errorMessage","setErrorMessage","isError","setError","getProperty","useCallback","expression","updateProperty","setProperty","getValidation","valid","TextareaAutosize","Date","rowsMin","fieldWrapper","clearButton","background","border","overflow","alignItems","TextField","canRemove","rootClass","labelClass","modelProperty","onClick","Close","SelectBox","emptyParameter","selectOptions","canBeDisabled","canBeHidden","setOptions","selectedOption","setSelectedOption","dynamicOptions","htmlFor","data-disable","data-show","option","checkbox","Checkbox","defaultValue","auth","checked","theme","autoComplete","common","black","endAdornment","circularProgress","errorDescription","labelTitle","SelectComponent","optionLabel","multiple","criteriaIds","propOptions","setOpen","searchText","setsearchText","loading","setLoading","fetchMethod","valueObj","fetchOptions","interval","isMounted","useDebounceEffect","inputFocused","clearIndicator","popupIndicator","onOpen","stopPropagation","onClose","clearOnEscape","getOptionSelected","optionName","onInputChange","renderInput","helperText","fullWidth","InputProps","Fragment","CircularProgress","disableUnderline","inputProps","InputLabelProps","getOptionLabel","getKey","listbox","maxHeight","inputSelected","whiteSpace","textOverflow","AutoComplete","isMulti","selectedValue","setSelectedValue","inputValue","setInputValue","flatOptions","optionLabelKey","optionValueKey","fetchAPI","inline","filterSelectedOptions","disableCloseOnSelect","concatValue","isProcessContext","inputRootClass","findOption","delayChange","onKeyDown","handleChange","reason","checkValue","Autocomplete","_uniqueId","disabled","newValue","inputRoot","newOptions","freeSolo","assignElements","backgroundColor","borderBottom","ExtensionElementTable","defaultOptions","setOptionLabelValue","createExtensionElement","onSelectionChange","removeExtensionElement","data-list-entry-container","header","icon","addButton","editButton","edit","Add","Edit","flexWrap","Selection","rest","FormControl","formControl","InputLabel","Select","marginRight","MenuItem","InputField","autoTitle","Input","placeholder","defaultProps","button","textTransform","buttonLabel","ButtonComp","Icon","Button","endIcon","IconButton","NumberField","blur","customeFormat","setVal","formatValue","Number","toFixed","combinator","map_combinator","and","or","map_bpm_combinator","join_operator","JS","GROOVY","BPM","dateFormat","date","time","datetime","positive_operators","query_custom_types","allowed_types","operators_by_type","enum","integer","boolean","map_operator","in","notIn","like","notLike","isNotNull","isNull","isTrue","isFalse","contains","notContains","operators","PICKERS","KeyboardDatePicker","KeyboardTimePicker","KeyboardDateTimePicker","DateTimePicker","valueRef","Picker","utils","MomentUtils","autoOk","ampm","PopoverProps","anchorOrigin","vertical","horizontal","transformOrigin","disableToolbar","variant","invalidDateMessage","animateYearScrolling","keyCode","chip","popper","$classes","renderTags","getTagProps","Chip","PopperComponent","CustomPopper","Popper","placement","timeline","timelineOppositeContent","justifyContent","maxWidth","timelineItem","timelineDot","timelineConnector","joinURL","subURL","AxelorService","services","_subURL","spread","records","metaModalService","metaFieldService","isQuery","isM2OField","isContextValue","targetName","getMetaFields","packageName","zonedDateTimeFieldsRes","zonedDateTimeFields","field","getMetaModal","isM2MFields","relationJsonModel","isAllowedButtons","metaModel","metaFields","resultFields","getData","modelService","getCustomModelData","jsonModel","getNameField","isBPMQuery","lowerCaseFirstLetter","getBO","getProcessConfig","processConfigs","extensionElements","noOptions","processConfigurations","metaModels","processConfigurationParameters","metaJsonModel","getJsonExpression","JOIN_OPERATOR","OPERATORS_BY_TYPE","menu_item","addOperatorByType","MuiAutocompleteRoot","iconButton","FieldEditor","initValue","editor","classNames","parentExpression","isBPM","isField","setInitialField","isAllowButtons","allField","setFields","isShow","setShow","useMemo","startValue","hasManyValues","relationModel","jsonTarget","fieldType","isM2MField","isOneToOne","isRelationalField","newFieldName","spiltedValues","getUpdatedValue","fieldNames","filterFields","fName","fieldNameValue","initValues","transformValue","fetchSubFields","getSubMetaField","isName","previousField","Tooltip","Container","rulesGroupHeader","paper","spacing","opacity","valueFrom","radio","fetchField","metaModals","getMetaFieldsAPI","RenderRelationalWidget","internalProps","parentType","targetModel","nameField","setNameField","fetchData","fieldData","isNameField","RenderSimpleWidget","Component","value2","RenderWidget","fieldValue","fieldValue2","widgetProps","stringToDate","moment","selectionList","Rule","onRemoveRule","parentMetaModal","isRelationalValue","relatedValueModal","relatedValueFieldName","relatedElseValueModal","relatedElseValueFieldName","showMetaModelField","isShowMetaModelField","showElseMetaModelField","isShowElseMetaModelField","setField","metaModal","setMetaModal","setIsShowMetaModelField","elseMetaModal","setElseMetaModal","setIsShowElseMetaModelField","getValue","elseNameValue","setElseNameValue","nameValue","setNameValue","operatorsOptions","operatorType","parentField","RadioGroup","aria-label","FormControlLabel","control","Radio","ArrowForward","DeleteIcon","Editor","onAddGroup","isRemoveGroup","onRemoveGroup","onAddRule","getChildEditors","isDisable","setBPM","childEditors","Paper","Timeline","TimelineItem","TimelineOppositeContent","TimelineSeparator","TimelineDot","TimelineConnector","TimelineContent","AddIcon","rule","MuiAutocompleteRoot1","flexGrow","popoverContainer","typography","popoverHeader","defaultRules","parentId","defaultState","ExpressionBuilder","allowAllModels","defaultModel","setMetaModals","setRules","getDMNValues","refs","elementProcessId","ele","decisionRef","dmnTables","tables","table","decisionId","dmnNodeId","dmnNodeNameId","resultVariable","isDMNAllow","state","produce","draft","editorId","editorIndex","dmnFieldIds","outputDmnFieldList","dmnFields","expressionContainer","dialogPaper","dialog","save","handleClose","getExpression","setCombinator","openAlert","setAlert","ExpressionComponent","expressionComponents","setExpressionComponents","singleResult","setSingleResult","generateWithId","setGenerateWithId","alertMessage","alertTitle","alertConfig","setAlertConfig","isClose","setClose","initialValues","setInitialValues","getRelationalCondition","map_operators","propFieldName","nameColumn","findRelational","nestedFieldName","isDateTime","jsStringEscape","getDateTimeValue","isManyToManyField","temp","fieldNew","isJsonField","toISOString","getCondition","modalName","upperCaseFirstLetter","map_type","getBPMCondition","parentCount","returnValues","parentCustomField","jsonFieldName","relatedValueModalName","relatedElseValueModalName","isRelatedModalSame","isRelatedElseModalSame","getBPMCriteria","isChildren","conditions","childrenConditions","parentValues","co","childrenValues","newValues","apply","childConditions","childValues","isChild","getCriteria","getListOfTree","roots","generateExpression","expressionValues","vals","expressions","isValid","parentNodes","flattenDeep","allRules","fValue","isNaN","checkValidation","listOfTree","expressionValue","metaModalName","expr","isSubscribed","fetchValue","Dialog","aria-labelledby","DialogTitle","combinators","onRemoveExpressionEditor","generateExpressionValues","aria-describedby","DialogContent","DialogContentText","DialogActions","autoFocus","expressionBuilder","newIcon","marginLeft","new","textbox","ScriptProps","openMapper","setMapper","setAlertTitle","setAlertMessage","setReadOnly","NotInterested","scriptValue","errror","fetchModels","CustomContextPadProvider","isCustom","CustomRules","customRules","removeElement","groupLabel","transition","fontStyle","divider","borderTop","PARAMETER_ELEMENT","getParameterElements","fetchParameterElements","getParameters","ParameterProps","parameterEntity","setParameterEntity","parameterOptions","setParameterOptions","getParameterElement","addOptions","isInitial","idGeneration","extensionEle","newElem","ind","parameterElement","tabProperty","widget","onchange","dialogTitle","tableBody","JsonViewer","showJson","setShowJson","onEntered","getElementById","innerHTML","prettyPrintJson","toHtml","linkUrls","quoteKeys","StyledTableCell","withStyles","head","white","TableCell","StyledTableRow","TableRow","CustomizedTables","modelParameters","useSelector","requestReducer","modelPayloads","payloadReducer","headerReducer","setModels","TableContainer","component","Table","TableHead","TableBody","scope","cercle","Line","fieldSelect","baseModelParams","addBaseModelParams","scrollDiv","ParameterBuilder","parametersTrans","setParemeters","renderComponent","newP","isOptional","Filter","deleteTransformation","transformation","setTransformation","showParam","setShowParam","fetchParams","library","ArrowRightAlt","getTransformations","modelParams","TransformationBuilder","initialData","onSave","_e","newTrans","handleTransformation","deleteFilter","textField","Parameter","deleteParam","correspondingFields","parameter","showTransformation","setShowTransformation","setParam","modelParameter","paperParams","inputSelect","block","ModelParameter","handleChangeParam","deleteModelParam","addParameter","handleParameterChange","idParam","newModelParameter","handleDelete","par","sendRequest","createAsyncThunk","response","requestSlice","createSlice","initialState","reducers","updateModelParam","addModelParam","modelParam","reducer","saveButtonText","saveMessageAlert","RequestBuilder","dispatch","useDispatch","modelParametersStore","setModelParameters","isAllFields","empty","handelDeleteModelParam","newModelParam","handleChangeModelParam","Header","headerSlice","updateHeader","addHeader","modelHeaders","deleteHeader","HeaderBuilder","headersFromStore","setHeaders","handelDeleteHeader","newHeaders","Payload","deletePayload","payload_","setPayload","embedded","setShowEmbeeded","handleSaveEmbedded","Clear","modelPayload","ModelPayload","handleChangePayload","deleteModelPayload","addPayload","handlePayloadChange","idPayload","newModelPayload","handleEmbeddedPayloadChange","emPayload","idPay","resetCorrespondingFields","handelAddPayload","handelAddEmbeddedPayload","PayloadBuilder","setModelPayloads","queryCriteria","handelDeleteModelPayload","addEmbeededPayload","handleChangeModelPayload","payloadSlice","updateModelPayload","addModelPayload","updateCriteria","containerTable","Expression","setBuilder","setAction","handleCloseMapper","handleSave","Checkboxs","boxs","contextSlice","targets","updateTarget","addTarget","deleteTarget","contextReducer","store","configureStore","tabPropertyAuth","tabPropertyConnector","AuthentificationField","borderTopRightRadius","borderTopLeftRadius","testArea","success","btn","Sucess","TestConnector","connector","setResult","runTest","actionRequest","authenticator","defaultWsAuthenticator","_recordId","_recordModel","RotateLeft","PlayArrow","addRequest","TextFieldMapper","readOnlyEdit","modelPayloadsStore","newPayloads","Check","formControlLabel","notAuth","AuthentificationAction","isAuthenticated","isAuth","setAuth","ModelTarget","deleteModelTarget","modelTarget","setTarget","getRecords","ContextBuilder","targetsFromStore","setTargets","targetsModel","modelTargets","resizeStyle","borderLeft","drawer","DRAWER_WIDTH","flexShrink","drawerPaper","drawerContainer","nodeTitle","propertyLable","toolTip","toolTipFont","flex","btnContainer","consoleHeader","paddingInline","iconParams","tabNav","messageResponseSuccess","messageResponseError","tabPanel","tabPanelConsole","tabStyle","toolbarButtons","bpmnModelerAuth","bpmnModelerConnector","bpmnModelerGlobal","MODELS","WebServiceEditor","setWidth","setHeight","drawerOpen","setDrawerOpen","setElement","setModel","consoleResponse","setConsole","setRequest","authRequest","setAuthRequest","setConnector","formatter","messageType","openSnackbar","setSnackbar","parametersMenu","showParametersMenu","criteriaQuery","modelParamStore","headersStore","setCSSWidth","documentElement","handleSnackbarClick","handleSnackbarClose","Nelement","studioApp","requestTypeSelect","wsUrl","idRequest","callIf","repeatIf","payLoadTypeSelect","versionRequest","version","overlays","ReactDOM","createMapper","mapper","authWsRequest","createConnectorMapper","wsRequestList","mappers","createMapperQauth","mapper2","mapper3","tokenWsRequest","refreshTokenWsRequest","getRequest","getAuth","createNewRequest","createNewAuth","req","headerWsKeyValueList","payLoadWsKeyValueList","parameterWsKeyValueList","removeRequest","buildPay","resultPay","subList","saveRequest","verificationFieldsRequest","verifySaveRequest","verifyParamsChanges","verifyHeadersChanges","verifySaveConnector","baseUrl","getConnector","related","removeConnector","verificationFieldsConnector","saveConnector","requests","createNewConnector","changeRequestAuth","wsConnector","authTypeSelect","removeAuth","onChangeSelectAuth","verifySaveAuth","verificationFieldsAuth","saveAuthentification","toolBarButtons","AddBox","tooltipText","Save","PlayCircleFilled","$version","Menu","classic","autheticateAction","requestAuth","a11yProps","openDiagramImage","bamlXml","fetchDiagram","BpmnModeler","customControlsModuleRequest","customControlsModuleAuth","setColors","forceUpdate","JSONFormatter","Infinity","hoverPreviewEnabled","hoverPreviewArrayCount","hoverPreviewFieldCount","animateOpen","animateClose","useToJSON","dx","REQUEST","onChangeSelect","AUTHENTICATION","CONNECTOR","onChangeSelectConnector","onResizeStop","innerWidth","Drawer","anchor","TabContext","Box","Tabs","Tab","TabPanel","Snackbar","autoHideDuration","Alert","elevation","severity","dangerouslySetInnerHTML","__html","App"],"mappings":"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","file":"static/js/main.7571085a.chunk.js","sourcesContent":["import { forEach, bind, pick, assign, isString, isObject } from \"min-dash\";\n\n/**\n * Moddle base element.\n */\nfunction Base() {}\n\nBase.prototype.get = function (name) {\n  return this.$model.properties.get(this, name);\n};\n\nBase.prototype.set = function (name, value) {\n  this.$model.properties.set(this, name, value);\n};\n\n/**\n * A model element factory.\n *\n * @param {Moddle} model\n * @param {Properties} properties\n */\nfunction Factory(model, properties) {\n  this.model = model;\n  this.properties = properties;\n}\n\nFactory.prototype.createType = function (descriptor) {\n  let model = this.model;\n\n  let props = this.properties,\n    prototype = Object.create(Base.prototype);\n\n  // initialize default values\n  forEach(descriptor.properties, function (p) {\n    if (!p.isMany && p.default !== undefined) {\n      prototype[p.name] = p.default;\n    }\n  });\n\n  props.defineModel(prototype, model);\n  props.defineDescriptor(prototype, descriptor);\n\n  let name = descriptor.ns.name;\n\n  /**\n   * The new type constructor\n   */\n  function ModdleElement(attrs) {\n    props.define(this, \"$type\", { value: name, enumerable: true });\n    props.define(this, \"$attrs\", { value: {} });\n    props.define(this, \"$parent\", { writable: true });\n\n    forEach(\n      attrs,\n      bind(function (val, key) {\n        this.set(key, val);\n      }, this)\n    );\n  }\n\n  ModdleElement.prototype = prototype;\n\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\n\n  // static links\n  props.defineModel(ModdleElement, model);\n  props.defineDescriptor(ModdleElement, descriptor);\n\n  return ModdleElement;\n};\n\n/**\n * Built-in moddle types\n */\nlet BUILTINS = {\n  String: true,\n  Boolean: true,\n  Integer: true,\n  Real: true,\n  Element: true,\n};\n\n/**\n * Converters for built in types from string representations\n */\nlet TYPE_CONVERTERS = {\n  String: function (s) {\n    return s;\n  },\n  Boolean: function (s) {\n    return s === \"true\";\n  },\n  Integer: function (s) {\n    return parseInt(s, 10);\n  },\n  Real: function (s) {\n    return parseFloat(s, 10);\n  },\n};\n\n/**\n * Convert a type to its real representation\n */\nfunction coerceType(type, value) {\n  let converter = TYPE_CONVERTERS[type];\n\n  if (converter) {\n    return converter(value);\n  } else {\n    return value;\n  }\n}\n\n/**\n * Return whether the given type is built-in\n */\nfunction isBuiltIn(type) {\n  return !!BUILTINS[type];\n}\n\n/**\n * Return whether the given type is simple\n */\nfunction isSimple(type) {\n  return !!TYPE_CONVERTERS[type];\n}\n\n/**\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\n * given a default prefix to assume in case no explicit namespace is given.\n *\n * @param {String} name\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\n *\n * @return {Object} the parsed name\n */\nfunction parseName(name, defaultPrefix) {\n  let parts = name.split(/:/),\n    localName,\n    prefix;\n\n  // no prefix (i.e. only local name)\n  if (parts.length === 1) {\n    localName = name;\n    prefix = defaultPrefix;\n  }\n  // prefix + local name\n  else if (parts.length === 2) {\n    localName = parts[1];\n    prefix = parts[0];\n  } else {\n    throw new Error(\"expected <prefix:localName> or <localName>, got \" + name);\n  }\n\n  name = (prefix ? prefix + \":\" : \"\") + localName;\n\n  return {\n    name: name,\n    prefix: prefix,\n    localName: localName,\n  };\n}\n\n/**\n * A utility to build element descriptors.\n */\nfunction DescriptorBuilder(nameNs) {\n  this.ns = nameNs;\n  this.name = nameNs.name;\n  this.allTypes = [];\n  this.allTypesByName = {};\n  this.properties = [];\n  this.propertiesByName = {};\n}\n\nDescriptorBuilder.prototype.build = function () {\n  return pick(this, [\n    \"ns\",\n    \"name\",\n    \"allTypes\",\n    \"allTypesByName\",\n    \"properties\",\n    \"propertiesByName\",\n    \"bodyProperty\",\n    \"idProperty\",\n  ]);\n};\n\n/**\n * Add property at given index.\n *\n * @param {Object} p\n * @param {Number} [idx]\n * @param {Boolean} [validate=true]\n */\nDescriptorBuilder.prototype.addProperty = function (p, idx, validate) {\n  if (typeof idx === \"boolean\") {\n    validate = idx;\n    idx = undefined;\n  }\n\n  this.addNamedProperty(p, validate !== false);\n\n  let properties = this.properties;\n\n  if (idx !== undefined) {\n    properties.splice(idx, 0, p);\n  } else {\n    properties.push(p);\n  }\n};\n\nDescriptorBuilder.prototype.replaceProperty = function (\n  oldProperty,\n  newProperty,\n  replace\n) {\n  let oldNameNs = oldProperty.ns;\n\n  let props = this.properties,\n    propertiesByName = this.propertiesByName,\n    rename = oldProperty.name !== newProperty.name;\n\n  if (oldProperty.isId) {\n    if (!newProperty.isId) {\n      throw new Error(\n        \"property <\" +\n          newProperty.ns.name +\n          \"> must be id property \" +\n          \"to refine <\" +\n          oldProperty.ns.name +\n          \">\"\n      );\n    }\n\n    this.setIdProperty(newProperty, false);\n  }\n\n  if (oldProperty.isBody) {\n    if (!newProperty.isBody) {\n      throw new Error(\n        \"property <\" +\n          newProperty.ns.name +\n          \"> must be body property \" +\n          \"to refine <\" +\n          oldProperty.ns.name +\n          \">\"\n      );\n    }\n\n    // TODO: Check compatibility\n    this.setBodyProperty(newProperty, false);\n  }\n\n  // validate existence and get location of old property\n  let idx = props.indexOf(oldProperty);\n  if (idx === -1) {\n    throw new Error(\n      \"property <\" + oldNameNs.name + \"> not found in property list\"\n    );\n  }\n\n  // remove old property\n  props.splice(idx, 1);\n\n  // replacing the named property is intentional\n  //\n  //  * validate only if this is a \"rename\" operation\n  //  * add at specific index unless we \"replace\"\n  //\n  this.addProperty(newProperty, replace ? undefined : idx, rename);\n\n  // make new property available under old name\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] =\n    newProperty;\n};\n\nDescriptorBuilder.prototype.redefineProperty = function (\n  p,\n  targetPropertyName,\n  replace\n) {\n  let nsPrefix = p.ns.prefix;\n  let parts = targetPropertyName.split(\"#\");\n\n  let name = parseName(parts[0], nsPrefix);\n  let attrName = parseName(parts[1], name.prefix).name;\n\n  let redefinedProperty = this.propertiesByName[attrName];\n  if (!redefinedProperty) {\n    throw new Error(\"refined property <\" + attrName + \"> not found\");\n  } else {\n    this.replaceProperty(redefinedProperty, p, replace);\n  }\n\n  delete p.redefines;\n};\n\nDescriptorBuilder.prototype.addNamedProperty = function (p, validate) {\n  let ns = p.ns,\n    propsByName = this.propertiesByName;\n\n  if (validate) {\n    this.assertNotDefined(p, ns.name);\n    this.assertNotDefined(p, ns.localName);\n  }\n\n  propsByName[ns.name] = propsByName[ns.localName] = p;\n};\n\nDescriptorBuilder.prototype.removeNamedProperty = function (p) {\n  let ns = p.ns,\n    propsByName = this.propertiesByName;\n\n  delete propsByName[ns.name];\n  delete propsByName[ns.localName];\n};\n\nDescriptorBuilder.prototype.setBodyProperty = function (p, validate) {\n  if (validate && this.bodyProperty) {\n    throw new Error(\n      \"body property defined multiple times \" +\n        \"(<\" +\n        this.bodyProperty.ns.name +\n        \">, <\" +\n        p.ns.name +\n        \">)\"\n    );\n  }\n\n  this.bodyProperty = p;\n};\n\nDescriptorBuilder.prototype.setIdProperty = function (p, validate) {\n  if (validate && this.idProperty) {\n    throw new Error(\n      \"id property defined multiple times \" +\n        \"(<\" +\n        this.idProperty.ns.name +\n        \">, <\" +\n        p.ns.name +\n        \">)\"\n    );\n  }\n\n  this.idProperty = p;\n};\n\nDescriptorBuilder.prototype.assertNotDefined = function (p, name) {\n  let propertyName = p.name,\n    definedProperty = this.propertiesByName[propertyName];\n\n  if (definedProperty) {\n    throw new Error(\n      \"property <\" +\n        propertyName +\n        \"> already defined; \" +\n        \"override of <\" +\n        definedProperty.definedBy.ns.name +\n        \"#\" +\n        definedProperty.ns.name +\n        \"> by \" +\n        \"<\" +\n        p.definedBy.ns.name +\n        \"#\" +\n        p.ns.name +\n        \"> not allowed without redefines\"\n    );\n  }\n};\n\nDescriptorBuilder.prototype.hasProperty = function (name) {\n  return this.propertiesByName[name];\n};\n\nDescriptorBuilder.prototype.addTrait = function (t, inherited) {\n  let typesByName = this.allTypesByName,\n    types = this.allTypes;\n\n  let typeName = t.name;\n\n  if (typeName in typesByName) {\n    return;\n  }\n\n  forEach(\n    t.properties,\n    bind(function (p) {\n      // clone property to allow extensions\n      p = assign({}, p, {\n        name: p.ns.localName,\n        inherited: inherited,\n      });\n\n      Object.defineProperty(p, \"definedBy\", {\n        value: t,\n      });\n\n      let replaces = p.replaces,\n        redefines = p.redefines;\n\n      // add replace/redefine support\n      if (replaces || redefines) {\n        this.redefineProperty(p, replaces || redefines, replaces);\n      } else {\n        if (p.isBody) {\n          this.setBodyProperty(p);\n        }\n        if (p.isId) {\n          this.setIdProperty(p);\n        }\n        this.addProperty(p);\n      }\n    }, this)\n  );\n\n  types.push(t);\n  typesByName[typeName] = t;\n};\n\n/**\n * A registry of Moddle packages.\n *\n * @param {Array<Package>} packages\n * @param {Properties} properties\n */\nfunction Registry(packages, properties) {\n  this.packageMap = {};\n  this.typeMap = {};\n\n  this.packages = [];\n\n  this.properties = properties;\n\n  forEach(packages, bind(this.registerPackage, this));\n}\n\nRegistry.prototype.getPackage = function (uriOrPrefix) {\n  return this.packageMap[uriOrPrefix];\n};\n\nRegistry.prototype.getPackages = function () {\n  return this.packages;\n};\n\nRegistry.prototype.registerPackage = function (pkg) {\n  // copy package\n  pkg = assign({}, pkg);\n\n  let pkgMap = this.packageMap;\n\n  ensureAvailable(pkgMap, pkg, \"prefix\");\n  ensureAvailable(pkgMap, pkg, \"uri\");\n\n  // register types\n  forEach(\n    pkg.types,\n    bind(function (descriptor) {\n      this.registerType(descriptor, pkg);\n    }, this)\n  );\n\n  pkgMap[pkg.uri] = pkgMap[pkg.prefix] = pkg;\n  this.packages.push(pkg);\n};\n\n/**\n * Register a type from a specific package with us\n */\nRegistry.prototype.registerType = function (type, pkg) {\n  type = assign({}, type, {\n    superClass: (type.superClass || []).slice(),\n    extends: (type.extends || []).slice(),\n    properties: (type.properties || []).slice(),\n    meta: assign(type.meta || {}),\n  });\n\n  let ns = parseName(type.name, pkg.prefix),\n    name = ns.name,\n    propertiesByName = {};\n\n  // parse properties\n  forEach(\n    type.properties,\n    bind(function (p) {\n      // namespace property names\n      let propertyNs = parseName(p.name, ns.prefix),\n        propertyName = propertyNs.name;\n\n      // namespace property types\n      if (!isBuiltIn(p.type)) {\n        p.type = parseName(p.type, propertyNs.prefix).name;\n      }\n\n      assign(p, {\n        ns: propertyNs,\n        name: propertyName,\n      });\n\n      propertiesByName[propertyName] = p;\n    }, this)\n  );\n\n  // update ns + name\n  assign(type, {\n    ns: ns,\n    name: name,\n    propertiesByName: propertiesByName,\n  });\n\n  forEach(\n    type.extends,\n    bind(function (extendsName) {\n      let extended = this.typeMap[extendsName];\n\n      extended.traits = extended.traits || [];\n      extended.traits.push(name);\n    }, this)\n  );\n\n  // link to package\n  this.definePackage(type, pkg);\n\n  // register\n  this.typeMap[name] = type;\n};\n\n/**\n * Traverse the type hierarchy from bottom to top,\n * calling iterator with (type, inherited) for all elements in\n * the inheritance chain.\n *\n * @param {Object} nsName\n * @param {Function} iterator\n * @param {Boolean} [trait=false]\n */\nRegistry.prototype.mapTypes = function (nsName, iterator, trait) {\n  let type = isBuiltIn(nsName.name)\n    ? { name: nsName.name }\n    : this.typeMap[nsName.name];\n\n  let self = this;\n\n  /**\n   * Traverse the selected trait.\n   *\n   * @param {String} cls\n   */\n  function traverseTrait(cls) {\n    return traverseSuper(cls, true);\n  }\n\n  /**\n   * Traverse the selected super type or trait\n   *\n   * @param {String} cls\n   * @param {Boolean} [trait=false]\n   */\n  function traverseSuper(cls, trait) {\n    let parentNs = parseName(cls, isBuiltIn(cls) ? \"\" : nsName.prefix);\n    self.mapTypes(parentNs, iterator, trait);\n  }\n\n  if (!type) {\n    throw new Error(\"unknown type <\" + nsName.name + \">\");\n  }\n\n  forEach(type.superClass, trait ? traverseTrait : traverseSuper);\n\n  // call iterator with (type, inherited=!trait)\n  iterator(type, !trait);\n\n  forEach(type.traits, traverseTrait);\n};\n\n/**\n * Returns the effective descriptor for a type.\n *\n * @param  {String} type the namespaced name (ns:localName) of the type\n *\n * @return {Descriptor} the resulting effective descriptor\n */\nRegistry.prototype.getEffectiveDescriptor = function (name) {\n  let nsName = parseName(name);\n\n  let builder = new DescriptorBuilder(nsName);\n\n  this.mapTypes(nsName, function (type, inherited) {\n    builder.addTrait(type, inherited);\n  });\n\n  let descriptor = builder.build();\n\n  // define package link\n  this.definePackage(\n    descriptor,\n    descriptor.allTypes[descriptor.allTypes.length - 1].$pkg\n  );\n\n  return descriptor;\n};\n\nRegistry.prototype.definePackage = function (target, pkg) {\n  this.properties.define(target, \"$pkg\", { value: pkg });\n};\n\n///////// helpers ////////////////////////////\n\nfunction ensureAvailable(packageMap, pkg, identifierKey) {\n  let value = pkg[identifierKey];\n\n  if (value in packageMap) {\n    throw new Error(\n      \"package with \" + identifierKey + \" <\" + value + \"> already defined\"\n    );\n  }\n}\n\n/**\n * A utility that gets and sets properties of model elements.\n *\n * @param {Model} model\n */\nfunction Properties(model) {\n  this.model = model;\n}\n\n/**\n * Sets a named property on the target element.\n * If the value is undefined, the property gets deleted.\n *\n * @param {Object} target\n * @param {String} name\n * @param {Object} value\n */\nProperties.prototype.set = function (target, name, value) {\n  let property = this.model.getPropertyDescriptor(target, name);\n\n  let propertyName = property && property.name;\n\n  if (isUndefined(value)) {\n    // unset the property, if the specified value is undefined;\n    // delete from $attrs (for extensions) or the target itself\n    if (property) {\n      delete target[propertyName];\n    } else {\n      delete target.$attrs[name];\n    }\n  } else {\n    // set the property, defining well defined properties on the fly\n    // or simply updating them in target.$attrs (for extensions)\n    if (property) {\n      if (propertyName in target) {\n        target[propertyName] = value;\n      } else {\n        defineProperty(target, property, value);\n      }\n    } else {\n      target.$attrs[name] = value;\n    }\n  }\n};\n\n/**\n * Returns the named property of the given element\n *\n * @param  {Object} target\n * @param  {String} name\n *\n * @return {Object}\n */\nProperties.prototype.get = function (target, name) {\n  let property = this.model.getPropertyDescriptor(target, name);\n\n  if (!property) {\n    return target.$attrs[name];\n  }\n\n  let propertyName = property.name;\n\n  // check if access to collection property and lazily initialize it\n  if (!target[propertyName] && property.isMany) {\n    defineProperty(target, property, []);\n  }\n\n  return target[propertyName];\n};\n\n/**\n * Define a property on the target element\n *\n * @param  {Object} target\n * @param  {String} name\n * @param  {Object} options\n */\nProperties.prototype.define = function (target, name, options) {\n  Object.defineProperty(target, name, options);\n};\n\n/**\n * Define the descriptor for an element\n */\nProperties.prototype.defineDescriptor = function (target, descriptor) {\n  this.define(target, \"$descriptor\", { value: descriptor });\n};\n\n/**\n * Define the model for an element\n */\nProperties.prototype.defineModel = function (target, model) {\n  this.define(target, \"$model\", { value: model });\n};\n\nfunction isUndefined(val) {\n  return typeof val === \"undefined\";\n}\n\nfunction defineProperty(target, property, value) {\n  Object.defineProperty(target, property.name, {\n    enumerable: !property.isReference,\n    writable: true,\n    value: value,\n    configurable: true,\n  });\n}\n\n//// Moddle implementation /////////////////////////////////////////////////\n\n/**\n * @class Moddle\n *\n * A model that can be used to create elements of a specific type.\n *\n * @example\n *\n * let Moddle = require('moddle');\n *\n * let pkg = {\n *   name: 'mypackage',\n *   prefix: 'my',\n *   types: [\n *     { name: 'Root' }\n *   ]\n * };\n *\n * let moddle = new Moddle([pkg]);\n *\n * @param {Array<Package>} packages the packages to contain\n */\nfunction Moddle(packages) {\n  this.properties = new Properties(this);\n\n  this.factory = new Factory(this, this.properties);\n  this.registry = new Registry(packages, this.properties);\n\n  this.typeCache = {};\n}\n\n/**\n * Create an instance of the specified type.\n *\n * @method Moddle#create\n *\n * @example\n *\n * let foo = moddle.create('my:Foo');\n * let bar = moddle.create('my:Bar', { id: 'BAR_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\n * @return {Object}         model instance\n */\nModdle.prototype.create = function (descriptor, attrs) {\n  let Type = this.getType(descriptor);\n\n  if (!Type) {\n    throw new Error(\"unknown type <\" + descriptor + \">\");\n  }\n\n  return new Type(attrs);\n};\n\n/**\n * Returns the type representing a given descriptor\n *\n * @method Moddle#getType\n *\n * @example\n *\n * let Foo = moddle.getType('my:Foo');\n * let foo = new Foo({ 'id' : 'FOO_1' });\n *\n * @param  {String|Object} descriptor the type descriptor or name know to the model\n * @return {Object}         the type representing the descriptor\n */\nModdle.prototype.getType = function (descriptor) {\n  let cache = this.typeCache;\n\n  let name = isString(descriptor) ? descriptor : descriptor.ns.name;\n\n  let type = cache[name];\n\n  if (!type) {\n    descriptor = this.registry.getEffectiveDescriptor(name);\n    type = cache[name] = this.factory.createType(descriptor);\n  }\n\n  return type;\n};\n\n/**\n * Creates an any-element type to be used within model instances.\n *\n * This can be used to create custom elements that lie outside the meta-model.\n * The created element contains all the meta-data required to serialize it\n * as part of meta-model elements.\n *\n * @method Moddle#createAny\n *\n * @example\n *\n * let foo = moddle.createAny('vendor:Foo', 'http://vendor', {\n *   value: 'bar'\n * });\n *\n * let container = moddle.create('my:Container', 'http://my', {\n *   any: [ foo ]\n * });\n *\n * // go ahead and serialize the stuff\n *\n *\n * @param  {String} name  the name of the element\n * @param  {String} nsUri the namespace uri of the element\n * @param  {Object} [properties] a map of properties to initialize the instance with\n * @return {Object} the any type instance\n */\nModdle.prototype.createAny = function (name, nsUri, properties) {\n  let nameNs = parseName(name);\n\n  let element = {\n    $type: name,\n    $instanceOf: function (type) {\n      return type === this.$type;\n    },\n  };\n\n  let descriptor = {\n    name: name,\n    isGeneric: true,\n    ns: {\n      prefix: nameNs.prefix,\n      localName: nameNs.localName,\n      uri: nsUri,\n    },\n  };\n\n  this.properties.defineDescriptor(element, descriptor);\n  this.properties.defineModel(element, this);\n  this.properties.define(element, \"$parent\", {\n    enumerable: false,\n    writable: true,\n  });\n\n  forEach(properties, function (a, key) {\n    if (isObject(a) && a.value !== undefined) {\n      element[a.name] = a.value;\n    } else {\n      element[key] = a;\n    }\n  });\n\n  return element;\n};\n\n/**\n * Returns a registered package by uri or prefix\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackage = function (uriOrPrefix) {\n  return this.registry.getPackage(uriOrPrefix);\n};\n\n/**\n * Returns a snapshot of all known packages\n *\n * @return {Object} the package\n */\nModdle.prototype.getPackages = function () {\n  return this.registry.getPackages();\n};\n\n/**\n * Returns the descriptor for an element\n */\nModdle.prototype.getElementDescriptor = function (element) {\n  return element.$descriptor;\n};\n\n/**\n * Returns true if the given descriptor or instance\n * represents the given type.\n *\n * May be applied to this, if element is omitted.\n */\nModdle.prototype.hasType = function (element, type) {\n  if (type === undefined) {\n    type = element;\n    element = this;\n  }\n\n  let descriptor = element.$model.getElementDescriptor(element);\n\n  return type in descriptor.allTypesByName;\n};\n\n/**\n * Returns the descriptor of an elements named property\n */\nModdle.prototype.getPropertyDescriptor = function (element, property) {\n  return this.getElementDescriptor(element).propertiesByName[property];\n};\n\n/**\n * Returns a mapped type's descriptor\n */\nModdle.prototype.getTypeDescriptor = function (type) {\n  return this.registry.typeMap[type];\n};\n\nexport {\n  Moddle,\n  coerceType,\n  isBuiltIn as isBuiltInType,\n  isSimple as isSimpleType,\n  parseName as parseNameNS,\n};\n","import { forEach, assign, find, filter, isString, map } from \"min-dash\";\nimport { Parser } from \"saxen\";\nimport { coerceType, parseNameNS, isSimpleType, Moddle } from \"../moddle\";\n\nfunction hasLowerCaseAlias(pkg) {\n  return pkg.xml && pkg.xml.tagAlias === \"lowerCase\";\n}\n\nconst DEFAULT_NS_MAP = {\n  xsi: \"http://www.w3.org/2001/XMLSchema-instance\",\n};\n\nconst XSI_TYPE = \"xsi:type\";\n\nfunction serializeFormat(element) {\n  return element.xml && element.xml.serialize;\n}\n\nfunction serializeAsType(element) {\n  return serializeFormat(element) === XSI_TYPE;\n}\n\nfunction serializeAsProperty(element) {\n  return serializeFormat(element) === \"property\";\n}\n\nfunction capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction aliasToName(aliasNs, pkg) {\n  if (!hasLowerCaseAlias(pkg)) {\n    return aliasNs.name;\n  }\n\n  return aliasNs.prefix + \":\" + capitalize(aliasNs.localName);\n}\n\nfunction prefixedToName(nameNs, pkg) {\n  let name = nameNs.name,\n    localName = nameNs.localName;\n\n  let typePrefix = pkg.xml && pkg.xml.typePrefix;\n\n  if (typePrefix && localName.indexOf(typePrefix) === 0) {\n    return nameNs.prefix + \":\" + localName.slice(typePrefix.length);\n  } else {\n    return name;\n  }\n}\n\nfunction normalizeXsiTypeName(name, model) {\n  let nameNs = parseNameNS(name);\n  let pkg = model.getPackage(nameNs.prefix);\n\n  return prefixedToName(nameNs, pkg);\n}\n\nfunction error(message) {\n  return new Error(message);\n}\n\n/**\n * Get the moddle descriptor for a given instance or type.\n *\n * @param  {ModdleElement|Function} element\n *\n * @return {Object} the moddle descriptor\n */\nfunction getModdleDescriptor(element) {\n  return element.$descriptor;\n}\n\nfunction defer(fn) {\n  setTimeout(fn, 0);\n}\n\n/**\n * A parse context.\n *\n * @class\n *\n * @param {Object} options\n * @param {ElementHandler} options.rootHandler the root handler for parsing a document\n * @param {boolean} [options.lax=false] whether or not to ignore invalid elements\n */\nfunction Context(options) {\n  /**\n   * @property {ElementHandler} rootHandler\n   */\n\n  /**\n   * @property {Boolean} lax\n   */\n\n  assign(this, options);\n\n  this.elementsById = {};\n  this.references = [];\n  this.warnings = [];\n\n  /**\n   * Add an unresolved reference.\n   *\n   * @param {Object} reference\n   */\n  this.addReference = function (reference) {\n    this.references.push(reference);\n  };\n\n  /**\n   * Add a processed element.\n   *\n   * @param {ModdleElement} element\n   */\n  this.addElement = function (element) {\n    if (!element) {\n      throw error(\"expected element\");\n    }\n\n    let elementsById = this.elementsById;\n\n    let descriptor = getModdleDescriptor(element);\n\n    let idProperty = descriptor.idProperty,\n      id;\n\n    if (idProperty) {\n      id = element.get(idProperty.name);\n\n      if (id) {\n        // for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\n        if (!/^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i.test(id)) {\n          throw new Error(\"illegal ID <\" + id + \">\");\n        }\n\n        if (elementsById[id]) {\n          throw error(\"duplicate ID <\" + id + \">\");\n        }\n\n        elementsById[id] = element;\n      }\n    }\n  };\n\n  /**\n   * Add an import warning.\n   *\n   * @param {Object} warning\n   * @param {String} warning.message\n   * @param {Error} [warning.error]\n   */\n  this.addWarning = function (warning) {\n    this.warnings.push(warning);\n  };\n}\n\nfunction BaseHandler() {}\n\nBaseHandler.prototype.handleEnd = function () {};\nBaseHandler.prototype.handleText = function () {};\nBaseHandler.prototype.handleNode = function () {};\n\n/**\n * A simple pass through handler that does nothing except for\n * ignoring all input it receives.\n *\n * This is used to ignore unknown elements and\n * attributes.\n */\nfunction NoopHandler() {}\n\nNoopHandler.prototype = Object.create(BaseHandler.prototype);\n\nNoopHandler.prototype.handleNode = function () {\n  return this;\n};\n\nfunction BodyHandler() {}\n\nBodyHandler.prototype = Object.create(BaseHandler.prototype);\n\nBodyHandler.prototype.handleText = function (text) {\n  this.body = (this.body || \"\") + text;\n};\n\nfunction ReferenceHandler(property, context) {\n  this.property = property;\n  this.context = context;\n}\n\nReferenceHandler.prototype = Object.create(BodyHandler.prototype);\n\nReferenceHandler.prototype.handleNode = function (node) {\n  if (this.element) {\n    throw error(\"expected no sub nodes\");\n  } else {\n    this.element = this.createReference(node);\n  }\n\n  return this;\n};\n\nReferenceHandler.prototype.handleEnd = function () {\n  this.element.id = this.body;\n};\n\nReferenceHandler.prototype.createReference = function (node) {\n  return {\n    property: this.property.ns.name,\n    id: \"\",\n  };\n};\n\nfunction ValueHandler(propertyDesc, element) {\n  this.element = element;\n  this.propertyDesc = propertyDesc;\n}\n\nValueHandler.prototype = Object.create(BodyHandler.prototype);\n\nValueHandler.prototype.handleEnd = function () {\n  let value = this.body || \"\",\n    element = this.element,\n    propertyDesc = this.propertyDesc;\n\n  value = coerceType(propertyDesc.type, value);\n\n  if (propertyDesc.isMany) {\n    element.get(propertyDesc.name).push(value);\n  } else {\n    element.set(propertyDesc.name, value);\n  }\n};\n\nfunction BaseElementHandler() {}\n\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\n\nBaseElementHandler.prototype.handleNode = function (node) {\n  let parser = this,\n    element = this.element;\n\n  if (!element) {\n    element = this.element = this.createElement(node);\n\n    this.context.addElement(element);\n  } else {\n    parser = this.handleChild(node);\n  }\n\n  return parser;\n};\n\n/**\n * @class Reader.ElementHandler\n *\n */\nfunction ElementHandler(model, typeName, context) {\n  this.model = model;\n  this.type = model.getType(typeName);\n  this.context = context;\n}\n\nElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nElementHandler.prototype.addReference = function (reference) {\n  this.context.addReference(reference);\n};\n\nElementHandler.prototype.handleText = function (text) {\n  let element = this.element,\n    descriptor = getModdleDescriptor(element),\n    bodyProperty = descriptor.bodyProperty;\n\n  if (!bodyProperty) {\n    throw error(\"unexpected body text <\" + text + \">\");\n  }\n\n  BodyHandler.prototype.handleText.call(this, text);\n};\n\nElementHandler.prototype.handleEnd = function () {\n  let value = this.body,\n    element = this.element,\n    descriptor = getModdleDescriptor(element),\n    bodyProperty = descriptor.bodyProperty;\n\n  if (bodyProperty && value !== undefined) {\n    value = coerceType(bodyProperty.type, value);\n    element.set(bodyProperty.name, value);\n  }\n};\n\n/**\n * Create an instance of the model from the given node.\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.createElement = function (node) {\n  let attributes = node.attributes,\n    Type = this.type,\n    descriptor = getModdleDescriptor(Type),\n    context = this.context,\n    instance = new Type({}),\n    model = this.model,\n    propNameNs;\n\n  forEach(attributes, function (value, name) {\n    let prop = descriptor.propertiesByName[name],\n      values;\n\n    if (prop && prop.isReference) {\n      if (!prop.isMany) {\n        context.addReference({\n          element: instance,\n          property: prop.ns.name,\n          id: value,\n        });\n      } else {\n        // IDREFS: parse references as whitespace-separated list\n        values = value.split(\" \");\n\n        forEach(values, function (v) {\n          context.addReference({\n            element: instance,\n            property: prop.ns.name,\n            id: v,\n          });\n        });\n      }\n    } else {\n      if (prop) {\n        value = coerceType(prop.type, value);\n      } else if (name !== \"xmlns\") {\n        propNameNs = parseNameNS(name, descriptor.ns.prefix);\n\n        // check whether attribute is defined in a well-known namespace\n        // if that is the case we emit a warning to indicate potential misuse\n        if (model.getPackage(propNameNs.prefix)) {\n          context.addWarning({\n            message: \"unknown attribute <\" + name + \">\",\n            element: instance,\n            property: name,\n            value: value,\n          });\n        }\n      }\n\n      instance.set(name, value);\n    }\n  });\n\n  return instance;\n};\n\nElementHandler.prototype.getPropertyForNode = function (node) {\n  let name = node.name;\n  let nameNs = parseNameNS(name);\n\n  let type = this.type,\n    model = this.model,\n    descriptor = getModdleDescriptor(type);\n\n  let propertyName = nameNs.name,\n    property = descriptor.propertiesByName[propertyName],\n    elementTypeName,\n    elementType;\n\n  // search for properties by name first\n\n  if (property && !property.isAttr) {\n    if (serializeAsType(property)) {\n      elementTypeName = node.attributes[XSI_TYPE];\n\n      // xsi type is optional, if it does not exists the\n      // default type is assumed\n      if (elementTypeName) {\n        // take possible type prefixes from XML\n        // into account, i.e.: xsi:type=\"t{ActualType}\"\n        elementTypeName = normalizeXsiTypeName(elementTypeName, model);\n\n        elementType = model.getType(elementTypeName);\n\n        return assign({}, property, {\n          effectiveType: getModdleDescriptor(elementType).name,\n        });\n      }\n    }\n\n    // search for properties by name first\n    return property;\n  }\n\n  let pkg = model.getPackage(nameNs.prefix);\n\n  if (pkg) {\n    elementTypeName = aliasToName(nameNs, pkg);\n    elementType = model.getType(elementTypeName);\n\n    // search for collection members later\n    property = find(descriptor.properties, function (p) {\n      return (\n        !p.isVirtual &&\n        !p.isReference &&\n        !p.isAttribute &&\n        elementType.hasType(p.type)\n      );\n    });\n\n    if (property) {\n      return assign({}, property, {\n        effectiveType: getModdleDescriptor(elementType).name,\n      });\n    }\n  } else {\n    // parse unknown element (maybe extension)\n    property = find(descriptor.properties, function (p) {\n      return !p.isReference && !p.isAttribute && p.type === \"Element\";\n    });\n\n    if (property) {\n      return property;\n    }\n  }\n\n  throw error(\"unrecognized element <\" + nameNs.name + \">\");\n};\n\nElementHandler.prototype.toString = function () {\n  return \"ElementDescriptor[\" + getModdleDescriptor(this.type).name + \"]\";\n};\n\nElementHandler.prototype.valueHandler = function (propertyDesc, element) {\n  return new ValueHandler(propertyDesc, element);\n};\n\nElementHandler.prototype.referenceHandler = function (propertyDesc) {\n  return new ReferenceHandler(propertyDesc, this.context);\n};\n\nElementHandler.prototype.handler = function (type) {\n  if (type === \"Element\") {\n    return new GenericElementHandler(this.model, type, this.context);\n  } else {\n    return new ElementHandler(this.model, type, this.context);\n  }\n};\n\n/**\n * Handle the child element parsing\n *\n * @param  {Element} node the xml node\n */\nElementHandler.prototype.handleChild = function (node) {\n  let propertyDesc, type, element, childHandler;\n\n  propertyDesc = this.getPropertyForNode(node);\n  element = this.element;\n\n  type = propertyDesc.effectiveType || propertyDesc.type;\n\n  if (isSimpleType(type)) {\n    return this.valueHandler(propertyDesc, element);\n  }\n\n  if (propertyDesc.isReference) {\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\n  } else {\n    childHandler = this.handler(type).handleNode(node);\n  }\n\n  let newElement = childHandler.element;\n\n  // child handles may decide to skip elements\n  // by not returning anything\n  if (newElement !== undefined) {\n    if (propertyDesc.isMany) {\n      element.get(propertyDesc.name).push(newElement);\n    } else {\n      element.set(propertyDesc.name, newElement);\n    }\n\n    if (propertyDesc.isReference) {\n      assign(newElement, {\n        element: element,\n      });\n\n      this.context.addReference(newElement);\n    } else {\n      // establish child -> parent relationship\n      newElement.$parent = element;\n    }\n  }\n\n  return childHandler;\n};\n\n/**\n * An element handler that performs special validation\n * to ensure the node it gets initialized with matches\n * the handlers type (namespace wise).\n *\n * @param {Moddle} model\n * @param {String} typeName\n * @param {Context} context\n */\nfunction RootElementHandler(model, typeName, context) {\n  ElementHandler.call(this, model, typeName, context);\n}\n\nRootElementHandler.prototype = Object.create(ElementHandler.prototype);\n\nRootElementHandler.prototype.createElement = function (node) {\n  let name = node.name,\n    nameNs = parseNameNS(name),\n    model = this.model,\n    type = this.type,\n    pkg = model.getPackage(nameNs.prefix),\n    typeName = (pkg && aliasToName(nameNs, pkg)) || name;\n\n  // verify the correct namespace if we parse\n  // the first element in the handler tree\n  //\n  // this ensures we don't mistakenly import wrong namespace elements\n  if (!type.hasType(typeName)) {\n    throw error(\"unexpected element <\" + node.originalName + \">\");\n  }\n\n  return ElementHandler.prototype.createElement.call(this, node);\n};\n\nfunction GenericElementHandler(model, typeName, context) {\n  this.model = model;\n  this.context = context;\n}\n\nGenericElementHandler.prototype = Object.create(BaseElementHandler.prototype);\n\nGenericElementHandler.prototype.createElement = function (node) {\n  let name = node.name,\n    ns = parseNameNS(name),\n    prefix = ns.prefix,\n    uri = node.ns[prefix + \"$uri\"],\n    attributes = node.attributes;\n\n  return this.model.createAny(name, uri, attributes);\n};\n\nGenericElementHandler.prototype.handleChild = function (node) {\n  let handler = new GenericElementHandler(\n      this.model,\n      \"Element\",\n      this.context\n    ).handleNode(node),\n    element = this.element;\n\n  let newElement = handler.element,\n    children;\n\n  if (newElement !== undefined) {\n    children = element.$children = element.$children || [];\n    children.push(newElement);\n\n    // establish child -> parent relationship\n    newElement.$parent = element;\n  }\n\n  return handler;\n};\n\nGenericElementHandler.prototype.handleEnd = function () {\n  if (this.body) {\n    this.element.$body = this.body;\n  }\n};\n\n/**\n * A reader for a meta-model\n *\n * @param {Object} options\n * @param {Model} options.model used to read xml files\n * @param {Boolean} options.lax whether to make parse errors warnings\n */\nfunction Reader(options) {\n  if (options instanceof Moddle) {\n    options = {\n      model: options,\n    };\n  }\n\n  assign(this, { lax: false }, options);\n}\n\n/**\n * Parse the given XML into a moddle document tree.\n *\n * @param {String} xml\n * @param {ElementHandler|Object} options or rootHandler\n * @param  {Function} done\n */\nReader.prototype.fromXML = function (xml, options, done) {\n  let rootHandler = options.rootHandler;\n\n  if (options instanceof ElementHandler) {\n    // root handler passed via (xml, { rootHandler: ElementHandler }, ...)\n    rootHandler = options;\n    options = {};\n  } else {\n    if (typeof options === \"string\") {\n      // rootHandler passed via (xml, 'someString', ...)\n      rootHandler = this.handler(options);\n      options = {};\n    } else if (typeof rootHandler === \"string\") {\n      // rootHandler passed via (xml, { rootHandler: 'someString' }, ...)\n      rootHandler = this.handler(rootHandler);\n    }\n  }\n\n  let model = this.model,\n    lax = this.lax;\n\n  let context = new Context(assign({}, options, { rootHandler: rootHandler })),\n    parser = new Parser({ proxy: true }),\n    stack = createStack();\n\n  rootHandler.context = context;\n\n  // push root handler\n  stack.push(rootHandler);\n\n  /**\n   * Handle error.\n   *\n   * @param  {Error} err\n   * @param  {Function} getContext\n   * @param  {boolean} lax\n   *\n   * @return {boolean} true if handled\n   */\n  function handleError(err, getContext, lax) {\n    let ctx = getContext();\n\n    let line = ctx.line,\n      column = ctx.column,\n      data = ctx.data;\n\n    // we receive the full context data here,\n    // for elements trim down the information\n    // to the tag name, only\n    if (data.charAt(0) === \"<\" && data.indexOf(\" \") !== -1) {\n      data = data.slice(0, data.indexOf(\" \")) + \">\";\n    }\n\n    let message =\n      \"unparsable content \" +\n      (data ? data + \" \" : \"\") +\n      \"detected\\n\\t\" +\n      \"line: \" +\n      line +\n      \"\\n\\t\" +\n      \"column: \" +\n      column +\n      \"\\n\\t\" +\n      \"nested error: \" +\n      err.message;\n\n    if (lax) {\n      context.addWarning({\n        message: message,\n        error: err,\n      });\n\n      return true;\n    } else {\n      throw error(message);\n    }\n  }\n\n  function handleWarning(err, getContext) {\n    // just like handling errors in <lax=true> mode\n    return handleError(err, getContext, true);\n  }\n\n  /**\n   * Resolve collected references on parse end.\n   */\n  function resolveReferences() {\n    let elementsById = context.elementsById;\n    let references = context.references;\n\n    let i, r;\n\n    for (i = 0; (r = references[i]); i++) {\n      let element = r.element;\n      let reference = elementsById[r.id];\n      let property = getModdleDescriptor(element).propertiesByName[r.property];\n\n      if (!reference) {\n        context.addWarning({\n          message: \"unresolved reference <\" + r.id + \">\",\n          element: r.element,\n          property: r.property,\n          value: r.id,\n        });\n      }\n\n      if (property.isMany) {\n        let collection = element.get(property.name),\n          idx = collection.indexOf(r);\n\n        // we replace an existing place holder (idx != -1) or\n        // append to the collection instead\n        if (idx === -1) {\n          idx = collection.length;\n        }\n\n        if (!reference) {\n          // remove unresolvable reference\n          collection.splice(idx, 1);\n        } else {\n          // add or update reference in collection\n          collection[idx] = reference;\n        }\n      } else {\n        element.set(property.name, reference);\n      }\n    }\n  }\n\n  function handleClose() {\n    stack.pop().handleEnd();\n  }\n\n  let PREAMBLE_START_PATTERN = /^<\\?xml /i;\n\n  let ENCODING_PATTERN = / encoding=\"([^\"]+)\"/i;\n\n  let UTF_8_PATTERN = /^utf-8$/i;\n\n  function handleQuestion(question) {\n    if (!PREAMBLE_START_PATTERN.test(question)) {\n      return;\n    }\n\n    let match = ENCODING_PATTERN.exec(question);\n    let encoding = match && match[1];\n\n    if (!encoding || UTF_8_PATTERN.test(encoding)) {\n      return;\n    }\n\n    context.addWarning({\n      message:\n        \"unsupported document encoding <\" +\n        encoding +\n        \">, \" +\n        \"falling back to UTF-8\",\n    });\n  }\n\n  function handleOpen(node, getContext) {\n    let handler = stack.peek();\n\n    try {\n      stack.push(handler.handleNode(node));\n    } catch (err) {\n      if (handleError(err, getContext, lax)) {\n        stack.push(new NoopHandler());\n      }\n    }\n  }\n\n  function handleCData(text, getContext) {\n    try {\n      stack.peek().handleText(text);\n    } catch (err) {\n      handleWarning(err, getContext);\n    }\n  }\n\n  function handleText(text, getContext) {\n    // strip whitespace only nodes, i.e. before\n    // <!CDATA[ ... ]> sections and in between tags\n    text = text.trim();\n\n    if (!text) {\n      return;\n    }\n\n    handleCData(text, getContext);\n  }\n\n  let uriMap = model.getPackages().reduce(function (uriMap, p) {\n    uriMap[p.uri] = p.prefix;\n\n    return uriMap;\n  }, {});\n\n  parser\n    .ns(uriMap)\n    .on(\"openTag\", function (obj, decodeStr, selfClosing, getContext) {\n      // gracefully handle unparsable attributes (attrs=false)\n      let attrs = obj.attrs || {};\n\n      let decodedAttrs = Object.keys(attrs).reduce(function (d, key) {\n        let value = decodeStr(attrs[key]);\n\n        d[key] = value;\n\n        return d;\n      }, {});\n\n      let node = {\n        name: obj.name,\n        originalName: obj.originalName,\n        attributes: decodedAttrs,\n        ns: obj.ns,\n      };\n\n      handleOpen(node, getContext);\n    })\n    .on(\"question\", handleQuestion)\n    .on(\"closeTag\", handleClose)\n    .on(\"cdata\", handleCData)\n    .on(\"text\", function (text, decodeEntities, getContext) {\n      handleText(decodeEntities(text), getContext);\n    })\n    .on(\"error\", handleError)\n    .on(\"warn\", handleWarning);\n\n  // deferred parse XML to make loading really ascnchronous\n  // this ensures the execution environment (node or browser)\n  // is kept responsive and that certain optimization strategies\n  // can kick in\n  defer(function () {\n    let err;\n\n    try {\n      parser.parse(xml);\n\n      resolveReferences();\n    } catch (e) {\n      err = e;\n    }\n\n    let element = rootHandler.element;\n\n    // handle the situation that we could not extract\n    // the desired root element from the document\n    if (!err && !element) {\n      err = error(\n        \"failed to parse document as <\" +\n          rootHandler.type.$descriptor.name +\n          \">\"\n      );\n    }\n\n    done(err, err ? undefined : element, context);\n  });\n};\n\nReader.prototype.handler = function (name) {\n  return new RootElementHandler(this.model, name);\n};\n\n// helpers //////////////////////////\n\nfunction createStack() {\n  let stack = [];\n\n  Object.defineProperty(stack, \"peek\", {\n    value: function () {\n      return this[this.length - 1];\n    },\n  });\n\n  return stack;\n}\n\nlet XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\n\nlet ESCAPE_ATTR_CHARS = /<|>|'|\"|&|\\n\\r|\\n/g;\nlet ESCAPE_CHARS = /<|>|&/g;\n\nfunction Namespaces(parent) {\n  let prefixMap = {};\n  let uriMap = {};\n  let used = {};\n\n  let wellknown = [];\n  let custom = [];\n\n  // API\n\n  this.byUri = function (uri) {\n    return uriMap[uri] || (parent && parent.byUri(uri));\n  };\n\n  this.add = function (ns, isWellknown) {\n    uriMap[ns.uri] = ns;\n\n    if (isWellknown) {\n      wellknown.push(ns);\n    } else {\n      custom.push(ns);\n    }\n\n    this.mapPrefix(ns.prefix, ns.uri);\n  };\n\n  this.uriByPrefix = function (prefix) {\n    return prefixMap[prefix || \"xmlns\"];\n  };\n\n  this.mapPrefix = function (prefix, uri) {\n    prefixMap[prefix || \"xmlns\"] = uri;\n  };\n\n  this.logUsed = function (ns) {\n    let uri = ns.uri;\n\n    used[uri] = this.byUri(uri);\n  };\n\n  this.getUsed = function (ns) {\n    function isUsed(ns) {\n      return used[ns.uri];\n    }\n\n    let allNs = [].concat(wellknown, custom);\n\n    return allNs.filter(isUsed);\n  };\n}\n\nfunction lower(string) {\n  return string.charAt(0).toLowerCase() + string.slice(1);\n}\n\nfunction nameToAlias(name, pkg) {\n  if (hasLowerCaseAlias(pkg)) {\n    return lower(name);\n  } else {\n    return name;\n  }\n}\n\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true,\n    },\n  });\n}\n\nfunction nsName(ns) {\n  if (isString(ns)) {\n    return ns;\n  } else {\n    // return ns.localName\n    return (ns.prefix ? ns.prefix + \":\" : \"\") + ns.localName;\n  }\n}\n\nfunction getNsAttrs(namespaces) {\n  return map(namespaces.getUsed(), function (ns) {\n    let name = \"xmlns\" + (ns.prefix ? \":\" + ns.prefix : \"\");\n    return { name: name, value: ns.uri };\n  });\n}\n\nfunction getElementNs(ns, descriptor) {\n  if (descriptor.isGeneric) {\n    return assign({ localName: descriptor.ns.localName }, ns);\n  } else {\n    return assign(\n      { localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) },\n      ns\n    );\n  }\n}\n\nfunction getPropertyNs(ns, descriptor) {\n  return assign({ localName: descriptor.ns.localName }, ns);\n}\n\nfunction getSerializableProperties(element) {\n  let descriptor = element.$descriptor;\n\n  return filter(descriptor.properties, function (p) {\n    let name = p.name;\n\n    if (p.isVirtual) {\n      return false;\n    }\n\n    // do not serialize defaults\n    if (!element.hasOwnProperty(name)) {\n      return false;\n    }\n\n    let value = element[name];\n\n    // do not serialize default equals\n    if (value === p.default) {\n      return false;\n    }\n\n    // do not serialize null properties\n    if (value === null) {\n      return false;\n    }\n\n    return p.isMany ? value.length : true;\n  });\n}\n\nlet ESCAPE_ATTR_MAP = {\n  \"\\n\": \"#10\",\n  \"\\n\\r\": \"#10\",\n  '\"': \"#34\",\n  \"'\": \"#39\",\n  \"<\": \"#60\",\n  \">\": \"#62\",\n  \"&\": \"#38\",\n};\n\nlet ESCAPE_MAP = {\n  \"<\": \"lt\",\n  \">\": \"gt\",\n  \"&\": \"amp\",\n};\n\nfunction escape(str, charPattern, replaceMap) {\n  // ensure we are handling strings here\n  str = isString(str) ? str : \"\" + str;\n\n  return str.replace(charPattern, function (s) {\n    return \"&\" + replaceMap[s] + \";\";\n  });\n}\n\n/**\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\n *\n * @param {String} str the string to escape\n * @return {String} the escaped string\n */\nfunction escapeAttr(str) {\n  return escape(str, ESCAPE_ATTR_CHARS, ESCAPE_ATTR_MAP);\n}\n\nfunction escapeBody(str) {\n  return escape(str, ESCAPE_CHARS, ESCAPE_MAP);\n}\n\nfunction filterAttributes(props) {\n  return filter(props, function (p) {\n    return p.isAttr;\n  });\n}\n\nfunction filterContained(props) {\n  return filter(props, function (p) {\n    return !p.isAttr;\n  });\n}\n\nfunction ReferenceSerializer(tagName) {\n  this.tagName = tagName;\n}\n\nReferenceSerializer.prototype.build = function (element) {\n  this.element = element;\n  return this;\n};\n\nReferenceSerializer.prototype.serializeTo = function (writer) {\n  writer\n    .appendIndent()\n    .append(\n      \"<\" + this.tagName + \">\" + this.element.id + \"</\" + this.tagName + \">\"\n    )\n    .appendNewLine();\n};\n\nfunction BodySerializer() {}\n\nBodySerializer.prototype.serializeValue = BodySerializer.prototype.serializeTo =\n  function (writer) {\n    writer.append(this.escape ? escapeBody(this.value) : this.value);\n  };\n\nBodySerializer.prototype.build = function (prop, value) {\n  this.value = value;\n\n  if (prop.type === \"String\" && value.search(ESCAPE_CHARS) !== -1) {\n    this.escape = true;\n  }\n\n  return this;\n};\n\nfunction ValueSerializer(tagName) {\n  this.tagName = tagName;\n}\n\ninherits(ValueSerializer, BodySerializer);\n\nValueSerializer.prototype.serializeTo = function (writer) {\n  writer.appendIndent().append(\"<\" + this.tagName + \">\");\n\n  this.serializeValue(writer);\n\n  writer.append(\"</\" + this.tagName + \">\").appendNewLine();\n};\n\nfunction ElementSerializer(parent, propertyDescriptor) {\n  this.body = [];\n  this.attrs = [];\n\n  this.parent = parent;\n  this.propertyDescriptor = propertyDescriptor;\n}\n\nElementSerializer.prototype.build = function (element) {\n  this.element = element;\n\n  let elementDescriptor = element.$descriptor,\n    propertyDescriptor = this.propertyDescriptor;\n\n  let otherAttrs, properties;\n\n  let isGeneric = elementDescriptor.isGeneric;\n\n  if (isGeneric) {\n    otherAttrs = this.parseGeneric(element);\n  } else {\n    otherAttrs = this.parseNsAttributes(element);\n  }\n\n  if (propertyDescriptor) {\n    this.ns = this.nsPropertyTagName(propertyDescriptor);\n  } else {\n    this.ns = this.nsTagName(elementDescriptor);\n  }\n\n  // compute tag name\n  this.tagName = this.addTagName(this.ns);\n\n  if (!isGeneric) {\n    properties = getSerializableProperties(element);\n\n    this.parseAttributes(filterAttributes(properties));\n    this.parseContainments(filterContained(properties));\n  }\n\n  this.parseGenericAttributes(element, otherAttrs);\n\n  return this;\n};\n\nElementSerializer.prototype.nsTagName = function (descriptor) {\n  let effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getElementNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.nsPropertyTagName = function (descriptor) {\n  let effectiveNs = this.logNamespaceUsed(descriptor.ns);\n  return getPropertyNs(effectiveNs, descriptor);\n};\n\nElementSerializer.prototype.isLocalNs = function (ns) {\n  return ns.uri === this.ns.uri;\n};\n\n/**\n * Get the actual ns attribute name for the given element.\n *\n * @param {Object} element\n * @param {Boolean} [element.inherited=false]\n *\n * @return {Object} nsName\n */\nElementSerializer.prototype.nsAttributeName = function (element) {\n  let ns;\n\n  if (isString(element)) {\n    ns = parseNameNS(element);\n  } else {\n    ns = element.ns;\n  }\n\n  // return just local name for inherited attributes\n  if (element.inherited) {\n    return { localName: ns.localName };\n  }\n\n  // parse + log effective ns\n  let effectiveNs = this.logNamespaceUsed(ns);\n\n  // LOG ACTUAL namespace use\n  this.getNamespaces().logUsed(effectiveNs);\n\n  // strip prefix if same namespace like parent\n  if (this.isLocalNs(effectiveNs)) {\n    return { localName: ns.localName };\n  } else {\n    return assign({ localName: ns.localName }, effectiveNs);\n  }\n};\n\nElementSerializer.prototype.parseGeneric = function (element) {\n  let self = this,\n    body = this.body;\n\n  let attributes = [];\n\n  forEach(element, function (val, key) {\n    let nonNsAttr;\n\n    if (key === \"$body\") {\n      body.push(new BodySerializer().build({ type: \"String\" }, val));\n    } else if (key === \"$children\") {\n      forEach(val, function (child) {\n        body.push(new ElementSerializer(self).build(child));\n      });\n    } else if (key.indexOf(\"$\") !== 0) {\n      nonNsAttr = self.parseNsAttribute(element, key, val);\n\n      if (nonNsAttr) {\n        attributes.push({ name: key, value: val });\n      }\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseNsAttribute = function (element, name, value) {\n  let model = element.$model;\n\n  let nameNs = parseNameNS(name);\n\n  let ns;\n\n  // parse xmlns:foo=\"http://foo.bar\"\n  if (nameNs.prefix === \"xmlns\") {\n    ns = { prefix: nameNs.localName, uri: value };\n  }\n\n  // parse xmlns=\"http://foo.bar\"\n  if (!nameNs.prefix && nameNs.localName === \"xmlns\") {\n    ns = { uri: value };\n  }\n\n  if (!ns) {\n    return {\n      name: name,\n      value: value,\n    };\n  }\n\n  if (model && model.getPackage(value)) {\n    // register well known namespace\n    this.logNamespace(ns, true, true);\n  } else {\n    // log custom namespace directly as used\n    let actualNs = this.logNamespaceUsed(ns, true);\n\n    this.getNamespaces().logUsed(actualNs);\n  }\n};\n\n/**\n * Parse namespaces and return a list of left over generic attributes\n *\n * @param  {Object} element\n * @return {Array<Object>}\n */\nElementSerializer.prototype.parseNsAttributes = function (element, attrs) {\n  let self = this;\n\n  let genericAttrs = element.$attrs;\n\n  let attributes = [];\n\n  // parse namespace attributes first\n  // and log them. push non namespace attributes to a list\n  // and process them later\n  forEach(genericAttrs, function (value, name) {\n    let nonNsAttr = self.parseNsAttribute(element, name, value);\n\n    if (nonNsAttr) {\n      attributes.push(nonNsAttr);\n    }\n  });\n\n  return attributes;\n};\n\nElementSerializer.prototype.parseGenericAttributes = function (\n  element,\n  attributes\n) {\n  let self = this;\n\n  forEach(attributes, function (attr) {\n    // do not serialize xsi:type attribute\n    // it is set manually based on the actual implementation type\n    if (attr.name === XSI_TYPE) {\n      return;\n    }\n\n    try {\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\n    } catch (e) {\n      console.warn(\n        \"missing namespace information for \",\n        attr.name,\n        \"=\",\n        attr.value,\n        \"on\",\n        element,\n        e\n      );\n    }\n  });\n};\n\nElementSerializer.prototype.parseContainments = function (properties) {\n  let self = this,\n    body = this.body,\n    element = this.element;\n\n  forEach(properties, function (p) {\n    let value = element.get(p.name),\n      isReference = p.isReference,\n      isMany = p.isMany;\n\n    if (!isMany) {\n      value = [value];\n    }\n\n    if (p.isBody) {\n      body.push(new BodySerializer().build(p, value[0]));\n    } else if (isSimpleType(p.type)) {\n      forEach(value, function (v) {\n        body.push(\n          new ValueSerializer(self.addTagName(self.nsPropertyTagName(p))).build(\n            p,\n            v\n          )\n        );\n      });\n    } else if (isReference) {\n      forEach(value, function (v) {\n        body.push(\n          new ReferenceSerializer(\n            self.addTagName(self.nsPropertyTagName(p))\n          ).build(v)\n        );\n      });\n    } else {\n      // allow serialization via type\n      // rather than element name\n      let asType = serializeAsType(p),\n        asProperty = serializeAsProperty(p);\n\n      forEach(value, function (v) {\n        let serializer;\n\n        if (asType) {\n          serializer = new TypeSerializer(self, p);\n        } else if (asProperty) {\n          serializer = new ElementSerializer(self, p);\n        } else {\n          serializer = new ElementSerializer(self);\n        }\n\n        body.push(serializer.build(v));\n      });\n    }\n  });\n};\n\nElementSerializer.prototype.getNamespaces = function (local) {\n  let namespaces = this.namespaces,\n    parent = this.parent,\n    parentNamespaces;\n\n  if (!namespaces) {\n    parentNamespaces = parent && parent.getNamespaces();\n\n    if (local || !parentNamespaces) {\n      this.namespaces = namespaces = new Namespaces(parentNamespaces);\n    } else {\n      namespaces = parentNamespaces;\n    }\n  }\n\n  return namespaces;\n};\n\nElementSerializer.prototype.logNamespace = function (ns, wellknown, local) {\n  let namespaces = this.getNamespaces(local);\n\n  let nsUri = ns.uri,\n    nsPrefix = ns.prefix;\n\n  let existing = namespaces.byUri(nsUri);\n\n  if (!existing) {\n    namespaces.add(ns, wellknown);\n  }\n\n  namespaces.mapPrefix(nsPrefix, nsUri);\n\n  return ns;\n};\n\nElementSerializer.prototype.logNamespaceUsed = function (ns, local) {\n  let element = this.element,\n    model = element.$model,\n    namespaces = this.getNamespaces(local);\n\n  // ns may be\n  //\n  //   * prefix only\n  //   * prefix:uri\n  //   * localName only\n\n  let prefix = ns.prefix,\n    uri = ns.uri,\n    newPrefix,\n    idx,\n    wellknownUri;\n\n  // handle anonymous namespaces (elementForm=unqualified), cf. #23\n  if (!prefix && !uri) {\n    return { localName: ns.localName };\n  }\n\n  wellknownUri =\n    DEFAULT_NS_MAP[prefix] || (model && (model.getPackage(prefix) || {}).uri);\n\n  uri = uri || wellknownUri || namespaces.uriByPrefix(prefix);\n\n  if (!uri) {\n    throw new Error(\"no namespace uri given for prefix <\" + prefix + \">\");\n  }\n\n  ns = namespaces.byUri(uri);\n\n  if (!ns) {\n    newPrefix = prefix;\n    idx = 1;\n\n    // find a prefix that is not mapped yet\n    while (namespaces.uriByPrefix(newPrefix)) {\n      newPrefix = prefix + \"_\" + idx++;\n    }\n\n    ns = this.logNamespace(\n      { prefix: newPrefix, uri: uri },\n      wellknownUri === uri\n    );\n  }\n\n  if (prefix) {\n    namespaces.mapPrefix(prefix, uri);\n  }\n\n  return ns;\n};\n\nElementSerializer.prototype.parseAttributes = function (properties) {\n  let self = this,\n    element = this.element;\n\n  forEach(properties, function (p) {\n    let value = element.get(p.name);\n\n    if (p.isReference) {\n      if (!p.isMany) {\n        value = value.id;\n      } else {\n        let values = [];\n        forEach(value, function (v) {\n          values.push(v.id);\n        });\n        // IDREFS is a whitespace-separated list of references.\n        value = values.join(\" \");\n      }\n    }\n\n    self.addAttribute(self.nsAttributeName(p), value);\n  });\n};\n\nElementSerializer.prototype.addTagName = function (nsTagName) {\n  let actualNs = this.logNamespaceUsed(nsTagName);\n\n  this.getNamespaces().logUsed(actualNs);\n\n  return nsName(nsTagName);\n};\n\nElementSerializer.prototype.addAttribute = function (name, value) {\n  let attrs = this.attrs;\n\n  if (isString(value)) {\n    value = escapeAttr(value);\n  }\n\n  attrs.push({ name: name, value: value });\n};\n\nElementSerializer.prototype.serializeAttributes = function (writer) {\n  let attrs = this.attrs,\n    namespaces = this.namespaces;\n\n  if (namespaces) {\n    attrs = getNsAttrs(namespaces).concat(attrs);\n  }\n\n  forEach(attrs, function (a) {\n    writer\n      .append(\" \")\n      .append(nsName(a.name))\n      .append('=\"')\n      .append(a.value)\n      .append('\"');\n  });\n};\n\nElementSerializer.prototype.serializeTo = function (writer) {\n  let firstBody = this.body[0],\n    indent = firstBody && firstBody.constructor !== BodySerializer;\n\n  writer.appendIndent().append(\"<\" + this.tagName);\n\n  this.serializeAttributes(writer);\n\n  writer.append(firstBody ? \">\" : \" />\");\n\n  if (firstBody) {\n    if (indent) {\n      writer.appendNewLine().indent();\n    }\n\n    forEach(this.body, function (b) {\n      b.serializeTo(writer);\n    });\n\n    if (indent) {\n      writer.unindent().appendIndent();\n    }\n\n    writer.append(\"</\" + this.tagName + \">\");\n  }\n\n  writer.appendNewLine();\n};\n\n/**\n * A serializer for types that handles serialization of data types\n */\nfunction TypeSerializer(parent, propertyDescriptor) {\n  ElementSerializer.call(this, parent, propertyDescriptor);\n}\n\ninherits(TypeSerializer, ElementSerializer);\n\nTypeSerializer.prototype.parseNsAttributes = function (element) {\n  // extracted attributes\n  let attributes = ElementSerializer.prototype.parseNsAttributes.call(\n    this,\n    element\n  );\n\n  let descriptor = element.$descriptor;\n\n  // only serialize xsi:type if necessary\n  if (descriptor.name === this.propertyDescriptor.type) {\n    return attributes;\n  }\n\n  let typeNs = (this.typeNs = this.nsTagName(descriptor));\n  this.getNamespaces().logUsed(this.typeNs);\n\n  // add xsi:type attribute to represent the elements\n  // actual type\n\n  let pkg = element.$model.getPackage(typeNs.uri),\n    typePrefix = (pkg.xml && pkg.xml.typePrefix) || \"\";\n\n  this.addAttribute(\n    this.nsAttributeName(XSI_TYPE),\n    (typeNs.prefix ? typeNs.prefix + \":\" : \"\") +\n      typePrefix +\n      descriptor.ns.localName\n  );\n\n  return attributes;\n};\n\nTypeSerializer.prototype.isLocalNs = function (ns) {\n  return ns.uri === (this.typeNs || this.ns).uri;\n};\n\nfunction SavingWriter() {\n  this.value = \"\";\n\n  this.write = function (str) {\n    this.value += str;\n  };\n}\n\nfunction FormatingWriter(out, format) {\n  let indent = [\"\"];\n\n  this.append = function (str) {\n    out.write(str);\n\n    return this;\n  };\n\n  this.appendNewLine = function () {\n    if (format) {\n      out.write(\"\\n\");\n    }\n\n    return this;\n  };\n\n  this.appendIndent = function () {\n    if (format) {\n      out.write(indent.join(\"  \"));\n    }\n\n    return this;\n  };\n\n  this.indent = function () {\n    indent.push(\"\");\n    return this;\n  };\n\n  this.unindent = function () {\n    indent.pop();\n    return this;\n  };\n}\n\n/**\n * A writer for meta-model backed document trees\n *\n * @param {Object} options output options to pass into the writer\n */\nfunction Writer(options) {\n  options = assign({ format: false, preamble: true }, options || {});\n\n  function toXML(tree, writer) {\n    let internalWriter = writer || new SavingWriter();\n    let formatingWriter = new FormatingWriter(internalWriter, options.format);\n\n    if (options.preamble) {\n      formatingWriter.append(XML_PREAMBLE);\n    }\n\n    new ElementSerializer().build(tree).serializeTo(formatingWriter);\n\n    if (!writer) {\n      return internalWriter.value;\n    }\n  }\n\n  return {\n    toXML: toXML,\n  };\n}\n\nexport { Reader, Writer };\n","import { isString, isFunction, assign } from \"min-dash\";\nimport { Moddle } from \"../moddle\";\nimport { Reader, Writer } from \"../moddle-xml\";\n\n/**\n * A sub class of {@link Moddle} with support for import and export of BPMN 2.0 xml files.\n *\n * @class BpmnModdle\n * @extends Moddle\n *\n * @param {Object|Array} packages to use for instantiating the model\n * @param {Object} [options] additional options to pass over\n */\nfunction BpmnModdle(packages, options) {\n  Moddle.call(this, packages, options);\n}\n\nBpmnModdle.prototype = Object.create(Moddle.prototype);\n\n/**\n * Instantiates a BPMN model tree from a given xml string.\n *\n * @param {String}   xmlStr\n * @param {String}   [typeName='bpmn:Process-actions'] name of the root element\n * @param {Object}   [options]  options to pass to the underlying reader\n * @param {Function} done       callback that is invoked with (err, result, parseContext)\n *                              once the import completes\n */\nBpmnModdle.prototype.fromXML = function (xmlStr, typeName, options, done) {\n  if (!isString(typeName)) {\n    done = options;\n    options = typeName;\n    typeName = \"bpmn:Process-actions\";\n  }\n\n  if (isFunction(options)) {\n    done = options;\n    options = {};\n  }\n\n  let reader = new Reader(assign({ model: this, lax: true }, options));\n  let rootHandler = reader.handler(typeName);\n\n  reader.fromXML(xmlStr, rootHandler, done);\n};\n\n/**\n * Serializes a BPMN 2.0 object tree to XML.\n *\n * @param {String}   element    the root element, typically an instance of `bpmn:Process-actions`\n * @param {Object}   [options]  to pass to the underlying writer\n * @param {Function} done       callback invoked with (err, xmlStr) once the import completes\n */\nBpmnModdle.prototype.toXML = function (element, options, done) {\n  if (isFunction(options)) {\n    done = options;\n    options = {};\n  }\n\n  let writer = new Writer(options);\n\n  let result;\n  let err;\n\n  try {\n    result = writer.toXML(element);\n  } catch (e) {\n    err = e;\n  }\n\n  return done(err, result);\n};\n\nlet name = \"BPMN20\";\nlet uri = \"http://www.omg.org/spec/BPMN/20100524/MODEL\";\nlet associations = [];\nlet types = [\n  {\n    name: \"Interface\",\n    superClass: [\"RootElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"operations\",\n        type: \"Operation\",\n        isMany: true,\n      },\n      {\n        name: \"implementationRef\",\n        type: \"String\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"Operation\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"inMessageRef\",\n        type: \"Message\",\n        isReference: true,\n      },\n      {\n        name: \"outMessageRef\",\n        type: \"Message\",\n        isReference: true,\n      },\n      {\n        name: \"errorRef\",\n        type: \"Error\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"implementationRef\",\n        type: \"String\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"EndPoint\",\n    superClass: [\"RootElement\"],\n  },\n  {\n    name: \"Auditing\",\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"GlobalTask\",\n    superClass: [\"CallableElement\"],\n    properties: [\n      {\n        name: \"resources\",\n        type: \"ResourceRole\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"Monitoring\",\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"Performer\",\n    superClass: [\"ResourceRole\"],\n  },\n  {\n    name: \"Process-action\",\n    superClass: [\"FlowElementsContainer\", \"CallableElement\"],\n    properties: [\n      {\n        name: \"targetModel\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"sourceModel\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n\t\t\t\tname: \"laneSets\",\n\t\t\t\tisMany: true,\n\t\t\t\treplaces: \"FlowElementsContainer#laneSets\",\n\t\t\t\ttype: \"LaneSet\"\n\t\t\t},\n      // {\n      //   name: \"staticCompile\",\n      //   isAttr: true,\n      //   type: \"Boolean\",\n      //   default: true,\n      // },\n    ],\n  },\n  {\n\t\tname: \"LaneSet\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"lanes\",\n\t\t\t\ttype: \"Lane\",\n\t\t\t\tisMany: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t}\n\t\t]\n\t},\n  {\n\t\tname: \"Lane\",\n\t\tsuperClass: [\n\t\t\t\"BaseElement\"\n\t\t],\n\t\tproperties: [\n\t\t\t{\n\t\t\t\tname: \"name\",\n\t\t\t\tisAttr: true,\n\t\t\t\ttype: \"String\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElementRef\",\n\t\t\t\ttype: \"BaseElement\",\n\t\t\t\tisAttr: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"partitionElement\",\n\t\t\t\ttype: \"BaseElement\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"flowNodeRef\",\n\t\t\t\ttype: \"FlowNode\",\n\t\t\t\tisMany: true,\n\t\t\t\tisReference: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"childLaneSet\",\n\t\t\t\ttype: \"LaneSet\",\n\t\t\t\txml: {\n\t\t\t\t\tserialize: \"xsi:type\"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n  {\n    name: \"Gateway\",\n    isAbstract: true,\n    superClass: [\"FlowNode\"],\n    properties: [\n      {\n        name: \"gatewayDirection\",\n        type: \"GatewayDirection\",\n        default: \"Unspecified\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"EventBasedGateway\",\n    superClass: [\"Gateway\"],\n    properties: [\n      {\n        name: \"instantiate\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"eventGatewayType\",\n        type: \"EventBasedGatewayType\",\n        isAttr: true,\n        default: \"Exclusive\",\n      },\n    ],\n  },\n  {\n    name: \"Parameter\",\n    superClass: [\"Element\"],\n    meta: {\n      allowedIn: [\"bpmn:Function\", \"bpmn:Query\"],\n    },\n    properties: [\n      {\n        name: \"id\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"target\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"expression\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n\n  {\n    name: \"RootElement\",\n    isAbstract: true,\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"Relationship\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"type\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"direction\",\n        type: \"RelationshipDirection\",\n        isAttr: true,\n      },\n      {\n        name: \"source\",\n        isMany: true,\n        isReference: true,\n        type: \"Element\",\n      },\n      {\n        name: \"target\",\n        isMany: true,\n        isReference: true,\n        type: \"Element\",\n      },\n    ],\n  },\n  {\n    name: \"BaseElement\",\n    isAbstract: true,\n    properties: [\n      {\n        name: \"id\",\n        isAttr: true,\n        type: \"String\",\n        isId: true,\n      },\n      {\n        name: \"documentation\",\n        type: \"Documentation\",\n        isMany: true,\n      },\n      {\n        name: \"extensionDefinitions\",\n        type: \"ExtensionDefinition\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"assignElements\",\n        type: \"AssignElements\",\n      },\n      {\n        name: \"parameters\",\n        type: \"Parameters\",\n      },\n    ],\n  },\n  {\n    name: \"Extension\",\n    properties: [\n      {\n        name: \"mustUnderstand\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"definition\",\n        type: \"ExtensionDefinition\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"ExtensionDefinition\",\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"extensionAttributeDefinitions\",\n        type: \"ExtensionAttributeDefinition\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"ExtensionAttributeDefinition\",\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"type\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"isReference\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"extensionDefinition\",\n        type: \"ExtensionDefinition\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"AssignElements\",\n    properties: [\n      {\n        name: \"valueRef\",\n        isAttr: true,\n        isReference: true,\n        type: \"Element\",\n      },\n      {\n        name: \"values\",\n        type: \"Element\",\n        isMany: true,\n      },\n      {\n        name: \"extensionAttributeDefinition\",\n        type: \"ExtensionAttributeDefinition\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"Parameters\",\n    properties: [\n      {\n        name: \"values\",\n        type: \"Element\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"FlowElement\",\n    isAbstract: true,\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"auditing\",\n        type: \"Auditing\",\n      },\n      {\n        name: \"monitoring\",\n        type: \"Monitoring\",\n      },\n      {\n        name: \"categoryValueRef\",\n        type: \"CategoryValue\",\n        isMany: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"SequenceFlow\",\n    superClass: [\"FlowElement\"],\n    properties: [\n      {\n        name: \"isImmediate\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"conditionExpression\",\n        type: \"Expression\",\n        xml: {\n          serialize: \"xsi:type\",\n        },\n      },\n      {\n        name: \"sourceRef\",\n        type: \"FlowNode\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"targetRef\",\n        type: \"FlowNode\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"FlowElementsContainer\",\n    isAbstract: true,\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"laneSets\",\n        type: \"LaneSet\",\n        isMany: true,\n      },\n      {\n        name: \"flowElements\",\n        type: \"FlowElement\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"CallableElement\",\n    isAbstract: true,\n    superClass: [\"RootElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"ioSpecification\",\n        type: \"InputOutputSpecification\",\n        xml: {\n          serialize: \"property\",\n        },\n      },\n      {\n        name: \"supportedInterfaceRef\",\n        type: \"Interface\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"ioBinding\",\n        type: \"InputOutputBinding\",\n        isMany: true,\n        xml: {\n          serialize: \"property\",\n        },\n      },\n    ],\n  },\n  {\n    name: \"FlowNode\",\n    isAbstract: true,\n    superClass: [\"FlowElement\"],\n    properties: [\n      // {\n      //   name: \"incoming\",\n      //   type: \"SequenceFlow\",\n      //   isMany: true,\n      //   isReference: true,\n      // },\n      // {\n      //   name: \"outgoing\",\n      //   type: \"SequenceFlow\",\n      //   isMany: true,\n      //   isReference: true,\n      // },\n      {\n        name: \"lanes\",\n        type: \"Lane\",\n        isVirtual: true,\n        isMany: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"CorrelationPropertyRetrievalExpression\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"messagePath\",\n        type: \"FormalExpression\",\n      },\n      {\n        name: \"messageRef\",\n        type: \"Message\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"CorrelationPropertyBinding\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"dataPath\",\n        type: \"FormalExpression\",\n      },\n      {\n        name: \"correlationPropertyRef\",\n        type: \"CorrelationProperty\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"Resource\",\n    superClass: [\"RootElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"resourceParameters\",\n        type: \"ResourceParameter\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"ResourceParameter\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"isRequired\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"type\",\n        type: \"ItemDefinition\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"CorrelationSubscription\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"correlationKeyRef\",\n        type: \"CorrelationKey\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"correlationPropertyBinding\",\n        type: \"CorrelationPropertyBinding\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"MessageFlow\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"sourceRef\",\n        type: \"InteractionNode\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"targetRef\",\n        type: \"InteractionNode\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"messageRef\",\n        type: \"Message\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"MessageFlowAssociation\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"innerMessageFlowRef\",\n        type: \"MessageFlow\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"outerMessageFlowRef\",\n        type: \"MessageFlow\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"InteractionNode\",\n    isAbstract: true,\n    properties: [\n      {\n        name: \"incomingConversationLinks\",\n        type: \"ConversationLink\",\n        isVirtual: true,\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"outgoingConversationLinks\",\n        type: \"ConversationLink\",\n        isVirtual: true,\n        isMany: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"Participant\",\n    superClass: [\"InteractionNode\", \"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"interfaceRef\",\n        type: \"Interface\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"participantMultiplicity\",\n        type: \"ParticipantMultiplicity\",\n      },\n      {\n        name: \"endPointRefs\",\n        type: \"EndPoint\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"processRef\",\n        type: \"Process-action\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"ParticipantAssociation\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"innerParticipantRef\",\n        type: \"Participant\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"outerParticipantRef\",\n        type: \"Participant\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"ParticipantMultiplicity\",\n    properties: [\n      {\n        name: \"minimum\",\n        default: 0,\n        isAttr: true,\n        type: \"Integer\",\n      },\n      {\n        name: \"maximum\",\n        default: 1,\n        isAttr: true,\n        type: \"Integer\",\n      },\n    ],\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"Collaboration\",\n    superClass: [\"RootElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"isClosed\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"participants\",\n        type: \"Participant\",\n        isMany: true,\n      },\n      {\n        name: \"messageFlows\",\n        type: \"MessageFlow\",\n        isMany: true,\n      },\n      {\n        name: \"artifacts\",\n        type: \"Artifact\",\n        isMany: true,\n      },\n      {\n        name: \"conversations\",\n        type: \"ConversationNode\",\n        isMany: true,\n      },\n      {\n        name: \"conversationAssociations\",\n        type: \"ConversationAssociation\",\n      },\n      {\n        name: \"participantAssociations\",\n        type: \"ParticipantAssociation\",\n        isMany: true,\n      },\n      {\n        name: \"messageFlowAssociations\",\n        type: \"MessageFlowAssociation\",\n        isMany: true,\n      },\n      {\n        name: \"correlationKeys\",\n        type: \"CorrelationKey\",\n        isMany: true,\n      },\n      {\n        name: \"choreographyRef\",\n        type: \"Choreography\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"conversationLinks\",\n        type: \"ConversationLink\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"ChoreographyActivity\",\n    isAbstract: true,\n    superClass: [\"FlowNode\"],\n    properties: [\n      {\n        name: \"participantRef\",\n        type: \"Participant\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"initiatingParticipantRef\",\n        type: \"Participant\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"correlationKeys\",\n        type: \"CorrelationKey\",\n        isMany: true,\n      },\n      {\n        name: \"loopType\",\n        type: \"ChoreographyLoopType\",\n        default: \"None\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"CallChoreography\",\n    superClass: [\"ChoreographyActivity\"],\n    properties: [\n      {\n        name: \"calledChoreographyRef\",\n        type: \"Choreography\",\n        isAttr: true,\n        isReference: true,\n      },\n      {\n        name: \"participantAssociations\",\n        type: \"ParticipantAssociation\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"SubChoreography\",\n    superClass: [\"ChoreographyActivity\", \"FlowElementsContainer\"],\n    properties: [\n      {\n        name: \"artifacts\",\n        type: \"Artifact\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"ChoreographyTask\",\n    superClass: [\"ChoreographyActivity\"],\n    properties: [\n      {\n        name: \"messageFlowRef\",\n        type: \"MessageFlow\",\n        isMany: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"Choreography\",\n    superClass: [\"Collaboration\", \"FlowElementsContainer\"],\n  },\n  {\n    name: \"GlobalChoreographyTask\",\n    superClass: [\"Choreography\"],\n    properties: [\n      {\n        name: \"initiatingParticipantRef\",\n        type: \"Participant\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n  },\n  {\n    name: \"TextAnnotation\",\n    superClass: [\"Artifact\"],\n    properties: [\n      {\n        name: \"text\",\n        type: \"String\",\n      },\n      {\n        name: \"textFormat\",\n        default: \"text/plain\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Activity\",\n    isAbstract: true,\n    superClass: [\"FlowNode\"],\n    properties: [\n      {\n        name: \"isForCompensation\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"ioSpecification\",\n        type: \"InputOutputSpecification\",\n        xml: {\n          serialize: \"property\",\n        },\n      },\n      {\n        name: \"boundaryEventRefs\",\n        type: \"BoundaryEvent\",\n        isMany: true,\n        isReference: true,\n      },\n      {\n        name: \"properties\",\n        type: \"Property\",\n        isMany: true,\n      },\n      {\n        name: \"dataInputAssociations\",\n        type: \"DataInputAssociation\",\n        isMany: true,\n      },\n      {\n        name: \"dataOutputAssociations\",\n        type: \"DataOutputAssociation\",\n        isMany: true,\n      },\n      {\n        name: \"startQuantity\",\n        default: 1,\n        isAttr: true,\n        type: \"Integer\",\n      },\n      {\n        name: \"resources\",\n        type: \"ResourceRole\",\n        isMany: true,\n      },\n      {\n        name: \"completionQuantity\",\n        default: 1,\n        isAttr: true,\n        type: \"Integer\",\n      },\n    ],\n  },\n  {\n    name: \"Conditional\",\n    superClass: [\"Activity\", \"FlowElementsContainer\", \"InteractionNode\"],\n    properties: [\n      {\n        name: \"triggeredByEvent\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"artifacts\",\n        type: \"Artifact\",\n        isMany: true,\n      },\n      {\n        name: \"expression\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"expressionValue\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Loop\",\n    superClass: [\"Activity\", \"FlowElementsContainer\", \"InteractionNode\"],\n    properties: [\n      {\n        name: \"triggeredByEvent\",\n        default: false,\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"artifacts\",\n        type: \"Artifact\",\n        isMany: true,\n      },\n      {\n        name: \"target\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"expression\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"expressionValue\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Task\",\n    superClass: [\"Activity\", \"InteractionNode\"],\n  },\n  {\n    name: \"Mapper\",\n    superClass: [\"Task\"],\n    properties: [\n      {\n        name: \"script\",\n        type: \"Script\",\n      },\n      {\n        name: \"scriptMeta\",\n        type: \"ScriptMeta\",\n      },\n      {\n        name: \"sourceField\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"targetField\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Script\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"value\",\n        isBody: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"ScriptMeta\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"value\",\n        isBody: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Function\",\n    superClass: [\"Task\"],\n    properties: [\n      {\n        name: \"returnType\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"functionName\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"values\",\n        type: \"Element\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"GlobalScriptTask\",\n    superClass: [\"GlobalTask\"],\n    properties: [\n      {\n        name: \"scriptLanguage\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"script\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"GlobalBusinessRuleTask\",\n    superClass: [\"GlobalTask\"],\n    properties: [\n      {\n        name: \"implementation\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"ComplexBehaviorDefinition\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"condition\",\n        type: \"FormalExpression\",\n      },\n      {\n        name: \"event\",\n        type: \"ImplicitThrowEvent\",\n      },\n    ],\n  },\n  {\n    name: \"ResourceRole\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"resourceRef\",\n        type: \"Resource\",\n        isReference: true,\n      },\n      {\n        name: \"resourceParameterBindings\",\n        type: \"ResourceParameterBinding\",\n        isMany: true,\n      },\n      {\n        name: \"resourceAssignmentExpression\",\n        type: \"ResourceAssignmentExpression\",\n      },\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"ResourceParameterBinding\",\n    properties: [\n      {\n        name: \"expression\",\n        type: \"Expression\",\n        xml: {\n          serialize: \"xsi:type\",\n        },\n      },\n      {\n        name: \"parameterRef\",\n        type: \"ResourceParameter\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"ResourceAssignmentExpression\",\n    properties: [\n      {\n        name: \"expression\",\n        type: \"Expression\",\n        xml: {\n          serialize: \"xsi:type\",\n        },\n      },\n    ],\n    superClass: [\"BaseElement\"],\n  },\n  {\n    name: \"Import\",\n    properties: [\n      {\n        name: \"importType\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"location\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"namespace\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"Process-actions\",\n    superClass: [\"BaseElement\"],\n    properties: [\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"targetNamespace\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"expressionLanguage\",\n        default: \"http://www.w3.org/1999/XPath\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"typeLanguage\",\n        default: \"http://www.w3.org/2001/XMLSchema\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"imports\",\n        type: \"Import\",\n        isMany: true,\n      },\n      {\n        name: \"extensions\",\n        type: \"Extension\",\n        isMany: true,\n      },\n      {\n        name: \"rootElements\",\n        type: \"RootElement\",\n        isMany: true,\n      },\n      {\n        name: \"diagrams\",\n        isMany: true,\n        type: \"bpmndi:BPMNDiagram\",\n      },\n      {\n        name: \"exporter\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"relationships\",\n        type: \"Relationship\",\n        isMany: true,\n      },\n      {\n        name: \"exporterVersion\", \n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n];\nlet enumerations = [\n  {\n    name: \"ProcessType\",\n    literalValues: [\n      {\n        name: \"None\",\n      },\n      {\n        name: \"Public\",\n      },\n      {\n        name: \"Private\",\n      },\n    ],\n  },\n  {\n    name: \"GatewayDirection\",\n    literalValues: [\n      {\n        name: \"Unspecified\",\n      },\n      {\n        name: \"Converging\",\n      },\n      {\n        name: \"Diverging\",\n      },\n      {\n        name: \"Mixed\",\n      },\n    ],\n  },\n  {\n    name: \"EventBasedGatewayType\",\n    literalValues: [\n      {\n        name: \"Parallel\",\n      },\n      {\n        name: \"Exclusive\",\n      },\n    ],\n  },\n  {\n    name: \"RelationshipDirection\",\n    literalValues: [\n      {\n        name: \"None\",\n      },\n      {\n        name: \"Forward\",\n      },\n      {\n        name: \"Backward\",\n      },\n      {\n        name: \"Both\",\n      },\n    ],\n  },\n  {\n    name: \"ItemKind\",\n    literalValues: [\n      {\n        name: \"Physical\",\n      },\n      {\n        name: \"Information\",\n      },\n    ],\n  },\n  {\n    name: \"ChoreographyLoopType\",\n    literalValues: [\n      {\n        name: \"None\",\n      },\n      {\n        name: \"Standard\",\n      },\n      {\n        name: \"MultiInstanceSequential\",\n      },\n      {\n        name: \"MultiInstanceParallel\",\n      },\n    ],\n  },\n  {\n    name: \"AssociationDirection\",\n    literalValues: [\n      {\n        name: \"None\",\n      },\n      {\n        name: \"One\",\n      },\n      {\n        name: \"Both\",\n      },\n    ],\n  },\n  {\n    name: \"MultiInstanceBehavior\",\n    literalValues: [\n      {\n        name: \"None\",\n      },\n      {\n        name: \"One\",\n      },\n      {\n        name: \"All\",\n      },\n      {\n        name: \"Complex\",\n      },\n    ],\n  },\n  {\n    name: \"AdHocOrdering\",\n    literalValues: [\n      {\n        name: \"Parallel\",\n      },\n      {\n        name: \"Sequential\",\n      },\n    ],\n  },\n];\nlet prefix = \"bpmn\";\nlet xml = {\n  tagAlias: \"lowerCase\",\n  typePrefix: \"t\",\n};\nlet BpmnPackage = {\n  name: name,\n  uri: uri,\n  associations: associations,\n  types: types,\n  enumerations: enumerations,\n  prefix: prefix,\n  xml: xml,\n};\n\nlet name$1 = \"BPMNDI\";\nlet uri$1 = \"http://www.omg.org/spec/BPMN/20100524/DI\";\nlet types$1 = [\n  {\n    name: \"BPMNDiagram\",\n    properties: [\n      {\n        name: \"plane\",\n        type: \"BPMNPlane\",\n        redefines: \"di:Diagram#rootElement\",\n      },\n      {\n        name: \"labelStyle\",\n        type: \"BPMNLabelStyle\",\n        isMany: true,\n      },\n    ],\n    superClass: [\"di:Diagram\"],\n  },\n  {\n    name: \"BPMNPlane\",\n    properties: [\n      {\n        name: \"bpmnElement\",\n        isAttr: true,\n        isReference: true,\n        type: \"bpmn:BaseElement\",\n        redefines: \"di:DiagramElement#modelElement\",\n      },\n    ],\n    superClass: [\"di:Plane\"],\n  },\n  {\n    name: \"BPMNShape\",\n    properties: [\n      {\n        name: \"bpmnElement\",\n        isAttr: true,\n        isReference: true,\n        type: \"bpmn:BaseElement\",\n        redefines: \"di:DiagramElement#modelElement\",\n      },\n      {\n        name: \"isHorizontal\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"isExpanded\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"isMarkerVisible\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"label\",\n        type: \"BPMNLabel\",\n      },\n      {\n        name: \"isMessageVisible\",\n        isAttr: true,\n        type: \"Boolean\",\n      },\n      {\n        name: \"participantBandKind\",\n        type: \"ParticipantBandKind\",\n        isAttr: true,\n      },\n      {\n        name: \"choreographyActivityShape\",\n        type: \"BPMNShape\",\n        isAttr: true,\n        isReference: true,\n      },\n    ],\n    superClass: [\"di:LabeledShape\"],\n  },\n  {\n    name: \"BPMNEdge\",\n    properties: [\n      {\n        name: \"label\",\n        type: \"BPMNLabel\",\n      },\n      {\n        name: \"bpmnElement\",\n        isAttr: true,\n        isReference: true,\n        type: \"bpmn:BaseElement\",\n        redefines: \"di:DiagramElement#modelElement\",\n      },\n      {\n        name: \"sourceElement\",\n        isAttr: true,\n        isReference: true,\n        type: \"di:DiagramElement\",\n        redefines: \"di:Edge#source\",\n      },\n      {\n        name: \"targetElement\",\n        isAttr: true,\n        isReference: true,\n        type: \"di:DiagramElement\",\n        redefines: \"di:Edge#target\",\n      },\n      {\n        name: \"messageVisibleKind\",\n        type: \"MessageVisibleKind\",\n        isAttr: true,\n        default: \"initiating\",\n      },\n    ],\n    superClass: [\"di:LabeledEdge\"],\n  },\n  {\n    name: \"BPMNLabel\",\n    properties: [\n      {\n        name: \"labelStyle\",\n        type: \"BPMNLabelStyle\",\n        isAttr: true,\n        isReference: true,\n        redefines: \"di:DiagramElement#style\",\n      },\n    ],\n    superClass: [\"di:Label\"],\n  },\n  {\n    name: \"BPMNLabelStyle\",\n    properties: [\n      {\n        name: \"font\",\n        type: \"dc:Font\",\n      },\n    ],\n    superClass: [\"di:Style\"],\n  },\n];\nlet enumerations$1 = [\n  {\n    name: \"ParticipantBandKind\",\n    literalValues: [\n      {\n        name: \"top_initiating\",\n      },\n      {\n        name: \"middle_initiating\",\n      },\n      {\n        name: \"bottom_initiating\",\n      },\n      {\n        name: \"top_non_initiating\",\n      },\n      {\n        name: \"middle_non_initiating\",\n      },\n      {\n        name: \"bottom_non_initiating\",\n      },\n    ],\n  },\n  {\n    name: \"MessageVisibleKind\",\n    literalValues: [\n      {\n        name: \"initiating\",\n      },\n      {\n        name: \"non_initiating\",\n      },\n    ],\n  },\n];\nlet associations$1 = [];\nlet prefix$1 = \"bpmndi\";\nlet BpmnDiPackage = {\n  name: name$1,\n  uri: uri$1,\n  types: types$1,\n  enumerations: enumerations$1,\n  associations: associations$1,\n  prefix: prefix$1,\n};\n\nlet name$2 = \"DC\";\nlet uri$2 = \"http://www.omg.org/spec/DD/20100524/DC\";\nlet types$2 = [\n  {\n    name: \"Boolean\",\n  },\n  {\n    name: \"Integer\",\n  },\n  {\n    name: \"Real\",\n  },\n  {\n    name: \"String\",\n  },\n  {\n    name: \"Font\",\n    properties: [\n      {\n        name: \"name\",\n        type: \"String\",\n        isAttr: true,\n      },\n      {\n        name: \"size\",\n        type: \"Real\",\n        isAttr: true,\n      },\n      {\n        name: \"isBold\",\n        type: \"Boolean\",\n        isAttr: true,\n      },\n      {\n        name: \"isItalic\",\n        type: \"Boolean\",\n        isAttr: true,\n      },\n      {\n        name: \"isUnderline\",\n        type: \"Boolean\",\n        isAttr: true,\n      },\n      {\n        name: \"isStrikeThrough\",\n        type: \"Boolean\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"Point\",\n    properties: [\n      {\n        name: \"x\",\n        type: \"Real\",\n        default: \"0\",\n        isAttr: true,\n      },\n      {\n        name: \"y\",\n        type: \"Real\",\n        default: \"0\",\n        isAttr: true,\n      },\n    ],\n  },\n  {\n    name: \"Bounds\",\n    properties: [\n      {\n        name: \"x\",\n        type: \"Real\",\n        default: \"0\",\n        isAttr: true,\n      },\n      {\n        name: \"y\",\n        type: \"Real\",\n        default: \"0\",\n        isAttr: true,\n      },\n      {\n        name: \"width\",\n        type: \"Real\",\n        isAttr: true,\n      },\n      {\n        name: \"height\",\n        type: \"Real\",\n        isAttr: true,\n      },\n    ],\n  },\n];\nlet prefix$2 = \"dc\";\nlet associations$2 = [];\nlet DcPackage = {\n  name: name$2,\n  uri: uri$2,\n  types: types$2,\n  prefix: prefix$2,\n  associations: associations$2,\n};\n\nlet name$3 = \"DI\";\nlet uri$3 = \"http://www.omg.org/spec/DD/20100524/DI\";\nlet types$3 = [\n  {\n    name: \"DiagramElement\",\n    isAbstract: true,\n    properties: [\n      {\n        name: \"id\",\n        type: \"String\",\n        isAttr: true,\n        isId: true,\n      },\n      {\n        name: \"extension\",\n        type: \"Extension\",\n      },\n      {\n        name: \"owningDiagram\",\n        type: \"Diagram\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n      },\n      {\n        name: \"owningElement\",\n        type: \"DiagramElement\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n      },\n      {\n        name: \"modelElement\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n        type: \"Element\",\n      },\n      {\n        name: \"style\",\n        type: \"Style\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n      },\n      {\n        name: \"ownedElement\",\n        type: \"DiagramElement\",\n        isReadOnly: true,\n        isVirtual: true,\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"Node\",\n    isAbstract: true,\n    superClass: [\"DiagramElement\"],\n  },\n  {\n    name: \"Edge\",\n    isAbstract: true,\n    superClass: [\"DiagramElement\"],\n    properties: [\n      {\n        name: \"source\",\n        type: \"DiagramElement\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n      },\n      {\n        name: \"target\",\n        type: \"DiagramElement\",\n        isReadOnly: true,\n        isVirtual: true,\n        isReference: true,\n      },\n      {\n        name: \"waypoint\",\n        isUnique: false,\n        isMany: true,\n        type: \"dc:Point\",\n        xml: {\n          serialize: \"xsi:type\",\n        },\n      },\n    ],\n  },\n  {\n    name: \"Diagram\",\n    isAbstract: true,\n    properties: [\n      {\n        name: \"id\",\n        type: \"String\",\n        isAttr: true,\n        isId: true,\n      },\n      {\n        name: \"rootElement\",\n        type: \"DiagramElement\",\n        isReadOnly: true,\n        isVirtual: true,\n      },\n      {\n        name: \"name\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"documentation\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"resolution\",\n        isAttr: true,\n        type: \"Real\",\n      },\n      {\n        name: \"ownedStyle\",\n        type: \"Style\",\n        isReadOnly: true,\n        isVirtual: true,\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"Shape\",\n    isAbstract: true,\n    superClass: [\"Node\"],\n    properties: [\n      {\n        name: \"bounds\",\n        type: \"dc:Bounds\",\n      },\n    ],\n  },\n  {\n    name: \"Plane\",\n    isAbstract: true,\n    superClass: [\"Node\"],\n    properties: [\n      {\n        name: \"planeElement\",\n        type: \"DiagramElement\",\n        subsettedProperty: \"DiagramElement-ownedElement\",\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"LabeledEdge\",\n    isAbstract: true,\n    superClass: [\"Edge\"],\n    properties: [\n      {\n        name: \"ownedLabel\",\n        type: \"Label\",\n        isReadOnly: true,\n        subsettedProperty: \"DiagramElement-ownedElement\",\n        isVirtual: true,\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"LabeledShape\",\n    isAbstract: true,\n    superClass: [\"Shape\"],\n    properties: [\n      {\n        name: \"ownedLabel\",\n        type: \"Label\",\n        isReadOnly: true,\n        subsettedProperty: \"DiagramElement-ownedElement\",\n        isVirtual: true,\n        isMany: true,\n      },\n    ],\n  },\n  {\n    name: \"Label\",\n    isAbstract: true,\n    superClass: [\"Node\"],\n    properties: [\n      {\n        name: \"bounds\",\n        type: \"dc:Bounds\",\n      },\n    ],\n  },\n  {\n    name: \"Style\",\n    isAbstract: true,\n    properties: [\n      {\n        name: \"id\",\n        type: \"String\",\n        isAttr: true,\n        isId: true,\n      },\n    ],\n  },\n  {\n    name: \"Extension\",\n    properties: [\n      {\n        name: \"values\",\n        type: \"Element\",\n        isMany: true,\n      },\n    ],\n  },\n];\nlet associations$3 = [];\nlet prefix$3 = \"di\";\nlet xml$1 = {\n  tagAlias: \"lowerCase\",\n};\nlet DiPackage = {\n  name: name$3,\n  uri: uri$3,\n  types: types$3,\n  associations: associations$3,\n  prefix: prefix$3,\n  xml: xml$1,\n};\n\nlet name$4 = \"bpmn.io colors for BPMN\";\nlet uri$4 = \"http://bpmn.io/schema/bpmn/biocolor/1.0\";\nlet prefix$4 = \"bioc\";\nlet types$4 = [\n  {\n    name: \"ColoredShape\",\n    extends: [\"bpmndi:BPMNShape\"],\n    properties: [\n      {\n        name: \"stroke\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"fill\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n  {\n    name: \"ColoredEdge\",\n    extends: [\"bpmndi:BPMNEdge\"],\n    properties: [\n      {\n        name: \"stroke\",\n        isAttr: true,\n        type: \"String\",\n      },\n      {\n        name: \"fill\",\n        isAttr: true,\n        type: \"String\",\n      },\n    ],\n  },\n];\nlet enumerations$2 = [];\nlet associations$4 = [];\nlet BiocPackage = {\n  name: name$4,\n  uri: uri$4,\n  prefix: prefix$4,\n  types: types$4,\n  enumerations: enumerations$2,\n  associations: associations$4,\n};\n\nlet packages = {\n  bpmn: BpmnPackage,\n  bpmndi: BpmnDiPackage,\n  dc: DcPackage,\n  di: DiPackage,\n  bioc: BiocPackage,\n};\n\nfunction simple(additionalPackages, options) {\n  let pks = assign({}, packages, additionalPackages);\n\n  return new BpmnModdle(pks, options);\n}\n\nexport default simple;\n","export function elementToString(e) {\n  if (!e) {\n    return \"<null>\";\n  }\n\n  return \"<\" + e.$type + (e.id ? ' id=\"' + e.id : \"\") + '\" />';\n}\n","import { filter, find, forEach } from \"min-dash\";\n\nimport Refs from \"object-refs\";\n\nimport { elementToString } from \"./Util\";\n\nlet diRefs = new Refs(\n  { name: \"bpmnElement\", enumerable: true },\n  { name: \"di\", configurable: true }\n);\n\n/**\n * Returns true if an element has the given meta-model type\n *\n * @param  {ModdleElement}  element\n * @param  {String}         type\n *\n * @return {Boolean}\n */\nfunction is(element, type) {\n  return element.$instanceOf(type);\n}\n\n/**\n * Find a suitable display candidate for definitions where the DI does not\n * correctly specify one.\n */\nfunction findDisplayCandidate(definitions) {\n  return find(definitions.rootElements, function (e) {\n    return is(e, \"bpmn:Process-action\") || is(e, \"bpmn:Collaboration\");\n  });\n}\n\nexport default function BpmnTreeWalker(handler, translate) {\n  // list of containers already walked\n  let handledElements = {};\n\n  // list of elements to handle deferred to ensure\n  // prerequisites are drawn\n  let deferred = [];\n\n  // Helpers //////////////////////\n\n  function contextual(fn, ctx) {\n    return function (e) {\n      fn(e, ctx);\n    };\n  }\n\n  function handled(element) {\n    handledElements[element.id] = element;\n  }\n\n  function isHandled(element) {\n    return handledElements[element.id];\n  }\n\n  function visit(element, ctx) {\n    let gfx = element.gfx;\n\n    // avoid multiple rendering of elements\n    if (gfx) {\n      throw new Error(\n        translate(\"already rendered {element}\", {\n          element: elementToString(element),\n        })\n      );\n    }\n\n    // call handler\n    return handler.element(element, ctx);\n  }\n\n  function visitRoot(element, diagram) {\n    return handler.root(element, diagram);\n  }\n\n  function visitIfDi(element, ctx) {\n    try {\n      let gfx = element.di && visit(element, ctx);\n\n      handled(element);\n\n      return gfx;\n    } catch (e) {\n      logError(e.message, { element: element, error: e });\n\n      console.error(\n        translate(\"failed to import {element}\", {\n          element: elementToString(element),\n        })\n      );\n      console.error(e);\n    }\n  }\n\n  function logError(message, context) {\n    handler.error(message, context);\n  }\n\n  // DI handling //////////////////////\n\n  function registerDi(di) {\n    let bpmnElement = di.bpmnElement;\n\n    if (bpmnElement) {\n      if (bpmnElement.di) {\n        logError(\n          translate(\"multiple DI elements defined for {element}\", {\n            element: elementToString(bpmnElement),\n          }),\n          { element: bpmnElement }\n        );\n      } else {\n        diRefs.bind(bpmnElement, \"di\");\n        bpmnElement.di = di;\n      }\n    } else {\n      logError(\n        translate(\"no bpmnElement referenced in {element}\", {\n          element: elementToString(di),\n        }),\n        { element: di }\n      );\n    }\n  }\n\n  function handleDiagram(diagram) {\n    handlePlane(diagram.plane);\n  }\n\n  function handlePlane(plane) {\n    registerDi(plane);\n\n    forEach(plane.planeElement, handlePlaneElement);\n  }\n\n  function handlePlaneElement(planeElement) {\n    registerDi(planeElement);\n  }\n\n  // Semantic handling //////////////////////\n\n  /**\n   * Handle definitions and return the rendered diagram (if any)\n   *\n   * @param {ModdleElement} definitions to walk and import\n   * @param {ModdleElement} [diagram] specific diagram to import and display\n   *\n   * @throws {Error} if no diagram to display could be found\n   */\n  function handleDefinitions(definitions, diagram) {\n    // make sure we walk the correct bpmnElement\n\n    let diagrams = definitions.diagrams;\n\n    if (diagram && diagrams.indexOf(diagram) === -1) {\n      throw new Error(translate(\"diagram not part of bpmn:Process-actions\"));\n    }\n\n    if (!diagram && diagrams && diagrams.length) {\n      diagram = diagrams[0];\n    }\n\n    // no diagram -> nothing to import\n    if (!diagram) {\n      throw new Error(translate(\"no diagram to display\"));\n    }\n\n    // load DI from selected diagram only\n    handleDiagram(diagram);\n\n    let plane = diagram.plane;\n\n    if (!plane) {\n      throw new Error(\n        translate(\"no plane for {element}\", {\n          element: elementToString(diagram),\n        })\n      );\n    }\n\n    let rootElement = plane.bpmnElement;\n\n    // ensure we default to a suitable display candidate (process or collaboration),\n    // even if non is specified in DI\n    if (!rootElement) {\n      rootElement = findDisplayCandidate(definitions);\n\n      if (!rootElement) {\n        throw new Error(translate(\"no process or collaboration to display\"));\n      } else {\n        logError(\n          translate(\n            \"correcting missing bpmnElement on {plane} to {rootElement}\",\n            {\n              plane: elementToString(plane),\n              rootElement: elementToString(rootElement),\n            }\n          )\n        );\n\n        // correct DI on the fly\n        plane.bpmnElement = rootElement;\n        registerDi(plane);\n      }\n    }\n\n    let ctx = visitRoot(rootElement, plane);\n\n    if (is(rootElement, \"bpmn:Process-action\")) {\n      handleProcess(rootElement, ctx);\n    } else if (is(rootElement, \"bpmn:Collaboration\")) {\n      handleCollaboration(rootElement, ctx);\n\n      // force drawing of everything not yet drawn that is part of the target DI\n      handleUnhandledProcesses(definitions.rootElements, ctx);\n    } else {\n      throw new Error(\n        translate(\"unsupported bpmnElement for {plane}: {rootElement}\", {\n          plane: elementToString(plane),\n          rootElement: elementToString(rootElement),\n        })\n      );\n    }\n\n    // handle all deferred elements\n    handleDeferred(deferred);\n  }\n\n  function handleDeferred() {\n    let fn;\n\n    // drain deferred until empty\n    while (deferred.length) {\n      fn = deferred.shift();\n\n      fn();\n    }\n  }\n\n  function handleProcess(process, context) {\n    handleFlowElementsContainer(process, context);\n    handleIoSpecification(process.ioSpecification, context);\n\n    handleArtifacts(process.artifacts, context);\n\n    // log process handled\n    handled(process);\n  }\n\n  function handleUnhandledProcesses(rootElements, ctx) {\n    // walk through all processes that have not yet been drawn and draw them\n    // if they contain lanes with DI information.\n    // we do this to pass the free-floating lane test cases in the MIWG test suite\n    let processes = filter(rootElements, function (e) {\n      return !isHandled(e) && is(e, \"bpmn:Process-action\") && e.laneSets;\n    });\n\n    processes.forEach(contextual(handleProcess, ctx));\n  }\n\n  function handleMessageFlow(messageFlow, context) {\n    visitIfDi(messageFlow, context);\n  }\n\n  function handleMessageFlows(messageFlows, context) {\n    forEach(messageFlows, contextual(handleMessageFlow, context));\n  }\n\n  function handleDataAssociation(association, context) {\n    visitIfDi(association, context);\n  }\n\n  function handleDataInput(dataInput, context) {\n    visitIfDi(dataInput, context);\n  }\n\n  function handleDataOutput(dataOutput, context) {\n    visitIfDi(dataOutput, context);\n  }\n\n  function handleArtifact(artifact, context) {\n    // bpmn:TextAnnotation\n    // bpmn:Group\n    // bpmn:Association\n\n    visitIfDi(artifact, context);\n  }\n\n  function handleArtifacts(artifacts, context) {\n    forEach(artifacts, function (e) {\n      if (is(e, \"bpmn:Association\")) {\n        deferred.push(function () {\n          handleArtifact(e, context);\n        });\n      } else {\n        handleArtifact(e, context);\n      }\n    });\n  }\n\n  function handleIoSpecification(ioSpecification, context) {\n    if (!ioSpecification) {\n      return;\n    }\n\n    forEach(ioSpecification.dataInputs, contextual(handleDataInput, context));\n    forEach(ioSpecification.dataOutputs, contextual(handleDataOutput, context));\n  }\n\n  function handleLoop(loop, context) {\n    handleFlowElementsContainer(loop, context);\n    handleArtifacts(loop.artifacts, context);\n  }\n\n  function handleFlowNode(flowNode, context) {\n    let childCtx = visitIfDi(flowNode, context);\n\n    if (is(flowNode, \"bpmn:Loop\")) {\n      handleLoop(flowNode, childCtx || context);\n    }\n\n    if (is(flowNode, \"bpmn:Conditional\")) {\n      handleLoop(flowNode, childCtx || context);\n    }\n\n    if (is(flowNode, \"bpmn:Activity\")) {\n      handleIoSpecification(flowNode.ioSpecification, context);\n    }\n\n    // defer handling of associations\n    // affected types:\n    //\n    //   * bpmn:Activity\n    //   * bpmn:ThrowEvent\n    //   * bpmn:CatchEvent\n    //\n    deferred.push(function () {\n      forEach(\n        flowNode.dataInputAssociations,\n        contextual(handleDataAssociation, context)\n      );\n      forEach(\n        flowNode.dataOutputAssociations,\n        contextual(handleDataAssociation, context)\n      );\n    });\n  }\n\n  function handleSequenceFlow(sequenceFlow, context) {\n    visitIfDi(sequenceFlow, context);\n  }\n\n  function handleDataElement(dataObject, context) {\n    visitIfDi(dataObject, context);\n  }\n\n  function handleLane(lane, context) {\n    deferred.push(function () {\n      let newContext = visitIfDi(lane, context);\n\n      if (lane.childLaneSet) {\n        handleLaneSet(lane.childLaneSet, newContext || context);\n      }\n\n      wireFlowNodeRefs(lane);\n    });\n  }\n\n  function handleLaneSet(laneSet, context) {\n    forEach(laneSet.lanes, contextual(handleLane, context));\n  }\n\n  function handleLaneSets(laneSets, context) {\n    forEach(laneSets, contextual(handleLaneSet, context));\n  }\n\n  function handleFlowElementsContainer(container, context) {\n    handleFlowElements(container.flowElements, context);\n\n    if (container.laneSets) {\n      handleLaneSets(container.laneSets, context);\n    }\n  }\n\n  function handleFlowElements(flowElements, context) {\n    forEach(flowElements, function (e) {\n      if (is(e, \"bpmn:SequenceFlow\")) {\n        deferred.push(function () {\n          handleSequenceFlow(e, context);\n        });\n      } else if (is(e, \"bpmn:BoundaryEvent\")) {\n        deferred.unshift(function () {\n          handleFlowNode(e, context);\n        });\n      } else if (is(e, \"bpmn:FlowNode\")) {\n        handleFlowNode(e, context);\n      } else if (is(e, \"bpmn:DataObject\")) {\n        // SKIP (assume correct referencing via DataObjectReference)\n      } else if (is(e, \"bpmn:DataStoreReference\")) {\n        handleDataElement(e, context);\n      } else if (is(e, \"bpmn:DataObjectReference\")) {\n        handleDataElement(e, context);\n      } else {\n        logError(\n          translate(\"unrecognized flowElement {element} in context {context}\", {\n            element: elementToString(e),\n            context: context ? elementToString(context.businessObject) : \"null\",\n          }),\n          { element: e, context: context }\n        );\n      }\n    });\n  }\n\n  function handleParticipant(participant, context) {\n    let newCtx = visitIfDi(participant, context);\n\n    let process = participant.processRef;\n    if (process) {\n      handleProcess(process, newCtx || context);\n    }\n  }\n\n  function handleCollaboration(collaboration) {\n    forEach(collaboration.participants, contextual(handleParticipant));\n\n    handleArtifacts(collaboration.artifacts);\n\n    // handle message flows latest in the process\n    deferred.push(function () {\n      handleMessageFlows(collaboration.messageFlows);\n    });\n  }\n\n  function wireFlowNodeRefs(lane) {\n    // wire the virtual flowNodeRefs <-> relationship\n    forEach(lane.flowNodeRef, function (flowNode) {\n      let lanes = flowNode.get(\"lanes\");\n\n      if (lanes) {\n        lanes.push(lane);\n      }\n    });\n  }\n\n  // API //////////////////////\n\n  return {\n    handleDeferred: handleDeferred,\n    handleDefinitions: handleDefinitions,\n    handleLoop: handleLoop,\n    registerDi: registerDi,\n  };\n}\n","import { assign, find, isFunction, isNumber, omit } from \"min-dash\";\nimport { domify, query as domQuery, remove as domRemove } from \"min-dom\";\nimport { innerSVG } from \"tiny-svg\";\n\nimport Diagram from \"diagram-js\";\nimport BpmnModdle from \"../../baml-moddle\";\n\nimport inherits from \"inherits\";\n\nimport { importBpmnDiagram } from \"./import/Importer\";\n\n/**\n * A base viewer for BPMN 2.0 diagrams.\n *\n * Have a look at {@link Viewer}, {@link NavigatedViewer} or {@link Modeler} for\n * bundles that include actual features.\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function BaseViewer(options) {\n  options = assign({}, DEFAULT_OPTIONS, options);\n\n  this._moddle = this._createModdle(options);\n\n  this._container = this._createContainer(options);\n  this._init(this._container, this._moddle, options);\n}\n\ninherits(BaseViewer, Diagram);\n\n/**\n * Parse and render a BPMN 2.0 diagram.\n *\n * Once finished the viewer reports back the result to the\n * provided callback function with (err, warnings).\n *\n * ## Life-Cycle Events\n *\n * During import the viewer will fire life-cycle events:\n *\n *   * import.parse.start (about to read model from xml)\n *   * import.parse.complete (model read; may have worked or not)\n *   * import.render.start (graphical import start)\n *   * import.render.complete (graphical import finished)\n *   * import.done (everything done)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {String} xml the BPMN 2.0 xml\n * @param {ModdleElement<BPMNDiagram>|String} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\n * @param {Function} [done] invoked with (err, warnings=[])\n */\nBaseViewer.prototype.importXML = function (xml, bpmnDiagram, done) {\n  if (isFunction(bpmnDiagram)) {\n    done = bpmnDiagram;\n    bpmnDiagram = null;\n  }\n\n  // done is optional\n  done = done || function () {};\n\n  let self = this;\n\n  // hook in pre-parse listeners +\n  // allow xml manipulation\n  xml = this._emit(\"import.parse.start\", { xml: xml }) || xml;\n\n  this._moddle.fromXML(\n    xml,\n    \"bpmn:Process-actions\",\n    function (err, definitions, context) {\n      // hook in post parse listeners +\n      // allow definitions manipulation\n      definitions =\n        self._emit(\"import.parse.complete\", {\n          error: err,\n          definitions: definitions,\n          context: context,\n        }) || definitions;\n\n      let parseWarnings = context.warnings;\n\n      if (err) {\n        err = checkValidationError(err);\n\n        self._emit(\"import.done\", { error: err, warnings: parseWarnings });\n\n        return done(err, parseWarnings);\n      }\n\n      self.importDefinitions(\n        definitions,\n        bpmnDiagram,\n        function (err, importWarnings) {\n          let allWarnings = [].concat(parseWarnings, importWarnings || []);\n\n          self._emit(\"import.done\", { error: err, warnings: allWarnings });\n\n          done(err, allWarnings);\n        }\n      );\n    }\n  );\n};\n\n/**\n * Import parsed definitions and render a BPMN 2.0 diagram.\n *\n * Once finished the viewer reports back the result to the\n * provided callback function with (err, warnings).\n *\n * ## Life-Cycle Events\n *\n * During import the viewer will fire life-cycle events:\n *\n *   * import.render.start (graphical import start)\n *   * import.render.complete (graphical import finished)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {ModdleElement<Process-actions>} definitions parsed BPMN 2.0 definitions\n * @param {ModdleElement<BPMNDiagram>|String} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\n * @param {Function} [done] invoked with (err, warnings=[])\n */\nBaseViewer.prototype.importDefinitions = function (\n  definitions,\n  bpmnDiagram,\n  done\n) {\n  if (isFunction(bpmnDiagram)) {\n    done = bpmnDiagram;\n    bpmnDiagram = null;\n  }\n\n  // done is optional\n  done = done || function () {};\n\n  this._setDefinitions(definitions);\n\n  return this.open(bpmnDiagram, done);\n};\n\n/**\n * Open diagram of previously imported XML.\n *\n * Once finished the viewer reports back the result to the\n * provided callback function with (err, warnings).\n *\n * ## Life-Cycle Events\n *\n * During switch the viewer will fire life-cycle events:\n *\n *   * import.render.start (graphical import start)\n *   * import.render.complete (graphical import finished)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {String|ModdleElement<BPMNDiagram>} [bpmnDiagramOrId] id or the diagram to open\n * @param {Function} [done] invoked with (err, warnings=[])\n */\nBaseViewer.prototype.open = function (bpmnDiagramOrId, done) {\n  if (isFunction(bpmnDiagramOrId)) {\n    done = bpmnDiagramOrId;\n    bpmnDiagramOrId = null;\n  }\n\n  let definitions = this._definitions;\n  let bpmnDiagram = bpmnDiagramOrId;\n\n  // done is optional\n  done = done || function () {};\n\n  if (!definitions) {\n    return done(new Error(\"no XML imported\"));\n  }\n\n  if (typeof bpmnDiagramOrId === \"string\") {\n    bpmnDiagram = findBPMNDiagram(definitions, bpmnDiagramOrId);\n\n    if (!bpmnDiagram) {\n      return done(new Error(\"BPMNDiagram <\" + bpmnDiagramOrId + \"> not found\"));\n    }\n  }\n\n  // clear existing rendered diagram\n  // catch synchronous exceptions during #clear()\n  try {\n    this.clear();\n  } catch (error) {\n    return done(error);\n  }\n\n  // perform graphical import\n  return importBpmnDiagram(this, definitions, bpmnDiagram, done);\n};\n\n/**\n * Export the currently displayed BPMN 2.0 diagram as\n * a BPMN 2.0 XML document.\n *\n * ## Life-Cycle Events\n *\n * During XML saving the viewer will fire life-cycle events:\n *\n *   * saveXML.start (before serialization)\n *   * saveXML.serialized (after xml generation)\n *   * saveXML.done (everything done)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {Object} [options] export options\n * @param {Boolean} [options.format=false] output formatted XML\n * @param {Boolean} [options.preamble=true] output preamble\n *\n * @param {Function} done invoked with (err, xml)\n */\nBaseViewer.prototype.saveXML = function (options, done) {\n  if (!done) {\n    done = options;\n    options = {};\n  }\n\n  let self = this;\n\n  let definitions = this._definitions;\n\n  if (!definitions) {\n    return done(new Error(\"no definitions loaded\"));\n  }\n\n  // allow to fiddle around with definitions\n  definitions =\n    this._emit(\"saveXML.start\", {\n      definitions: definitions,\n    }) || definitions;\n\n  this._moddle.toXML(definitions, options, function (err, xml) {\n    try {\n      xml =\n        self._emit(\"saveXML.serialized\", {\n          error: err,\n          xml: xml,\n        }) || xml;\n\n      self._emit(\"saveXML.done\", {\n        error: err,\n        xml: xml,\n      });\n    } catch (e) {\n      console.error(\"error in saveXML life-cycle listener\", e);\n    }\n\n    done(err, xml);\n  });\n};\n\n/**\n * Export the currently displayed BPMN 2.0 diagram as\n * an SVG image.\n *\n * ## Life-Cycle Events\n *\n * During SVG saving the viewer will fire life-cycle events:\n *\n *   * saveSVG.start (before serialization)\n *   * saveSVG.done (everything done)\n *\n * You can use these events to hook into the life-cycle.\n *\n * @param {Object} [options]\n * @param {Function} done invoked with (err, svgStr)\n */\nBaseViewer.prototype.saveSVG = function (options, done) {\n  if (!done) {\n    done = options;\n    options = {};\n  }\n\n  this._emit(\"saveSVG.start\");\n\n  let svg, err;\n\n  try {\n    let canvas = this.get(\"canvas\");\n\n    let contentNode = canvas.getDefaultLayer(),\n      defsNode = domQuery(\"defs\", canvas._svg);\n\n    let contents = innerSVG(contentNode),\n      defs = defsNode ? \"<defs>\" + innerSVG(defsNode) + \"</defs>\" : \"\";\n\n    let bbox = contentNode.getBBox();\n\n    svg =\n      '<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\n      \"<!-- created with bpmn-js / http://bpmn.io -->\\n\" +\n      '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\n      'width=\"' +\n      bbox.width +\n      '\" height=\"' +\n      bbox.height +\n      '\" ' +\n      'viewBox=\"' +\n      bbox.x +\n      \" \" +\n      bbox.y +\n      \" \" +\n      bbox.width +\n      \" \" +\n      bbox.height +\n      '\" version=\"1.1\">' +\n      defs +\n      contents +\n      \"</svg>\";\n  } catch (e) {\n    err = e;\n  }\n\n  this._emit(\"saveSVG.done\", {\n    error: err,\n    svg: svg,\n  });\n\n  done(err, svg);\n};\n\n/**\n * Get a named diagram service.\n *\n * @example\n *\n * let elementRegistry = viewer.get('elementRegistry');\n * let startEventShape = elementRegistry.get('StartEvent_1');\n *\n * @param {String} name\n *\n * @return {Object} diagram service instance\n *\n * @method BaseViewer#get\n */\n\n/**\n * Invoke a function in the context of this viewer.\n *\n * @example\n *\n * viewer.invoke(function(elementRegistry) {\n *   let startEventShape = elementRegistry.get('StartEvent_1');\n * });\n *\n * @param {Function} fn to be invoked\n *\n * @return {Object} the functions return value\n *\n * @method BaseViewer#invoke\n */\n\nBaseViewer.prototype._setDefinitions = function (definitions) {\n  this._definitions = definitions;\n};\n\nBaseViewer.prototype.getModules = function () {\n  return this._modules;\n};\n\n/**\n * Remove all drawn elements from the viewer.\n *\n * After calling this method the viewer can still\n * be reused for opening another diagram.\n *\n * @method BaseViewer#clear\n */\nBaseViewer.prototype.clear = function () {\n  if (!this.getDefinitions()) {\n    // no diagram to clear\n    return;\n  }\n\n  // remove businessObject#di binding\n  //\n  // this is necessary, as we establish the bindings\n  // in the BpmnTreeWalker (and assume none are given\n  // on reimport)\n  this.get(\"elementRegistry\").forEach(function (element) {\n    let bo = element.businessObject;\n\n    if (bo && bo.di) {\n      delete bo.di;\n    }\n  });\n\n  // remove drawn elements\n  Diagram.prototype.clear.call(this);\n};\n\n/**\n * Destroy the viewer instance and remove all its\n * remainders from the document tree.\n */\nBaseViewer.prototype.destroy = function () {\n  // diagram destroy\n  Diagram.prototype.destroy.call(this);\n\n  // dom detach\n  domRemove(this._container);\n};\n\n/**\n * Register an event listener\n *\n * Remove a previously added listener via {@link #off(event, callback)}.\n *\n * @param {String} event\n * @param {Number} [priority]\n * @param {Function} callback\n * @param {Object} [that]\n */\nBaseViewer.prototype.on = function (event, priority, callback, target) {\n  return this.get(\"eventBus\").on(event, priority, callback, target);\n};\n\n/**\n * De-register an event listener\n *\n * @param {String} event\n * @param {Function} callback\n */\nBaseViewer.prototype.off = function (event, callback) {\n  this.get(\"eventBus\").off(event, callback);\n};\n\nBaseViewer.prototype.attachTo = function (parentNode) {\n  if (!parentNode) {\n    throw new Error(\"parentNode required\");\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === \"string\") {\n    parentNode = domQuery(parentNode);\n  }\n\n  parentNode.appendChild(this._container);\n\n  this._emit(\"attach\", {});\n\n  this.get(\"canvas\").resized();\n};\n\nBaseViewer.prototype.getDefinitions = function () {\n  return this._definitions;\n};\n\nBaseViewer.prototype.detach = function () {\n  let container = this._container,\n    parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit(\"detach\", {});\n\n  parentNode.removeChild(container);\n};\n\nBaseViewer.prototype._init = function (container, moddle, options) {\n  let baseModules = options.modules || this.getModules(),\n    additionalModules = options.additionalModules || [],\n    staticModules = [\n      {\n        bpmnjs: [\"value\", this],\n        moddle: [\"value\", moddle],\n      },\n    ];\n\n  let diagramModules = [].concat(staticModules, baseModules, additionalModules);\n\n  let diagramOptions = assign(omit(options, [\"additionalModules\"]), {\n    canvas: assign({}, options.canvas, { container: container }),\n    modules: diagramModules,\n  });\n\n  // invoke diagram constructor\n  Diagram.call(this, diagramOptions);\n\n  if (options && options.container) {\n    this.attachTo(options.container);\n  }\n};\n\n/**\n * Emit an event on the underlying {@link EventBus}\n *\n * @param  {String} type\n * @param  {Object} event\n *\n * @return {Object} event processing result (if any)\n */\nBaseViewer.prototype._emit = function (type, event) {\n  return this.get(\"eventBus\").fire(type, event);\n};\n\nBaseViewer.prototype._createContainer = function (options) {\n  let container = domify('<div class=\"bjs-container\"></div>');\n\n  assign(container.style, {\n    width: ensureUnit(options.width),\n    height: ensureUnit(options.height),\n    position: options.position,\n  });\n\n  return container;\n};\n\nBaseViewer.prototype._createModdle = function (options) {\n  let moddleOptions = assign(\n    {},\n    this._moddleExtensions,\n    options.moddleExtensions\n  );\n\n  return new BpmnModdle(moddleOptions);\n};\n\nBaseViewer.prototype._modules = [];\n\n// helpers ///////////////\n\nfunction checkValidationError(err) {\n  // check if we can help the user by indicating wrong BPMN 2.0 xml\n  // (in case he or the exporting tool did not get that right)\n\n  let pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\n  let match = pattern.exec(err.message);\n\n  if (match) {\n    err.message =\n      \"unparsable content <\" +\n      match[1] +\n      \"> detected; \" +\n      \"this may indicate an invalid BPMN 2.0 diagram file\" +\n      match[2];\n  }\n\n  return err;\n}\n\nlet DEFAULT_OPTIONS = {\n  width: \"100%\",\n  height: \"100%\",\n  position: \"relative\",\n};\n\n/**\n * Ensure the passed argument is a proper unit (defaulting to px)\n */\nfunction ensureUnit(val) {\n  return val + (isNumber(val) ? \"px\" : \"\");\n}\n\n/**\n * Find BPMNDiagram in definitions by ID\n *\n * @param {ModdleElement<Process-actions>} definitions\n * @param {String} diagramId\n *\n * @return {ModdleElement<BPMNDiagram>|null}\n */\nfunction findBPMNDiagram(definitions, diagramId) {\n  if (!diagramId) {\n    return null;\n  }\n\n  return (\n    find(definitions.diagrams, function (element) {\n      return element.id === diagramId;\n    }) || null\n  );\n}\n","import BpmnTreeWalker from \"./BpmnTreeWalker\";\n\nimport { isFunction } from \"min-dash\";\n\n/**\n * Import the definitions into a diagram.\n *\n * Errors and warnings are reported through the specified callback.\n *\n * @param  {djs.Diagram} diagram\n * @param  {ModdleElement<Process-actions>} definitions\n * @param  {ModdleElement<BPMNDiagram>} [bpmnDiagram] the diagram to be rendered\n * (if not provided, the first one will be rendered)\n * @param  {Function} done the callback, invoked with (err, [ warning ]) once the import is done\n */\nexport function importBpmnDiagram(diagram, definitions, bpmnDiagram, done) {\n  if (isFunction(bpmnDiagram)) {\n    done = bpmnDiagram;\n    bpmnDiagram = null;\n  }\n\n  let importer, eventBus, translate;\n\n  let error,\n    warnings = [];\n\n  /**\n   * Walk the diagram semantically, importing (=drawing)\n   * all elements you encounter.\n   *\n   * @param {ModdleElement<Process-actions>} definitions\n   * @param {ModdleElement<BPMNDiagram>} bpmnDiagram\n   */\n  function render(definitions, bpmnDiagram) {\n    let visitor = {\n      root: function (element) {\n        return importer.add(element);\n      },\n\n      element: function (element, parentShape) {\n        return importer.add(element, parentShape);\n      },\n\n      error: function (message, context) {\n        warnings.push({ message: message, context: context });\n      },\n    };\n\n    let walker = new BpmnTreeWalker(visitor, translate);\n\n    // traverse BPMN 2.0 document model,\n    // starting at definitions\n    walker.handleDefinitions(definitions, bpmnDiagram);\n  }\n\n  try {\n    importer = diagram.get(\"bpmnImporter\");\n    eventBus = diagram.get(\"eventBus\");\n    translate = diagram.get(\"translate\");\n\n    eventBus.fire(\"import.render.start\", { definitions: definitions });\n\n    render(definitions, bpmnDiagram);\n\n    eventBus.fire(\"import.render.complete\", {\n      error: error,\n      warnings: warnings,\n    });\n  } catch (e) {\n    error = e;\n  }\n\n  done(error, warnings);\n}\n","import inherits from \"inherits\";\n\nimport Ids from \"ids\";\n\nimport BaseViewer from \"./BaseViewer\";\n\n/**\n * A base modeler for BPMN 2.0 diagrams.\n *\n * Have a look at {@link Modeler} for a bundle that includes actual features.\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function BaseModeler(options) {\n  BaseViewer.call(this, options);\n\n  // hook ID collection into the modeler\n  this.on(\n    \"import.parse.complete\",\n    function (event) {\n      if (!event.error) {\n        this._collectIds(event.definitions, event.context);\n      }\n    },\n    this\n  );\n\n  this.on(\n    \"diagram.destroy\",\n    function () {\n      this.get(\"moddle\").ids.clear();\n    },\n    this\n  );\n}\n\ninherits(BaseModeler, BaseViewer);\n\n/**\n * Create a moddle instance, attaching ids to it.\n *\n * @param {Object} options\n */\nBaseModeler.prototype._createModdle = function (options) {\n  let moddle = BaseViewer.prototype._createModdle.call(this, options);\n\n  // attach ids to moddle to be able to track\n  // and validated ids in the BPMN 2.0 XML document\n  // tree\n  moddle.ids = new Ids([32, 36, 1]);\n\n  return moddle;\n};\n\n/**\n * Collect ids processed during parsing of the\n * definitions object.\n *\n * @param {ModdleElement} definitions\n * @param {Context} context\n */\nBaseModeler.prototype._collectIds = function (definitions, context) {\n  let moddle = definitions.$model,\n    ids = moddle.ids,\n    id;\n\n  // remove references from previous import\n  ids.clear();\n\n  for (id in context.elementsById) {\n    ids.claim(id, context.elementsById[id]);\n  }\n};\n","/**\n * Is an element of the given BPMN type?\n *\n * @param  {djs.model.Base|ModdleElement} element\n * @param  {String} type\n *\n * @return {Boolean}\n */\nexport function is(element, type) {\n  let bo = getBusinessObject(element);\n\n  return bo && typeof bo.$instanceOf === \"function\" && bo.$instanceOf(type);\n}\n\n/**\n * Return the business object for a given element.\n *\n * @param  {djs.model.Base|ModdleElement} element\n *\n * @return {ModdleElement}\n */\nexport function getBusinessObject(element) {\n  return (element && element.businessObject) || element;\n}\n","import { is, getBusinessObject } from \"./ModelUtil\";\n\nimport { forEach } from \"min-dash\";\n\nexport function isExpanded(element) {\n  if (is(element, \"bpmn:CallActivity\")) {\n    return false;\n  }\n\n  if (is(element, \"bpmn:Loop\")) {\n    return !!getBusinessObject(element).di.isExpanded;\n  }\n\n  if (is(element, \"bpmn:Conditional\")) {\n    return !!getBusinessObject(element).di.isExpanded;\n  }\n\n  if (is(element, \"bpmn:Participant\")) {\n    return !!getBusinessObject(element).processRef;\n  }\n\n  return true;\n}\n\nexport function isInterrupting(element) {\n  return element && getBusinessObject(element).isInterrupting !== false;\n}\n\nexport function isEventLoop(element) {\n  return element && !!getBusinessObject(element).triggeredByEvent;\n}\n\nexport function hasEventDefinition(element, eventType) {\n  let bo = getBusinessObject(element),\n    hasEventDefinition = false;\n\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function (event) {\n      if (is(event, eventType)) {\n        hasEventDefinition = true;\n      }\n    });\n  }\n\n  return hasEventDefinition;\n}\n\nexport function hasErrorEventDefinition(element) {\n  return hasEventDefinition(element, \"bpmn:ErrorEventDefinition\");\n}\n\nexport function hasEscalationEventDefinition(element) {\n  return hasEventDefinition(element, \"bpmn:EscalationEventDefinition\");\n}\n\nexport function hasCompensateEventDefinition(element) {\n  return hasEventDefinition(element, \"bpmn:CompensateEventDefinition\");\n}\n","import { is } from \"../../util/ModelUtil\";\n\nfunction getLabelAttr(semantic) {\n  if (\n    is(semantic, \"bpmn:FlowElement\") ||\n    is(semantic, \"bpmn:Participant\") ||\n    is(semantic, \"bpmn:Lane\") ||\n    is(semantic, \"bpmn:SequenceFlow\") ||\n    is(semantic, \"bpmn:MessageFlow\") ||\n    is(semantic, \"bpmn:DataInput\") ||\n    is(semantic, \"bpmn:DataOutput\")\n  ) {\n    return \"name\";\n  }\n\n  if (is(semantic, \"bpmn:TextAnnotation\")) {\n    return \"text\";\n  }\n\n  if (is(semantic, \"bpmn:Group\")) {\n    return \"categoryValueRef\";\n  }\n}\n\nfunction getCategoryValue(semantic) {\n  let categoryValueRef = semantic[\"categoryValueRef\"];\n\n  if (!categoryValueRef) {\n    return \"\";\n  }\n\n  return categoryValueRef.value || \"\";\n}\n\nexport function getLabel(element) {\n  let semantic = element.businessObject,\n    attr = getLabelAttr(semantic);\n\n  if (attr) {\n    if (attr === \"categoryValueRef\") {\n      return getCategoryValue(semantic);\n    }\n\n    return semantic[attr] || \"\";\n  }\n}\n\nexport function setLabel(element, text, isExternal) {\n  let semantic = element.businessObject,\n    attr = getLabelAttr(semantic);\n\n  if (attr) {\n    if (attr === \"categoryValueRef\") {\n      semantic[\"categoryValueRef\"].value = text;\n    } else {\n      semantic[attr] = text;\n    }\n  }\n\n  return element;\n}\n","import { every, some } from \"min-dash\";\nimport { componentsToPath } from \"diagram-js/lib/util/RenderUtil\";\n\nexport function isTypedEvent(event, eventDefinitionType, filter) {\n  function matches(definition, filter) {\n    return every(filter, function (val, key) {\n      return definition[key] === val;\n    });\n  }\n\n  return some(event.eventDefinitions, function (definition) {\n    return definition.$type === eventDefinitionType && matches(event, filter);\n  });\n}\n\nexport function isThrowEvent(event) {\n  return (\n    event.$type === \"bpmn:IntermediateThrowEvent\" ||\n    event.$type === \"bpmn:EndEvent\"\n  );\n}\n\nexport function isCollection(element) {\n  let dataObject = element.dataObjectRef;\n\n  return element.isCollection || (dataObject && dataObject.isCollection);\n}\n\nexport function getDi(element) {\n  return element.businessObject.di;\n}\n\nexport function getSemantic(element) {\n  return element.businessObject;\n}\n\nexport function getFillColor(element, defaultColor) {\n  return getDi(element).get(\"bioc:fill\") || defaultColor || \"white\";\n}\n\nexport function getStrokeColor(element, defaultColor) {\n  return getDi(element).get(\"bioc:stroke\") || defaultColor || \"black\";\n}\n\nexport function getCirclePath(shape) {\n  let cx = shape.x + shape.width / 2,\n    cy = shape.y + shape.height / 2,\n    radius = shape.width / 2;\n\n  let circlePath = [\n    [\"M\", cx, cy],\n    [\"m\", 0, -radius],\n    [\"a\", radius, radius, 0, 1, 1, 0, 2 * radius],\n    [\"a\", radius, radius, 0, 1, 1, 0, -2 * radius],\n    [\"z\"],\n  ];\n\n  return componentsToPath(circlePath);\n}\n\nexport function getRoundRectPath(shape, borderRadius) {\n  let x = shape.x,\n    y = shape.y,\n    width = shape.width,\n    height = shape.height;\n\n  let roundRectPath = [\n    [\"M\", x + borderRadius, y],\n    [\"l\", width - borderRadius * 2, 0],\n    [\"a\", borderRadius, borderRadius, 0, 0, 1, borderRadius, borderRadius],\n    [\"l\", 0, height - borderRadius * 2],\n    [\"a\", borderRadius, borderRadius, 0, 0, 1, -borderRadius, borderRadius],\n    [\"l\", borderRadius * 2 - width, 0],\n    [\"a\", borderRadius, borderRadius, 0, 0, 1, -borderRadius, -borderRadius],\n    [\"l\", 0, borderRadius * 2 - height],\n    [\"a\", borderRadius, borderRadius, 0, 0, 1, borderRadius, -borderRadius],\n    [\"z\"],\n  ];\n\n  return componentsToPath(roundRectPath);\n}\n\nexport function getDiamondPath(shape) {\n  let width = shape.width,\n    height = shape.height,\n    x = shape.x,\n    y = shape.y,\n    halfWidth = width / 2,\n    halfHeight = height / 2;\n\n  let diamondPath = [\n    [\"M\", x + halfWidth, y],\n    [\"l\", halfWidth, halfHeight],\n    [\"l\", -halfWidth, halfHeight],\n    [\"l\", -halfWidth, -halfHeight],\n    [\"z\"],\n  ];\n\n  return componentsToPath(diamondPath);\n}\n\nexport function getRectPath(shape) {\n  let x = shape.x,\n    y = shape.y,\n    width = shape.width,\n    height = shape.height;\n\n  let rectPath = [\n    [\"M\", x, y],\n    [\"l\", width, 0],\n    [\"l\", 0, height],\n    [\"l\", -width, 0],\n    [\"z\"],\n  ];\n\n  return componentsToPath(rectPath);\n}\n","import inherits from \"inherits\";\nimport BaseRenderer from \"diagram-js/lib/draw/BaseRenderer\";\nimport Ids from \"ids\";\nimport { createLine } from \"diagram-js/lib/util/RenderUtil\";\nimport { isObject, assign, forEach } from \"min-dash\";\nimport { query as domQuery } from \"min-dom\";\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  classes as svgClasses,\n} from \"tiny-svg\";\nimport {\n  rotate,\n  transform,\n  translate,\n} from \"diagram-js/lib/util/SvgTransformUtil\";\n\nimport { isExpanded, isEventLoop } from \"../util/DiUtil\";\nimport { getLabel } from \"../features/label-editing/LabelUtil\";\nimport { is } from \"../util/ModelUtil\";\nimport {\n  isTypedEvent,\n  isThrowEvent,\n  isCollection,\n  getDi,\n  getSemantic,\n  getCirclePath,\n  getRoundRectPath,\n  getDiamondPath,\n  getRectPath,\n  getFillColor,\n  getStrokeColor,\n} from \"./BpmnRenderUtil\";\n\nconst RENDERER_IDS = new Ids();\n\nconst TASK_BORDER_RADIUS = 10;\nconst INNER_OUTER_DIST = 3;\n\nconst DEFAULT_FILL_OPACITY = 0.95,\n  HIGH_FILL_OPACITY = 0.35;\n\nexport default function BpmnRenderer(\n  config,\n  eventBus,\n  styles,\n  pathMap,\n  canvas,\n  textRenderer,\n  priority\n) {\n  BaseRenderer.call(this, eventBus, priority);\n\n  let defaultFillColor = config && config.defaultFillColor,\n    defaultStrokeColor = config && config.defaultStrokeColor;\n\n  let rendererId = RENDERER_IDS.next();\n\n  let markers = {};\n\n  let computeStyle = styles.computeStyle;\n\n  function addMarker(id, options) {\n    let attrs = assign(\n      {\n        fill: \"black\",\n        strokeWidth: 1,\n        strokeLinecap: \"round\",\n        strokeDasharray: \"none\",\n      },\n      options.attrs\n    );\n\n    let ref = options.ref || { x: 0, y: 0 };\n\n    let scale = options.scale || 1;\n\n    // fix for safari / chrome / firefox bug not correctly\n    // resetting stroke dash array\n    if (attrs.strokeDasharray === \"none\") {\n      attrs.strokeDasharray = [10000, 1];\n    }\n\n    let marker = svgCreate(\"marker\");\n\n    svgAttr(options.element, attrs);\n\n    svgAppend(marker, options.element);\n\n    svgAttr(marker, {\n      id: id,\n      viewBox: \"0 0 20 20\",\n      refX: ref.x,\n      refY: ref.y,\n      markerWidth: 20 * scale,\n      markerHeight: 20 * scale,\n      orient: \"auto\",\n    });\n\n    let defs = domQuery(\"defs\", canvas._svg);\n\n    if (!defs) {\n      defs = svgCreate(\"defs\");\n\n      svgAppend(canvas._svg, defs);\n    }\n\n    svgAppend(defs, marker);\n\n    markers[id] = marker;\n  }\n\n  function colorEscape(str) {\n    // only allow characters and numbers\n    return str.replace(/[^0-9a-zA-z]+/g, \"_\");\n  }\n\n  function marker(type, fill, stroke) {\n    let id =\n      type +\n      \"-\" +\n      colorEscape(fill) +\n      \"-\" +\n      colorEscape(stroke) +\n      \"-\" +\n      rendererId;\n\n    if (!markers[id]) {\n      createMarker(id, type, fill, stroke);\n    }\n\n    return \"url(#\" + id + \")\";\n  }\n\n  function createMarker(id, type, fill, stroke) {\n    if (type === \"sequenceflow-end\") {\n      let sequenceflowEnd = svgCreate(\"path\");\n      svgAttr(sequenceflowEnd, { d: \"M 1 5 L 11 10 L 1 15 Z\" });\n\n      addMarker(id, {\n        element: sequenceflowEnd,\n        ref: { x: 11, y: 10 },\n        scale: 0.5,\n        attrs: {\n          fill: stroke,\n          stroke: stroke,\n        },\n      });\n    }\n\n    if (type === \"messageflow-start\") {\n      let messageflowStart = svgCreate(\"circle\");\n      svgAttr(messageflowStart, { cx: 6, cy: 6, r: 3.5 });\n\n      addMarker(id, {\n        element: messageflowStart,\n        attrs: {\n          fill: fill,\n          stroke: stroke,\n        },\n        ref: { x: 6, y: 6 },\n      });\n    }\n\n    if (type === \"messageflow-end\") {\n      let messageflowEnd = svgCreate(\"path\");\n      svgAttr(messageflowEnd, { d: \"m 1 5 l 0 -3 l 7 3 l -7 3 z\" });\n\n      addMarker(id, {\n        element: messageflowEnd,\n        attrs: {\n          fill: fill,\n          stroke: stroke,\n          strokeLinecap: \"butt\",\n        },\n        ref: { x: 8.5, y: 5 },\n      });\n    }\n\n    if (type === \"association-start\") {\n      let associationStart = svgCreate(\"path\");\n      svgAttr(associationStart, { d: \"M 11 5 L 1 10 L 11 15\" });\n\n      addMarker(id, {\n        element: associationStart,\n        attrs: {\n          fill: \"none\",\n          stroke: stroke,\n          strokeWidth: 1.5,\n        },\n        ref: { x: 1, y: 10 },\n        scale: 0.5,\n      });\n    }\n\n    if (type === \"association-end\") {\n      let associationEnd = svgCreate(\"path\");\n      svgAttr(associationEnd, { d: \"M 1 5 L 11 10 L 1 15\" });\n\n      addMarker(id, {\n        element: associationEnd,\n        attrs: {\n          fill: \"none\",\n          stroke: stroke,\n          strokeWidth: 1.5,\n        },\n        ref: { x: 12, y: 10 },\n        scale: 0.5,\n      });\n    }\n\n    if (type === \"conditional-flow-marker\") {\n      let conditionalflowMarker = svgCreate(\"path\");\n      svgAttr(conditionalflowMarker, { d: \"M 0 10 L 8 6 L 16 10 L 8 14 Z\" });\n\n      addMarker(id, {\n        element: conditionalflowMarker,\n        attrs: {\n          fill: fill,\n          stroke: stroke,\n        },\n        ref: { x: -1, y: 10 },\n        scale: 0.5,\n      });\n    }\n\n    if (type === \"conditional-default-flow-marker\") {\n      let conditionaldefaultflowMarker = svgCreate(\"path\");\n      svgAttr(conditionaldefaultflowMarker, { d: \"M 6 4 L 10 16\" });\n\n      addMarker(id, {\n        element: conditionaldefaultflowMarker,\n        attrs: {\n          stroke: stroke,\n        },\n        ref: { x: 0, y: 10 },\n        scale: 0.5,\n      });\n    }\n  }\n\n  function drawCircle(parentGfx, width, height, offset, attrs) {\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: \"black\",\n      strokeWidth: 2,\n      fill: \"white\",\n    });\n\n    if (attrs.fill === \"none\") {\n      delete attrs.fillOpacity;\n    }\n\n    let cx = width / 2,\n      cy = height / 2;\n\n    let circle = svgCreate(\"circle\");\n    svgAttr(circle, {\n      cx: cx,\n      cy: cy,\n      r: Math.round((width + height) / 4 - offset),\n    });\n    svgAttr(circle, attrs);\n\n    svgAppend(parentGfx, circle);\n\n    return circle;\n  }\n\n  function drawRect(parentGfx, width, height, r, offset, attrs) {\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: \"black\",\n      strokeWidth: 2,\n      fill: \"white\",\n    });\n\n    let rect = svgCreate(\"rect\");\n    svgAttr(rect, {\n      x: offset,\n      y: offset,\n      width: width - offset * 2,\n      height: height - offset * 2,\n      rx: r,\n      ry: r,\n    });\n    svgAttr(rect, attrs);\n\n    svgAppend(parentGfx, rect);\n\n    return rect;\n  }\n\n  function drawDiamond(parentGfx, width, height, attrs) {\n    let x_2 = width / 2;\n    let y_2 = height / 2;\n\n    let points = [\n      { x: x_2, y: 0 },\n      { x: width, y: y_2 },\n      { x: x_2, y: height },\n      { x: 0, y: y_2 },\n    ];\n\n    let pointsString = points\n      .map(function (point) {\n        return point.x + \",\" + point.y;\n      })\n      .join(\" \");\n\n    attrs = computeStyle(attrs, {\n      stroke: \"black\",\n      strokeWidth: 2,\n      fill: \"white\",\n    });\n\n    let polygon = svgCreate(\"polygon\");\n    svgAttr(polygon, {\n      points: pointsString,\n    });\n    svgAttr(polygon, attrs);\n\n    svgAppend(parentGfx, polygon);\n\n    return polygon;\n  }\n\n  function drawLine(parentGfx, waypoints, attrs) {\n    attrs = computeStyle(attrs, [\"no-fill\"], {\n      stroke: \"black\",\n      strokeWidth: 2,\n      fill: \"none\",\n    });\n\n    let line = createLine(waypoints, attrs);\n\n    svgAppend(parentGfx, line);\n\n    return line;\n  }\n\n  function drawPath(parentGfx, d, attrs) {\n    attrs = computeStyle(attrs, [\"no-fill\"], {\n      strokeWidth: 2,\n      stroke: \"black\",\n    });\n\n    let path = svgCreate(\"path\");\n    svgAttr(path, { d: d });\n    svgAttr(path, attrs);\n\n    svgAppend(parentGfx, path);\n\n    return path;\n  }\n\n  function drawMarker(type, parentGfx, path, attrs) {\n    return drawPath(parentGfx, path, assign({ \"data-marker\": type }, attrs));\n  }\n\n  function as(type) {\n    return function (parentGfx, element) {\n      return handlers[type](parentGfx, element);\n    };\n  }\n\n  function renderer(type) {\n    return handlers[type];\n  }\n\n  function renderEventContent(element, parentGfx) {\n    let event = getSemantic(element);\n    let isThrowing = isThrowEvent(event);\n\n    if (event.eventDefinitions && event.eventDefinitions.length > 1) {\n      if (event.parallelMultiple) {\n        return renderer(\"bpmn:ParallelMultipleEventDefinition\")(\n          parentGfx,\n          element,\n          isThrowing\n        );\n      } else {\n        return renderer(\"bpmn:MultipleEventDefinition\")(\n          parentGfx,\n          element,\n          isThrowing\n        );\n      }\n    }\n\n    if (isTypedEvent(event, \"bpmn:MessageEventDefinition\")) {\n      return renderer(\"bpmn:MessageEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:TimerEventDefinition\")) {\n      return renderer(\"bpmn:TimerEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:ConditionalEventDefinition\")) {\n      return renderer(\"bpmn:ConditionalEventDefinition\")(parentGfx, element);\n    }\n\n    if (isTypedEvent(event, \"bpmn:SignalEventDefinition\")) {\n      return renderer(\"bpmn:SignalEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:EscalationEventDefinition\")) {\n      return renderer(\"bpmn:EscalationEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:LinkEventDefinition\")) {\n      return renderer(\"bpmn:LinkEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:ErrorEventDefinition\")) {\n      return renderer(\"bpmn:ErrorEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:CancelEventDefinition\")) {\n      return renderer(\"bpmn:CancelEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:CompensateEventDefinition\")) {\n      return renderer(\"bpmn:CompensateEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    if (isTypedEvent(event, \"bpmn:TerminateEventDefinition\")) {\n      return renderer(\"bpmn:TerminateEventDefinition\")(\n        parentGfx,\n        element,\n        isThrowing\n      );\n    }\n\n    return null;\n  }\n\n  function renderLabel(parentGfx, label, options) {\n    options = assign(\n      {\n        size: {\n          width: 100,\n        },\n      },\n      options\n    );\n\n    let text = textRenderer.createText(label || \"\", options);\n\n    svgClasses(text).add(\"djs-label\");\n\n    svgAppend(parentGfx, text);\n\n    return text;\n  }\n\n  function renderEmbeddedLabel(parentGfx, element, align) {\n    let semantic = getSemantic(element);\n\n    return renderLabel(parentGfx, semantic.name, {\n      box: element,\n      align: align,\n      padding: 5,\n      style: {\n        fill: getStrokeColor(element, defaultStrokeColor),\n      },\n    });\n  }\n\n  function renderExternalLabel(parentGfx, element) {\n    let box = {\n      width: 90,\n      height: 30,\n      x: element.width / 2 + element.x,\n      y: element.height / 2 + element.y,\n    };\n\n    return renderLabel(parentGfx, getLabel(element), {\n      box: box,\n      fitBox: true,\n      style: assign({}, textRenderer.getExternalStyle(), {\n        fill: getStrokeColor(element, defaultStrokeColor),\n      }),\n    });\n  }\n\n  function renderLaneLabel(parentGfx, text, element) {\n    let textBox = renderLabel(parentGfx, text, {\n      box: {\n        height: 30,\n        width: element.height,\n      },\n      align: \"center-middle\",\n      style: {\n        fill: getStrokeColor(element, defaultStrokeColor),\n      },\n    });\n\n    let top = -1 * element.height;\n\n    transform(textBox, 0, -top, 270);\n  }\n\n  function createPathFromConnection(connection) {\n    let waypoints = connection.waypoints;\n\n    let pathData = \"m  \" + waypoints[0].x + \",\" + waypoints[0].y;\n    for (let i = 1; i < waypoints.length; i++) {\n      pathData += \"L\" + waypoints[i].x + \",\" + waypoints[i].y + \" \";\n    }\n    return pathData;\n  }\n\n  let handlers = (this.handlers = {\n    \"bpmn:Event\": function (parentGfx, element, attrs) {\n      if (!(\"fillOpacity\" in attrs)) {\n        attrs.fillOpacity = DEFAULT_FILL_OPACITY;\n      }\n\n      return drawCircle(parentGfx, element.width, element.height, attrs);\n    },\n    \"bpmn:StartEvent\": function (parentGfx, element) {\n      let attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let semantic = getSemantic(element);\n\n      if (!semantic.isInterrupting) {\n        attrs = {\n          strokeDasharray: \"6\",\n          strokeLinecap: \"round\",\n          fill: getFillColor(element, defaultFillColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        };\n      }\n\n      let circle = renderer(\"bpmn:Event\")(parentGfx, element, attrs);\n\n      renderEventContent(element, parentGfx);\n\n      return circle;\n    },\n    \"bpmn:MessageEventDefinition\": function (parentGfx, element, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_MESSAGE\", {\n        xScaleFactor: 0.9,\n        yScaleFactor: 0.9,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.235,\n          my: 0.315,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(element, defaultStrokeColor)\n        : getFillColor(element, defaultFillColor);\n      let stroke = isThrowing\n        ? getFillColor(element, defaultFillColor)\n        : getStrokeColor(element, defaultStrokeColor);\n\n      let messagePath = drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: stroke,\n      });\n\n      return messagePath;\n    },\n    \"bpmn:TimerEventDefinition\": function (parentGfx, element) {\n      let circle = drawCircle(\n        parentGfx,\n        element.width,\n        element.height,\n        0.2 * element.height,\n        {\n          strokeWidth: 2,\n          fill: getFillColor(element, defaultFillColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        }\n      );\n\n      let pathData = pathMap.getScaledPath(\"EVENT_TIMER_WH\", {\n        xScaleFactor: 0.75,\n        yScaleFactor: 0.75,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.5,\n          my: 0.5,\n        },\n      });\n\n      drawPath(parentGfx, pathData, {\n        strokeWidth: 2,\n        strokeLinecap: \"square\",\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      for (let i = 0; i < 12; i++) {\n        let linePathData = pathMap.getScaledPath(\"EVENT_TIMER_LINE\", {\n          xScaleFactor: 0.75,\n          yScaleFactor: 0.75,\n          containerWidth: element.width,\n          containerHeight: element.height,\n          position: {\n            mx: 0.5,\n            my: 0.5,\n          },\n        });\n\n        let width = element.width / 2;\n        let height = element.height / 2;\n\n        drawPath(parentGfx, linePathData, {\n          strokeWidth: 1,\n          strokeLinecap: \"square\",\n          transform: \"rotate(\" + i * 30 + \",\" + height + \",\" + width + \")\",\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        });\n      }\n\n      return circle;\n    },\n    \"bpmn:EscalationEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_ESCALATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.5,\n          my: 0.2,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:ConditionalEventDefinition\": function (parentGfx, event) {\n      let pathData = pathMap.getScaledPath(\"EVENT_CONDITIONAL\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.5,\n          my: 0.222,\n        },\n      });\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:LinkEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_LINK\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.57,\n          my: 0.263,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:ErrorEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_ERROR\", {\n        xScaleFactor: 1.1,\n        yScaleFactor: 1.1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.2,\n          my: 0.722,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:CancelEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_CANCEL_45\", {\n        xScaleFactor: 1.0,\n        yScaleFactor: 1.0,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.638,\n          my: -0.055,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      let path = drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n\n      rotate(path, 45);\n\n      return path;\n    },\n    \"bpmn:CompensateEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_COMPENSATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.22,\n          my: 0.5,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:SignalEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_SIGNAL\", {\n        xScaleFactor: 0.9,\n        yScaleFactor: 0.9,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.5,\n          my: 0.2,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:MultipleEventDefinition\": function (parentGfx, event, isThrowing) {\n      let pathData = pathMap.getScaledPath(\"EVENT_MULTIPLE\", {\n        xScaleFactor: 1.1,\n        yScaleFactor: 1.1,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.222,\n          my: 0.36,\n        },\n      });\n\n      let fill = isThrowing\n        ? getStrokeColor(event, defaultStrokeColor)\n        : \"none\";\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: fill,\n      });\n    },\n    \"bpmn:ParallelMultipleEventDefinition\": function (parentGfx, event) {\n      let pathData = pathMap.getScaledPath(\"EVENT_PARALLEL_MULTIPLE\", {\n        xScaleFactor: 1.2,\n        yScaleFactor: 1.2,\n        containerWidth: event.width,\n        containerHeight: event.height,\n        position: {\n          mx: 0.458,\n          my: 0.194,\n        },\n      });\n\n      return drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(event, defaultStrokeColor),\n        stroke: getStrokeColor(event, defaultStrokeColor),\n      });\n    },\n    \"bpmn:EndEvent\": function (parentGfx, element) {\n      let circle = renderer(\"bpmn:Event\")(parentGfx, element, {\n        strokeWidth: 4,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      renderEventContent(element, parentGfx, true);\n\n      return circle;\n    },\n    \"bpmn:TerminateEventDefinition\": function (parentGfx, element) {\n      let circle = drawCircle(parentGfx, element.width, element.height, 8, {\n        strokeWidth: 4,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return circle;\n    },\n    \"bpmn:IntermediateEvent\": function (parentGfx, element) {\n      let outer = renderer(\"bpmn:Event\")(parentGfx, element, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      /* inner */\n      drawCircle(parentGfx, element.width, element.height, INNER_OUTER_DIST, {\n        strokeWidth: 1,\n        fill: getFillColor(element, \"none\"),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      renderEventContent(element, parentGfx);\n\n      return outer;\n    },\n    \"bpmn:IntermediateCatchEvent\": as(\"bpmn:IntermediateEvent\"),\n    \"bpmn:IntermediateThrowEvent\": as(\"bpmn:IntermediateEvent\"),\n\n    \"bpmn:Activity\": function (parentGfx, element, attrs) {\n      attrs = attrs || {};\n\n      if (!(\"fillOpacity\" in attrs)) {\n        attrs.fillOpacity = DEFAULT_FILL_OPACITY;\n      }\n\n      return drawRect(\n        parentGfx,\n        element.width,\n        element.height,\n        TASK_BORDER_RADIUS,\n        attrs\n      );\n    },\n\n    \"bpmn:Task\": function (parentGfx, element) {\n      let attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let rect = renderer(\"bpmn:Activity\")(parentGfx, element, attrs);\n\n      renderEmbeddedLabel(parentGfx, element, \"center-middle\");\n      attachTaskMarkers(parentGfx, element);\n\n      return rect;\n    },\n    \"bpmn:Mapper\": function (parentGfx, element) {\n      let attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let rect = renderer(\"bpmn:Activity\")(parentGfx, element, attrs);\n\n      renderEmbeddedLabel(parentGfx, element, \"center-middle\");\n      attachTaskMarkers(parentGfx, element);\n\n      return rect;\n    },\n    \"bpmn:Function\": function (parentGfx, element) {\n      let attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: \"#00b0ff\",\n      };\n\n      let rect = renderer(\"bpmn:Activity\")(parentGfx, element, attrs);\n\n      renderEmbeddedLabel(parentGfx, element, \"center-middle\");\n      attachTaskMarkers(parentGfx, element);\n\n      return rect;\n    },\n    \"bpmn:ServiceTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let pathDataBG = pathMap.getScaledPath(\"TASK_TYPE_SERVICE\", {\n        abspos: {\n          x: 12,\n          y: 18,\n        },\n      });\n\n      /* service bg */ drawPath(parentGfx, pathDataBG, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let fillPathData = pathMap.getScaledPath(\"TASK_TYPE_SERVICE_FILL\", {\n        abspos: {\n          x: 17.2,\n          y: 18,\n        },\n      });\n\n      /* service fill */ drawPath(parentGfx, fillPathData, {\n        strokeWidth: 0,\n        fill: getFillColor(element, defaultFillColor),\n      });\n\n      let pathData = pathMap.getScaledPath(\"TASK_TYPE_SERVICE\", {\n        abspos: {\n          x: 17,\n          y: 22,\n        },\n      });\n\n      /* service */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:UserTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let x = 15;\n      let y = 12;\n\n      let pathData = pathMap.getScaledPath(\"TASK_TYPE_USER_1\", {\n        abspos: {\n          x: x,\n          y: y,\n        },\n      });\n\n      /* user path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 0.5,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let pathData2 = pathMap.getScaledPath(\"TASK_TYPE_USER_2\", {\n        abspos: {\n          x: x,\n          y: y,\n        },\n      });\n\n      /* user2 path */ drawPath(parentGfx, pathData2, {\n        strokeWidth: 0.5,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let pathData3 = pathMap.getScaledPath(\"TASK_TYPE_USER_3\", {\n        abspos: {\n          x: x,\n          y: y,\n        },\n      });\n\n      /* user3 path */ drawPath(parentGfx, pathData3, {\n        strokeWidth: 0.5,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:ManualTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"TASK_TYPE_MANUAL\", {\n        abspos: {\n          x: 17,\n          y: 15,\n        },\n      });\n\n      /* manual path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 0.5, // 0.25,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:SendTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"TASK_TYPE_SEND\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: 21,\n        containerHeight: 14,\n        position: {\n          mx: 0.285,\n          my: 0.357,\n        },\n      });\n\n      /* send path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getFillColor(element, defaultFillColor),\n      });\n\n      return task;\n    },\n    \"bpmn:ReceiveTask\": function (parentGfx, element) {\n      let semantic = getSemantic(element);\n\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n      let pathData;\n\n      if (semantic.instantiate) {\n        drawCircle(parentGfx, 28, 28, 20 * 0.22, { strokeWidth: 1 });\n\n        pathData = pathMap.getScaledPath(\"TASK_TYPE_INSTANTIATING_SEND\", {\n          abspos: {\n            x: 7.77,\n            y: 9.52,\n          },\n        });\n      } else {\n        pathData = pathMap.getScaledPath(\"TASK_TYPE_SEND\", {\n          xScaleFactor: 0.9,\n          yScaleFactor: 0.9,\n          containerWidth: 21,\n          containerHeight: 14,\n          position: {\n            mx: 0.3,\n            my: 0.4,\n          },\n        });\n      }\n\n      /* receive path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:ScriptTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"TASK_TYPE_SCRIPT\", {\n        abspos: {\n          x: 15,\n          y: 20,\n        },\n      });\n\n      /* script path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:BusinessRuleTask\": function (parentGfx, element) {\n      let task = renderer(\"bpmn:Task\")(parentGfx, element);\n\n      let headerPathData = pathMap.getScaledPath(\n        \"TASK_TYPE_BUSINESS_RULE_HEADER\",\n        {\n          abspos: {\n            x: 8,\n            y: 8,\n          },\n        }\n      );\n\n      let businessHeaderPath = drawPath(parentGfx, headerPathData);\n      svgAttr(businessHeaderPath, {\n        strokeWidth: 1,\n        fill: getFillColor(element, \"#aaaaaa\"),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let headerData = pathMap.getScaledPath(\"TASK_TYPE_BUSINESS_RULE_MAIN\", {\n        abspos: {\n          x: 8,\n          y: 8,\n        },\n      });\n\n      let businessPath = drawPath(parentGfx, headerData);\n      svgAttr(businessPath, {\n        strokeWidth: 1,\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return task;\n    },\n    \"bpmn:Loop\": function (parentGfx, element, attrs) {\n      attrs = assign(\n        {\n          fill: getFillColor(element, defaultFillColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        },\n        attrs\n      );\n\n      let rect = renderer(\"bpmn:Activity\")(parentGfx, element, attrs);\n\n      if (isEventLoop(element)) {\n        svgAttr(rect, {\n          strokeDasharray: \"1,2\",\n        });\n      }\n\n      renderEmbeddedLabel(parentGfx, element, \"center-top\");\n      attachTaskMarkers(parentGfx, element, [\"LoopProcessMarker\"]);\n      return rect;\n    },\n    \"bpmn:Conditional\": function (parentGfx, element, attrs) {\n      attrs = assign(\n        {\n          fill: getFillColor(element, defaultFillColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        },\n        attrs\n      );\n\n      let rect = renderer(\"bpmn:Activity\")(parentGfx, element, attrs);\n\n      if (isEventLoop(element)) {\n        svgAttr(rect, {\n          strokeDasharray: \"1,2\",\n        });\n      }\n      renderEmbeddedLabel(parentGfx, element, \"center-top\");\n      attachTaskMarkers(parentGfx, element, [\"ConditionalMarker\"]);\n      return rect;\n    },\n    \"bpmn:AdHocSubProcess\": function (parentGfx, element) {\n      return renderer(\"bpmn:Loop\")(parentGfx, element);\n    },\n    \"bpmn:Transaction\": function (parentGfx, element) {\n      let outer = renderer(\"bpmn:Loop\")(parentGfx, element);\n\n      let innerAttrs = styles.style([\"no-fill\", \"no-events\"], {\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      /* inner path */ drawRect(\n        parentGfx,\n        element.width,\n        element.height,\n        TASK_BORDER_RADIUS - 2,\n        INNER_OUTER_DIST,\n        innerAttrs\n      );\n\n      return outer;\n    },\n    \"bpmn:CallActivity\": function (parentGfx, element) {\n      return renderer(\"bpmn:Loop\")(parentGfx, element, {\n        strokeWidth: 5,\n      });\n    },\n    \"bpmn:Participant\": function (parentGfx, element) {\n      let attrs = {\n        fillOpacity: DEFAULT_FILL_OPACITY,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let lane = renderer(\"bpmn:Lane\")(parentGfx, element, attrs);\n\n      let expandedPool = isExpanded(element);\n\n      if (expandedPool) {\n        drawLine(\n          parentGfx,\n          [\n            { x: 30, y: 0 },\n            { x: 30, y: element.height },\n          ],\n          {\n            stroke: getStrokeColor(element, defaultStrokeColor),\n          }\n        );\n        let text = getSemantic(element).name;\n        renderLaneLabel(parentGfx, text, element);\n      } else {\n        // Collapsed pool draw text inline\n        let text2 = getSemantic(element).name;\n        renderLabel(parentGfx, text2, {\n          box: element,\n          align: \"center-middle\",\n          style: {\n            fill: getStrokeColor(element, defaultStrokeColor),\n          },\n        });\n      }\n\n      let participantMultiplicity =\n        !!getSemantic(element).participantMultiplicity;\n\n      if (participantMultiplicity) {\n        renderer(\"ParticipantMultiplicityMarker\")(parentGfx, element);\n      }\n\n      return lane;\n    },\n    \"bpmn:Lane\": function (parentGfx, element, attrs) {\n      let rect = drawRect(\n        parentGfx,\n        element.width,\n        element.height,\n        0,\n        assign(\n          {\n            fill: getFillColor(element, defaultFillColor),\n            fillOpacity: HIGH_FILL_OPACITY,\n            stroke: getStrokeColor(element, defaultStrokeColor),\n          },\n          attrs\n        )\n      );\n\n      let semantic = getSemantic(element);\n\n      if (semantic.$type === \"bpmn:Lane\") {\n        let text = semantic.name;\n        renderLaneLabel(parentGfx, text, element);\n      }\n\n      return rect;\n    },\n    \"bpmn:InclusiveGateway\": function (parentGfx, element) {\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      /* circle path */\n      drawCircle(\n        parentGfx,\n        element.width,\n        element.height,\n        element.height * 0.24,\n        {\n          strokeWidth: 2.5,\n          fill: getFillColor(element, defaultFillColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        }\n      );\n\n      return diamond;\n    },\n    \"bpmn:ExclusiveGateway\": function (parentGfx, element) {\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"GATEWAY_EXCLUSIVE\", {\n        xScaleFactor: 0.4,\n        yScaleFactor: 0.4,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.32,\n          my: 0.3,\n        },\n      });\n\n      if (getDi(element).isMarkerVisible) {\n        drawPath(parentGfx, pathData, {\n          strokeWidth: 1,\n          fill: getStrokeColor(element, defaultStrokeColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        });\n      }\n\n      return diamond;\n    },\n    \"bpmn:Query\": function (parentGfx, element) {\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"GATEWAY_EXCLUSIVE\", {\n        xScaleFactor: 0.4,\n        yScaleFactor: 0.4,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.32,\n          my: 0.3,\n        },\n      });\n\n      if (getDi(element).isMarkerVisible) {\n        drawPath(parentGfx, pathData, {\n          strokeWidth: 1,\n          fill: getStrokeColor(element, defaultStrokeColor),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        });\n      }\n\n      return diamond;\n    },\n    \"bpmn:ComplexGateway\": function (parentGfx, element) {\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"GATEWAY_COMPLEX\", {\n        xScaleFactor: 0.5,\n        yScaleFactor: 0.5,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.46,\n          my: 0.26,\n        },\n      });\n\n      /* complex path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return diamond;\n    },\n    \"bpmn:ParallelGateway\": function (parentGfx, element) {\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      let pathData = pathMap.getScaledPath(\"GATEWAY_PARALLEL\", {\n        xScaleFactor: 0.6,\n        yScaleFactor: 0.6,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.46,\n          my: 0.2,\n        },\n      });\n\n      /* parallel path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return diamond;\n    },\n    \"bpmn:EventBasedGateway\": function (parentGfx, element) {\n      let semantic = getSemantic(element);\n\n      let diamond = renderer(\"bpmn:Gateway\")(parentGfx, element);\n\n      /* outer circle path */ drawCircle(\n        parentGfx,\n        element.width,\n        element.height,\n        element.height * 0.2,\n        {\n          strokeWidth: 1,\n          fill: \"none\",\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        }\n      );\n\n      let type = semantic.eventGatewayType;\n      let instantiate = !!semantic.instantiate;\n\n      function drawEvent() {\n        let pathData = pathMap.getScaledPath(\"GATEWAY_EVENT_BASED\", {\n          xScaleFactor: 0.18,\n          yScaleFactor: 0.18,\n          containerWidth: element.width,\n          containerHeight: element.height,\n          position: {\n            mx: 0.36,\n            my: 0.44,\n          },\n        });\n\n        let attrs = {\n          strokeWidth: 2,\n          fill: getFillColor(element, \"none\"),\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        };\n\n        /* event path */ drawPath(parentGfx, pathData, attrs);\n      }\n\n      if (type === \"Parallel\") {\n        let pathData = pathMap.getScaledPath(\"GATEWAY_PARALLEL\", {\n          xScaleFactor: 0.4,\n          yScaleFactor: 0.4,\n          containerWidth: element.width,\n          containerHeight: element.height,\n          position: {\n            mx: 0.474,\n            my: 0.296,\n          },\n        });\n\n        let parallelPath = drawPath(parentGfx, pathData);\n        svgAttr(parallelPath, {\n          strokeWidth: 1,\n          fill: \"none\",\n        });\n      } else if (type === \"Exclusive\") {\n        if (!instantiate) {\n          let innerCircle = drawCircle(\n            parentGfx,\n            element.width,\n            element.height,\n            element.height * 0.26\n          );\n          svgAttr(innerCircle, {\n            strokeWidth: 1,\n            fill: \"none\",\n            stroke: getStrokeColor(element, defaultStrokeColor),\n          });\n        }\n\n        drawEvent();\n      }\n\n      return diamond;\n    },\n    \"bpmn:Gateway\": function (parentGfx, element) {\n      let attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        fillOpacity: DEFAULT_FILL_OPACITY,\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      return drawDiamond(parentGfx, element.width, element.height, attrs);\n    },\n    \"bpmn:SequenceFlow\": function (parentGfx, element) {\n      let pathData = createPathFromConnection(element);\n\n      let fill = getFillColor(element, defaultFillColor),\n        stroke = getStrokeColor(element, defaultStrokeColor);\n\n      let attrs = {\n        strokeLinejoin: \"round\",\n        markerEnd: marker(\"sequenceflow-end\", fill, stroke),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let path = drawPath(parentGfx, pathData, attrs);\n\n      let sequenceFlow = getSemantic(element);\n\n      let source;\n\n      if (element.source) {\n        source = element.source.businessObject;\n\n        // conditional flow marker\n        if (\n          sequenceFlow.conditionExpression &&\n          source.$instanceOf(\"bpmn:Activity\")\n        ) {\n          svgAttr(path, {\n            markerStart: marker(\"conditional-flow-marker\", fill, stroke),\n          });\n        }\n\n        // default marker\n        if (\n          source.default &&\n          (source.$instanceOf(\"bpmn:Gateway\") ||\n            source.$instanceOf(\"bpmn:Activity\")) &&\n          source.default === sequenceFlow\n        ) {\n          svgAttr(path, {\n            markerStart: marker(\n              \"conditional-default-flow-marker\",\n              fill,\n              stroke\n            ),\n          });\n        }\n      }\n\n      return path;\n    },\n    \"bpmn:Association\": function (parentGfx, element, attrs) {\n      let semantic = getSemantic(element);\n\n      let fill = getFillColor(element, defaultFillColor),\n        stroke = getStrokeColor(element, defaultStrokeColor);\n\n      attrs = assign(\n        {\n          strokeDasharray: \"0.5, 5\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          stroke: getStrokeColor(element, defaultStrokeColor),\n        },\n        attrs || {}\n      );\n\n      if (\n        semantic.associationDirection === \"One\" ||\n        semantic.associationDirection === \"Both\"\n      ) {\n        attrs.markerEnd = marker(\"association-end\", fill, stroke);\n      }\n\n      if (semantic.associationDirection === \"Both\") {\n        attrs.markerStart = marker(\"association-start\", fill, stroke);\n      }\n\n      return drawLine(parentGfx, element.waypoints, attrs);\n    },\n    \"bpmn:DataInputAssociation\": function (parentGfx, element) {\n      let fill = getFillColor(element, defaultFillColor),\n        stroke = getStrokeColor(element, defaultStrokeColor);\n\n      return renderer(\"bpmn:Association\")(parentGfx, element, {\n        markerEnd: marker(\"association-end\", fill, stroke),\n      });\n    },\n    \"bpmn:DataOutputAssociation\": function (parentGfx, element) {\n      let fill = getFillColor(element, defaultFillColor),\n        stroke = getStrokeColor(element, defaultStrokeColor);\n\n      return renderer(\"bpmn:Association\")(parentGfx, element, {\n        markerEnd: marker(\"association-end\", fill, stroke),\n      });\n    },\n    \"bpmn:MessageFlow\": function (parentGfx, element) {\n      let semantic = getSemantic(element),\n        di = getDi(element);\n\n      let fill = getFillColor(element, defaultFillColor),\n        stroke = getStrokeColor(element, defaultStrokeColor);\n\n      let pathData = createPathFromConnection(element);\n\n      let attrs = {\n        markerEnd: marker(\"messageflow-end\", fill, stroke),\n        markerStart: marker(\"messageflow-start\", fill, stroke),\n        strokeDasharray: \"10, 12\",\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: \"1.5px\",\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      let path = drawPath(parentGfx, pathData, attrs);\n\n      if (semantic.messageRef) {\n        let midPoint = path.getPointAtLength(path.getTotalLength() / 2);\n\n        let markerPathData = pathMap.getScaledPath(\"MESSAGE_FLOW_MARKER\", {\n          abspos: {\n            x: midPoint.x,\n            y: midPoint.y,\n          },\n        });\n\n        let messageAttrs = { strokeWidth: 1 };\n\n        if (di.messageVisibleKind === \"initiating\") {\n          messageAttrs.fill = \"white\";\n          messageAttrs.stroke = \"black\";\n        } else {\n          messageAttrs.fill = \"#888\";\n          messageAttrs.stroke = \"white\";\n        }\n\n        drawPath(parentGfx, markerPathData, messageAttrs);\n      }\n\n      return path;\n    },\n    \"bpmn:DataObject\": function (parentGfx, element) {\n      let pathData = pathMap.getScaledPath(\"DATA_OBJECT_PATH\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.474,\n          my: 0.296,\n        },\n      });\n\n      let elementObject = drawPath(parentGfx, pathData, {\n        fill: getFillColor(element, defaultFillColor),\n        fillOpacity: DEFAULT_FILL_OPACITY,\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let semantic = getSemantic(element);\n\n      if (isCollection(semantic)) {\n        renderDataItemCollection(parentGfx, element);\n      }\n\n      return elementObject;\n    },\n    \"bpmn:DataObjectReference\": as(\"bpmn:DataObject\"),\n    \"bpmn:DataInput\": function (parentGfx, element) {\n      let arrowPathData = pathMap.getRawPath(\"DATA_ARROW\");\n\n      // page\n      let elementObject = renderer(\"bpmn:DataObject\")(parentGfx, element);\n\n      /* input arrow path */ drawPath(parentGfx, arrowPathData, {\n        strokeWidth: 1,\n      });\n\n      return elementObject;\n    },\n    \"bpmn:DataOutput\": function (parentGfx, element) {\n      let arrowPathData = pathMap.getRawPath(\"DATA_ARROW\");\n\n      // page\n      let elementObject = renderer(\"bpmn:DataObject\")(parentGfx, element);\n\n      /* output arrow path */ drawPath(parentGfx, arrowPathData, {\n        strokeWidth: 1,\n        fill: \"black\",\n      });\n\n      return elementObject;\n    },\n    \"bpmn:DataStoreReference\": function (parentGfx, element) {\n      let DATA_STORE_PATH = pathMap.getScaledPath(\"DATA_STORE\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0,\n          my: 0.133,\n        },\n      });\n\n      let elementStore = drawPath(parentGfx, DATA_STORE_PATH, {\n        strokeWidth: 2,\n        fill: getFillColor(element, defaultFillColor),\n        fillOpacity: DEFAULT_FILL_OPACITY,\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      return elementStore;\n    },\n    \"bpmn:BoundaryEvent\": function (parentGfx, element) {\n      let semantic = getSemantic(element),\n        cancel = semantic.cancelActivity;\n\n      let attrs = {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      };\n\n      if (!cancel) {\n        attrs.strokeDasharray = \"6\";\n        attrs.strokeLinecap = \"round\";\n      }\n\n      // apply fillOpacity\n      let outerAttrs = assign({}, attrs, {\n        fillOpacity: 1,\n      });\n\n      // apply no-fill\n      let innerAttrs = assign({}, attrs, {\n        fill: \"none\",\n      });\n\n      let outer = renderer(\"bpmn:Event\")(parentGfx, element, outerAttrs);\n\n      /* inner path */ drawCircle(\n        parentGfx,\n        element.width,\n        element.height,\n        INNER_OUTER_DIST,\n        innerAttrs\n      );\n\n      renderEventContent(element, parentGfx);\n\n      return outer;\n    },\n    \"bpmn:Group\": function (parentGfx, element) {\n      let group = drawRect(\n        parentGfx,\n        element.width,\n        element.height,\n        TASK_BORDER_RADIUS,\n        {\n          stroke: getStrokeColor(element, defaultStrokeColor),\n          strokeWidth: 1,\n          strokeDasharray: \"8,3,1,3\",\n          fill: \"none\",\n          pointerEvents: \"none\",\n        }\n      );\n\n      return group;\n    },\n    label: function (parentGfx, element) {\n      return renderExternalLabel(parentGfx, element);\n    },\n    \"bpmn:TextAnnotation\": function (parentGfx, element) {\n      let style = {\n        fill: \"none\",\n        stroke: \"none\",\n      };\n\n      let textElement = drawRect(\n        parentGfx,\n        element.width,\n        element.height,\n        0,\n        0,\n        style\n      );\n\n      let textPathData = pathMap.getScaledPath(\"TEXT_ANNOTATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0,\n        },\n      });\n\n      drawPath(parentGfx, textPathData, {\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      let text = getSemantic(element).text || \"\";\n      renderLabel(parentGfx, text, {\n        box: element,\n        align: \"left-top\",\n        padding: 5,\n        style: {\n          fill: getStrokeColor(element, defaultStrokeColor),\n        },\n      });\n\n      return textElement;\n    },\n    ParticipantMultiplicityMarker: function (parentGfx, element) {\n      let markerPath = pathMap.getScaledPath(\"MARKER_PARALLEL\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: element.width / 2 / element.width,\n          my: (element.height - 15) / element.height,\n        },\n      });\n\n      drawMarker(\"participant-multiplicity\", parentGfx, markerPath, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    SubProcessMarker: function (parentGfx, element) {\n      let markerRect = drawRect(parentGfx, 14, 14, 0, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      // Process marker is placed in the middle of the box\n      // therefore fixed values can be used here\n      translate(markerRect, element.width / 2 - 7.5, element.height - 20);\n\n      let markerPath = pathMap.getScaledPath(\"MARKER_SUB_PROCESS\", {\n        xScaleFactor: 1.5,\n        yScaleFactor: 1.5,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 - 7.5) / element.width,\n          my: (element.height - 20) / element.height,\n        },\n      });\n\n      drawMarker(\"sub-process\", parentGfx, markerPath, {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    ConditionalMarker: function (parentGfx, element) {\n      let markerRect = drawRect(parentGfx, 20, 20, 0, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n\n      // Process marker is placed in the middle of the box\n      // therefore fixed values can be used here\n      translate(markerRect, element.width / 2 - 7.5, element.height - 25);\n\n      let markerPath = pathMap.getScaledPath(\"MARKER_CONDITIONAL\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 - 4.5) / element.width,\n          my: (element.height - 22) / element.height,\n        },\n      });\n\n      drawMarker(\"sub-process\", parentGfx, markerPath, {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    LoopProcessMarker: function (parentGfx, element, position) {\n      let markerRect = drawRect(parentGfx, 20, 20, 0, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n      translate(markerRect, element.width / 2 - 7.5, element.height - 25);\n      let markerPath = pathMap.getScaledPath(\"MARKER_LOOP\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.loop + 2) / element.width,\n          my: (element.height - 9) / element.height,\n        },\n      });\n\n      drawMarker(\"loop\", parentGfx, markerPath, {\n        strokeWidth: 1.5,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n        strokeLinecap: \"round\",\n        strokeMiterlimit: 0.5,\n      });\n      // let markerDiamond = drawDiamond(parentGfx, 30, 30);\n      // let circle = drawCircle(parentGfx, 25, 25, 25 * 0.24, {\n      //   strokeWidth: 2.5,\n      //   fill: getFillColor(element, defaultFillColor),\n      //   stroke: getStrokeColor(element, defaultStrokeColor),\n      // });\n      // translate(markerDiamond, element.width / 2 - 7.5, element.height - 35);\n      // translate(circle, element.width / 2 - 5, element.height - 32.5);\n    },\n    ParallelMarker: function (parentGfx, element, position) {\n      let markerPath = pathMap.getScaledPath(\"MARKER_PARALLEL\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.parallel) / element.width,\n          my: (element.height - 20) / element.height,\n        },\n      });\n\n      drawMarker(\"parallel\", parentGfx, markerPath, {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    SequentialMarker: function (parentGfx, element, position) {\n      let markerPath = pathMap.getScaledPath(\"MARKER_SEQUENTIAL\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.seq) / element.width,\n          my: (element.height - 19) / element.height,\n        },\n      });\n\n      drawMarker(\"sequential\", parentGfx, markerPath, {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    CompensationMarker: function (parentGfx, element, position) {\n      let markerMath = pathMap.getScaledPath(\"MARKER_COMPENSATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.compensation) / element.width,\n          my: (element.height - 13) / element.height,\n        },\n      });\n\n      drawMarker(\"compensation\", parentGfx, markerMath, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n    LoopMarker: function (parentGfx, element, position) {\n      let markerPath = pathMap.getScaledPath(\"MARKER_LOOP\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.loop) / element.width,\n          my: (element.height - 7) / element.height,\n        },\n      });\n\n      drawMarker(\"loop\", parentGfx, markerPath, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n        strokeLinecap: \"round\",\n        strokeMiterlimit: 0.5,\n      });\n    },\n    AdhocMarker: function (parentGfx, element, position) {\n      let markerPath = pathMap.getScaledPath(\"MARKER_ADHOC\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 + position.adhoc) / element.width,\n          my: (element.height - 15) / element.height,\n        },\n      });\n\n      drawMarker(\"adhoc\", parentGfx, markerPath, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor),\n      });\n    },\n  });\n\n  function attachTaskMarkers(parentGfx, element, taskMarkers) {\n    let obj = getSemantic(element);\n\n    let loop = taskMarkers && taskMarkers.indexOf(\"SubProcessMarker\") !== -1;\n    let position;\n\n    if (loop) {\n      position = {\n        seq: -21,\n        parallel: -22,\n        compensation: -42,\n        loop: -18,\n        adhoc: 10,\n      };\n    } else {\n      position = {\n        seq: -3,\n        parallel: -6,\n        compensation: -27,\n        loop: 0,\n        adhoc: 10,\n      };\n    }\n\n    forEach(taskMarkers, function (marker) {\n      renderer(marker)(parentGfx, element, position);\n    });\n\n    if (obj.isForCompensation) {\n      renderer(\"CompensationMarker\")(parentGfx, element, position);\n    }\n\n    if (obj.$type === \"bpmn:AdHocSubProcess\") {\n      renderer(\"AdhocMarker\")(parentGfx, element, position);\n    }\n\n    let loopCharacteristics = obj.loopCharacteristics,\n      isSequential = loopCharacteristics && loopCharacteristics.isSequential;\n\n    if (loopCharacteristics) {\n      if (isSequential === undefined) {\n        renderer(\"LoopMarker\")(parentGfx, element, position);\n      }\n\n      if (isSequential === false) {\n        renderer(\"ParallelMarker\")(parentGfx, element, position);\n      }\n\n      if (isSequential === true) {\n        renderer(\"SequentialMarker\")(parentGfx, element, position);\n      }\n    }\n  }\n\n  function renderDataItemCollection(parentGfx, element) {\n    let yPosition = (element.height - 16) / element.height;\n\n    let pathData = pathMap.getScaledPath(\"DATA_OBJECT_COLLECTION_PATH\", {\n      xScaleFactor: 1,\n      yScaleFactor: 1,\n      containerWidth: element.width,\n      containerHeight: element.height,\n      position: {\n        mx: 0.451,\n        my: yPosition,\n      },\n    });\n\n    /* collection path */ drawPath(parentGfx, pathData, {\n      strokeWidth: 2,\n    });\n  }\n\n  // extension API, use at your own risk\n  this._drawPath = drawPath;\n}\n\ninherits(BpmnRenderer, BaseRenderer);\n\nBpmnRenderer.$inject = [\n  \"config.bpmnRenderer\",\n  \"eventBus\",\n  \"styles\",\n  \"pathMap\",\n  \"canvas\",\n  \"textRenderer\",\n];\n\nBpmnRenderer.prototype.canRender = function (element) {\n  return is(element, \"bpmn:BaseElement\");\n};\n\nBpmnRenderer.prototype.drawShape = function (parentGfx, element) {\n  let type = element.type;\n  let h = this.handlers[type];\n\n  /* jshint -W040 */\n  return h(parentGfx, element);\n};\n\nBpmnRenderer.prototype.drawConnection = function (parentGfx, element) {\n  let type = element.type;\n  let h = this.handlers[type];\n\n  /* jshint -W040 */\n  return h(parentGfx, element);\n};\n\nBpmnRenderer.prototype.getShapePath = function (element) {\n  if (is(element, \"bpmn:Event\")) {\n    return getCirclePath(element);\n  }\n\n  if (is(element, \"bpmn:Activity\")) {\n    return getRoundRectPath(element, TASK_BORDER_RADIUS);\n  }\n\n  if (is(element, \"bpmn:Gateway\")) {\n    return getDiamondPath(element);\n  }\n\n  return getRectPath(element);\n};\n","import { assign } from \"min-dash\";\n\nimport TextUtil from \"diagram-js/lib/util/Text\";\n\nconst DEFAULT_FONT_SIZE = 12;\nconst LINE_HEIGHT_RATIO = 1.2;\n\nconst MIN_TEXT_ANNOTATION_HEIGHT = 30;\n\nexport default function TextRenderer(config) {\n  let defaultStyle = assign(\n    {\n      fontFamily: \"Arial, sans-serif\",\n      fontSize: DEFAULT_FONT_SIZE,\n      fontWeight: \"normal\",\n      lineHeight: LINE_HEIGHT_RATIO,\n    },\n    (config && config.defaultStyle) || {}\n  );\n\n  let fontSize = parseInt(defaultStyle.fontSize, 10) - 1;\n\n  let externalStyle = assign(\n    {},\n    defaultStyle,\n    {\n      fontSize: fontSize,\n    },\n    (config && config.externalStyle) || {}\n  );\n\n  let textUtil = new TextUtil({\n    style: defaultStyle,\n  });\n\n  /**\n   * Get the new bounds of an externally rendered,\n   * layouted label.\n   *\n   * @param  {Bounds} bounds\n   * @param  {String} text\n   *\n   * @return {Bounds}\n   */\n  this.getExternalLabelBounds = function (bounds, text) {\n    let layoutedDimensions = textUtil.getDimensions(text, {\n      box: {\n        width: 90,\n        height: 30,\n        x: bounds.width / 2 + bounds.x,\n        y: bounds.height / 2 + bounds.y,\n      },\n      style: externalStyle,\n    });\n\n    // resize label shape to fit label text\n    return {\n      x: Math.round(bounds.x + bounds.width / 2 - layoutedDimensions.width / 2),\n      y: Math.round(bounds.y),\n      width: Math.ceil(layoutedDimensions.width),\n      height: Math.ceil(layoutedDimensions.height),\n    };\n  };\n\n  /**\n   * Get the new bounds of text annotation.\n   *\n   * @param  {Bounds} bounds\n   * @param  {String} text\n   *\n   * @return {Bounds}\n   */\n  this.getTextAnnotationBounds = function (bounds, text) {\n    let layoutedDimensions = textUtil.getDimensions(text, {\n      box: bounds,\n      style: defaultStyle,\n      align: \"left-top\",\n      padding: 5,\n    });\n\n    return {\n      x: bounds.x,\n      y: bounds.y,\n      width: bounds.width,\n      height: Math.max(\n        MIN_TEXT_ANNOTATION_HEIGHT,\n        Math.round(layoutedDimensions.height)\n      ),\n    };\n  };\n\n  /**\n   * Create a layouted text element.\n   *\n   * @param {String} text\n   * @param {Object} [options]\n   *\n   * @return {SVGElement} rendered text\n   */\n  this.createText = function (text, options) {\n    return textUtil.createText(text, options || {});\n  };\n\n  /**\n   * Get default text style.\n   */\n  this.getDefaultStyle = function () {\n    return defaultStyle;\n  };\n\n  /**\n   * Get the external text style.\n   */\n  this.getExternalStyle = function () {\n    return externalStyle;\n  };\n}\n\nTextRenderer.$inject = [\"config.textRenderer\"];\n","export default function PathMap() {\n  this.pathMap = {\n    EVENT_MESSAGE: {\n      d: \"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}\",\n      height: 36,\n      width: 36,\n      heightElements: [6, 14],\n      widthElements: [10.5, 21],\n    },\n    EVENT_SIGNAL: {\n      d: \"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z\",\n      height: 36,\n      width: 36,\n      heightElements: [18],\n      widthElements: [10, 20],\n    },\n    EVENT_ESCALATION: {\n      d: \"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z\",\n      height: 36,\n      width: 36,\n      heightElements: [20, 7],\n      widthElements: [8],\n    },\n    EVENT_CONDITIONAL: {\n      d:\n        \"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z \" +\n        \"M {e.x2},{e.y3} l {e.x0},0 \" +\n        \"M {e.x2},{e.y4} l {e.x0},0 \" +\n        \"M {e.x2},{e.y5} l {e.x0},0 \" +\n        \"M {e.x2},{e.y6} l {e.x0},0 \" +\n        \"M {e.x2},{e.y7} l {e.x0},0 \" +\n        \"M {e.x2},{e.y8} l {e.x0},0 \",\n      height: 36,\n      width: 36,\n      heightElements: [8.5, 14.5, 18, 11.5, 14.5, 17.5, 20.5, 23.5, 26.5],\n      widthElements: [10.5, 14.5, 12.5],\n    },\n    EVENT_LINK: {\n      d: \"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z\",\n      height: 36,\n      width: 36,\n      heightElements: [4.4375, 6.75, 7.8125],\n      widthElements: [9.84375, 13.5],\n    },\n    EVENT_ERROR: {\n      d: \"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z\",\n      height: 36,\n      width: 36,\n      heightElements: [0.023, 8.737, 8.151, 16.564, 10.591, 8.714],\n      widthElements: [0.085, 6.672, 6.97, 4.273, 5.337, 6.636],\n    },\n    EVENT_CANCEL_45: {\n      d:\n        \"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 \" +\n        \"0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z\",\n      height: 36,\n      width: 36,\n      heightElements: [4.75, 8.5],\n      widthElements: [4.75, 8.5],\n    },\n    EVENT_COMPENSATION: {\n      d: \"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z\",\n      height: 36,\n      width: 36,\n      heightElements: [6.5, 13, 0.4, 6.1],\n      widthElements: [9, 9.3, 8.7],\n    },\n    EVENT_TIMER_WH: {\n      d: \"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} \",\n      height: 36,\n      width: 36,\n      heightElements: [10, 2],\n      widthElements: [3, 7],\n    },\n    EVENT_TIMER_LINE: {\n      d: `M {mx},{my}  m {e.x0},{e.y0} l -{e.x1},{e.y1} `,\n      height: 36,\n      width: 36,\n      heightElements: [10, 3],\n      widthElements: [0, 0],\n    },\n    EVENT_MULTIPLE: {\n      d: \"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z\",\n      height: 36,\n      width: 36,\n      heightElements: [6.28099, 12.56199],\n      widthElements: [3.1405, 9.42149, 12.56198],\n    },\n    EVENT_PARALLEL_MULTIPLE: {\n      d:\n        \"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} \" +\n        \"-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z\",\n      height: 36,\n      width: 36,\n      heightElements: [2.56228, 7.68683],\n      widthElements: [2.56228, 7.68683],\n    },\n    GATEWAY_EXCLUSIVE: {\n      d:\n        \"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} \" +\n        \"{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} \" +\n        \"{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z\",\n      height: 17.5,\n      width: 17.5,\n      heightElements: [8.5, 6.5312, -6.5312, -8.5],\n      widthElements: [6.5, -6.5, 3, -3, 5, -5],\n    },\n    GATEWAY_PARALLEL: {\n      d:\n        \"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 \" +\n        \"0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z\",\n      height: 30,\n      width: 30,\n      heightElements: [5, 12.5],\n      widthElements: [5, 12.5],\n    },\n    GATEWAY_EVENT_BASED: {\n      d: \"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z\",\n      height: 11,\n      width: 11,\n      heightElements: [-6, 6, 12, -12],\n      widthElements: [9, -3, -12],\n    },\n    GATEWAY_COMPLEX: {\n      d:\n        \"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} \" +\n        \"{e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} \" +\n        \"{e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} \" +\n        \"-{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z\",\n      height: 17.125,\n      width: 17.125,\n      heightElements: [4.875, 3.4375, 2.125, 3],\n      widthElements: [3.4375, 2.125, 4.875, 3],\n    },\n    DATA_OBJECT_PATH: {\n      d: \"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0\",\n      height: 61,\n      width: 51,\n      heightElements: [10, 50, 60],\n      widthElements: [10, 40, 50, 60],\n    },\n    DATA_OBJECT_COLLECTION_PATH: {\n      d:\n        \"m {mx}, {my} \" +\n        \"m  0 15  l 0 -15 \" +\n        \"m  4 15  l 0 -15 \" +\n        \"m  4 15  l 0 -15 \",\n      height: 61,\n      width: 51,\n      heightElements: [12],\n      widthElements: [1, 6, 12, 15],\n    },\n    DATA_ARROW: {\n      d: \"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z\",\n      height: 61,\n      width: 51,\n      heightElements: [],\n      widthElements: [],\n    },\n    DATA_STORE: {\n      d:\n        \"m  {mx},{my} \" +\n        \"l  0,{e.y2} \" +\n        \"c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 \" +\n        \"l  0,-{e.y2} \" +\n        \"c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0\" +\n        \"c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 \" +\n        \"m  -{e.x2},{e.y0}\" +\n        \"c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0\" +\n        \"m  -{e.x2},{e.y0}\" +\n        \"c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0\",\n      height: 61,\n      width: 61,\n      heightElements: [7, 10, 45],\n      widthElements: [2, 58, 60],\n    },\n    TEXT_ANNOTATION: {\n      d: \"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0\",\n      height: 30,\n      width: 10,\n      heightElements: [30],\n      widthElements: [10],\n    },\n    MARKER_SUB_PROCESS: {\n      d: \"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0\",\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_CONDITIONAL: {\n      d: \"m{mx},{my} m 2,4 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0\",\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_PARALLEL: {\n      d: \"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10\",\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_SEQUENTIAL: {\n      d: \"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0\",\n      height: 10,\n      width: 10,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_COMPENSATION: {\n      d: \"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z\",\n      height: 10,\n      width: 21,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_LOOP: {\n      d:\n        \"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 \" +\n        \"-6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 \" +\n        \"0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 \" +\n        \"l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902\",\n      height: 13.9,\n      width: 13.7,\n      heightElements: [],\n      widthElements: [],\n    },\n    MARKER_ADHOC: {\n      d:\n        \"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 \" +\n        \"3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 \" +\n        \"1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 \" +\n        \"-3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 \" +\n        \"-2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z\",\n      height: 4,\n      width: 15,\n      heightElements: [],\n      widthElements: [],\n    },\n    TASK_TYPE_SEND: {\n      d: \"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}\",\n      height: 14,\n      width: 21,\n      heightElements: [6, 14],\n      widthElements: [10.5, 21],\n    },\n    TASK_TYPE_SCRIPT: {\n      d:\n        \"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 \" +\n        \"c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z \" +\n        \"m -7,-12 l 5,0 \" +\n        \"m -4.5,3 l 4.5,0 \" +\n        \"m -3,3 l 5,0\" +\n        \"m -4,3 l 5,0\",\n      height: 15,\n      width: 12.6,\n      heightElements: [6, 14],\n      widthElements: [10.5, 21],\n    },\n    TASK_TYPE_USER_1: {\n      d:\n        \"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 \" +\n        \"-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 \" +\n        \"0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 \" +\n        \"h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z\" +\n        \"m -8,6 l 0,5.5 m 11,0 l 0,-5\",\n    },\n    TASK_TYPE_USER_2: {\n      d:\n        \"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 \" +\n        \"-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 \",\n    },\n    TASK_TYPE_USER_3: {\n      d:\n        \"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 \" +\n        \"4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 \" +\n        \"-4.20799998,3.36699999 -4.20699998,4.34799999 z\",\n    },\n    TASK_TYPE_MANUAL: {\n      d:\n        \"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 \" +\n        \"-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 \" +\n        \"0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 \" +\n        \"-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 \" +\n        \"0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 \" +\n        \"-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 \" +\n        \"2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 \" +\n        \"-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 \" +\n        \"-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 \" +\n        \"-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 \" +\n        \"0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 \" +\n        \"-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z\",\n    },\n    TASK_TYPE_INSTANTIATING_SEND: {\n      d: \"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6\",\n    },\n    TASK_TYPE_SERVICE: {\n      d:\n        \"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 \" +\n        \"0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 \" +\n        \"-1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 \" +\n        \"v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 \" +\n        \"-0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 \" +\n        \"-1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 \" +\n        \"h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 \" +\n        \"-0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 \" +\n        \"c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 \" +\n        \"l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 \" +\n        \"0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 \" +\n        \"c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z \" +\n        \"m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 \" +\n        \"0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 \" +\n        \"0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z\",\n    },\n    TASK_TYPE_SERVICE_FILL: {\n      d:\n        \"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 \" +\n        \"0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 \" +\n        \"0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z\",\n    },\n    TASK_TYPE_BUSINESS_RULE_HEADER: {\n      d: \"m {mx},{my} 0,4 20,0 0,-4 z\",\n    },\n    TASK_TYPE_BUSINESS_RULE_MAIN: {\n      d: `m {mx},{my} 0,12 20,0 0,-12 z m 0,8 l 20,0 m -13,-4 l 0,8`,\n    },\n    MESSAGE_FLOW_MARKER: {\n      d: \"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6\",\n    },\n  };\n\n  this.getRawPath = function getRawPath(pathId) {\n    return this.pathMap[pathId].d;\n  };\n\n  this.getScaledPath = function getScaledPath(pathId, param) {\n    let rawPath = this.pathMap[pathId];\n    let mx, my;\n\n    if (param.abspos) {\n      mx = param.abspos.x;\n      my = param.abspos.y;\n    } else {\n      mx = param.containerWidth * param.position.mx;\n      my = param.containerHeight * param.position.my;\n    }\n\n    let coordinates = {}; // map for the scaled coordinates\n    if (param.position) {\n      // path\n      let heightRatio =\n        (param.containerHeight / rawPath.height) * param.yScaleFactor;\n      let widthRatio =\n        (param.containerWidth / rawPath.width) * param.xScaleFactor;\n\n      // Apply height ratio\n      for (\n        let heightIndex = 0;\n        heightIndex < rawPath.heightElements.length;\n        heightIndex++\n      ) {\n        coordinates[\"y\" + heightIndex] =\n          rawPath.heightElements[heightIndex] * heightRatio;\n      }\n\n      // Apply width ratio\n      for (\n        let widthIndex = 0;\n        widthIndex < rawPath.widthElements.length;\n        widthIndex++\n      ) {\n        coordinates[\"x\" + widthIndex] =\n          rawPath.widthElements[widthIndex] * widthRatio;\n      }\n    }\n\n    // Apply value to raw path\n    let path = format(rawPath.d, {\n      mx: mx,\n      my: my,\n      e: coordinates,\n    });\n    return path;\n  };\n}\n\nlet tokenRegex = /\\{([^}]+)\\}/g,\n  objNotationRegex = /(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[('|\")(.+?)\\2\\])(\\(\\))?/g; // matches .xxxxx or [\"xxxxx\"] to run over object properties\n\nfunction replacer(all, key, obj) {\n  let res = obj;\n  key.replace(\n    objNotationRegex,\n    function (all, name, quote, quotedName, isFunc) {\n      name = name || quotedName;\n      if (res) {\n        if (name in res) {\n          res = res[name];\n        }\n        typeof res == \"function\" && isFunc && (res = res());\n      }\n    }\n  );\n  res = (res == null || res === obj ? all : res) + \"\";\n\n  return res;\n}\n\nfunction format(str, obj) {\n  return String(str).replace(tokenRegex, function (all, key) {\n    return replacer(all, key, obj);\n  });\n}\n","import BpmnRenderer from \"./BpmnRenderer\";\nimport TextRenderer from \"./TextRenderer\";\n\nimport PathMap from \"./PathMap\";\n\nexport default {\n  __init__: [\"bpmnRenderer\"],\n  bpmnRenderer: [\"type\", BpmnRenderer],\n  textRenderer: [\"type\", TextRenderer],\n  pathMap: [\"type\", PathMap],\n};\n","import { assign } from \"min-dash\";\n\nimport { is } from \"./ModelUtil\";\n\nexport let DEFAULT_LABEL_SIZE = {\n  width: 90,\n  height: 20,\n};\n\nexport let FLOW_LABEL_INDENT = 15;\n\n/**\n * Returns true if the given semantic has an external label\n *\n * @param {BpmnElement} semantic\n * @return {Boolean} true if has label\n */\nexport function isLabelExternal(semantic) {\n  return (\n    is(semantic, \"bpmn:Event\") ||\n    is(semantic, \"bpmn:Gateway\") ||\n    is(semantic, \"bpmn:DataStoreReference\") ||\n    is(semantic, \"bpmn:DataObjectReference\") ||\n    is(semantic, \"bpmn:DataInput\") ||\n    is(semantic, \"bpmn:DataOutput\") ||\n    is(semantic, \"bpmn:SequenceFlow\") ||\n    is(semantic, \"bpmn:MessageFlow\") ||\n    is(semantic, \"bpmn:Group\")\n  );\n}\n\n/**\n * Returns true if the given element has an external label\n *\n * @param {djs.model.shape} element\n * @return {Boolean} true if has label\n */\nexport function hasExternalLabel(element) {\n  return isLabel(element.label);\n}\n\n/**\n * Get the position for sequence flow labels\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the label position\n */\nexport function getFlowLabelPosition(waypoints) {\n  // get the waypoints mid\n  let mid = waypoints.length / 2 - 1;\n\n  let first = waypoints[Math.floor(mid)];\n  let second = waypoints[Math.ceil(mid + 0.01)];\n\n  // get position\n  let position = getWaypointsMid(waypoints);\n\n  // calculate angle\n  let angle = Math.atan((second.y - first.y) / (second.x - first.x));\n\n  let x = position.x,\n    y = position.y;\n\n  if (Math.abs(angle) < Math.PI / 2) {\n    y -= FLOW_LABEL_INDENT;\n  } else {\n    x += FLOW_LABEL_INDENT;\n  }\n\n  return { x: x, y: y };\n}\n\n/**\n * Get the middle of a number of waypoints\n *\n * @param  {Array<Point>} waypoints\n * @return {Point} the mid point\n */\nexport function getWaypointsMid(waypoints) {\n  let mid = waypoints.length / 2 - 1;\n\n  let first = waypoints[Math.floor(mid)];\n  let second = waypoints[Math.ceil(mid + 0.01)];\n\n  return {\n    x: first.x + (second.x - first.x) / 2,\n    y: first.y + (second.y - first.y) / 2,\n  };\n}\n\nexport function getExternalLabelMid(element) {\n  if (element.waypoints) {\n    return getFlowLabelPosition(element.waypoints);\n  } else if (is(element, \"bpmn:Group\")) {\n    return {\n      x: element.x + element.width / 2,\n      y: element.y + DEFAULT_LABEL_SIZE.height / 2,\n    };\n  } else {\n    return {\n      x: element.x + element.width / 2,\n      y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2,\n    };\n  }\n}\n\n/**\n * Returns the bounds of an elements label, parsed from the elements DI or\n * generated from its bounds.\n *\n * @param {BpmnElement} semantic\n * @param {djs.model.Base} element\n */\nexport function getExternalLabelBounds(semantic, element) {\n  let mid,\n    size,\n    bounds,\n    di = semantic.di,\n    label = di.label;\n\n  if (label && label.bounds) {\n    bounds = label.bounds;\n\n    size = {\n      width: Math.max(DEFAULT_LABEL_SIZE.width, bounds.width),\n      height: bounds.height,\n    };\n\n    mid = {\n      x: bounds.x + bounds.width / 2,\n      y: bounds.y + bounds.height / 2,\n    };\n  } else {\n    mid = getExternalLabelMid(element);\n\n    size = DEFAULT_LABEL_SIZE;\n  }\n\n  return assign(\n    {\n      x: mid.x - size.width / 2,\n      y: mid.y - size.height / 2,\n    },\n    size\n  );\n}\n\nexport function isLabel(element) {\n  return element && !!element.labelTarget;\n}\n","import { assign } from \"min-dash\";\n\nimport { is } from \"../util/ModelUtil\";\n\nimport { isLabelExternal, getExternalLabelBounds } from \"../util/LabelUtil\";\n\nimport { getMid } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { isExpanded } from \"../util/DiUtil\";\n\nimport { getLabel } from \"../features/label-editing/LabelUtil\";\n\nimport { elementToString } from \"./Util\";\n\nfunction elementData(semantic, attrs) {\n  return assign(\n    {\n      id: semantic.id,\n      type: semantic.$type,\n      businessObject: semantic,\n    },\n    attrs\n  );\n}\n\nfunction getWaypoints(bo, source, target) {\n  let waypoints = bo.di.waypoint;\n\n  if (!waypoints || waypoints.length < 2) {\n    return [getMid(source), getMid(target)];\n  }\n\n  return waypoints.map(function (p) {\n    return { x: p.x, y: p.y };\n  });\n}\n\nfunction notYetDrawn(translate, semantic, refSemantic, property) {\n  return new Error(\n    translate(\n      \"element {element} referenced by {referenced}#{property} not yet drawn\",\n      {\n        element: elementToString(refSemantic),\n        referenced: elementToString(semantic),\n        property: property,\n      }\n    )\n  );\n}\n\n/**\n * An importer that adds bpmn elements to the canvas\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementFactory} elementFactory\n * @param {ElementRegistry} elementRegistry\n * @param {Function} translate\n * @param {TextRenderer} textRenderer\n */\nexport default function BpmnImporter(\n  eventBus,\n  canvas,\n  elementFactory,\n  elementRegistry,\n  translate,\n  textRenderer\n) {\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._elementFactory = elementFactory;\n  this._elementRegistry = elementRegistry;\n  this._translate = translate;\n  this._textRenderer = textRenderer;\n}\n\nBpmnImporter.$inject = [\n  \"eventBus\",\n  \"canvas\",\n  \"elementFactory\",\n  \"elementRegistry\",\n  \"translate\",\n  \"textRenderer\",\n];\n\n/**\n * Add bpmn element (semantic) to the canvas onto the\n * specified parent shape.\n */\nBpmnImporter.prototype.add = function (semantic, parentElement) {\n  let di = semantic.di,\n    element,\n    translate = this._translate,\n    hidden;\n\n  let parentIndex;\n\n  // ROOT ELEMENT\n  // handle the special case that we deal with a\n  // invisible root element (process or collaboration)\n  if (is(di, \"bpmndi:BPMNPlane\")) {\n    // add a virtual element (not being drawn)\n    element = this._elementFactory.createRoot(elementData(semantic));\n\n    this._canvas.setRootElement(element);\n  }\n\n  // SHAPE\n  else if (is(di, \"bpmndi:BPMNShape\")) {\n    let collapsed = !isExpanded(semantic),\n      isFrame = isFrameElement(semantic);\n    hidden = parentElement && (parentElement.hidden || parentElement.collapsed);\n\n    let bounds = semantic.di.bounds;\n\n    element = this._elementFactory.createShape(\n      elementData(semantic, {\n        collapsed: collapsed,\n        hidden: hidden,\n        x: Math.round(bounds.x),\n        y: Math.round(bounds.y),\n        width: Math.round(bounds.width),\n        height: Math.round(bounds.height),\n        isFrame: isFrame,\n      })\n    );\n\n    if (is(semantic, \"bpmn:BoundaryEvent\")) {\n      this._attachBoundary(semantic, element);\n    }\n\n    // insert lanes behind other flow nodes (cf. #727)\n    if (is(semantic, \"bpmn:Lane\")) {\n      parentIndex = 0;\n    }\n\n    if (is(semantic, \"bpmn:DataStoreReference\")) {\n      // check whether data store is inside our outside of its semantic parent\n      if (!isPointInsideBBox(parentElement, getMid(bounds))) {\n        parentElement = this._canvas.getRootElement();\n      }\n    }\n\n    this._canvas.addShape(element, parentElement, parentIndex);\n  }\n\n  // CONNECTION\n  else if (is(di, \"bpmndi:BPMNEdge\")) {\n    let source = this._getSource(semantic),\n      target = this._getTarget(semantic);\n\n    hidden = parentElement && (parentElement.hidden || parentElement.collapsed);\n\n    element = this._elementFactory.createConnection(\n      elementData(semantic, {\n        hidden: hidden,\n        source: source,\n        target: target,\n        waypoints: getWaypoints(semantic, source, target),\n      })\n    );\n\n    if (is(semantic, \"bpmn:DataAssociation\")) {\n      // render always on top; this ensures DataAssociations\n      // are rendered correctly across different \"hacks\" people\n      // love to model such as cross participant / sub process\n      // associations\n      parentElement = null;\n    }\n\n    // insert sequence flows behind other flow nodes (cf. #727)\n    if (is(semantic, \"bpmn:SequenceFlow\")) {\n      parentIndex = 0;\n    }\n\n    this._canvas.addConnection(element, parentElement, parentIndex);\n  } else {\n    throw new Error(\n      translate(\"unknown di {di} for element {semantic}\", {\n        di: elementToString(di),\n        semantic: elementToString(semantic),\n      })\n    );\n  }\n\n  // (optional) LABEL\n  if (isLabelExternal(semantic) && getLabel(element)) {\n    this.addLabel(semantic, element);\n  }\n\n  this._eventBus.fire(\"bpmnElement.added\", { element: element });\n\n  return element;\n};\n\n/**\n * Attach the boundary element to the given host\n *\n * @param {ModdleElement} boundarySemantic\n * @param {djs.model.Base} boundaryElement\n */\nBpmnImporter.prototype._attachBoundary = function (\n  boundarySemantic,\n  boundaryElement\n) {\n  let translate = this._translate;\n  let hostSemantic = boundarySemantic.attachedToRef;\n\n  if (!hostSemantic) {\n    throw new Error(\n      translate(\"missing {semantic}#attachedToRef\", {\n        semantic: elementToString(boundarySemantic),\n      })\n    );\n  }\n\n  let host = this._elementRegistry.get(hostSemantic.id),\n    attachers = host && host.attachers;\n\n  if (!host) {\n    throw notYetDrawn(\n      translate,\n      boundarySemantic,\n      hostSemantic,\n      \"attachedToRef\"\n    );\n  }\n\n  // wire element.host <> host.attachers\n  boundaryElement.host = host;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  if (attachers.indexOf(boundaryElement) === -1) {\n    attachers.push(boundaryElement);\n  }\n};\n\n/**\n * add label for an element\n */\nBpmnImporter.prototype.addLabel = function (semantic, element) {\n  let bounds, text, label;\n\n  bounds = getExternalLabelBounds(semantic, element);\n\n  text = getLabel(element);\n\n  if (text) {\n    // get corrected bounds from actual layouted text\n    bounds = this._textRenderer.getExternalLabelBounds(bounds, text);\n  }\n\n  label = this._elementFactory.createLabel(\n    elementData(semantic, {\n      id: semantic.id + \"_label\",\n      labelTarget: element,\n      type: \"label\",\n      hidden: element.hidden || !getLabel(element),\n      x: Math.round(bounds.x),\n      y: Math.round(bounds.y),\n      width: Math.round(bounds.width),\n      height: Math.round(bounds.height),\n    })\n  );\n\n  return this._canvas.addShape(label, element.parent);\n};\n\n/**\n * Return the drawn connection end based on the given side.\n *\n * @throws {Error} if the end is not yet drawn\n */\nBpmnImporter.prototype._getEnd = function (semantic, side) {\n  let element,\n    refSemantic,\n    type = semantic.$type,\n    translate = this._translate;\n\n  refSemantic = semantic[side + \"Ref\"];\n\n  // handle mysterious isMany DataAssociation#sourceRef\n  if (side === \"source\" && type === \"bpmn:DataInputAssociation\") {\n    refSemantic = refSemantic && refSemantic[0];\n  }\n\n  // fix source / target for DataInputAssociation / DataOutputAssociation\n  if (\n    (side === \"source\" && type === \"bpmn:DataOutputAssociation\") ||\n    (side === \"target\" && type === \"bpmn:DataInputAssociation\")\n  ) {\n    refSemantic = semantic.$parent;\n  }\n\n  element = refSemantic && this._getElement(refSemantic);\n\n  if (element) {\n    return element;\n  }\n\n  if (refSemantic) {\n    throw notYetDrawn(translate, semantic, refSemantic, side + \"Ref\");\n  } else {\n    throw new Error(\n      translate(\"{semantic}#{side} Ref not specified\", {\n        semantic: elementToString(semantic),\n        side: side,\n      })\n    );\n  }\n};\n\nBpmnImporter.prototype._getSource = function (semantic) {\n  return this._getEnd(semantic, \"source\");\n};\n\nBpmnImporter.prototype._getTarget = function (semantic) {\n  return this._getEnd(semantic, \"target\");\n};\n\nBpmnImporter.prototype._getElement = function (semantic) {\n  return this._elementRegistry.get(semantic.id);\n};\n\n// helpers ////////////////////\n\nfunction isPointInsideBBox(bbox, point) {\n  let x = point.x,\n    y = point.y;\n\n  return (\n    x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height\n  );\n}\n\nfunction isFrameElement(semantic) {\n  return is(semantic, \"bpmn:Group\");\n}\n","import translate from \"diagram-js/lib/i18n/translate\";\n\nimport BpmnImporter from \"./BpmnImporter\";\n\nexport default {\n  __depends__: [translate],\n  bpmnImporter: [\"type\", BpmnImporter],\n};\n","import DrawModule from \"../draw\";\nimport ImportModule from \"../import\";\n\nexport default {\n  __depends__: [DrawModule, ImportModule],\n};\n","import inherits from \"inherits\";\n\nimport CoreModule from \"./core\";\nimport TranslateModule from \"diagram-js/lib/i18n/translate\";\nimport SelectionModule from \"diagram-js/lib/features/selection\";\nimport OverlaysModule from \"diagram-js/lib/features/overlays\";\n\nimport BaseViewer from \"./BaseViewer\";\n\n/**\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function Viewer(options) {\n  BaseViewer.call(this, options);\n}\n\ninherits(Viewer, BaseViewer);\n\n// modules the viewer is composed of\nViewer.prototype._modules = [\n  CoreModule,\n  TranslateModule,\n  SelectionModule,\n  OverlaysModule,\n];\n\n// default moddle extensions the viewer is composed of\nViewer.prototype._moddleExtensions = {};\n","import inherits from \"inherits\";\n\nimport Viewer from \"./Viewer\";\n\nimport KeyboardMoveModule from \"diagram-js/lib/navigation/keyboard-move\";\nimport MoveCanvasModule from \"diagram-js/lib/navigation/movecanvas\";\nimport ZoomScrollModule from \"diagram-js/lib/navigation/zoomscroll\";\n\n/**\n * A viewer that includes mouse navigation facilities\n *\n * @param {Object} options\n */\nexport default function NavigatedViewer(options) {\n  Viewer.call(this, options);\n}\n\ninherits(NavigatedViewer, Viewer);\n\nNavigatedViewer.prototype._navigationModules = [\n  KeyboardMoveModule,\n  MoveCanvasModule,\n  ZoomScrollModule,\n];\n\nNavigatedViewer.prototype._modules = [].concat(\n  Viewer.prototype._modules,\n  NavigatedViewer.prototype._navigationModules\n);\n","import { some } from \"min-dash\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\n/**\n * Return true if element has any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nexport function isAny(element, types) {\n  return some(types, function (t) {\n    return is(element, t);\n  });\n}\n\n/**\n * Return the parent of the element with any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {String|Array<String>} anyType\n *\n * @return {djs.model.Base}\n */\nexport function getParent(element, anyType) {\n  if (typeof anyType === \"string\") {\n    anyType = [anyType];\n  }\n\n  while ((element = element.parent)) {\n    if (isAny(element, anyType)) {\n      return element;\n    }\n  }\n\n  return null;\n}\n","import { is } from \"../../util/ModelUtil\";\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\nimport {\n  getMid,\n  asTRBL,\n  getOrientation,\n} from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { find, reduce } from \"min-dash\";\n\nconst DEFAULT_HORIZONTAL_DISTANCE = 50;\n\nconst MAX_HORIZONTAL_DISTANCE = 250;\n\n// padding to detect element placement\nconst PLACEMENT_DETECTION_PAD = 10;\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Point}\n */\nexport function getNewShapePosition(source, element) {\n  if (is(element, \"bpmn:TextAnnotation\")) {\n    return getTextAnnotationPosition(source, element);\n  }\n\n  if (isAny(element, [\"bpmn:DataObjectReference\", \"bpmn:DataStoreReference\"])) {\n    return getDataElementPosition(source, element);\n  }\n\n  if (is(element, \"bpmn:FlowNode\")) {\n    return getFlowNodePosition(source, element);\n  }\n\n  return getDefaultPosition(source, element);\n}\n\n/**\n * Always try to place element right of source;\n * compute actual distance from previous nodes in flow.\n */\nexport function getFlowNodePosition(source, element) {\n  let sourceTrbl = asTRBL(source);\n  let sourceMid = getMid(source);\n\n  let horizontalDistance = getFlowNodeDistance(source, element);\n\n  let orientation = \"left\",\n    rowSize = 80,\n    margin = 30;\n\n  if (is(source, \"bpmn:BoundaryEvent\")) {\n    orientation = getOrientation(source, source.host, -25);\n\n    if (orientation.indexOf(\"top\") !== -1) {\n      margin *= -1;\n    }\n  }\n\n  function getVerticalDistance(orient) {\n    if (orient.indexOf(\"top\") !== -1) {\n      return -1 * rowSize;\n    } else if (orient.indexOf(\"bottom\") !== -1) {\n      return rowSize;\n    } else {\n      return 0;\n    }\n  }\n\n  let position = {\n    x: sourceTrbl.right + horizontalDistance + element.width / 2,\n    y: sourceMid.y + getVerticalDistance(orientation),\n  };\n\n  let escapeDirection = {\n    y: {\n      margin: margin,\n      rowSize: rowSize,\n    },\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n/**\n * Compute best distance between source and target,\n * based on existing connections to and from source.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n *\n * @return {Number} distance\n */\nexport function getFlowNodeDistance(source, element) {\n  let sourceTrbl = asTRBL(source);\n\n  // is connection a reference to consider?\n  function isReference(c) {\n    return is(c, \"bpmn:SequenceFlow\");\n  }\n\n  function toTargetNode(weight) {\n    return function (shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function (shape) {\n          let shapeTrbl = asTRBL(shape);\n\n          return shapeTrbl.left - sourceTrbl.right;\n        },\n      };\n    };\n  }\n\n  function toSourceNode(weight) {\n    return function (shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function (shape) {\n          let shapeTrbl = asTRBL(shape);\n\n          return sourceTrbl.left - shapeTrbl.right;\n        },\n      };\n    };\n  }\n\n  // we create a list of nodes to take into consideration\n  // for calculating the optimal flow node distance\n  //\n  //   * weight existing target nodes higher than source nodes\n  //   * only take into account individual nodes once\n  //\n  let nodes = reduce(\n    [].concat(\n      getTargets(source, isReference).map(toTargetNode(5)),\n      getSources(source, isReference).map(toSourceNode(1))\n    ),\n    function (nodes, node) {\n      // filter out shapes connected twice via source or target\n      nodes[node.shape.id + \"__weight_\" + node.weight] = node;\n\n      return nodes;\n    },\n    {}\n  );\n\n  // compute distances between source and incoming nodes;\n  // group at the same time by distance and expose the\n  // favourite distance as { fav: { count, value } }.\n  let distancesGrouped = reduce(\n    nodes,\n    function (result, node) {\n      let shape = node.shape,\n        weight = node.weight,\n        distanceTo = node.distanceTo;\n\n      let fav = result.fav,\n        currentDistance,\n        currentDistanceCount,\n        currentDistanceEntry;\n\n      currentDistance = distanceTo(shape);\n\n      // ignore too far away peers\n      // or non-left to right modeled nodes\n      if (currentDistance < 0 || currentDistance > MAX_HORIZONTAL_DISTANCE) {\n        return result;\n      }\n\n      currentDistanceEntry = result[String(currentDistance)] = result[\n        String(currentDistance)\n      ] || {\n        value: currentDistance,\n        count: 0,\n      };\n\n      // inc diff count\n      currentDistanceCount = currentDistanceEntry.count += 1 * weight;\n\n      if (!fav || fav.count < currentDistanceCount) {\n        result.fav = currentDistanceEntry;\n      }\n\n      return result;\n    },\n    {}\n  );\n\n  if (distancesGrouped.fav) {\n    return distancesGrouped.fav.value;\n  } else {\n    return DEFAULT_HORIZONTAL_DISTANCE;\n  }\n}\n\n/**\n * Always try to place text annotations top right of source.\n */\nexport function getTextAnnotationPosition(source, element) {\n  let sourceTrbl = asTRBL(source);\n\n  let position = {\n    x: sourceTrbl.right + element.width / 2,\n    y: sourceTrbl.top - 50 - element.height / 2,\n  };\n\n  let escapeDirection = {\n    y: {\n      margin: -30,\n      rowSize: 20,\n    },\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n/**\n * Always put element bottom right of source.\n */\nexport function getDataElementPosition(source, element) {\n  let sourceTrbl = asTRBL(source);\n\n  let position = {\n    x: sourceTrbl.right - 10 + element.width / 2,\n    y: sourceTrbl.bottom + 40 + element.width / 2,\n  };\n\n  let escapeDirection = {\n    x: {\n      margin: 30,\n      rowSize: 30,\n    },\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n/**\n * Always put element right of source per default.\n */\nexport function getDefaultPosition(source, element) {\n  let sourceTrbl = asTRBL(source);\n\n  let sourceMid = getMid(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + DEFAULT_HORIZONTAL_DISTANCE + element.width / 2,\n    y: sourceMid.y,\n  };\n}\n\n/**\n * Returns all connected elements around the given source.\n *\n * This includes:\n *\n *   - connected elements\n *   - host connected elements\n *   - attachers connected elements\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Array<djs.model.Shape>}\n */\nfunction getAutoPlaceClosure(source, element) {\n  let allConnected = getConnected(source);\n\n  if (source.host) {\n    allConnected = allConnected.concat(getConnected(source.host));\n  }\n\n  if (source.attachers) {\n    allConnected = allConnected.concat(\n      source.attachers.reduce(function (shapes, attacher) {\n        return shapes.concat(getConnected(attacher));\n      }, [])\n    );\n  }\n\n  return allConnected;\n}\n\n/**\n * Return target at given position, if defined.\n *\n * This takes connected elements from host and attachers\n * into account, too.\n */\nexport function getConnectedAtPosition(source, position, element) {\n  let bounds = {\n    x: position.x - element.width / 2,\n    y: position.y - element.height / 2,\n    width: element.width,\n    height: element.height,\n  };\n\n  let closure = getAutoPlaceClosure(source, element);\n\n  return find(closure, function (target) {\n    if (target === element) {\n      return false;\n    }\n\n    let orientation = getOrientation(target, bounds, PLACEMENT_DETECTION_PAD);\n\n    return orientation === \"intersect\";\n  });\n}\n\n/**\n * Returns a new, position for the given element\n * based on the given element that is not occupied\n * by some element connected to source.\n *\n * Take into account the escapeDirection (where to move\n * on positioning clashes) in the computation.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n * @param {Point} position\n * @param {Object} escapeDelta\n *\n * @return {Point}\n */\nexport function deconflictPosition(source, element, position, escapeDelta) {\n  function nextPosition(existingElement) {\n    let newPosition = {\n      x: position.x,\n      y: position.y,\n    };\n\n    [\"x\", \"y\"].forEach(function (axis) {\n      let axisDelta = escapeDelta[axis];\n\n      if (!axisDelta) {\n        return;\n      }\n\n      let dimension = axis === \"x\" ? \"width\" : \"height\";\n\n      let margin = axisDelta.margin,\n        rowSize = axisDelta.rowSize;\n\n      if (margin < 0) {\n        newPosition[axis] = Math.min(\n          existingElement[axis] + margin - element[dimension] / 2,\n          position[axis] - rowSize + margin\n        );\n      } else {\n        newPosition[axis] = Math.max(\n          existingTarget[axis] +\n            existingTarget[dimension] +\n            margin +\n            element[dimension] / 2,\n          position[axis] + rowSize + margin\n        );\n      }\n    });\n\n    return newPosition;\n  }\n\n  let existingTarget;\n\n  // deconflict position until free slot is found\n  while ((existingTarget = getConnectedAtPosition(source, position, element))) {\n    position = nextPosition(existingTarget);\n  }\n\n  return position;\n}\n\n// helpers //////////////////////\n\nfunction noneFilter() {\n  return true;\n}\n\nfunction getConnected(element, connectionFilter) {\n  return [].concat(\n    getTargets(element, connectionFilter),\n    getSources(element, connectionFilter)\n  );\n}\n\nfunction getSources(shape, connectionFilter) {\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.incoming.filter(connectionFilter).map(function (c) {\n    return c.source;\n  });\n}\n\nfunction getTargets(shape, connectionFilter) {\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.outgoing.filter(connectionFilter).map(function (c) {\n    return c.target;\n  });\n}\n","import { getNewShapePosition } from \"./AutoPlaceUtil\";\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling) {\n  function emit(event, payload) {\n    return eventBus.fire(event, payload);\n  }\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function (source, shape) {\n    emit(\"autoPlace.start\", {\n      source: source,\n      shape: shape,\n    });\n\n    // allow others to provide the position\n    let position = emit(\"autoPlace\", {\n      source: source,\n      shape: shape,\n    });\n\n    if (!position) {\n      position = getNewShapePosition(source, shape);\n    }\n\n    let newShape = modeling.appendShape(source, shape, position, source.parent);\n\n    emit(\"autoPlace.end\", {\n      source: source,\n      shape: newShape,\n    });\n\n    return newShape;\n  };\n}\n\nAutoPlace.$inject = [\"eventBus\", \"modeling\"];\n","/**\n * Select element after auto placement.\n *\n * @param {EventBus} eventBus\n * @param {Selection} selection\n */\nexport default function AutoPlaceSelectionBehavior(eventBus, selection) {\n  eventBus.on(\"autoPlace.end\", 500, function (e) {\n    selection.select(e.shape);\n  });\n}\n\nAutoPlaceSelectionBehavior.$inject = [\"eventBus\", \"selection\"];\n","import AutoPlace from \"./AutoPlace\";\nimport AutoPlaceSelectionBehavior from \"./AutoPlaceSelectionBehavior\";\n\nexport default {\n  __init__: [\"autoPlaceSelectionBehavior\"],\n  autoPlace: [\"type\", AutoPlace],\n  autoPlaceSelectionBehavior: [\"type\", AutoPlaceSelectionBehavior],\n};\n","import AutoResize from \"diagram-js/lib/features/auto-resize/AutoResize\";\n\nimport inherits from \"inherits\";\n\nimport { is } from \"../../util/ModelUtil\";\n\n/**\n * Sub class of the AutoResize module which implements a BPMN\n * specific resize function.\n */\nexport default function BpmnAutoResize(injector) {\n  injector.invoke(AutoResize, this);\n}\n\nBpmnAutoResize.$inject = [\"injector\"];\n\ninherits(BpmnAutoResize, AutoResize);\n\n/**\n * Resize shapes and lanes.\n *\n * @param {djs.model.Shape} target\n * @param {Bounds} newBounds\n * @param {Object} hints\n */\nBpmnAutoResize.prototype.resize = function (target, newBounds, hints) {\n  if (is(target, \"bpmn:Participant\")) {\n    this._modeling.resizeLane(target, newBounds, null, hints);\n  } else {\n    this._modeling.resizeShape(target, newBounds, null, hints);\n  }\n};\n","import { is } from \"../../util/ModelUtil\";\n\nimport inherits from \"inherits\";\n\nimport { forEach } from \"min-dash\";\n\nimport AutoResizeProvider from \"diagram-js/lib/features/auto-resize/AutoResizeProvider\";\n\n/**\n * This module is a provider for automatically resizing parent BPMN elements\n */\nexport default function BpmnAutoResizeProvider(eventBus, modeling) {\n  AutoResizeProvider.call(this, eventBus);\n\n  this._modeling = modeling;\n}\n\ninherits(BpmnAutoResizeProvider, AutoResizeProvider);\n\nBpmnAutoResizeProvider.$inject = [\"eventBus\", \"modeling\"];\n\n/**\n * Check if the given target can be expanded\n *\n * @param  {djs.model.Shape} target\n *\n * @return {boolean}\n */\nBpmnAutoResizeProvider.prototype.canResize = function (elements, target) {\n  if (\n    !is(target, \"bpmn:Participant\") &&\n    !is(target, \"bpmn:Lane\") &&\n    !is(target, \"bpmn:Loop\") &&\n    !is(target, \"bpmn:Conditional\")\n  ) {\n    return false;\n  }\n\n  let canResize = true;\n\n  forEach(elements, function (element) {\n    if (is(element, \"bpmn:Lane\") || element.labelTarget) {\n      canResize = false;\n      return;\n    }\n  });\n\n  return canResize;\n};\n","import BpmnAutoResize from \"./BpmnAutoResize\";\nimport BpmnAutoResizeProvider from \"./BpmnAutoResizeProvider\";\n\nexport default {\n  __init__: [\"bpmnAutoResize\", \"bpmnAutoResizeProvider\"],\n  bpmnAutoResize: [\"type\", BpmnAutoResize],\n  bpmnAutoResizeProvider: [\"type\", BpmnAutoResizeProvider],\n};\n","import { getBusinessObject, is } from \"../../util/ModelUtil\";\n\nimport { forEach, isArray, isUndefined, omit, reduce } from \"min-dash\";\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [properties];\n  }\n\n  forEach(properties, function (property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nfunction removeProperties(element, properties) {\n  if (!isArray(properties)) {\n    properties = [properties];\n  }\n\n  forEach(properties, function (property) {\n    if (element[property]) {\n      delete element[property];\n    }\n  });\n}\n\nlet LOW_PRIORITY = 750;\n\nexport default function BpmnCopyPaste(bpmnFactory, eventBus, moddleCopy) {\n  eventBus.on(\"copyPaste.copyElement\", LOW_PRIORITY, function (context) {\n    let descriptor = context.descriptor,\n      element = context.element;\n\n    let businessObject = (descriptor.oldBusinessObject =\n      getBusinessObject(element));\n\n    descriptor.type = element.type;\n\n    copyProperties(businessObject, descriptor, \"name\");\n\n    descriptor.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(businessObject.di, descriptor.di, [\"fill\", \"stroke\"]);\n\n    copyProperties(businessObject.di, descriptor, \"isExpanded\");\n\n    if (isLabel(descriptor)) {\n      return descriptor;\n    }\n\n    // default sequence flow\n    if (businessObject.default) {\n      descriptor.default = businessObject.default.id;\n    }\n  });\n\n  eventBus.on(\"moddleCopy.canCopyProperty\", function (context) {\n    let parent = context.parent,\n      property = context.property,\n      propertyName = context.propertyName,\n      bpmnProcess;\n\n    if (\n      propertyName === \"processRef\" &&\n      is(parent, \"bpmn:Participant\") &&\n      is(property, \"bpmn:Process-action\")\n    ) {\n      bpmnProcess = bpmnFactory.create(\"bpmn:Process-action\");\n\n      // return copy of process\n      return moddleCopy.copyElement(property, bpmnProcess);\n    }\n  });\n\n  let references;\n\n  function resolveReferences(descriptor, cache) {\n    let businessObject = getBusinessObject(descriptor);\n\n    // default sequence flows\n    if (descriptor.default) {\n      // relationship cannot be resolved immediately\n      references[descriptor.default] = {\n        element: businessObject,\n        property: \"default\",\n      };\n    }\n\n    // boundary events\n    if (descriptor.host) {\n      // relationship can be resolved immediately\n      getBusinessObject(descriptor).attachedToRef = getBusinessObject(\n        cache[descriptor.host]\n      );\n    }\n\n    references = omit(\n      references,\n      reduce(\n        references,\n        function (array, reference, key) {\n          let element = reference.element,\n            property = reference.property;\n\n          if (key === descriptor.id) {\n            element[property] = businessObject;\n\n            array.push(descriptor.id);\n          }\n\n          return array;\n        },\n        []\n      )\n    );\n  }\n\n  eventBus.on(\"copyPaste.pasteElements\", function () {\n    references = {};\n  });\n\n  eventBus.on(\"copyPaste.pasteElement\", function (context) {\n    let cache = context.cache,\n      descriptor = context.descriptor,\n      oldBusinessObject = descriptor.oldBusinessObject,\n      newBusinessObject;\n\n    // do NOT copy business object if external label\n    if (isLabel(descriptor)) {\n      descriptor.businessObject = getBusinessObject(\n        cache[descriptor.labelTarget]\n      );\n\n      return;\n    }\n\n    newBusinessObject = bpmnFactory.create(oldBusinessObject.$type);\n\n    descriptor.businessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject\n    );\n\n    // resolve references e.g. default sequence flow\n    resolveReferences(descriptor, cache);\n\n    copyProperties(descriptor, newBusinessObject, [\"isExpanded\", \"name\"]);\n\n    removeProperties(descriptor, \"oldBusinessObject\");\n  });\n}\n\nBpmnCopyPaste.$inject = [\"bpmnFactory\", \"eventBus\", \"moddleCopy\"];\n\n// helpers //////////\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\n  find,\n  forEach,\n  isArray,\n  isDefined,\n  isObject,\n  matchPattern,\n  reduce,\n  has,\n  sortBy,\n} from \"min-dash\";\n\nlet DISALLOWED_PROPERTIES = [\n  \"artifacts\",\n  \"dataInputAssociations\",\n  \"dataOutputAssociations\",\n  \"default\",\n  \"flowElements\",\n  \"lanes\",\n  \"incoming\",\n  \"outgoing\",\n];\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperties> listener\n *\n * @param {Object} context\n * @param {Array<string>} context.propertyNames\n * @param {ModdleElement} context.sourceElement\n * @param {ModdleElement} context.targetElement\n *\n * @returns {Array<string>|boolean} - Return properties to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {*|boolean} - Return copied property or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canSetCopiedProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {boolean} - Return false to disallow\n * setting copied property.\n */\n\n/**\n * Utility for copying model properties from source element to target element.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n * @param {BpmnModdle} moddle\n */\nexport default function ModdleCopy(eventBus, bpmnFactory, moddle) {\n  this._bpmnFactory = bpmnFactory;\n  this._eventBus = eventBus;\n  this._moddle = moddle;\n\n  // copy extension elements last\n  eventBus.on(\"moddleCopy.canCopyProperties\", function (context) {\n    let propertyNames = context.propertyNames;\n\n    if (!propertyNames || !propertyNames.length) {\n      return;\n    }\n\n    return sortBy(propertyNames, function (propertyName) {\n      return propertyName === \"assignElements\";\n    });\n  });\n\n  // default check whether property can be copied\n  eventBus.on(\"moddleCopy.canCopyProperty\", function (context) {\n    let parent = context.parent,\n      parentDescriptor = isObject(parent) && parent.$descriptor,\n      propertyName = context.propertyName;\n\n    if (propertyName && DISALLOWED_PROPERTIES.indexOf(propertyName) !== -1) {\n      // disallow copying property\n      return false;\n    }\n\n    if (\n      propertyName &&\n      parentDescriptor &&\n      !find(parentDescriptor.properties, matchPattern({ name: propertyName }))\n    ) {\n      // disallow copying property\n      return false;\n    }\n  });\n\n  // do NOT allow to copy empty extension elements\n  eventBus.on(\"moddleCopy.canSetCopiedProperty\", function (context) {\n    let property = context.property;\n\n    if (\n      is(property, \"bpmn:AssignElements\") &&\n      (!property.values || !property.values.length)\n    ) {\n      // disallow setting copied property\n      return false;\n    }\n  });\n}\n\nModdleCopy.$inject = [\"eventBus\", \"bpmnFactory\", \"moddle\"];\n\n/**\n * Copy model properties of source element to target element.\n *\n * @param {ModdleElement} sourceElement\n * @param {ModdleElement} targetElement\n * @param {Array<string>} [propertyNames]\n *\n * @param {ModdleElement}\n */\nModdleCopy.prototype.copyElement = function (\n  sourceElement,\n  targetElement,\n  propertyNames\n) {\n  let self = this;\n\n  if (propertyNames && !isArray(propertyNames)) {\n    propertyNames = [propertyNames];\n  }\n\n  propertyNames = propertyNames || getPropertyNames(sourceElement.$descriptor);\n\n  let canCopyProperties = this._eventBus.fire(\"moddleCopy.canCopyProperties\", {\n    propertyNames: propertyNames,\n    sourceElement: sourceElement,\n    targetElement: targetElement,\n  });\n\n  if (canCopyProperties === false) {\n    return targetElement;\n  }\n\n  if (isArray(canCopyProperties)) {\n    propertyNames = canCopyProperties;\n  }\n\n  // copy properties\n  forEach(propertyNames, function (propertyName) {\n    let sourceProperty;\n\n    if (has(sourceElement, propertyName)) {\n      sourceProperty = sourceElement.get(propertyName);\n    }\n\n    let copiedProperty = self.copyProperty(\n      sourceProperty,\n      targetElement,\n      propertyName\n    );\n\n    let canSetProperty = self._eventBus.fire(\n      \"moddleCopy.canSetCopiedProperty\",\n      {\n        parent: targetElement,\n        property: copiedProperty,\n        propertyName: propertyName,\n      }\n    );\n\n    if (canSetProperty === false) {\n      return;\n    }\n\n    if (isDefined(copiedProperty)) {\n      targetElement.set(propertyName, copiedProperty);\n    }\n  });\n\n  return targetElement;\n};\n\n/**\n * Copy model property.\n *\n * @param {*} property\n * @param {ModdleElement} parent\n * @param {string} propertyName\n *\n * @returns {*}\n */\nModdleCopy.prototype.copyProperty = function (property, parent, propertyName) {\n  let self = this;\n\n  // allow others to copy property\n  let copiedProperty = this._eventBus.fire(\"moddleCopy.canCopyProperty\", {\n    parent: parent,\n    property: property,\n    propertyName: propertyName,\n  });\n\n  // return if copying is NOT allowed\n  if (copiedProperty === false) {\n    return;\n  }\n\n  if (copiedProperty) {\n    if (\n      isObject(copiedProperty) &&\n      copiedProperty.$type &&\n      !copiedProperty.$parent\n    ) {\n      copiedProperty.$parent = parent;\n    }\n\n    return copiedProperty;\n  }\n\n  let propertyDescriptor = this._moddle.getPropertyDescriptor(\n    parent,\n    propertyName\n  );\n\n  // do NOT copy Ids and references\n  if (propertyDescriptor.isId || propertyDescriptor.isReference) {\n    return;\n  }\n\n  // copy arrays\n  if (isArray(property)) {\n    return reduce(\n      property,\n      function (childProperties, childProperty) {\n        // recursion\n        copiedProperty = self.copyProperty(childProperty, parent, propertyName);\n\n        // copying might NOT be allowed\n        if (copiedProperty) {\n          copiedProperty.$parent = parent;\n\n          return childProperties.concat(copiedProperty);\n        }\n\n        return childProperties;\n      },\n      []\n    );\n  }\n\n  // copy model elements\n  if (isObject(property) && property.$type) {\n    if (this._moddle.getElementDescriptor(property).isGeneric) {\n      return;\n    }\n\n    copiedProperty = self._bpmnFactory.create(property.$type);\n\n    copiedProperty.$parent = parent;\n\n    // recursion\n    copiedProperty = self.copyElement(property, copiedProperty);\n\n    return copiedProperty;\n  }\n\n  // copy primitive properties\n  return property;\n};\n\n// helpers //////////\n\nexport function getPropertyNames(descriptor, keepDefaultProperties) {\n  return reduce(\n    descriptor.properties,\n    function (properties, property) {\n      if (keepDefaultProperties && property.default) {\n        return properties;\n      }\n\n      return properties.concat(property.name);\n    },\n    []\n  );\n}\n\nfunction is(element, type) {\n  return (\n    element &&\n    typeof element.$instanceOf === \"function\" &&\n    element.$instanceOf(type)\n  );\n}\n","import CopyPasteModule from \"diagram-js/lib/features/copy-paste\";\n\nimport BpmnCopyPaste from \"./BpmnCopyPaste\";\nimport ModdleCopy from \"./ModdleCopy\";\n\nexport default {\n  __depends__: [CopyPasteModule],\n  __init__: [\"bpmnCopyPaste\", \"moddleCopy\"],\n  bpmnCopyPaste: [\"type\", BpmnCopyPaste],\n  moddleCopy: [\"type\", ModdleCopy],\n};\n","import {\n  pick,\n  assign,\n  filter,\n  forEach,\n  isArray,\n  isUndefined,\n  has,\n} from \"min-dash\";\n\nimport { is, getBusinessObject } from \"../../util/ModelUtil\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\nimport { isExpanded, isEventLoop } from \"../../util/DiUtil\";\n\nimport { getPropertyNames } from \"../copy-paste/ModdleCopy\";\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [properties];\n  }\n\n  forEach(properties, function (property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nlet CUSTOM_PROPERTIES = [\n  \"cancelActivity\",\n  \"instantiate\",\n  \"eventGatewayType\",\n  \"triggeredByEvent\",\n  \"isInterrupting\",\n];\n\nfunction toggeling(element, target) {\n  let oldCollapsed =\n    element && has(element, \"collapsed\")\n      ? element.collapsed\n      : !isExpanded(element);\n\n  let targetCollapsed;\n\n  if (target && (has(target, \"collapsed\") || has(target, \"isExpanded\"))) {\n    // property is explicitly set so use it\n    targetCollapsed = has(target, \"collapsed\")\n      ? target.collapsed\n      : !target.isExpanded;\n  } else {\n    // keep old state\n    targetCollapsed = oldCollapsed;\n  }\n\n  if (oldCollapsed !== targetCollapsed) {\n    element.collapsed = oldCollapsed;\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * This module takes care of replacing BPMN elements\n */\nexport default function BpmnReplace(\n  bpmnFactory,\n  elementFactory,\n  moddleCopy,\n  modeling,\n  replace,\n  selection\n) {\n  /**\n   * Prepares a new business object for the replacement element\n   * and triggers the replace operation.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {Object} target\n   * @param  {Object} [hints]\n   *\n   * @return {djs.model.Base} the newly created element\n   */\n  function replaceElement(element, target, hints) {\n    hints = hints || {};\n\n    let type = target.type,\n      oldBusinessObject = element.businessObject;\n\n    if (isLoop(oldBusinessObject)) {\n      if (type === \"bpmn:Loop\") {\n        if (toggeling(element, target)) {\n          // expanding or collapsing process\n          modeling.toggleCollapse(element);\n\n          return element;\n        }\n      }\n    }\n\n    let newBusinessObject = bpmnFactory.create(type);\n\n    let newElement = {\n      type: type,\n      businessObject: newBusinessObject,\n    };\n\n    let elementProps = getPropertyNames(oldBusinessObject.$descriptor),\n      newElementProps = getPropertyNames(newBusinessObject.$descriptor, true),\n      copyProps = intersection(elementProps, newElementProps);\n\n    // initialize special properties defined in target definition\n    assign(newBusinessObject, pick(target, CUSTOM_PROPERTIES));\n\n    let properties = filter(copyProps, function (propertyName) {\n      // copying event definitions, unless we replace\n      if (propertyName === \"eventDefinitions\") {\n        return hasEventDefinition(element, target.eventDefinitionType);\n      }\n\n      // retain loop characteristics if the target element\n      // is not an event sub process\n      if (propertyName === \"loopCharacteristics\") {\n        return !isEventLoop(newBusinessObject);\n      }\n\n      // so the applied properties from 'target' don't get lost\n      if (newBusinessObject.hasOwnProperty(propertyName)) {\n        return false;\n      }\n\n      if (propertyName === \"processRef\" && target.isExpanded === false) {\n        return false;\n      }\n\n      if (propertyName === \"triggeredByEvent\") {\n        return false;\n      }\n\n      return true;\n    });\n\n    newBusinessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject,\n      properties\n    );\n\n    // initialize custom BPMN extensions\n    if (target.eventDefinitionType) {\n      // only initialize with new eventDefinition\n      // if we did not set an event definition yet,\n      // i.e. because we copied it\n      if (!hasEventDefinition(newBusinessObject, target.eventDefinitionType)) {\n        newElement.eventDefinitionType = target.eventDefinitionType;\n      }\n    }\n\n    if (is(oldBusinessObject, \"bpmn:Activity\")) {\n      if (isLoop(oldBusinessObject)) {\n        // no toggeling, so keep old state\n        newElement.isExpanded = isExpanded(oldBusinessObject);\n      }\n\n      // else if property is explicitly set, use it\n      else if (target && has(target, \"isExpanded\")) {\n        newElement.isExpanded = target.isExpanded;\n      }\n\n      // TODO: need also to respect min/max Size\n      // copy size, from an expanded loop to an expanded alternative loop\n      // except bpmn:Task, because Task is always expanded\n      if (\n        isExpanded(oldBusinessObject) &&\n        !is(oldBusinessObject, \"bpmn:Task\") &&\n        newElement.isExpanded\n      ) {\n        newElement.width = element.width;\n        newElement.height = element.height;\n      }\n    }\n\n    // remove children if not expanding sub process\n    if (isLoop(oldBusinessObject) && !isLoop(newBusinessObject)) {\n      hints.moveChildren = false;\n    }\n\n    // transform collapsed/expanded pools\n    if (is(oldBusinessObject, \"bpmn:Participant\")) {\n      // create expanded pool\n      if (target.isExpanded === true) {\n        newBusinessObject.processRef = bpmnFactory.create(\n          \"bpmn:Process-action\"\n        );\n      } else {\n        // remove children when transforming to collapsed pool\n        hints.moveChildren = false;\n      }\n\n      // apply same width and default height\n      newElement.width = element.width;\n      newElement.height =\n        elementFactory._getDefaultSize(newBusinessObject).height;\n    }\n\n    newBusinessObject.name = oldBusinessObject.name;\n\n    // retain default flow's reference between inclusive <-> exclusive gateways and activities\n    if (\n      isAny(oldBusinessObject, [\n        \"bpmn:ExclusiveGateway\",\n        \"bpmn:InclusiveGateway\",\n        \"bpmn:Activity\",\n      ]) &&\n      isAny(newBusinessObject, [\n        \"bpmn:ExclusiveGateway\",\n        \"bpmn:InclusiveGateway\",\n        \"bpmn:Activity\",\n      ])\n    ) {\n      newBusinessObject.default = oldBusinessObject.default;\n    }\n\n    if (\n      target.host &&\n      !is(oldBusinessObject, \"bpmn:BoundaryEvent\") &&\n      is(newBusinessObject, \"bpmn:BoundaryEvent\")\n    ) {\n      newElement.host = target.host;\n    }\n\n    newElement.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(oldBusinessObject.di, newElement.di, [\"fill\", \"stroke\"]);\n\n    newElement = replace.replaceElement(element, newElement, hints);\n\n    if (hints.select !== false) {\n      selection.select(newElement);\n    }\n\n    return newElement;\n  }\n\n  this.replaceElement = replaceElement;\n}\n\nBpmnReplace.$inject = [\n  \"bpmnFactory\",\n  \"elementFactory\",\n  \"moddleCopy\",\n  \"modeling\",\n  \"replace\",\n  \"selection\",\n];\n\nfunction isLoop(bo) {\n  return is(bo, \"bpmn:Loop\");\n}\n\nfunction hasEventDefinition(element, type) {\n  let bo = getBusinessObject(element);\n\n  return (\n    type &&\n    bo.get(\"eventDefinitions\").some(function (definition) {\n      return is(definition, type);\n    })\n  );\n}\n\n/**\n * Compute intersection between two arrays.\n */\nfunction intersection(a1, a2) {\n  return a1.filter(function (el) {\n    return a2.indexOf(el) !== -1;\n  });\n}\n","import CopyPasteModule from \"../copy-paste\";\nimport ReplaceModule from \"diagram-js/lib/features/replace\";\nimport SelectionModule from \"diagram-js/lib/features/selection\";\n\nimport BpmnReplace from \"./BpmnReplace\";\n\nexport default {\n  __depends__: [CopyPasteModule, ReplaceModule, SelectionModule],\n  bpmnReplace: [\"type\", BpmnReplace],\n};\n","import { getBusinessObject } from \"../../../util/ModelUtil\";\n\nimport { isExpanded } from \"../../../util/DiUtil\";\n\n/**\n * Returns true, if an element is from a different type\n * than a target definition. Takes into account the type,\n * event definition type and triggeredByEvent property.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nexport function isDifferentType(element) {\n  return function (entry) {\n    let target = entry.target;\n\n    let businessObject = getBusinessObject(element),\n      eventDefinition =\n        businessObject.eventDefinitions && businessObject.eventDefinitions[0];\n\n    let isTypeEqual = businessObject.$type === target.type;\n\n    let isEventDefinitionEqual =\n      (eventDefinition && eventDefinition.$type) === target.eventDefinitionType;\n\n    let isTriggeredByEventEqual =\n      businessObject.triggeredByEvent === target.triggeredByEvent;\n\n    let isExpandedEqual =\n      target.isExpanded === undefined ||\n      target.isExpanded === isExpanded(businessObject);\n\n    return (\n      !isTypeEqual ||\n      !isEventDefinitionEqual ||\n      !isTriggeredByEventEqual ||\n      !isExpandedEqual\n    );\n  };\n}\n","export let START_EVENT = [\n  {\n    label: \"Start Event\",\n    actionName: \"replace-with-none-start\",\n    className: \"bpmn-icon-start-event-none\",\n    target: {\n      type: \"bpmn:StartEvent\",\n    },\n  },\n  {\n    label: \"Intermediate Throw Event\",\n    actionName: \"replace-with-none-intermediate-throwing\",\n    className: \"bpmn-icon-intermediate-event-none\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n    },\n  },\n  {\n    label: \"End Event\",\n    actionName: \"replace-with-none-end\",\n    className: \"bpmn-icon-end-event-none\",\n    target: {\n      type: \"bpmn:EndEvent\",\n    },\n  },\n  {\n    label: \"Message Start Event\",\n    actionName: \"replace-with-message-start\",\n    className: \"bpmn-icon-start-event-message\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Timer Start Event\",\n    actionName: \"replace-with-timer-start\",\n    className: \"bpmn-icon-start-event-timer\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n    },\n  },\n  {\n    label: \"Conditional Start Event\",\n    actionName: \"replace-with-conditional-start\",\n    className: \"bpmn-icon-start-event-condition\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal Start Event\",\n    actionName: \"replace-with-signal-start\",\n    className: \"bpmn-icon-start-event-signal\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n];\n\nexport let INTERMEDIATE_EVENT = [\n  {\n    label: \"Start Event\",\n    actionName: \"replace-with-none-start\",\n    className: \"bpmn-icon-start-event-none\",\n    target: {\n      type: \"bpmn:StartEvent\",\n    },\n  },\n  {\n    label: \"Intermediate Throw Event\",\n    actionName: \"replace-with-none-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-none\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n    },\n  },\n  {\n    label: \"End Event\",\n    actionName: \"replace-with-none-end\",\n    className: \"bpmn-icon-end-event-none\",\n    target: {\n      type: \"bpmn:EndEvent\",\n    },\n  },\n  {\n    label: \"Message Intermediate Catch Event\",\n    actionName: \"replace-with-message-intermediate-catch\",\n    className: \"bpmn-icon-intermediate-event-catch-message\",\n    target: {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Message Intermediate Throw Event\",\n    actionName: \"replace-with-message-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-throw-message\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Timer Intermediate Catch Event\",\n    actionName: \"replace-with-timer-intermediate-catch\",\n    className: \"bpmn-icon-intermediate-event-catch-timer\",\n    target: {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n    },\n  },\n  {\n    label: \"Escalation Intermediate Throw Event\",\n    actionName: \"replace-with-escalation-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-throw-escalation\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n    },\n  },\n  {\n    label: \"Conditional Intermediate Catch Event\",\n    actionName: \"replace-with-conditional-intermediate-catch\",\n    className: \"bpmn-icon-intermediate-event-catch-condition\",\n    target: {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n    },\n  },\n  {\n    label: \"Link Intermediate Catch Event\",\n    actionName: \"replace-with-link-intermediate-catch\",\n    className: \"bpmn-icon-intermediate-event-catch-link\",\n    target: {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: \"bpmn:LinkEventDefinition\",\n    },\n  },\n  {\n    label: \"Link Intermediate Throw Event\",\n    actionName: \"replace-with-link-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-throw-link\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n      eventDefinitionType: \"bpmn:LinkEventDefinition\",\n    },\n  },\n  {\n    label: \"Compensation Intermediate Throw Event\",\n    actionName: \"replace-with-compensation-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-throw-compensation\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n      eventDefinitionType: \"bpmn:CompensateEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal Intermediate Catch Event\",\n    actionName: \"replace-with-signal-intermediate-catch\",\n    className: \"bpmn-icon-intermediate-event-catch-signal\",\n    target: {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal Intermediate Throw Event\",\n    actionName: \"replace-with-signal-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-throw-signal\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n];\n\nexport let END_EVENT = [\n  {\n    label: \"Start Event\",\n    actionName: \"replace-with-none-start\",\n    className: \"bpmn-icon-start-event-none\",\n    target: {\n      type: \"bpmn:StartEvent\",\n    },\n  },\n  {\n    label: \"Intermediate Throw Event\",\n    actionName: \"replace-with-none-intermediate-throw\",\n    className: \"bpmn-icon-intermediate-event-none\",\n    target: {\n      type: \"bpmn:IntermediateThrowEvent\",\n    },\n  },\n  {\n    label: \"End Event\",\n    actionName: \"replace-with-none-end\",\n    className: \"bpmn-icon-end-event-none\",\n    target: {\n      type: \"bpmn:EndEvent\",\n    },\n  },\n  {\n    label: \"Message End Event\",\n    actionName: \"replace-with-message-end\",\n    className: \"bpmn-icon-end-event-message\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Escalation End Event\",\n    actionName: \"replace-with-escalation-end\",\n    className: \"bpmn-icon-end-event-escalation\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n    },\n  },\n  {\n    label: \"Error End Event\",\n    actionName: \"replace-with-error-end\",\n    className: \"bpmn-icon-end-event-error\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:ErrorEventDefinition\",\n    },\n  },\n  {\n    label: \"Cancel End Event\",\n    actionName: \"replace-with-cancel-end\",\n    className: \"bpmn-icon-end-event-cancel\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:CancelEventDefinition\",\n    },\n  },\n  {\n    label: \"Compensation End Event\",\n    actionName: \"replace-with-compensation-end\",\n    className: \"bpmn-icon-end-event-compensation\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:CompensateEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal End Event\",\n    actionName: \"replace-with-signal-end\",\n    className: \"bpmn-icon-end-event-signal\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n  {\n    label: \"Terminate End Event\",\n    actionName: \"replace-with-terminate-end\",\n    className: \"bpmn-icon-end-event-terminate\",\n    target: {\n      type: \"bpmn:EndEvent\",\n      eventDefinitionType: \"bpmn:TerminateEventDefinition\",\n    },\n  },\n];\n\nexport let GATEWAY = [\n  {\n    label: \"Exclusive Gateway\",\n    actionName: \"replace-with-exclusive-gateway\",\n    className: \"bpmn-icon-gateway-xor\",\n    target: {\n      type: \"bpmn:ExclusiveGateway\",\n    },\n  },\n  {\n    label: \"Parallel Gateway\",\n    actionName: \"replace-with-parallel-gateway\",\n    className: \"bpmn-icon-gateway-parallel\",\n    target: {\n      type: \"bpmn:ParallelGateway\",\n    },\n  },\n  {\n    label: \"Inclusive Gateway\",\n    actionName: \"replace-with-inclusive-gateway\",\n    className: \"bpmn-icon-gateway-or\",\n    target: {\n      type: \"bpmn:InclusiveGateway\",\n    },\n  },\n  {\n    label: \"Complex Gateway\",\n    actionName: \"replace-with-complex-gateway\",\n    className: \"bpmn-icon-gateway-complex\",\n    target: {\n      type: \"bpmn:ComplexGateway\",\n    },\n  },\n  {\n    label: \"Event based Gateway\",\n    actionName: \"replace-with-event-based-gateway\",\n    className: \"bpmn-icon-gateway-eventbased\",\n    target: {\n      type: \"bpmn:EventBasedGateway\",\n      instantiate: false,\n      eventGatewayType: \"Exclusive\",\n    },\n  },\n\n  // Gateways deactivated until https://github.com/bpmn-io/bpmn-js/issues/194\n  // {\n  //   label: 'Event based instantiating Gateway',\n  //   actionName: 'replace-with-exclusive-event-based-gateway',\n  //   className: 'bpmn-icon-exclusive-event-based',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Exclusive' }\n  //   }\n  // },\n  // {\n  //   label: 'Parallel Event based instantiating Gateway',\n  //   actionName: 'replace-with-parallel-event-based-instantiate-gateway',\n  //   className: 'bpmn-icon-parallel-event-based-instantiate-gateway',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Parallel' }\n  //   }\n  // }\n];\n\nexport let LOOP_EXPANDED = [\n  {\n    label: \"Transaction\",\n    actionName: \"replace-with-transaction\",\n    className: \"bpmn-icon-transaction\",\n    target: {\n      type: \"bpmn:Transaction\",\n      isExpanded: true,\n    },\n  },\n  {\n    label: \"Event Sub Process\",\n    actionName: \"replace-with-event-loop\",\n    className: \"bpmn-icon-event-loop-expanded\",\n    target: {\n      type: \"bpmn:Loop\",\n      triggeredByEvent: true,\n      isExpanded: true,\n    },\n  },\n  {\n    label: \"Sub Process (collapsed)\",\n    actionName: \"replace-with-collapsed-loop\",\n    className: \"bpmn-icon-loop-collapsed\",\n    target: {\n      type: \"bpmn:Loop\",\n      isExpanded: false,\n    },\n  },\n];\n\nexport let TRANSACTION = [\n  {\n    label: \"Sub Process\",\n    actionName: \"replace-with-loop\",\n    className: \"bpmn-icon-loop-expanded\",\n    target: {\n      type: \"bpmn:Loop\",\n      isExpanded: true,\n    },\n  },\n  {\n    label: \"Event Sub Process\",\n    actionName: \"replace-with-event-loop\",\n    className: \"bpmn-icon-event-loop-expanded\",\n    target: {\n      type: \"bpmn:Loop\",\n      triggeredByEvent: true,\n      isExpanded: true,\n    },\n  },\n];\n\nexport let EVENT_SUB_PROCESS = [\n  {\n    label: \"Sub Process\",\n    actionName: \"replace-with-loop\",\n    className: \"bpmn-icon-loop-expanded\",\n    target: {\n      type: \"bpmn:Loop\",\n      isExpanded: true,\n    },\n  },\n  {\n    label: \"Transaction\",\n    actionName: \"replace-with-transaction\",\n    className: \"bpmn-icon-transaction\",\n    target: {\n      type: \"bpmn:Transaction\",\n      isExpanded: true,\n    },\n  },\n];\n\nexport let TASK = [\n  {\n    label: \"Task\",\n    actionName: \"replace-with-task\",\n    className: \"bpmn-icon-task\",\n    target: {\n      type: \"bpmn:Task\",\n    },\n  },\n  {\n    label: \"Send Task\",\n    actionName: \"replace-with-send-task\",\n    className: \"bpmn-icon-send\",\n    target: {\n      type: \"bpmn:SendTask\",\n    },\n  },\n  {\n    label: \"Receive Task\",\n    actionName: \"replace-with-receive-task\",\n    className: \"bpmn-icon-receive\",\n    target: {\n      type: \"bpmn:ReceiveTask\",\n    },\n  },\n  {\n    label: \"User Task\",\n    actionName: \"replace-with-user-task\",\n    className: \"bpmn-icon-user\",\n    target: {\n      type: \"bpmn:UserTask\",\n    },\n  },\n  {\n    label: \"Manual Task\",\n    actionName: \"replace-with-manual-task\",\n    className: \"bpmn-icon-manual\",\n    target: {\n      type: \"bpmn:ManualTask\",\n    },\n  },\n  {\n    label: \"Business Rule Task\",\n    actionName: \"replace-with-rule-task\",\n    className: \"bpmn-icon-business-rule\",\n    target: {\n      type: \"bpmn:BusinessRuleTask\",\n    },\n  },\n  {\n    label: \"Service Task\",\n    actionName: \"replace-with-service-task\",\n    className: \"bpmn-icon-service\",\n    target: {\n      type: \"bpmn:ServiceTask\",\n    },\n  },\n  {\n    label: \"Script Task\",\n    actionName: \"replace-with-script-task\",\n    className: \"bpmn-icon-script\",\n    target: {\n      type: \"bpmn:ScriptTask\",\n    },\n  },\n  {\n    label: \"Call Activity\",\n    actionName: \"replace-with-call-activity\",\n    className: \"bpmn-icon-call-activity\",\n    target: {\n      type: \"bpmn:CallActivity\",\n    },\n  },\n  {\n    label: \"Sub Process (collapsed)\",\n    actionName: \"replace-with-collapsed-loop\",\n    className: \"bpmn-icon-loop-collapsed\",\n    target: {\n      type: \"bpmn:Loop\",\n      isExpanded: false,\n    },\n  },\n  {\n    label: \"Sub Process (expanded)\",\n    actionName: \"replace-with-expanded-loop\",\n    className: \"bpmn-icon-loop-expanded\",\n    target: {\n      type: \"bpmn:Loop\",\n      isExpanded: true,\n    },\n  },\n];\n\nexport let BOUNDARY_EVENT = [\n  {\n    label: \"Message Boundary Event\",\n    actionName: \"replace-with-message-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-message\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Timer Boundary Event\",\n    actionName: \"replace-with-timer-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-timer\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n    },\n  },\n  {\n    label: \"Escalation Boundary Event\",\n    actionName: \"replace-with-escalation-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-escalation\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n    },\n  },\n  {\n    label: \"Conditional Boundary Event\",\n    actionName: \"replace-with-conditional-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-condition\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n    },\n  },\n  {\n    label: \"Error Boundary Event\",\n    actionName: \"replace-with-error-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-error\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:ErrorEventDefinition\",\n    },\n  },\n  {\n    label: \"Cancel Boundary Event\",\n    actionName: \"replace-with-cancel-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-cancel\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:CancelEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal Boundary Event\",\n    actionName: \"replace-with-signal-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-signal\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n  {\n    label: \"Compensation Boundary Event\",\n    actionName: \"replace-with-compensation-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-compensation\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:CompensateEventDefinition\",\n    },\n  },\n  {\n    label: \"Message Boundary Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-message-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-non-interrupting-message\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n      cancelActivity: false,\n    },\n  },\n  {\n    label: \"Timer Boundary Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-timer-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-non-interrupting-timer\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n      cancelActivity: false,\n    },\n  },\n  {\n    label: \"Escalation Boundary Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-escalation-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-non-interrupting-escalation\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n      cancelActivity: false,\n    },\n  },\n  {\n    label: \"Conditional Boundary Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-conditional-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-non-interrupting-condition\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n      cancelActivity: false,\n    },\n  },\n  {\n    label: \"Signal Boundary Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-signal-boundary\",\n    className: \"bpmn-icon-intermediate-event-catch-non-interrupting-signal\",\n    target: {\n      type: \"bpmn:BoundaryEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n      cancelActivity: false,\n    },\n  },\n];\n\nexport let EVENT_SUB_PROCESS_START_EVENT = [\n  {\n    label: \"Message Start Event\",\n    actionName: \"replace-with-message-start\",\n    className: \"bpmn-icon-start-event-message\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n    },\n  },\n  {\n    label: \"Timer Start Event\",\n    actionName: \"replace-with-timer-start\",\n    className: \"bpmn-icon-start-event-timer\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n    },\n  },\n  {\n    label: \"Conditional Start Event\",\n    actionName: \"replace-with-conditional-start\",\n    className: \"bpmn-icon-start-event-condition\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n    },\n  },\n  {\n    label: \"Signal Start Event\",\n    actionName: \"replace-with-signal-start\",\n    className: \"bpmn-icon-start-event-signal\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n    },\n  },\n  {\n    label: \"Error Start Event\",\n    actionName: \"replace-with-error-start\",\n    className: \"bpmn-icon-start-event-error\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:ErrorEventDefinition\",\n    },\n  },\n  {\n    label: \"Escalation Start Event\",\n    actionName: \"replace-with-escalation-start\",\n    className: \"bpmn-icon-start-event-escalation\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n    },\n  },\n  {\n    label: \"Compensation Start Event\",\n    actionName: \"replace-with-compensation-start\",\n    className: \"bpmn-icon-start-event-compensation\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:CompensateEventDefinition\",\n    },\n  },\n  {\n    label: \"Message Start Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-message-start\",\n    className: \"bpmn-icon-start-event-non-interrupting-message\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:MessageEventDefinition\",\n      isInterrupting: false,\n    },\n  },\n  {\n    label: \"Timer Start Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-timer-start\",\n    className: \"bpmn-icon-start-event-non-interrupting-timer\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:TimerEventDefinition\",\n      isInterrupting: false,\n    },\n  },\n  {\n    label: \"Conditional Start Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-conditional-start\",\n    className: \"bpmn-icon-start-event-non-interrupting-condition\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:ConditionalEventDefinition\",\n      isInterrupting: false,\n    },\n  },\n  {\n    label: \"Signal Start Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-signal-start\",\n    className: \"bpmn-icon-start-event-non-interrupting-signal\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:SignalEventDefinition\",\n      isInterrupting: false,\n    },\n  },\n  {\n    label: \"Escalation Start Event (non-interrupting)\",\n    actionName: \"replace-with-non-interrupting-escalation-start\",\n    className: \"bpmn-icon-start-event-non-interrupting-escalation\",\n    target: {\n      type: \"bpmn:StartEvent\",\n      eventDefinitionType: \"bpmn:EscalationEventDefinition\",\n      isInterrupting: false,\n    },\n  },\n];\n\nexport let SEQUENCE_FLOW = [\n  {\n    label: \"Sequence Flow\",\n    actionName: \"replace-with-sequence-flow\",\n    className: \"bpmn-icon-connection\",\n  },\n  {\n    label: \"Default Flow\",\n    actionName: \"replace-with-default-flow\",\n    className: \"bpmn-icon-default-flow\",\n  },\n  {\n    label: \"Conditional Flow\",\n    actionName: \"replace-with-conditional-flow\",\n    className: \"bpmn-icon-conditional-flow\",\n  },\n];\n\nexport let PARTICIPANT = [\n  {\n    label: \"Expanded Pool\",\n    actionName: \"replace-with-expanded-pool\",\n    className: \"bpmn-icon-participant\",\n    target: {\n      type: \"bpmn:Participant\",\n      isExpanded: true,\n    },\n  },\n  {\n    label: \"Collapsed Pool\",\n    actionName: \"replace-with-collapsed-pool\",\n\n    // TODO(@janstuemmel): maybe design new icon\n    className: \"bpmn-icon-lane\",\n    target: {\n      type: \"bpmn:Participant\",\n      isExpanded: false,\n    },\n  },\n];\n","import { getBusinessObject, is } from \"../../util/ModelUtil\";\n\nimport { isEventLoop, isExpanded } from \"../../util/DiUtil\";\n\nimport { isDifferentType } from \"./util/TypeUtil\";\n\nimport { forEach, filter } from \"min-dash\";\n\nimport * as replaceOptions from \"../replace/ReplaceOptions\";\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nexport default function ReplaceMenuProvider(\n  popupMenu,\n  modeling,\n  moddle,\n  bpmnReplace,\n  rules,\n  translate\n) {\n  this._popupMenu = popupMenu;\n  this._modeling = modeling;\n  this._moddle = moddle;\n  this._bpmnReplace = bpmnReplace;\n  this._rules = rules;\n  this._translate = translate;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [\n  \"popupMenu\",\n  \"modeling\",\n  \"moddle\",\n  \"bpmnReplace\",\n  \"rules\",\n  \"translate\",\n];\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function () {\n  this._popupMenu.registerProvider(\"bpmn-replace\", this);\n};\n\n/**\n * Get all entries from replaceOptions for the given element and apply filters\n * on them. Get for example only elements, which are different from the current one.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function (element) {\n  let businessObject = element.businessObject;\n\n  let rules = this._rules;\n\n  let entries;\n\n  if (!rules.allowed(\"shape.replace\", { element: element })) {\n    return [];\n  }\n\n  let differentType = isDifferentType(element);\n\n  // start events outside event sub processes\n  if (\n    is(businessObject, \"bpmn:StartEvent\") &&\n    !isEventLoop(businessObject.$parent)\n  ) {\n    entries = filter(replaceOptions.START_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded/collapsed pools\n  if (is(businessObject, \"bpmn:Participant\")) {\n    entries = filter(replaceOptions.PARTICIPANT, function (entry) {\n      return isExpanded(businessObject) !== entry.target.isExpanded;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // start events inside event sub processes\n  if (\n    is(businessObject, \"bpmn:StartEvent\") &&\n    isEventLoop(businessObject.$parent)\n  ) {\n    entries = filter(\n      replaceOptions.EVENT_SUB_PROCESS_START_EVENT,\n      function (entry) {\n        let target = entry.target;\n\n        let isInterrupting = target.isInterrupting !== false;\n\n        let isInterruptingEqual =\n          getBusinessObject(element).isInterrupting === isInterrupting;\n\n        // filters elements which types and event definition are equal but have have different interrupting types\n        return (\n          differentType(entry) ||\n          (!differentType(entry) && !isInterruptingEqual)\n        );\n      }\n    );\n\n    return this._createEntries(element, entries);\n  }\n\n  // end events\n  if (is(businessObject, \"bpmn:EndEvent\")) {\n    entries = filter(replaceOptions.END_EVENT, function (entry) {\n      let target = entry.target;\n\n      // hide cancel end events outside transactions\n      if (\n        target.eventDefinitionType === \"bpmn:CancelEventDefinition\" &&\n        !is(businessObject.$parent, \"bpmn:Transaction\")\n      ) {\n        return false;\n      }\n\n      return differentType(entry);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // boundary events\n  if (is(businessObject, \"bpmn:BoundaryEvent\")) {\n    entries = filter(replaceOptions.BOUNDARY_EVENT, function (entry) {\n      let target = entry.target;\n\n      if (\n        target.eventDefinition === \"bpmn:CancelEventDefinition\" &&\n        !is(businessObject.attachedToRef, \"bpmn:Transaction\")\n      ) {\n        return false;\n      }\n      let cancelActivity = target.cancelActivity !== false;\n\n      let isCancelActivityEqual =\n        businessObject.cancelActivity === cancelActivity;\n\n      return (\n        differentType(entry) ||\n        (!differentType(entry) && !isCancelActivityEqual)\n      );\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // intermediate events\n  if (\n    is(businessObject, \"bpmn:IntermediateCatchEvent\") ||\n    is(businessObject, \"bpmn:IntermediateThrowEvent\")\n  ) {\n    entries = filter(replaceOptions.INTERMEDIATE_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // gateways\n  if (is(businessObject, \"bpmn:Gateway\")) {\n    entries = filter(replaceOptions.GATEWAY, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // transactions\n  if (is(businessObject, \"bpmn:Transaction\")) {\n    entries = filter(replaceOptions.TRANSACTION, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded event sub processes\n  if (isEventLoop(businessObject) && isExpanded(businessObject)) {\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded sub processes\n  if (is(businessObject, \"bpmn:Loop\") && isExpanded(businessObject)) {\n    entries = filter(replaceOptions.LOOP_EXPANDED, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // collapsed ad hoc sub processes\n  if (\n    is(businessObject, \"bpmn:AdHocSubProcess\") &&\n    !isExpanded(businessObject)\n  ) {\n    entries = filter(replaceOptions.TASK, function (entry) {\n      let target = entry.target;\n\n      let isTargetLoop = target.type === \"bpmn:Loop\";\n\n      let isTargetExpanded = target.isExpanded === true;\n\n      return (\n        isDifferentType(element, target) && (!isTargetLoop || isTargetExpanded)\n      );\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // sequence flows\n  if (is(businessObject, \"bpmn:SequenceFlow\")) {\n    return this._createSequenceFlowEntries(\n      element,\n      replaceOptions.SEQUENCE_FLOW\n    );\n  }\n\n  // flow nodes\n  if (is(businessObject, \"bpmn:FlowNode\")) {\n    entries = filter(replaceOptions.TASK, differentType);\n\n    // collapsed SubProcess can not be replaced with itself\n    if (is(businessObject, \"bpmn:Loop\") && !isExpanded(businessObject)) {\n      entries = filter(entries, function (entry) {\n        return entry.label !== \"Sub Process (collapsed)\";\n      });\n    }\n\n    return this._createEntries(element, entries);\n  }\n\n  return [];\n};\n\n/**\n * Get a list of header items for the given element. This includes buttons\n * for multi instance markers and for the ad hoc marker.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getHeaderEntries = function (element) {\n  let headerEntries = [];\n\n  if (is(element, \"bpmn:Activity\") && !isEventLoop(element)) {\n    headerEntries = headerEntries.concat(this._getLoopEntries(element));\n  }\n\n  if (\n    is(element, \"bpmn:Loop\") &&\n    !is(element, \"bpmn:Transaction\") &&\n    !isEventLoop(element)\n  ) {\n    headerEntries.push(this._getAdHocEntry(element));\n  }\n\n  return headerEntries;\n};\n\n/**\n * Creates an array of menu entry objects for a given element and filters the replaceOptions\n * according to a filter function.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function (\n  element,\n  replaceOptions\n) {\n  let menuEntries = [];\n\n  let self = this;\n\n  forEach(replaceOptions, function (definition) {\n    let entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n/**\n * Creates an array of menu entry objects for a given sequence flow.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createSequenceFlowEntries = function (\n  element,\n  replaceOptions\n) {\n  let businessObject = getBusinessObject(element);\n\n  let menuEntries = [];\n\n  let modeling = this._modeling,\n    moddle = this._moddle;\n\n  let self = this;\n\n  forEach(replaceOptions, function (entry) {\n    switch (entry.actionName) {\n      case \"replace-with-default-flow\":\n        if (\n          businessObject.sourceRef.default !== businessObject &&\n          (is(businessObject.sourceRef, \"bpmn:ExclusiveGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:InclusiveGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:ComplexGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:Activity\"))\n        ) {\n          menuEntries.push(\n            self._createMenuEntry(entry, element, function () {\n              modeling.updateProperties(element.source, {\n                default: businessObject,\n              });\n            })\n          );\n        }\n        break;\n      case \"replace-with-conditional-flow\":\n        if (\n          !businessObject.conditionExpression &&\n          is(businessObject.sourceRef, \"bpmn:Activity\")\n        ) {\n          menuEntries.push(\n            self._createMenuEntry(entry, element, function () {\n              let conditionExpression = moddle.create(\"bpmn:FormalExpression\", {\n                body: \"\",\n              });\n\n              modeling.updateProperties(element, {\n                conditionExpression: conditionExpression,\n              });\n            })\n          );\n        }\n        break;\n      default:\n        // default flows\n        if (\n          is(businessObject.sourceRef, \"bpmn:Activity\") &&\n          businessObject.conditionExpression\n        ) {\n          return menuEntries.push(\n            self._createMenuEntry(entry, element, function () {\n              modeling.updateProperties(element, {\n                conditionExpression: undefined,\n              });\n            })\n          );\n        }\n\n        // conditional flows\n        if (\n          (is(businessObject.sourceRef, \"bpmn:ExclusiveGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:InclusiveGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:ComplexGateway\") ||\n            is(businessObject.sourceRef, \"bpmn:Activity\")) &&\n          businessObject.sourceRef.default === businessObject\n        ) {\n          return menuEntries.push(\n            self._createMenuEntry(entry, element, function () {\n              modeling.updateProperties(element.source, { default: undefined });\n            })\n          );\n        }\n    }\n  });\n\n  return menuEntries;\n};\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function (\n  definition,\n  element,\n  action\n) {\n  let translate = this._translate;\n  let replaceElement = this._bpmnReplace.replaceElement;\n\n  let replaceAction = function () {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  let menuEntry = {\n    label: translate(definition.label),\n    className: definition.className,\n    id: definition.actionName,\n    action: action,\n  };\n\n  return menuEntry;\n};\n\n/**\n * Get a list of menu items containing buttons for multi instance markers\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._getLoopEntries = function (element) {\n  let self = this;\n  let translate = this._translate;\n\n  function toggleLoopEntry(event, entry) {\n    let loopCharacteristics;\n\n    if (entry.active) {\n      loopCharacteristics = undefined;\n    } else {\n      loopCharacteristics = self._moddle.create(\n        entry.options.loopCharacteristics\n      );\n\n      if (entry.options.isSequential) {\n        loopCharacteristics.isSequential = entry.options.isSequential;\n      }\n    }\n    self._modeling.updateProperties(element, {\n      loopCharacteristics: loopCharacteristics,\n    });\n  }\n\n  let businessObject = getBusinessObject(element),\n    loopCharacteristics = businessObject.loopCharacteristics;\n\n  let isSequential, isLoop, isParallel;\n\n  if (loopCharacteristics) {\n    isSequential = loopCharacteristics.isSequential;\n    isLoop = loopCharacteristics.isSequential === undefined;\n    isParallel =\n      loopCharacteristics.isSequential !== undefined &&\n      !loopCharacteristics.isSequential;\n  }\n\n  let loopEntries = [\n    {\n      id: \"toggle-parallel-mi\",\n      className: \"bpmn-icon-parallel-mi-marker\",\n      title: translate(\"Parallel Multi Instance\"),\n      active: isParallel,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: \"bpmn:MultiInstanceLoopCharacteristics\",\n        isSequential: false,\n      },\n    },\n    {\n      id: \"toggle-sequential-mi\",\n      className: \"bpmn-icon-sequential-mi-marker\",\n      title: translate(\"Sequential Multi Instance\"),\n      active: isSequential,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: \"bpmn:MultiInstanceLoopCharacteristics\",\n        isSequential: true,\n      },\n    },\n    {\n      id: \"toggle-loop\",\n      className: \"bpmn-icon-loop-marker\",\n      title: translate(\"Loop\"),\n      active: isLoop,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: \"bpmn:StandardLoopCharacteristics\",\n      },\n    },\n  ];\n  return loopEntries;\n};\n\n/**\n * Get the menu items containing a button for the ad hoc marker\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} a menu item\n */\nReplaceMenuProvider.prototype._getAdHocEntry = function (element) {\n  let translate = this._translate;\n  let businessObject = getBusinessObject(element);\n\n  let isAdHoc = is(businessObject, \"bpmn:AdHocSubProcess\");\n\n  let replaceElement = this._bpmnReplace.replaceElement;\n\n  let adHocEntry = {\n    id: \"toggle-adhoc\",\n    className: \"bpmn-icon-ad-hoc-marker\",\n    title: translate(\"Ad-hoc\"),\n    active: isAdHoc,\n    action: function (event, entry) {\n      if (isAdHoc) {\n        return replaceElement(\n          element,\n          { type: \"bpmn:Loop\" },\n          {\n            autoResize: false,\n            layoutConnection: false,\n          }\n        );\n      } else {\n        return replaceElement(\n          element,\n          { type: \"bpmn:AdHocSubProcess\" },\n          {\n            autoResize: false,\n            layoutConnection: false,\n          }\n        );\n      }\n    },\n  };\n\n  return adHocEntry;\n};\n","import PopupMenuModule from \"diagram-js/lib/features/popup-menu\";\nimport ReplaceModule from \"../replace\";\n\nimport ReplaceMenuProvider from \"./ReplaceMenuProvider\";\n\nexport default {\n  __depends__: [PopupMenuModule, ReplaceModule],\n  __init__: [\"replaceMenuProvider\"],\n  replaceMenuProvider: [\"type\", ReplaceMenuProvider],\n};\n","import { is } from \"../../../util/ModelUtil\";\n\nimport { getParent } from \"./ModelingUtil\";\n\nimport { asTRBL } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport {\n  substractTRBL,\n  resizeTRBL,\n} from \"diagram-js/lib/features/resize/ResizeUtil\";\n\nlet abs = Math.abs;\n\nfunction getTRBLResize(oldBounds, newBounds) {\n  return substractTRBL(asTRBL(newBounds), asTRBL(oldBounds));\n}\n\nlet LANE_PARENTS = [\"bpmn:Participant\", \"bpmn:Process-action\", \"bpmn:Loop\"];\n\nexport let LANE_INDENTATION = 30;\n\n/**\n * Collect all lane shapes in the given paren\n *\n * @param  {djs.model.Shape} shape\n * @param  {Array<djs.model.Base>} [collectedShapes]\n *\n * @return {Array<djs.model.Base>}\n */\nexport function collectLanes(shape, collectedShapes) {\n  collectedShapes = collectedShapes || [];\n\n  shape.children.filter(function (s) {\n    if (is(s, \"bpmn:Lane\")) {\n      collectLanes(s, collectedShapes);\n      collectedShapes.push(s);\n      return s;\n    }\n    return s;\n  });\n\n  return collectedShapes;\n}\n\n/**\n * Return the lane children of the given element.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {Array<djs.model.Shape>}\n */\nexport function getChildLanes(shape) {\n  return shape.children.filter(function (c) {\n    return is(c, \"bpmn:Lane\");\n  });\n}\n\n/**\n * Return the root element containing the given lane shape\n *\n * @param {djs.model.Shape} shape\n *\n * @return {djs.model.Shape}\n */\nexport function getLanesRoot(shape) {\n  return getParent(shape, LANE_PARENTS) || shape;\n}\n\n/**\n * Compute the required resize operations for lanes\n * adjacent to the given shape, assuming it will be\n * resized to the given new bounds.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n *\n * @return {Array<Object>}\n */\nexport function computeLanesResize(shape, newBounds) {\n  let rootElement = getLanesRoot(shape);\n\n  let initialShapes = is(rootElement, \"bpmn:Process\") ? [] : [rootElement];\n\n  let allLanes = collectLanes(rootElement, initialShapes),\n    shapeTrbl = asTRBL(shape),\n    shapeNewTrbl = asTRBL(newBounds),\n    trblResize = getTRBLResize(shape, newBounds),\n    resizeNeeded = [];\n\n  allLanes.forEach(function (other) {\n    if (other === shape) {\n      return;\n    }\n\n    let topResize = 0,\n      rightResize = trblResize.right,\n      bottomResize = 0,\n      leftResize = trblResize.left;\n\n    let otherTrbl = asTRBL(other);\n\n    if (trblResize.top) {\n      if (abs(otherTrbl.bottom - shapeTrbl.top) < 10) {\n        bottomResize = shapeNewTrbl.top - otherTrbl.bottom;\n      }\n\n      if (abs(otherTrbl.top - shapeTrbl.top) < 5) {\n        topResize = shapeNewTrbl.top - otherTrbl.top;\n      }\n    }\n\n    if (trblResize.bottom) {\n      if (abs(otherTrbl.top - shapeTrbl.bottom) < 10) {\n        topResize = shapeNewTrbl.bottom - otherTrbl.top;\n      }\n\n      if (abs(otherTrbl.bottom - shapeTrbl.bottom) < 5) {\n        bottomResize = shapeNewTrbl.bottom - otherTrbl.bottom;\n      }\n    }\n\n    if (topResize || rightResize || bottomResize || leftResize) {\n      resizeNeeded.push({\n        shape: other,\n        newBounds: resizeTRBL(other, {\n          top: topResize,\n          right: rightResize,\n          bottom: bottomResize,\n          left: leftResize,\n        }),\n      });\n    }\n  });\n\n  return resizeNeeded;\n}\n","import { assign, forEach, isArray } from \"min-dash\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nimport { isExpanded, isEventLoop } from \"../../util/DiUtil\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\nimport { getChildLanes } from \"../modeling/util/LaneUtil\";\n\nimport { hasPrimaryModifier } from \"diagram-js/lib/util/Mouse\";\n\n/**\n * A provider for BPMN 2.0 elements context pad\n */\nexport default function ContextPadProvider(\n  config,\n  injector,\n  eventBus,\n  contextPad,\n  modeling,\n  elementFactory,\n  connect,\n  create,\n  popupMenu,\n  canvas,\n  rules,\n  translate\n) {\n  config = config || {};\n\n  contextPad.registerProvider(this);\n\n  this._contextPad = contextPad;\n\n  this._modeling = modeling;\n\n  this._elementFactory = elementFactory;\n  this._connect = connect;\n  this._create = create;\n  this._popupMenu = popupMenu;\n  this._canvas = canvas;\n  this._rules = rules;\n  this._translate = translate;\n\n  if (config.autoPlace !== false) {\n    this._autoPlace = injector.get(\"autoPlace\", false);\n  }\n\n  eventBus.on(\"create.end\", 250, function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (!hasPrimaryModifier(event) || !contextPad.isOpen(shape)) {\n      return;\n    }\n\n    let entries = contextPad.getEntries(shape);\n\n    if (entries.replace) {\n      entries.replace.action.click(event, shape);\n    }\n  });\n}\n\nContextPadProvider.$inject = [\n  \"config.contextPad\",\n  \"injector\",\n  \"eventBus\",\n  \"contextPad\",\n  \"modeling\",\n  \"elementFactory\",\n  \"connect\",\n  \"create\",\n  \"popupMenu\",\n  \"canvas\",\n  \"rules\",\n  \"translate\",\n];\n\nContextPadProvider.prototype.getContextPadEntries = function (element) {\n  let contextPad = this._contextPad,\n    modeling = this._modeling,\n    elementFactory = this._elementFactory,\n    connect = this._connect,\n    create = this._create,\n    popupMenu = this._popupMenu,\n    canvas = this._canvas,\n    rules = this._rules,\n    autoPlace = this._autoPlace,\n    translate = this._translate;\n\n  let actions = {};\n\n  if (element.type === \"label\") {\n    return actions;\n  }\n\n  let businessObject = element.businessObject;\n\n  function startConnect(event, element) {\n    connect.start(event, element);\n  }\n\n  function removeElement(e) {\n    modeling.removeElements([element]);\n  }\n\n  function getReplaceMenuPosition(element) {\n    let Y_OFFSET = 5;\n\n    let diagramContainer = canvas.getContainer(),\n      pad = contextPad.getPad(element).html;\n\n    let diagramRect = diagramContainer.getBoundingClientRect(),\n      padRect = pad.getBoundingClientRect();\n\n    let top = padRect.top - diagramRect.top;\n    let left = padRect.left - diagramRect.left;\n\n    let pos = {\n      x: left,\n      y: top + padRect.height + Y_OFFSET,\n    };\n\n    return pos;\n  }\n\n  /**\n   * Create an append action\n   *\n   * @param {String} type\n   * @param {String} className\n   * @param {String} [title]\n   * @param {Object} [options]\n   *\n   * @return {Object} descriptor\n   */\n  function appendAction(type, className, title, options) {\n    if (typeof title !== \"string\") {\n      options = title;\n      title = translate(\"Append {type}\", { type: type.replace(/^bpmn:/, \"\") });\n    }\n\n    function appendStart(event, element) {\n      let shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, {\n        source: element,\n      });\n    }\n\n    let append = autoPlace\n      ? function (event, element) {\n          let shape = elementFactory.createShape(\n            assign({ type: type }, options)\n          );\n\n          autoPlace.append(element, shape);\n        }\n      : appendStart;\n\n    return {\n      group: \"model\",\n      className: className,\n      title: title,\n      action: {\n        dragstart: appendStart,\n        click: append,\n      },\n    };\n  }\n\n  function splitLaneHandler(count) {\n    return function (event, element) {\n      // actual split\n      modeling.splitLane(element, count);\n\n      // refresh context pad after split to\n      // get rid of split icons\n      contextPad.open(element, true);\n    };\n  }\n\n  if (\n    isAny(businessObject, [\"bpmn:Lane\", \"bpmn:Participant\"]) &&\n    isExpanded(businessObject)\n  ) {\n    let childLanes = getChildLanes(element);\n\n    assign(actions, {\n      \"lane-insert-above\": {\n        group: \"lane-insert-above\",\n        className: \"bpmn-icon-lane-insert-above\",\n        title: translate(\"Add Lane above\"),\n        action: {\n          click: function (event, element) {\n            modeling.addLane(element, \"top\");\n          },\n        },\n      },\n    });\n\n    if (childLanes.length < 2) {\n      if (element.height >= 120) {\n        assign(actions, {\n          \"lane-divide-two\": {\n            group: \"lane-divide\",\n            className: \"bpmn-icon-lane-divide-two\",\n            title: translate(\"Divide into two Lanes\"),\n            action: {\n              click: splitLaneHandler(2),\n            },\n          },\n        });\n      }\n\n      if (element.height >= 180) {\n        assign(actions, {\n          \"lane-divide-three\": {\n            group: \"lane-divide\",\n            className: \"bpmn-icon-lane-divide-three\",\n            title: translate(\"Divide into three Lanes\"),\n            action: {\n              click: splitLaneHandler(3),\n            },\n          },\n        });\n      }\n    }\n\n    assign(actions, {\n      \"lane-insert-below\": {\n        group: \"lane-insert-below\",\n        className: \"bpmn-icon-lane-insert-below\",\n        title: translate(\"Add Lane below\"),\n        action: {\n          click: function (event, element) {\n            modeling.addLane(element, \"bottom\");\n          },\n        },\n      },\n    });\n  }\n\n  if (is(businessObject, \"bpmn:FlowNode\")) {\n    if (is(businessObject, \"bpmn:EventBasedGateway\")) {\n      assign(actions, {\n        \"append.receive-task\": appendAction(\n          \"bpmn:ReceiveTask\",\n          \"bpmn-icon-receive-task\",\n          translate(\"Append ReceiveTask\")\n        ),\n        \"append.message-intermediate-event\": appendAction(\n          \"bpmn:IntermediateCatchEvent\",\n          \"bpmn-icon-intermediate-event-catch-message\",\n          translate(\"Append MessageIntermediateCatchEvent\"),\n          { eventDefinitionType: \"bpmn:MessageEventDefinition\" }\n        ),\n        \"append.timer-intermediate-event\": appendAction(\n          \"bpmn:IntermediateCatchEvent\",\n          \"bpmn-icon-intermediate-event-catch-timer\",\n          translate(\"Append TimerIntermediateCatchEvent\"),\n          { eventDefinitionType: \"bpmn:TimerEventDefinition\" }\n        ),\n        \"append.condition-intermediate-event\": appendAction(\n          \"bpmn:IntermediateCatchEvent\",\n          \"bpmn-icon-intermediate-event-catch-condition\",\n          translate(\"Append ConditionIntermediateCatchEvent\"),\n          { eventDefinitionType: \"bpmn:ConditionalEventDefinition\" }\n        ),\n        \"append.signal-intermediate-event\": appendAction(\n          \"bpmn:IntermediateCatchEvent\",\n          \"bpmn-icon-intermediate-event-catch-signal\",\n          translate(\"Append SignalIntermediateCatchEvent\"),\n          { eventDefinitionType: \"bpmn:SignalEventDefinition\" }\n        ),\n      });\n    } else if (\n      isEventType(\n        businessObject,\n        \"bpmn:BoundaryEvent\",\n        \"bpmn:CompensateEventDefinition\"\n      )\n    ) {\n      assign(actions, {\n        \"append.compensation-activity\": appendAction(\n          \"bpmn:Task\",\n          \"bpmn-icon-task\",\n          translate(\"Append compensation activity\"),\n          {\n            isForCompensation: true,\n          }\n        ),\n      });\n    } else if (\n      !is(businessObject, \"bpmn:EndEvent\") &&\n      !businessObject.isForCompensation &&\n      !isEventType(\n        businessObject,\n        \"bpmn:IntermediateThrowEvent\",\n        \"bpmn:LinkEventDefinition\"\n      ) &&\n      !isEventLoop(businessObject)\n    ) {\n      assign(actions, {\n        \"append.end-event\": appendAction(\n          \"bpmn:EndEvent\",\n          \"bpmn-icon-end-event-none\",\n          translate(\"Append EndEvent\")\n        ),\n        \"append.gateway\": appendAction(\n          \"bpmn:ExclusiveGateway\",\n          \"bpmn-icon-gateway-none\",\n          translate(\"Append Gateway\")\n        ),\n        \"append.append-task\": appendAction(\n          \"bpmn:Task\",\n          \"bpmn-icon-task\",\n          translate(\"Append Task\")\n        ),\n        \"append.intermediate-event\": appendAction(\n          \"bpmn:IntermediateThrowEvent\",\n          \"bpmn-icon-intermediate-event-none\",\n          translate(\"Append Intermediate/Boundary Event\")\n        ),\n      });\n    }\n  }\n\n  if (!popupMenu.isEmpty(element, \"bpmn-replace\")) {\n    // Replace menu entry\n    assign(actions, {\n      replace: {\n        group: \"edit\",\n        className: \"bpmn-icon-screw-wrench\",\n        title: translate(\"Change type\"),\n        action: {\n          click: function (event, element) {\n            let position = assign(getReplaceMenuPosition(element), {\n              cursor: { x: event.x, y: event.y },\n            });\n\n            popupMenu.open(element, \"bpmn-replace\", position);\n          },\n        },\n      },\n    });\n  }\n\n  if (\n    isAny(businessObject, [\n      \"bpmn:FlowNode\",\n      \"bpmn:InteractionNode\",\n      \"bpmn:DataObjectReference\",\n      \"bpmn:DataStoreReference\",\n    ])\n  ) {\n    assign(actions, {\n      \"append.text-annotation\": appendAction(\n        \"bpmn:TextAnnotation\",\n        \"bpmn-icon-text-annotation\"\n      ),\n\n      connect: {\n        group: \"connect\",\n        className: \"bpmn-icon-connection-multi\",\n        title: translate(\n          \"Connect using \" +\n            (businessObject.isForCompensation\n              ? \"\"\n              : \"Sequence/MessageFlow or \") +\n            \"Association\"\n        ),\n        action: {\n          click: startConnect,\n          dragstart: startConnect,\n        },\n      },\n    });\n  }\n\n  if (\n    isAny(businessObject, [\n      \"bpmn:DataObjectReference\",\n      \"bpmn:DataStoreReference\",\n    ])\n  ) {\n    assign(actions, {\n      connect: {\n        group: \"connect\",\n        className: \"bpmn-icon-connection-multi\",\n        title: translate(\"Connect using DataInputAssociation\"),\n        action: {\n          click: startConnect,\n          dragstart: startConnect,\n        },\n      },\n    });\n  }\n\n  // delete element entry, only show if allowed by rules\n  let deleteAllowed = rules.allowed(\"elements.delete\", { elements: [element] });\n\n  if (isArray(deleteAllowed)) {\n    // was the element returned as a deletion candidate?\n    deleteAllowed = deleteAllowed[0] === element;\n  }\n\n  if (deleteAllowed) {\n    assign(actions, {\n      delete: {\n        group: \"edit\",\n        className: \"bpmn-icon-trash\",\n        title: translate(\"Remove\"),\n        action: {\n          click: removeElement,\n        },\n      },\n    });\n  }\n\n  return actions;\n};\n\n// helpers /////////\n\nfunction isEventType(eventBo, type, definition) {\n  let isType = eventBo.$instanceOf(type);\n  let isDefinition = false;\n\n  let definitions = eventBo.eventDefinitions || [];\n  forEach(definitions, function (def) {\n    if (def.$type === definition) {\n      isDefinition = true;\n    }\n  });\n\n  return isType && isDefinition;\n}\n","import DirectEditingModule from \"diagram-js-direct-editing\";\nimport ContextPadModule from \"diagram-js/lib/features/context-pad\";\nimport SelectionModule from \"diagram-js/lib/features/selection\";\nimport ConnectModule from \"diagram-js/lib/features/connect\";\nimport CreateModule from \"diagram-js/lib/features/create\";\nimport PopupMenuModule from \"../popup-menu\";\n\nimport ContextPadProvider from \"./ContextPadProvider\";\n\nexport default {\n  __depends__: [\n    DirectEditingModule,\n    ContextPadModule,\n    SelectionModule,\n    ConnectModule,\n    CreateModule,\n    PopupMenuModule,\n  ],\n  __init__: [\"contextPadProvider\"],\n  contextPadProvider: [\"type\", ContextPadProvider],\n};\n","import { filter } from \"min-dash\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\n/**\n * Registers element exclude filters for elements that\n * currently do not support distribution.\n */\nexport default function BpmnDistributeElements(distributeElements) {\n  distributeElements.registerFilter(function (elements) {\n    return filter(elements, function (element) {\n      let cannotDistribute = isAny(element, [\n        \"bpmn:Association\",\n        \"bpmn:BoundaryEvent\",\n        \"bpmn:DataInputAssociation\",\n        \"bpmn:DataOutputAssociation\",\n        \"bpmn:Lane\",\n        \"bpmn:MessageFlow\",\n        \"bpmn:Participant\",\n        \"bpmn:SequenceFlow\",\n        \"bpmn:TextAnnotation\",\n      ]);\n\n      return !(element.labelTarget || cannotDistribute);\n    });\n  });\n}\n\nBpmnDistributeElements.$inject = [\"distributeElements\"];\n","import DistributeElementsModule from \"diagram-js/lib/features/distribute-elements\";\n\nimport BpmnDistributeElements from \"./BpmnDistributeElements\";\n\nexport default {\n  __depends__: [DistributeElementsModule],\n  __init__: [\"bpmnDistributeElements\"],\n  bpmnDistributeElements: [\"type\", BpmnDistributeElements],\n};\n","import inherits from \"inherits\";\n\nimport EditorActions from \"diagram-js/lib/features/editor-actions/EditorActions\";\n\nimport { filter } from \"min-dash\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nimport { getBBox } from \"diagram-js/lib/util/Elements\";\n\n/**\n * Registers and executes BPMN specific editor actions.\n *\n * @param {Injector} injector\n */\nexport default function BpmnEditorActions(injector) {\n  injector.invoke(EditorActions, this);\n}\n\ninherits(BpmnEditorActions, EditorActions);\n\nBpmnEditorActions.$inject = [\"injector\"];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nBpmnEditorActions.prototype._registerDefaultActions = function (injector) {\n  // (0) invoke super method\n\n  EditorActions.prototype._registerDefaultActions.call(this, injector);\n\n  // (1) retrieve optional components to integrate with\n\n  let canvas = injector.get(\"canvas\", false);\n  let elementRegistry = injector.get(\"elementRegistry\", false);\n  let selection = injector.get(\"selection\", false);\n  let spaceTool = injector.get(\"spaceTool\", false);\n  let lassoTool = injector.get(\"lassoTool\", false);\n  let handTool = injector.get(\"handTool\", false);\n  let globalConnect = injector.get(\"globalConnect\", false);\n  let distributeElements = injector.get(\"distributeElements\", false);\n  let alignElements = injector.get(\"alignElements\", false);\n  let directEditing = injector.get(\"directEditing\", false);\n  let searchPad = injector.get(\"searchPad\", false);\n  let modeling = injector.get(\"modeling\", false);\n\n  // (2) check components and register actions\n\n  if (canvas && elementRegistry && selection) {\n    this._registerAction(\"selectElements\", function () {\n      // select all elements except for the invisible\n      // root element\n      let rootElement = canvas.getRootElement();\n\n      let elements = elementRegistry.filter(function (element) {\n        return element !== rootElement;\n      });\n\n      selection.select(elements);\n\n      return elements;\n    });\n  }\n\n  if (spaceTool) {\n    this._registerAction(\"spaceTool\", function () {\n      spaceTool.toggle();\n    });\n  }\n\n  if (lassoTool) {\n    this._registerAction(\"lassoTool\", function () {\n      lassoTool.toggle();\n    });\n  }\n\n  if (handTool) {\n    this._registerAction(\"handTool\", function () {\n      handTool.toggle();\n    });\n  }\n\n  if (globalConnect) {\n    this._registerAction(\"globalConnectTool\", function () {\n      globalConnect.toggle();\n    });\n  }\n\n  if (selection && distributeElements) {\n    this._registerAction(\"distributeElements\", function (opts) {\n      let currentSelection = selection.get(),\n        type = opts.type;\n\n      if (currentSelection.length) {\n        distributeElements.trigger(currentSelection, type);\n      }\n    });\n  }\n\n  if (selection && alignElements) {\n    this._registerAction(\"alignElements\", function (opts) {\n      let currentSelection = selection.get(),\n        aligneableElements = [],\n        type = opts.type;\n\n      if (currentSelection.length) {\n        aligneableElements = filter(currentSelection, function (element) {\n          return !is(element, \"bpmn:Lane\");\n        });\n\n        alignElements.trigger(aligneableElements, type);\n      }\n    });\n  }\n\n  if (selection && modeling) {\n    this._registerAction(\"setColor\", function (opts) {\n      let currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        modeling.setColor(currentSelection, opts);\n      }\n    });\n  }\n\n  if (selection && directEditing) {\n    this._registerAction(\"directEditing\", function () {\n      let currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        directEditing.activate(currentSelection[0]);\n      }\n    });\n  }\n\n  if (searchPad) {\n    this._registerAction(\"find\", function () {\n      searchPad.toggle();\n    });\n  }\n\n  if (canvas && modeling) {\n    this._registerAction(\"moveToOrigin\", function () {\n      let rootElement = canvas.getRootElement(),\n        boundingBox,\n        elements;\n\n      if (is(rootElement, \"bpmn:Collaboration\")) {\n        elements = elementRegistry.filter(function (element) {\n          return is(element.parent, \"bpmn:Collaboration\");\n        });\n      } else {\n        elements = elementRegistry.filter(function (element) {\n          return element !== rootElement && !is(element.parent, \"bpmn:Loop\");\n        });\n      }\n\n      boundingBox = getBBox(elements);\n\n      modeling.moveElements(\n        elements,\n        { x: -boundingBox.x, y: -boundingBox.y },\n        rootElement\n      );\n    });\n  }\n};\n","import EditorActionsModule from \"diagram-js/lib/features/editor-actions\";\n\nimport BpmnEditorActions from \"./BpmnEditorActions\";\n\nexport default {\n  __depends__: [EditorActionsModule],\n  editorActions: [\"type\", BpmnEditorActions],\n};\n","import { isAny } from \"../modeling/util/ModelingUtil\";\n\nexport default function BpmnGridSnapping(eventBus) {\n  eventBus.on([\"create.init\", \"shape.move.init\"], function (event) {\n    let context = event.context,\n      shape = event.shape;\n\n    if (\n      isAny(shape, [\n        \"bpmn:Participant\",\n        \"bpmn:Loop\",\n        \"bpmn:Conditional\",\n        \"bpmn:TextAnnotation\",\n      ])\n    ) {\n      if (!context.gridSnappingContext) {\n        context.gridSnappingContext = {};\n      }\n\n      context.gridSnappingContext.snapLocation = \"top-left\";\n    }\n  });\n}\n\nBpmnGridSnapping.$inject = [\"eventBus\"];\n","import { getNewShapePosition } from \"../../auto-place/AutoPlaceUtil\";\n\nimport { getMid } from \"diagram-js/lib/layout/LayoutUtil\";\nimport { is } from \"../../../util/ModelUtil\";\n\nexport default function AutoPlaceBehavior(eventBus, gridSnapping) {\n  eventBus.on(\"autoPlace\", function (context) {\n    let source = context.source,\n      sourceMid = getMid(source),\n      shape = context.shape;\n\n    let position = getNewShapePosition(source, shape);\n\n    [\"x\", \"y\"].forEach(function (axis) {\n      let options = {};\n\n      // do not snap if x/y equal\n      if (position[axis] === sourceMid[axis]) {\n        return;\n      }\n\n      if (position[axis] > sourceMid[axis]) {\n        options.min = position[axis];\n      } else {\n        options.max = position[axis];\n      }\n\n      if (is(shape, \"bpmn:TextAnnotation\")) {\n        if (isHorizontal(axis)) {\n          options.offset = -shape.width / 2;\n        } else {\n          options.offset = -shape.height / 2;\n        }\n      }\n\n      position[axis] = gridSnapping.snapValue(position[axis], options);\n    });\n\n    // must be returned to be considered by auto place\n    return position;\n  });\n}\n\nAutoPlaceBehavior.$inject = [\"eventBus\", \"gridSnapping\"];\n\n// helpers //////////\n\nfunction isHorizontal(axis) {\n  return axis === \"x\";\n}\n","import { is } from \"../../../util/ModelUtil\";\n\nlet HIGHER_PRIORITY = 1750;\n\nexport default function CreateParticipantBehavior(\n  canvas,\n  eventBus,\n  gridSnapping\n) {\n  eventBus.on(\n    [\"create.start\", \"shape.move.start\"],\n    HIGHER_PRIORITY,\n    function (event) {\n      let context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement();\n\n      if (\n        !is(shape, \"bpmn:Participant\") ||\n        !is(rootElement, \"bpmn:Process-action\") ||\n        !rootElement.children.length\n      ) {\n        return;\n      }\n\n      let createConstraints = context.createConstraints;\n\n      if (!createConstraints) {\n        return;\n      }\n\n      shape.width = gridSnapping.snapValue(shape.width, { min: shape.width });\n      shape.height = gridSnapping.snapValue(shape.height, {\n        min: shape.height,\n      });\n    }\n  );\n}\n\nCreateParticipantBehavior.$inject = [\"canvas\", \"eventBus\", \"gridSnapping\"];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { pointsAligned } from \"diagram-js/lib/util/Geometry\";\n\nimport { assign } from \"min-dash\";\n\nlet HIGH_PRIORITY = 3000;\n\n/**\n * Snaps connections with Manhattan layout.\n */\nexport default function LayoutConnectionBehavior(\n  eventBus,\n  gridSnapping,\n  modeling\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  this._gridSnapping = gridSnapping;\n\n  let self = this;\n\n  this.postExecuted(\n    [\"connection.create\", \"connection.layout\"],\n    HIGH_PRIORITY,\n    function (event) {\n      let context = event.context,\n        connection = context.connection,\n        hints = context.hints || {},\n        waypoints = connection.waypoints;\n\n      if (\n        hints.connectionStart ||\n        hints.connectionEnd ||\n        hints.createElementsBehavior === false\n      ) {\n        return;\n      }\n\n      if (!hasMiddleSegments(waypoints)) {\n        return;\n      }\n\n      modeling.updateWaypoints(connection, self.snapMiddleSegments(waypoints));\n    }\n  );\n}\n\nLayoutConnectionBehavior.$inject = [\"eventBus\", \"gridSnapping\", \"modeling\"];\n\ninherits(LayoutConnectionBehavior, CommandInterceptor);\n\n/**\n * Snap middle segments of a given connection.\n *\n * @param {Array<Point>} waypoints\n *\n * @returns {Array<Point>}\n */\nLayoutConnectionBehavior.prototype.snapMiddleSegments = function (waypoints) {\n  let gridSnapping = this._gridSnapping,\n    snapped;\n\n  waypoints = waypoints.slice();\n\n  for (let i = 1; i < waypoints.length - 2; i++) {\n    snapped = snapSegment(gridSnapping, waypoints[i], waypoints[i + 1]);\n\n    waypoints[i] = snapped[0];\n    waypoints[i + 1] = snapped[1];\n  }\n\n  return waypoints;\n};\n\n// helpers //////////\n\n/**\n * Check whether a connection has a middle segments.\n *\n * @param {Array} waypoints\n *\n * @returns {boolean}\n */\nfunction hasMiddleSegments(waypoints) {\n  return waypoints.length > 3;\n}\n\n/**\n * Check whether an alignment is horizontal.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction horizontallyAligned(aligned) {\n  return aligned === \"h\";\n}\n\n/**\n * Check whether an alignment is vertical.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction verticallyAligned(aligned) {\n  return aligned === \"v\";\n}\n\n/**\n * Get middle segments from a given connection.\n *\n * @param {Array} waypoints\n *\n * @returns {Array}\n */\nfunction snapSegment(gridSnapping, segmentStart, segmentEnd) {\n  let aligned = pointsAligned(segmentStart, segmentEnd);\n\n  let snapped = {};\n\n  if (horizontallyAligned(aligned)) {\n    // snap horizontally\n    snapped.y = gridSnapping.snapValue(segmentStart.y);\n  }\n\n  if (verticallyAligned(aligned)) {\n    // snap vertically\n    snapped.x = gridSnapping.snapValue(segmentStart.x);\n  }\n\n  if (\"x\" in snapped || \"y\" in snapped) {\n    segmentStart = assign({}, segmentStart, snapped);\n    segmentEnd = assign({}, segmentEnd, snapped);\n  }\n\n  return [segmentStart, segmentEnd];\n}\n","import AutoPlaceBehavior from \"./AutoPlaceBehavior\";\nimport CreateParticipantBehavior from \"./CreateParticipantBehavior\";\nimport LayoutConnectionBehavior from \"./LayoutConnectionBehavior\";\n\nexport default {\n  __init__: [\n    \"gridSnappingAutoPlaceBehavior\",\n    \"gridSnappingCreateParticipantBehavior\",\n    \"gridSnappingLayoutConnectionBehavior\",\n  ],\n  gridSnappingAutoPlaceBehavior: [\"type\", AutoPlaceBehavior],\n  gridSnappingCreateParticipantBehavior: [\"type\", CreateParticipantBehavior],\n  gridSnappingLayoutConnectionBehavior: [\"type\", LayoutConnectionBehavior],\n};\n","import BpmnGridSnapping from \"./BpmnGridSnapping\";\nimport GridSnappingModule from \"diagram-js/lib/features/grid-snapping\";\n\nimport GridSnappingBehaviorModule from \"./behavior\";\n\nexport default {\n  __depends__: [GridSnappingModule, GridSnappingBehaviorModule],\n  __init__: [\"bpmnGridSnapping\"],\n  bpmnGridSnapping: [\"type\", BpmnGridSnapping],\n};\n","import { is } from \"../../util/ModelUtil\";\n\nimport { isExpanded } from \"../../util/DiUtil\";\n\nlet LABEL_WIDTH = 30,\n  LABEL_HEIGHT = 30;\n\n/**\n * BPMN-specific hit zones and interaction fixes.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function BpmnInteractionEvents(eventBus, interactionEvents) {\n  this._interactionEvents = interactionEvents;\n\n  let self = this;\n\n  eventBus.on(\n    [\"interactionEvents.createHit\", \"interactionEvents.updateHit\"],\n    function (context) {\n      let element = context.element,\n        gfx = context.gfx;\n\n      if (is(element, \"bpmn:Lane\")) {\n        return self.createParticipantHit(element, gfx);\n      } else if (is(element, \"bpmn:Participant\")) {\n        if (isExpanded(element)) {\n          return self.createParticipantHit(element, gfx);\n        } else {\n          return self.createDefaultHit(element, gfx);\n        }\n      } else if (is(element, \"bpmn:Loop\")) {\n        if (isExpanded(element)) {\n          return self.createLoopHit(element, gfx);\n        } else {\n          return self.createDefaultHit(element, gfx);\n        }\n      } else if (is(element, \"bpmn:Conditional\")) {\n        if (isExpanded(element)) {\n          return self.createLoopHit(element, gfx);\n        } else {\n          return self.createDefaultHit(element, gfx);\n        }\n      }\n    }\n  );\n}\n\nBpmnInteractionEvents.$inject = [\"eventBus\", \"interactionEvents\"];\n\nBpmnInteractionEvents.prototype.createDefaultHit = function (element, gfx) {\n  this._interactionEvents.removeHits(gfx);\n\n  this._interactionEvents.createDefaultHit(element, gfx);\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createParticipantHit = function (element, gfx) {\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, \"click-stroke\", {\n    width: element.width,\n    height: element.height,\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, \"all\", {\n    width: LABEL_WIDTH,\n    height: element.height,\n  });\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createLoopHit = function (element, gfx) {\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, \"click-stroke\", {\n    width: element.width,\n    height: element.height,\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, \"all\", {\n    width: element.width,\n    height: LABEL_HEIGHT,\n  });\n\n  // indicate that we created a hit\n  return true;\n};\n","import BpmnInteractionEvents from \"./BpmnInteractionEvents\";\n\nexport default {\n  __init__: [\"bpmnInteractionEvents\"],\n  bpmnInteractionEvents: [\"type\", BpmnInteractionEvents],\n};\n","import inherits from \"inherits\";\n\nimport KeyboardBindings from \"diagram-js/lib/features/keyboard/KeyboardBindings\";\n\n/**\n * BPMN 2.0 specific keyboard bindings.\n *\n * @param {Injector} injector\n */\nexport default function BpmnKeyboardBindings(injector) {\n  injector.invoke(KeyboardBindings, this);\n}\n\ninherits(BpmnKeyboardBindings, KeyboardBindings);\n\nBpmnKeyboardBindings.$inject = [\"injector\"];\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nBpmnKeyboardBindings.prototype.registerBindings = function (\n  keyboard,\n  editorActions\n) {\n  // inherit default bindings\n  KeyboardBindings.prototype.registerBindings.call(\n    this,\n    keyboard,\n    editorActions\n  );\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n  // select all elements\n  // CTRL + A\n  addListener(\"selectElements\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.isKey([\"a\", \"A\"], event) && keyboard.isCmd(event)) {\n      editorActions.trigger(\"selectElements\");\n\n      return true;\n    }\n  });\n\n  // search labels\n  // CTRL + F\n  addListener(\"find\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.isKey([\"f\", \"F\"], event) && keyboard.isCmd(event)) {\n      editorActions.trigger(\"find\");\n\n      return true;\n    }\n  });\n\n  // activate space tool\n  // S\n  addListener(\"spaceTool\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\"s\", \"S\"], event)) {\n      editorActions.trigger(\"spaceTool\");\n\n      return true;\n    }\n  });\n\n  // activate lasso tool\n  // L\n  addListener(\"lassoTool\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\"l\", \"L\"], event)) {\n      editorActions.trigger(\"lassoTool\");\n\n      return true;\n    }\n  });\n\n  // activate hand tool\n  // H\n  addListener(\"handTool\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\"h\", \"H\"], event)) {\n      editorActions.trigger(\"handTool\");\n\n      return true;\n    }\n  });\n\n  // activate global connect tool\n  // C\n  addListener(\"globalConnectTool\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\"c\", \"C\"], event)) {\n      editorActions.trigger(\"globalConnectTool\");\n\n      return true;\n    }\n  });\n\n  // activate direct editing\n  // E\n  addListener(\"directEditing\", function (context) {\n    let event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey([\"e\", \"E\"], event)) {\n      editorActions.trigger(\"directEditing\");\n\n      return true;\n    }\n  });\n};\n","import KeyboardModule from \"diagram-js/lib/features/keyboard\";\n\nimport BpmnKeyboardBindings from \"./BpmnKeyboardBindings\";\n\nexport default {\n  __depends__: [KeyboardModule],\n  __init__: [\"keyboardBindings\"],\n  keyboardBindings: [\"type\", BpmnKeyboardBindings],\n};\n","import { add as collectionAdd } from \"diagram-js/lib/util/Collections\";\n\nimport { getBusinessObject } from \"../../../../util/ModelUtil\";\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nexport function createCategoryValue(definitions, bpmnFactory) {\n  let categoryValue = bpmnFactory.create(\"bpmn:CategoryValue\"),\n    category = bpmnFactory.create(\"bpmn:Category\", {\n      categoryValue: [categoryValue],\n    });\n\n  // add to correct place\n  collectionAdd(definitions.get(\"rootElements\"), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n}\n","import { assign } from \"min-dash\";\n\nimport { getLabel } from \"./LabelUtil\";\n\nimport { getBusinessObject, is } from \"../../util/ModelUtil\";\n\nimport { createCategoryValue } from \"../modeling/behavior/util/CategoryUtil\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\nimport { isExpanded } from \"../../util/DiUtil\";\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel,\n} from \"../../util/LabelUtil\";\n\nexport default function LabelEditingProvider(\n  eventBus,\n  bpmnFactory,\n  canvas,\n  directEditing,\n  modeling,\n  resizeHandles,\n  textRenderer\n) {\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on(\"element.dblclick\", function (event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on(\n    [\n      \"autoPlace.start\",\n      \"canvas.viewbox.changing\",\n      \"drag.init\",\n      \"element.mousedown\",\n      \"popupMenu.open\",\n    ],\n    function (event) {\n      if (directEditing.isActive()) {\n        directEditing.complete();\n      }\n    }\n  );\n\n  // cancel on command stack changes\n  eventBus.on([\"commandStack.changed\"], function (e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n  eventBus.on(\"directEditing.activate\", function (event) {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on(\"create.end\", 500, function (event) {\n    let context = event.context,\n      element = context.shape,\n      canExecute = event.context.canExecute,\n      isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on(\"autoPlace.end\", 500, function (event) {\n    activateDirectEdit(event.shape);\n  });\n\n  function activateDirectEdit(element, force) {\n    if (\n      force ||\n      isAny(element, [\"bpmn:Task\", \"bpmn:TextAnnotation\", \"bpmn:Group\"]) ||\n      isCollapsedLoop(element)\n    ) {\n      directEditing.activate(element);\n    }\n  }\n}\n\nLabelEditingProvider.$inject = [\n  \"eventBus\",\n  \"bpmnFactory\",\n  \"canvas\",\n  \"directEditing\",\n  \"modeling\",\n  \"resizeHandles\",\n  \"textRenderer\",\n];\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function (element) {\n  // text\n  let text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  let context = {\n    text: text,\n  };\n\n  // bounds\n  let bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  let options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      \"bpmn:Task\",\n      \"bpmn:Participant\",\n      \"bpmn:Lane\",\n      \"bpmn:CallActivity\",\n    ]) ||\n    isCollapsedLoop(element)\n  ) {\n    assign(options, {\n      centerVertically: true,\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true,\n    });\n  }\n\n  // text annotations\n  if (is(element, \"bpmn:TextAnnotation\")) {\n    assign(options, {\n      resizable: true,\n      autoResize: true,\n    });\n  }\n\n  assign(context, {\n    options: options,\n  });\n\n  return context;\n};\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function (element) {\n  let canvas = this._canvas;\n\n  let target = element.label || element;\n\n  let bbox = canvas.getAbsoluteBBox(target);\n\n  let mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2,\n  };\n\n  // default position\n  let bounds = { x: bbox.x, y: bbox.y };\n\n  let zoom = canvas.zoom();\n\n  let defaultStyle = this._textRenderer.getDefaultStyle(),\n    externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  let externalFontSize = externalStyle.fontSize * zoom,\n    externalLineHeight = externalStyle.lineHeight,\n    defaultFontSize = defaultStyle.fontSize * zoom,\n    defaultLineHeight = defaultStyle.lineHeight;\n\n  let style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight,\n  };\n\n  // adjust for expanded pools AND lanes\n  if (is(element, \"bpmn:Lane\") || isExpandedPool(element)) {\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + 15 * zoom,\n      y: mid.y - (30 * zoom) / 2,\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + \"px\",\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + \"px\",\n      paddingBottom: 7 * zoom + \"px\",\n      paddingLeft: 5 * zoom + \"px\",\n      paddingRight: 5 * zoom + \"px\",\n      transform: \"rotate(-90deg)\",\n    });\n  }\n\n  // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n  if (\n    isAny(element, [\"bpmn:Task\", \"bpmn:CallActivity\"]) ||\n    isCollapsedPool(element) ||\n    isCollapsedLoop(element)\n  ) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + \"px\",\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + \"px\",\n      paddingBottom: 7 * zoom + \"px\",\n      paddingLeft: 5 * zoom + \"px\",\n      paddingRight: 5 * zoom + \"px\",\n    });\n  }\n\n  // internal labels for expanded sub processes\n  if (isExpandedLoop(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x,\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + \"px\",\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + \"px\",\n      paddingBottom: 7 * zoom + \"px\",\n      paddingLeft: 5 * zoom + \"px\",\n      paddingRight: 5 * zoom + \"px\",\n    });\n  }\n\n  let width = 90 * zoom,\n    paddingTop = 7 * zoom,\n    paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop,\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + \"px\",\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + \"px\",\n      paddingBottom: paddingBottom + \"px\",\n    });\n  }\n\n  // external label not yet created\n  if (\n    isLabelExternal(target) &&\n    !hasExternalLabel(target) &&\n    !isLabel(target)\n  ) {\n    let externalLabelMid = getExternalLabelMid(element);\n\n    let absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0,\n    });\n\n    let height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2,\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + \"px\",\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + \"px\",\n      paddingBottom: paddingBottom + \"px\",\n    });\n  }\n\n  // text annotations\n  if (is(element, \"bpmn:TextAnnotation\")) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom,\n    });\n\n    assign(style, {\n      textAlign: \"left\",\n      paddingTop: 5 * zoom + \"px\",\n      paddingBottom: 7 * zoom + \"px\",\n      paddingLeft: 7 * zoom + \"px\",\n      paddingRight: 5 * zoom + \"px\",\n      fontSize: defaultFontSize + \"px\",\n      lineHeight: defaultLineHeight,\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\nLabelEditingProvider.prototype.update = function (\n  element,\n  newLabel,\n  activeContextText,\n  bounds\n) {\n  let newBounds, bbox;\n\n  if (is(element, \"bpmn:TextAnnotation\")) {\n    bbox = this._canvas.getAbsoluteBBox(element);\n\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: (element.width / bbox.width) * bounds.width,\n      height: (element.height / bbox.height) * bounds.height,\n    };\n  }\n\n  if (is(element, \"bpmn:Group\")) {\n    let businessObject = getBusinessObject(element);\n\n    // initialize categoryValue if not existing\n    if (!businessObject.categoryValueRef) {\n      let rootElement = this._canvas.getRootElement(),\n        definitions = getBusinessObject(rootElement).$parent;\n\n      let categoryValue = createCategoryValue(definitions, this._bpmnFactory);\n\n      getBusinessObject(element).categoryValueRef = categoryValue;\n    }\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n// helpers //////////////////////\n\nfunction isCollapsedLoop(element) {\n  return (\n    (is(element, \"bpmn:Loop\") && !isExpanded(element)) ||\n    (is(element, \"bpmn:Conditional\") && !isExpanded(element))\n  );\n}\n\nfunction isExpandedLoop(element) {\n  return (\n    (is(element, \"bpmn:Loop\") && isExpanded(element)) ||\n    (is(element, \"bpmn:Conditional\") && isExpanded(element))\n  );\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, \"bpmn:Participant\") && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, \"bpmn:Participant\") && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove,\n} from \"tiny-svg\";\n\nimport { getBusinessObject, is } from \"../../util/ModelUtil\";\n\nimport { translate } from \"diagram-js/lib/util/SvgTransformUtil\";\n\nlet MARKER_HIDDEN = \"djs-element-hidden\",\n  MARKER_LABEL_HIDDEN = \"djs-label-hidden\";\n\nexport default function LabelEditingPreview(\n  eventBus,\n  canvas,\n  elementRegistry,\n  pathMap\n) {\n  let self = this;\n\n  let defaultLayer = canvas.getDefaultLayer();\n\n  let element, absoluteElementBBox, gfx;\n\n  eventBus.on(\"directEditing.activate\", function (context) {\n    let activeProvider = context.active;\n\n    element = activeProvider.element.label || activeProvider.element;\n\n    // text annotation\n    if (is(element, \"bpmn:TextAnnotation\")) {\n      absoluteElementBBox = canvas.getAbsoluteBBox(element);\n\n      gfx = svgCreate(\"g\");\n\n      let textPathData = pathMap.getScaledPath(\"TEXT_ANNOTATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0,\n        },\n      });\n\n      let path = (self.path = svgCreate(\"path\"));\n\n      svgAttr(path, {\n        d: textPathData,\n        strokeWidth: 2,\n        stroke: getStrokeColor(element),\n      });\n\n      svgAppend(gfx, path);\n\n      svgAppend(defaultLayer, gfx);\n\n      translate(gfx, element.x, element.y);\n    }\n\n    if (is(element, \"bpmn:TextAnnotation\") || element.labelTarget) {\n      canvas.addMarker(element, MARKER_HIDDEN);\n    } else if (\n      is(element, \"bpmn:Task\") ||\n      is(element, \"bpmn:CallActivity\") ||\n      is(element, \"bpmn:Loop\") ||\n      is(element, \"bpmn:Conditional\") ||\n      is(element, \"bpmn:Participant\")\n    ) {\n      canvas.addMarker(element, MARKER_LABEL_HIDDEN);\n    }\n  });\n\n  eventBus.on(\"directEditing.resize\", function (context) {\n    // text annotation\n    if (is(element, \"bpmn:TextAnnotation\")) {\n      let height = context.height,\n        dy = context.dy;\n\n      let newElementHeight = Math.max(\n        (element.height / absoluteElementBBox.height) * (height + dy),\n        0\n      );\n\n      let textPathData = pathMap.getScaledPath(\"TEXT_ANNOTATION\", {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: newElementHeight,\n        position: {\n          mx: 0.0,\n          my: 0.0,\n        },\n      });\n\n      svgAttr(self.path, {\n        d: textPathData,\n      });\n    }\n  });\n\n  eventBus.on(\n    [\"directEditing.complete\", \"directEditing.cancel\"],\n    function (context) {\n      let activeProvider = context.active;\n\n      if (activeProvider) {\n        canvas.removeMarker(\n          activeProvider.element.label || activeProvider.element,\n          MARKER_HIDDEN\n        );\n        canvas.removeMarker(element, MARKER_LABEL_HIDDEN);\n      }\n\n      element = undefined;\n      absoluteElementBBox = undefined;\n\n      if (gfx) {\n        svgRemove(gfx);\n\n        gfx = undefined;\n      }\n    }\n  );\n}\n\nLabelEditingPreview.$inject = [\n  \"eventBus\",\n  \"canvas\",\n  \"elementRegistry\",\n  \"pathMap\",\n];\n\n// helpers ///////////////////\n\nfunction getStrokeColor(element, defaultColor) {\n  let bo = getBusinessObject(element);\n\n  return bo.di.get(\"stroke\") || defaultColor || \"black\";\n}\n","import ChangeSupportModule from \"diagram-js/lib/features/change-support\";\nimport ResizeModule from \"diagram-js/lib/features/resize\";\nimport DirectEditingModule from \"diagram-js-direct-editing\";\n\nimport LabelEditingProvider from \"./LabelEditingProvider\";\nimport LabelEditingPreview from \"./LabelEditingPreview\";\n\nexport default {\n  __depends__: [ChangeSupportModule, ResizeModule, DirectEditingModule],\n  __init__: [\"labelEditingProvider\", \"labelEditingPreview\"],\n  labelEditingProvider: [\"type\", LabelEditingProvider],\n  labelEditingPreview: [\"type\", LabelEditingPreview],\n};\n","import inherits from \"inherits\";\n\nimport {\n  getOrientation,\n  getMid,\n  asTRBL,\n} from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { substract } from \"diagram-js/lib/util/Math\";\n\nimport { hasExternalLabel } from \"../../../util/LabelUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nlet ALIGNMENTS = [\"top\", \"bottom\", \"left\", \"right\"];\n\nlet ELEMENT_LABEL_DISTANCE = 10;\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AdaptiveLabelPositioningBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.postExecuted(\n    [\"connection.create\", \"connection.layout\", \"connection.updateWaypoints\"],\n    function (event) {\n      let context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hints = context.hints || {};\n\n      if (hints.createElementsBehavior !== false) {\n        checkLabelAdjustment(source);\n        checkLabelAdjustment(target);\n      }\n    }\n  );\n\n  this.postExecuted([\"label.create\"], function (event) {\n    let context = event.context,\n      shape = context.shape,\n      hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(shape.labelTarget);\n    }\n  });\n\n  this.postExecuted([\"elements.create\"], function (event) {\n    let context = event.context,\n      elements = context.elements,\n      hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      elements.forEach(function (element) {\n        checkLabelAdjustment(element);\n      });\n    }\n  });\n\n  function checkLabelAdjustment(element) {\n    // skip non-existing labels\n    if (!hasExternalLabel(element)) {\n      return;\n    }\n\n    let optimalPosition = getOptimalPosition(element);\n\n    // no optimal position found\n    if (!optimalPosition) {\n      return;\n    }\n\n    adjustLabelPosition(element, optimalPosition);\n  }\n\n  function adjustLabelPosition(element, orientation) {\n    let elementMid = getMid(element),\n      label = element.label,\n      labelMid = getMid(label);\n\n    // ignore labels that are being created\n    if (!label.parent) {\n      return;\n    }\n\n    let elementTrbl = asTRBL(element);\n\n    let newLabelMid;\n\n    switch (orientation) {\n      case \"top\":\n        newLabelMid = {\n          x: elementMid.x,\n          y: elementTrbl.top - ELEMENT_LABEL_DISTANCE - label.height / 2,\n        };\n\n        break;\n\n      case \"left\":\n        newLabelMid = {\n          x: elementTrbl.left - ELEMENT_LABEL_DISTANCE - label.width / 2,\n          y: elementMid.y,\n        };\n\n        break;\n\n      case \"bottom\":\n        newLabelMid = {\n          x: elementMid.x,\n          y: elementTrbl.bottom + ELEMENT_LABEL_DISTANCE + label.height / 2,\n        };\n\n        break;\n\n      case \"right\":\n        newLabelMid = {\n          x: elementTrbl.right + ELEMENT_LABEL_DISTANCE + label.width / 2,\n          y: elementMid.y,\n        };\n\n        break;\n      default:\n        break;\n    }\n\n    let delta = substract(newLabelMid, labelMid);\n\n    modeling.moveShape(label, delta);\n  }\n}\n\ninherits(AdaptiveLabelPositioningBehavior, CommandInterceptor);\n\nAdaptiveLabelPositioningBehavior.$inject = [\"eventBus\", \"modeling\"];\n\n// helpers //////////////////////\n\n/**\n * Return alignments which are taken by a boundary's host element\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenHostAlignments(element) {\n  let hostElement = element.host,\n    elementMid = getMid(element),\n    hostOrientation = getOrientation(elementMid, hostElement);\n\n  let freeAlignments;\n\n  // check whether there is a multi-orientation, e.g. 'top-left'\n  if (hostOrientation.indexOf(\"-\") >= 0) {\n    freeAlignments = hostOrientation.split(\"-\");\n  } else {\n    freeAlignments = [hostOrientation];\n  }\n\n  let takenAlignments = ALIGNMENTS.filter(function (alignment) {\n    return freeAlignments.indexOf(alignment) === -1;\n  });\n\n  return takenAlignments;\n}\n\n/**\n * Return alignments which are taken by related connections\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenConnectionAlignments(element) {\n  let elementMid = getMid(element);\n\n  let takenAlignments = []\n    .concat(\n      element.incoming.map(function (c) {\n        return c.waypoints[c.waypoints.length - 2];\n      }),\n      element.outgoing.map(function (c) {\n        return c.waypoints[1];\n      })\n    )\n    .map(function (point) {\n      return getApproximateOrientation(elementMid, point);\n    });\n\n  return takenAlignments;\n}\n\n/**\n * Return the optimal label position around an element\n * or _undefined_, if none was found.\n *\n * @param  {Shape} element\n *\n * @return {String} positioning identifier\n */\nfunction getOptimalPosition(element) {\n  let labelMid = getMid(element.label);\n\n  let elementMid = getMid(element);\n\n  let labelOrientation = getApproximateOrientation(elementMid, labelMid);\n\n  if (!isAligned(labelOrientation)) {\n    return;\n  }\n\n  let takenAlignments = getTakenConnectionAlignments(element);\n\n  if (element.host) {\n    let takenHostAlignments = getTakenHostAlignments(element);\n\n    takenAlignments = takenAlignments.concat(takenHostAlignments);\n  }\n\n  let freeAlignments = ALIGNMENTS.filter(function (alignment) {\n    return takenAlignments.indexOf(alignment) === -1;\n  });\n\n  // NOTHING TO DO; label already aligned a.O.K.\n  if (freeAlignments.indexOf(labelOrientation) !== -1) {\n    return;\n  }\n\n  return freeAlignments[0];\n}\n\nfunction getApproximateOrientation(p0, p1) {\n  return getOrientation(p1, p0, 5);\n}\n\nfunction isAligned(orientation) {\n  return ALIGNMENTS.indexOf(orientation) !== -1;\n}\n","import inherits from \"inherits\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nexport default function AppendBehavior(eventBus, elementFactory, bpmnRules) {\n  CommandInterceptor.call(this, eventBus);\n\n  // assign correct shape position unless already set\n\n  this.preExecute(\n    \"shape.append\",\n    function (context) {\n      let source = context.source,\n        shape = context.shape;\n\n      if (!context.position) {\n        if (is(shape, \"bpmn:TextAnnotation\")) {\n          context.position = {\n            x: source.x + source.width / 2 + 75,\n            y: source.y - 50 - shape.height / 2,\n          };\n        } else {\n          context.position = {\n            x: source.x + source.width + 80 + shape.width / 2,\n            y: source.y + source.height / 2,\n          };\n        }\n      }\n    },\n    true\n  );\n}\n\ninherits(AppendBehavior, CommandInterceptor);\n\nAppendBehavior.$inject = [\"eventBus\", \"elementFactory\", \"bpmnRules\"];\n","import inherits from \"inherits\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { filter, forEach } from \"min-dash\";\n\nexport default function AssociationBehavior(injector, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.postExecute(\n    \"shape.move\",\n    function (context) {\n      let newParent = context.newParent,\n        shape = context.shape;\n\n      let associations = filter(\n        shape.incoming.concat(shape.outgoing),\n        function (connection) {\n          return is(connection, \"bpmn:Association\");\n        }\n      );\n\n      forEach(associations, function (association) {\n        modeling.moveConnection(association, { x: 0, y: 0 }, newParent);\n      });\n    },\n    true\n  );\n}\n\ninherits(AssociationBehavior, CommandInterceptor);\n\nAssociationBehavior.$inject = [\"injector\", \"modeling\"];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getBusinessObject } from \"../../../util/ModelUtil\";\n\nimport { isAny } from \"../util/ModelingUtil\";\n\nimport { isLabel } from \"../../../util/LabelUtil\";\n\nlet LOW_PRIORITY = 500;\n\n/**\n * Replace intermediate event with boundary event when creating or moving results in attached event.\n */\nexport default function AttachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  let self = this;\n\n  this.postExecuted(\n    \"elements.create\",\n    LOW_PRIORITY,\n    function (context) {\n      let elements = context.elements;\n\n      elements = elements.filter(function (shape) {\n        let host = shape.host;\n\n        return shouldReplace(shape, host);\n      });\n\n      if (elements.length !== 1) {\n        return;\n      }\n\n      elements\n        .map(function (element) {\n          return elements.indexOf(element);\n        })\n        .forEach(function (index) {\n          let host = elements[index];\n\n          context.elements[index] = self.replaceShape(elements[index], host);\n        });\n    },\n    true\n  );\n\n  this.preExecute(\n    \"elements.move\",\n    LOW_PRIORITY,\n    function (context) {\n      let shapes = context.shapes,\n        host = context.newHost;\n\n      if (shapes.length !== 1) {\n        return;\n      }\n\n      let shape = shapes[0];\n\n      if (shouldReplace(shape, host)) {\n        context.shapes = [self.replaceShape(shape, host)];\n      }\n    },\n    true\n  );\n}\n\nAttachEventBehavior.$inject = [\"bpmnReplace\", \"injector\"];\n\ninherits(AttachEventBehavior, CommandInterceptor);\n\nAttachEventBehavior.prototype.replaceShape = function (shape, host) {\n  let eventDefinition = getEventDefinition(shape);\n\n  let boundaryEvent = {\n    type: \"bpmn:BoundaryEvent\",\n    host: host,\n  };\n\n  if (eventDefinition) {\n    boundaryEvent.eventDefinitionType = eventDefinition.$type;\n  }\n\n  return this._bpmnReplace.replaceElement(shape, boundaryEvent, {\n    layoutConnection: false,\n  });\n};\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  let businessObject = getBusinessObject(element),\n    eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return (\n    !isLabel(shape) &&\n    isAny(shape, [\n      \"bpmn:IntermediateThrowEvent\",\n      \"bpmn:IntermediateCatchEvent\",\n    ]) &&\n    !!host\n  );\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { filter, forEach } from \"min-dash\";\n\n/**\n * BPMN specific boundary event behavior\n */\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function (attacher) {\n      return is(attacher, \"bpmn:BoundaryEvent\");\n    });\n  }\n\n  // remove after connecting to event-based gateway\n  this.postExecute(\"connection.create\", function (event) {\n    let source = event.context.source,\n      target = event.context.target,\n      boundaryEvents = getBoundaryEvents(target);\n\n    if (\n      is(source, \"bpmn:EventBasedGateway\") &&\n      is(target, \"bpmn:ReceiveTask\") &&\n      boundaryEvents.length > 0\n    ) {\n      modeling.removeElements(boundaryEvents);\n    }\n  });\n\n  // remove after replacing connected gateway with event-based gateway\n  this.postExecute(\"connection.reconnect\", function (event) {\n    let oldSource = event.context.oldSource,\n      newSource = event.context.newSource;\n\n    if (\n      is(oldSource, \"bpmn:Gateway\") &&\n      is(newSource, \"bpmn:EventBasedGateway\")\n    ) {\n      forEach(newSource.outgoing, function (connection) {\n        let target = connection.target,\n          attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (\n          is(target, \"bpmn:ReceiveTask\") &&\n          attachedboundaryEvents.length > 0\n        ) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n}\n\nBoundaryEventBehavior.$inject = [\"eventBus\", \"modeling\"];\n\ninherits(BoundaryEventBehavior, CommandInterceptor);\n","import inherits from \"inherits\";\n\nimport { find, isArray, matchPattern, some } from \"min-dash\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove,\n} from \"diagram-js/lib/util/Collections\";\n\nimport { getBusinessObject, is } from \"../../../util/ModelUtil\";\n\nimport { isAny } from \"../util/ModelingUtil\";\n\nimport { hasEventDefinition } from \"../../../util/DiUtil\";\n\nconst LOW_PRIORITY = 500;\n\n/**\n * Add referenced root elements (error, escalation, message, signal) if they don't exist.\n * Copy referenced root elements on copy & paste.\n */\nexport default function RootElementReferenceBehavior(\n  bpmnjs,\n  eventBus,\n  injector,\n  moddleCopy,\n  bpmnFactory\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  function canHaveRootElementReference(element) {\n    return (\n      isAny(element, [\"bpmn:ReceiveTask\", \"bpmn:SendTask\"]) ||\n      hasAnyEventDefinition(element, [\n        \"bpmn:ErrorEventDefinition\",\n        \"bpmn:EscalationEventDefinition\",\n        \"bpmn:MessageEventDefinition\",\n        \"bpmn:SignalEventDefinition\",\n      ])\n    );\n  }\n\n  function hasRootElement(rootElement) {\n    let definitions = bpmnjs.getDefinitions(),\n      rootElements = definitions.get(\"rootElements\");\n\n    return !!find(rootElements, matchPattern({ id: rootElement.id }));\n  }\n\n  function getRootElementReferencePropertyName(eventDefinition) {\n    if (is(eventDefinition, \"bpmn:ErrorEventDefinition\")) {\n      return \"errorRef\";\n    } else if (is(eventDefinition, \"bpmn:EscalationEventDefinition\")) {\n      return \"escalationRef\";\n    } else if (is(eventDefinition, \"bpmn:MessageEventDefinition\")) {\n      return \"messageRef\";\n    } else if (is(eventDefinition, \"bpmn:SignalEventDefinition\")) {\n      return \"signalRef\";\n    }\n  }\n\n  function getRootElement(businessObject) {\n    if (isAny(businessObject, [\"bpmn:ReceiveTask\", \"bpmn:SendTask\"])) {\n      return businessObject.get(\"messageRef\");\n    }\n\n    let eventDefinitions = businessObject.get(\"eventDefinitions\"),\n      eventDefinition = eventDefinitions[0];\n\n    return eventDefinition.get(\n      getRootElementReferencePropertyName(eventDefinition)\n    );\n  }\n\n  function setRootElement(businessObject, rootElement) {\n    if (isAny(businessObject, [\"bpmn:ReceiveTask\", \"bpmn:SendTask\"])) {\n      return businessObject.set(\"messageRef\", rootElement);\n    }\n\n    let eventDefinitions = businessObject.get(\"eventDefinitions\"),\n      eventDefinition = eventDefinitions[0];\n\n    return eventDefinition.set(\n      getRootElementReferencePropertyName(eventDefinition),\n      rootElement\n    );\n  }\n\n  // create shape\n  this.executed(\n    \"shape.create\",\n    function (context) {\n      let shape = context.shape;\n\n      if (!canHaveRootElementReference(shape)) {\n        return;\n      }\n\n      let businessObject = getBusinessObject(shape),\n        rootElement = getRootElement(businessObject),\n        rootElements;\n\n      if (rootElement && !hasRootElement(rootElement)) {\n        rootElements = bpmnjs.getDefinitions().get(\"rootElements\");\n\n        // add root element\n        collectionAdd(rootElements, rootElement);\n\n        context.addedRootElement = rootElement;\n      }\n    },\n    true\n  );\n\n  this.reverted(\n    \"shape.create\",\n    function (context) {\n      let addedRootElement = context.addedRootElement;\n\n      if (!addedRootElement) {\n        return;\n      }\n\n      let rootElements = bpmnjs.getDefinitions().get(\"rootElements\");\n\n      // remove root element\n      collectionRemove(rootElements, addedRootElement);\n    },\n    true\n  );\n\n  eventBus.on(\"copyPaste.copyElement\", function (context) {\n    let descriptor = context.descriptor,\n      element = context.element;\n\n    if (!canHaveRootElementReference(element)) {\n      return;\n    }\n\n    let businessObject = getBusinessObject(element),\n      rootElement = getRootElement(businessObject);\n\n    if (rootElement) {\n      descriptor.referencedRootElement = rootElement;\n    }\n  });\n\n  eventBus.on(\"copyPaste.pasteElement\", LOW_PRIORITY, function (context) {\n    let descriptor = context.descriptor,\n      businessObject = descriptor.businessObject;\n\n    if (!canHaveRootElementReference(businessObject)) {\n      return;\n    }\n\n    let referencedRootElement = descriptor.referencedRootElement;\n\n    if (!referencedRootElement) {\n      return;\n    }\n\n    if (!hasRootElement(referencedRootElement)) {\n      referencedRootElement = moddleCopy.copyElement(\n        referencedRootElement,\n        bpmnFactory.create(referencedRootElement.$type)\n      );\n    }\n\n    setRootElement(businessObject, referencedRootElement);\n  });\n}\n\nRootElementReferenceBehavior.$inject = [\n  \"bpmnjs\",\n  \"eventBus\",\n  \"injector\",\n  \"moddleCopy\",\n  \"bpmnFactory\",\n];\n\ninherits(RootElementReferenceBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction hasAnyEventDefinition(element, types) {\n  if (!isArray(types)) {\n    types = [types];\n  }\n\n  return some(types, function (type) {\n    return hasEventDefinition(element, type);\n  });\n}\n","import inherits from \"inherits\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getParent } from \"../util/ModelingUtil\";\n\nexport default function CreateBehavior(injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute(\"shape.create\", 1500, function (event) {\n    let context = event.context,\n      parent = context.parent,\n      shape = context.shape;\n\n    if (is(parent, \"bpmn:Lane\") && !is(shape, \"bpmn:Lane\")) {\n      context.parent = getParent(parent, \"bpmn:Participant\");\n    }\n  });\n}\n\nCreateBehavior.$inject = [\"injector\"];\n\ninherits(CreateBehavior, CommandInterceptor);\n","import { getLanesRoot } from \"../util/LaneUtil\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { isAny } from \"../util/ModelingUtil\";\n\nlet HIGH_PRIORITY = 1500;\nlet HIGHEST_PRIORITY = 2000;\n\n/**\n * Correct hover targets in certain situations to improve diagram interaction.\n *\n * @param {ElementRegistry} elementRegistry\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\n  eventBus.on(\n    [\n      \"create.hover\",\n      \"create.move\",\n      \"create.end\",\n      \"shape.move.hover\",\n      \"shape.move.move\",\n      \"shape.move.end\",\n    ],\n    HIGH_PRIORITY,\n    function (event) {\n      let context = event.context,\n        shape = context.shape || event.shape,\n        hover = event.hover;\n\n      // ensure elements are not dropped onto a bpmn:Lane but onto\n      // the underlying bpmn:Participant\n      if (\n        is(hover, \"bpmn:Lane\") &&\n        !isAny(shape, [\"bpmn:Lane\", \"bpmn:Participant\"])\n      ) {\n        event.hover = getLanesRoot(hover);\n        event.hoverGfx = elementRegistry.getGraphics(event.hover);\n      }\n\n      let rootElement = canvas.getRootElement();\n\n      // ensure bpmn:Group and label elements are dropped\n      // always onto the root\n      if (\n        hover !== rootElement &&\n        (shape.labelTarget || is(shape, \"bpmn:Group\"))\n      ) {\n        event.hover = rootElement;\n        event.hoverGfx = elementRegistry.getGraphics(event.hover);\n      }\n    }\n  );\n\n  eventBus.on(\n    [\n      \"connect.hover\",\n      \"connect.out\",\n      \"connect.end\",\n      \"connect.cleanup\",\n      \"global-connect.hover\",\n      \"global-connect.out\",\n      \"global-connect.end\",\n      \"global-connect.cleanup\",\n    ],\n    HIGH_PRIORITY,\n    function (event) {\n      let hover = event.hover;\n\n      // ensure connections start/end on bpmn:Participant,\n      // not the underlying bpmn:Lane\n      if (is(hover, \"bpmn:Lane\")) {\n        event.hover = getLanesRoot(hover) || hover;\n        event.hoverGfx = elementRegistry.getGraphics(event.hover);\n      }\n    }\n  );\n\n  eventBus.on([\"bendpoint.move.hover\"], HIGH_PRIORITY, function (event) {\n    let context = event.context,\n      hover = event.hover,\n      type = context.type;\n\n    // ensure reconnect start/end on bpmn:Participant,\n    // not the underlying bpmn:Lane\n    if (is(hover, \"bpmn:Lane\") && /reconnect/.test(type)) {\n      event.hover = getLanesRoot(hover) || hover;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n\n  eventBus.on([\"connect.start\"], HIGH_PRIORITY, function (event) {\n    let context = event.context,\n      start = context.start;\n\n    // ensure connect start on bpmn:Participant,\n    // not the underlying bpmn:Lane\n    if (is(start, \"bpmn:Lane\")) {\n      context.start = getLanesRoot(start) || start;\n    }\n  });\n\n  // allow movement of participants from lanes\n  eventBus.on(\"shape.move.start\", HIGHEST_PRIORITY, function (event) {\n    let shape = event.shape;\n\n    if (is(shape, \"bpmn:Lane\")) {\n      event.shape = getLanesRoot(shape) || shape;\n    }\n  });\n}\n\nFixHoverBehavior.$inject = [\"elementRegistry\", \"eventBus\", \"canvas\"];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\n/**\n * BPMN specific create data object behavior\n */\nexport default function CreateDataObjectBehavior(\n  eventBus,\n  bpmnFactory,\n  moddle\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute(\"shape.create\", function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:DataObjectReference\") && shape.type !== \"label\") {\n      // create a DataObject every time a DataObjectReference is created\n      let dataObject = bpmnFactory.create(\"bpmn:DataObject\");\n\n      // set the reference to the DataObject\n      shape.businessObject.dataObjectRef = dataObject;\n    }\n  });\n}\n\nCreateDataObjectBehavior.$inject = [\"eventBus\", \"bpmnFactory\", \"moddle\"];\n\ninherits(CreateDataObjectBehavior, CommandInterceptor);\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { isLabel } from \"../../../util/LabelUtil\";\n\nimport { getBBox } from \"diagram-js/lib/util/Elements\";\n\nimport { assign, find } from \"min-dash\";\n\nimport { asTRBL } from \"diagram-js/lib/layout/LayoutUtil\";\n\nlet HORIZONTAL_PARTICIPANT_PADDING = 20,\n  VERTICAL_PARTICIPANT_PADDING = 20;\n\nexport let PARTICIPANT_BORDER_WIDTH = 30;\n\nlet HIGH_PRIORITY = 2000;\n\n/**\n * BPMN-specific behavior for creating participants.\n */\nexport default function CreateParticipantBehavior(canvas, eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  // fit participant\n  eventBus.on(\n    [\"create.start\", \"shape.move.start\"],\n    HIGH_PRIORITY,\n    function (event) {\n      let context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement();\n\n      if (\n        !is(shape, \"bpmn:Participant\") ||\n        !is(rootElement, \"bpmn:Process-action\") ||\n        !rootElement.children.length\n      ) {\n        return;\n      }\n\n      // ignore connections, groups and labels\n      let children = rootElement.children.filter(function (element) {\n        return (\n          !is(element, \"bpmn:Group\") &&\n          !isLabel(element) &&\n          !isConnection(element)\n        );\n      });\n\n      // ensure for available children to calculate bounds\n      if (!children.length) {\n        return;\n      }\n\n      let childrenBBox = getBBox(children);\n\n      let participantBounds = getParticipantBounds(shape, childrenBBox);\n\n      // assign width and height\n      assign(shape, participantBounds);\n\n      // assign create constraints\n      context.createConstraints = getParticipantCreateConstraints(\n        shape,\n        childrenBBox\n      );\n    }\n  );\n\n  // force hovering process when creating first participant\n  eventBus.on(\"create.start\", HIGH_PRIORITY, function (event) {\n    let context = event.context,\n      shape = context.shape,\n      rootElement = canvas.getRootElement(),\n      rootElementGfx = canvas.getGraphics(rootElement);\n\n    function ensureHoveringProcess(event) {\n      event.element = rootElement;\n      event.gfx = rootElementGfx;\n    }\n\n    if (\n      is(shape, \"bpmn:Participant\") &&\n      is(rootElement, \"bpmn:Process-action\")\n    ) {\n      eventBus.on(\"element.hover\", HIGH_PRIORITY, ensureHoveringProcess);\n\n      eventBus.once(\"create.cleanup\", function () {\n        eventBus.off(\"element.hover\", ensureHoveringProcess);\n      });\n    }\n  });\n\n  function ensureCollaboration(context) {\n    let parent = context.parent,\n      collaboration;\n\n    let rootElement = canvas.getRootElement();\n\n    if (is(rootElement, \"bpmn:Collaboration\")) {\n      collaboration = rootElement;\n    } else {\n      // update root element by making collaboration\n      collaboration = modeling.makeCollaboration();\n\n      // re-use process when creating first participant\n      context.process = parent;\n    }\n\n    context.parent = collaboration;\n  }\n\n  // turn process into collaboration before adding participant\n  this.preExecute(\n    \"shape.create\",\n    function (context) {\n      let parent = context.parent,\n        shape = context.shape;\n\n      if (is(shape, \"bpmn:Participant\") && is(parent, \"bpmn:Process-action\")) {\n        ensureCollaboration(context);\n      }\n    },\n    true\n  );\n\n  this.execute(\n    \"shape.create\",\n    function (context) {\n      let process = context.process,\n        shape = context.shape;\n\n      if (process) {\n        context.oldProcessRef = shape.businessObject.processRef;\n\n        // re-use process when creating first participant\n        shape.businessObject.processRef = process.businessObject;\n      }\n    },\n    true\n  );\n\n  this.revert(\n    \"shape.create\",\n    function (context) {\n      let process = context.process,\n        shape = context.shape;\n\n      if (process) {\n        // re-use process when creating first participant\n        shape.businessObject.processRef = context.oldProcessRef;\n      }\n    },\n    true\n  );\n\n  this.postExecute(\n    \"shape.create\",\n    function (context) {\n      let process = context.process,\n        shape = context.shape;\n\n      if (process) {\n        // move children from process to participant\n        let processChildren = process.children.slice();\n\n        modeling.moveElements(processChildren, { x: 0, y: 0 }, shape);\n      }\n    },\n    true\n  );\n\n  // turn process into collaboration when creating participants\n  this.preExecute(\n    \"elements.create\",\n    HIGH_PRIORITY,\n    function (context) {\n      let elements = context.elements,\n        parent = context.parent,\n        participant;\n\n      let hasParticipants = findParticipant(elements);\n\n      if (hasParticipants && is(parent, \"bpmn:Process-action\")) {\n        ensureCollaboration(context);\n\n        participant = findParticipant(elements);\n\n        context.oldProcessRef = participant.businessObject.processRef;\n\n        // re-use process when creating first participant\n        participant.businessObject.processRef = parent.businessObject;\n      }\n    },\n    true\n  );\n\n  this.revert(\n    \"elements.create\",\n    function (context) {\n      let elements = context.elements,\n        process = context.process,\n        participant;\n\n      if (process) {\n        participant = findParticipant(elements);\n\n        // re-use process when creating first participant\n        participant.businessObject.processRef = context.oldProcessRef;\n      }\n    },\n    true\n  );\n\n  this.postExecute(\n    \"elements.create\",\n    function (context) {\n      let elements = context.elements,\n        process = context.process,\n        participant;\n\n      if (process) {\n        participant = findParticipant(elements);\n\n        // move children from process to first participant\n        let processChildren = process.children.slice();\n\n        modeling.moveElements(processChildren, { x: 0, y: 0 }, participant);\n      }\n    },\n    true\n  );\n}\n\nCreateParticipantBehavior.$inject = [\"canvas\", \"eventBus\", \"modeling\"];\n\ninherits(CreateParticipantBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getParticipantBounds(shape, childrenBBox) {\n  childrenBBox = {\n    width:\n      childrenBBox.width +\n      HORIZONTAL_PARTICIPANT_PADDING * 2 +\n      PARTICIPANT_BORDER_WIDTH,\n    height: childrenBBox.height + VERTICAL_PARTICIPANT_PADDING * 2,\n  };\n\n  let width = Math.max(shape.width, childrenBBox.width),\n    height = Math.max(shape.height, childrenBBox.height);\n\n  return {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height,\n  };\n}\n\nfunction getParticipantCreateConstraints(shape, childrenBBox) {\n  childrenBBox = asTRBL(childrenBBox);\n\n  return {\n    bottom: childrenBBox.top + shape.height / 2 - VERTICAL_PARTICIPANT_PADDING,\n    left: childrenBBox.right - shape.width / 2 + HORIZONTAL_PARTICIPANT_PADDING,\n    top: childrenBBox.bottom - shape.height / 2 + VERTICAL_PARTICIPANT_PADDING,\n    right:\n      childrenBBox.left +\n      shape.width / 2 -\n      HORIZONTAL_PARTICIPANT_PADDING -\n      PARTICIPANT_BORDER_WIDTH,\n  };\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction findParticipant(elements) {\n  return find(elements, function (element) {\n    return is(element, \"bpmn:Participant\");\n  });\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove,\n} from \"diagram-js/lib/util/Collections\";\n\nimport { find } from \"min-dash\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nlet TARGET_REF_PLACEHOLDER_NAME = \"__targetRef_placeholder\";\n\n/**\n * This behavior makes sure we always set a fake\n * DataInputAssociation#targetRef as demanded by the BPMN 2.0\n * XSD schema.\n *\n * The reference is set to a bpmn:Property{ name: '__targetRef_placeholder' }\n * which is created on the fly and cleaned up afterwards if not needed\n * anymore.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n */\nexport default function DataInputAssociationBehavior(eventBus, bpmnFactory) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.executed(\n    [\n      \"connection.create\",\n      \"connection.delete\",\n      \"connection.move\",\n      \"connection.reconnect\",\n    ],\n    ifDataInputAssociation(fixTargetRef)\n  );\n\n  this.reverted(\n    [\n      \"connection.create\",\n      \"connection.delete\",\n      \"connection.move\",\n      \"connection.reconnect\",\n    ],\n    ifDataInputAssociation(fixTargetRef)\n  );\n\n  function usesTargetRef(element, targetRef, removedConnection) {\n    let inputAssociations = element.get(\"dataInputAssociations\");\n\n    return find(inputAssociations, function (association) {\n      return (\n        association !== removedConnection && association.targetRef === targetRef\n      );\n    });\n  }\n\n  function getTargetRef(element, create) {\n    let properties = element.get(\"properties\");\n\n    let targetRefProp = find(properties, function (p) {\n      return p.name === TARGET_REF_PLACEHOLDER_NAME;\n    });\n\n    if (!targetRefProp && create) {\n      targetRefProp = bpmnFactory.create(\"bpmn:Property\", {\n        name: TARGET_REF_PLACEHOLDER_NAME,\n      });\n\n      collectionAdd(properties, targetRefProp);\n    }\n\n    return targetRefProp;\n  }\n\n  function cleanupTargetRef(element, connection) {\n    let targetRefProp = getTargetRef(element);\n\n    if (!targetRefProp) {\n      return;\n    }\n\n    if (!usesTargetRef(element, targetRefProp, connection)) {\n      collectionRemove(element.get(\"properties\"), targetRefProp);\n    }\n  }\n\n  /**\n   * Make sure targetRef is set to a valid property or\n   * `null` if the connection is detached.\n   *\n   * @param {Event} event\n   */\n  function fixTargetRef(event) {\n    let context = event.context,\n      connection = context.connection,\n      connectionBo = connection.businessObject,\n      target = connection.target,\n      targetBo = target && target.businessObject,\n      newTarget = context.newTarget,\n      newTargetBo = newTarget && newTarget.businessObject,\n      oldTarget = context.oldTarget || context.target,\n      oldTargetBo = oldTarget && oldTarget.businessObject;\n\n    let dataAssociation = connection.businessObject,\n      targetRefProp;\n\n    if (oldTargetBo && oldTargetBo !== targetBo) {\n      cleanupTargetRef(oldTargetBo, connectionBo);\n    }\n\n    if (newTargetBo && newTargetBo !== targetBo) {\n      cleanupTargetRef(newTargetBo, connectionBo);\n    }\n\n    if (targetBo) {\n      targetRefProp = getTargetRef(targetBo, true);\n      dataAssociation.targetRef = targetRefProp;\n    } else {\n      dataAssociation.targetRef = null;\n    }\n  }\n}\n\nDataInputAssociationBehavior.$inject = [\"eventBus\", \"bpmnFactory\"];\n\ninherits(DataInputAssociationBehavior, CommandInterceptor);\n\n/**\n * Only call the given function when the event\n * touches a bpmn:DataInputAssociation.\n *\n * @param {Function} fn\n * @return {Function}\n */\nfunction ifDataInputAssociation(fn) {\n  return function (event) {\n    let context = event.context,\n      connection = context.connection;\n\n    if (is(connection, \"bpmn:DataInputAssociation\")) {\n      return fn(event);\n    }\n  };\n}\n","export default function UpdateSemanticParentHandler(bpmnUpdater) {\n  this._bpmnUpdater = bpmnUpdater;\n}\n\nUpdateSemanticParentHandler.$inject = [\"bpmnUpdater\"];\n\nUpdateSemanticParentHandler.prototype.execute = function (context) {\n  let dataStoreBo = context.dataStoreBo,\n    newSemanticParent = context.newSemanticParent,\n    newDiParent = context.newDiParent;\n\n  context.oldSemanticParent = dataStoreBo.$parent;\n  context.oldDiParent = dataStoreBo.di.$parent;\n\n  // update semantic parent\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, newSemanticParent);\n\n  // update DI parent\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, newDiParent);\n};\n\nUpdateSemanticParentHandler.prototype.revert = function (context) {\n  let dataStoreBo = context.dataStoreBo,\n    oldSemanticParent = context.oldSemanticParent,\n    oldDiParent = context.oldDiParent;\n\n  // update semantic parent\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, oldSemanticParent);\n\n  // update DI parent\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, oldDiParent);\n};\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { isAny } from \"../util/ModelingUtil\";\n\nimport UpdateSemanticParentHandler from \"../cmd/UpdateSemanticParentHandler\";\n\n/**\n * BPMN specific data store behavior\n */\nexport default function DataStoreBehavior(\n  canvas,\n  commandStack,\n  elementRegistry,\n  eventBus\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  commandStack.registerHandler(\n    \"dataStore.updateContainment\",\n    UpdateSemanticParentHandler\n  );\n\n  function getFirstParticipant() {\n    return elementRegistry.filter(function (element) {\n      return is(element, \"bpmn:Participant\");\n    })[0];\n  }\n\n  function getDataStores(element) {\n    return element.children.filter(function (child) {\n      return is(child, \"bpmn:DataStoreReference\") && !child.labelTarget;\n    });\n  }\n\n  function updateDataStoreParent(dataStore, newDataStoreParent) {\n    let dataStoreBo = dataStore.businessObject || dataStore;\n\n    newDataStoreParent = newDataStoreParent || getFirstParticipant();\n\n    if (newDataStoreParent) {\n      let newDataStoreParentBo =\n        newDataStoreParent.businessObject || newDataStoreParent;\n\n      commandStack.execute(\"dataStore.updateContainment\", {\n        dataStoreBo: dataStoreBo,\n        newSemanticParent:\n          newDataStoreParentBo.processRef || newDataStoreParentBo,\n        newDiParent: newDataStoreParentBo.di,\n      });\n    }\n  }\n\n  // disable auto-resize for data stores\n  this.preExecute(\"shape.create\", function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:DataStoreReference\") && shape.type !== \"label\") {\n      if (!context.hints) {\n        context.hints = {};\n      }\n\n      // prevent auto resizing\n      context.hints.autoResize = false;\n    }\n  });\n\n  // disable auto-resize for data stores\n  this.preExecute(\"elements.move\", function (event) {\n    let context = event.context,\n      shapes = context.shapes;\n\n    let dataStoreReferences = shapes.filter(function (shape) {\n      return is(shape, \"bpmn:DataStoreReference\");\n    });\n\n    if (dataStoreReferences.length) {\n      if (!context.hints) {\n        context.hints = {};\n      }\n\n      // prevent auto resizing for data store references\n      context.hints.autoResize = shapes.filter(function (shape) {\n        return !is(shape, \"bpmn:DataStoreReference\");\n      });\n    }\n  });\n\n  // update parent on data store created\n  this.postExecute(\"shape.create\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      parent = shape.parent;\n\n    if (\n      is(shape, \"bpmn:DataStoreReference\") &&\n      shape.type !== \"label\" &&\n      is(parent, \"bpmn:Collaboration\")\n    ) {\n      updateDataStoreParent(shape);\n    }\n  });\n\n  // update parent on data store moved\n  this.postExecute(\"shape.move\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      oldParent = context.oldParent,\n      parent = shape.parent;\n\n    if (is(oldParent, \"bpmn:Collaboration\")) {\n      // do nothing if not necessary\n      return;\n    }\n\n    if (\n      is(shape, \"bpmn:DataStoreReference\") &&\n      shape.type !== \"label\" &&\n      is(parent, \"bpmn:Collaboration\")\n    ) {\n      let participant = is(oldParent, \"bpmn:Participant\")\n        ? oldParent\n        : getAncestor(oldParent, \"bpmn:Participant\");\n\n      updateDataStoreParent(shape, participant);\n    }\n  });\n\n  // update data store parents on participant or loop deleted\n  this.postExecute(\"shape.delete\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      rootElement = canvas.getRootElement();\n\n    if (\n      isAny(shape, [\"bpmn:Participant\", \"bpmn:Loop\", \"bpmn:Conditional\"]) &&\n      is(rootElement, \"bpmn:Collaboration\")\n    ) {\n      getDataStores(rootElement)\n        .filter(function (dataStore) {\n          return isDescendant(dataStore, shape);\n        })\n        .forEach(function (dataStore) {\n          updateDataStoreParent(dataStore);\n        });\n    }\n  });\n\n  // update data store parents on collaboration -> process\n  this.postExecute(\"canvas.updateRoot\", function (event) {\n    let context = event.context,\n      oldRoot = context.oldRoot,\n      newRoot = context.newRoot;\n\n    let dataStores = getDataStores(oldRoot);\n\n    dataStores.forEach(function (dataStore) {\n      if (is(newRoot, \"bpmn:Process-action\")) {\n        updateDataStoreParent(dataStore, newRoot);\n      }\n    });\n  });\n}\n\nDataStoreBehavior.$inject = [\n  \"canvas\",\n  \"commandStack\",\n  \"elementRegistry\",\n  \"eventBus\",\n];\n\ninherits(DataStoreBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction isDescendant(descendant, ancestor) {\n  let descendantBo = descendant.businessObject || descendant,\n    ancestorBo = ancestor.businessObject || ancestor;\n\n  while (descendantBo.$parent) {\n    if (descendantBo.$parent === ancestorBo.processRef || ancestorBo) {\n      return true;\n    }\n\n    descendantBo = descendantBo.$parent;\n  }\n\n  return false;\n}\n\nfunction getAncestor(element, type) {\n  while (element.parent) {\n    if (is(element.parent, type)) {\n      return element.parent;\n    }\n\n    element = element.parent;\n  }\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { getChildLanes } from \"../util/LaneUtil\";\n\nimport { eachElement } from \"diagram-js/lib/util/Elements\";\n\nlet LOW_PRIORITY = 500;\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n  CommandInterceptor.call(this, eventBus);\n\n  function compensateLaneDelete(shape, oldParent) {\n    let siblings = getChildLanes(oldParent);\n\n    let topAffected = [];\n    let bottomAffected = [];\n\n    eachElement(siblings, function (element) {\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    let offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    let topAdjustments, bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected,\n        \"y\",\n        offset,\n        shape.y - 10\n      );\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset },\n        \"s\"\n      );\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected,\n        \"y\",\n        -offset,\n        shape.y + shape.height + 10\n      );\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset },\n        \"n\"\n      );\n    }\n  }\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted(\"shape.delete\", LOW_PRIORITY, function (event) {\n    let context = event.context,\n      hints = context.hints,\n      shape = context.shape,\n      oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, \"bpmn:Lane\")) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\"eventBus\", \"modeling\", \"spaceTool\"];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getBusinessObject, is } from \"../../../util/ModelUtil\";\n\nimport { isLabel } from \"../../../util/LabelUtil\";\n\nconst LOW_PRIORITY = 500;\n\n/**\n * Replace boundary event with intermediate event when creating or moving results in detached event.\n */\nexport default function DetachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  let self = this;\n\n  this.postExecuted(\n    \"elements.create\",\n    LOW_PRIORITY,\n    function (context) {\n      let elements = context.elements;\n\n      elements\n        .filter(function (shape) {\n          let host = shape.host;\n\n          return shouldReplace(shape, host);\n        })\n        .map(function (shape) {\n          return elements.indexOf(shape);\n        })\n        .forEach(function (index) {\n          context.elements[index] = self.replaceShape(elements[index]);\n        });\n    },\n    true\n  );\n\n  this.preExecute(\n    \"elements.move\",\n    LOW_PRIORITY,\n    function (context) {\n      let shapes = context.shapes,\n        newHost = context.newHost;\n\n      shapes.forEach(function (shape, index) {\n        let host = shape.host;\n\n        if (shouldReplace(shape, includes(shapes, host) ? host : newHost)) {\n          shapes[index] = self.replaceShape(shape);\n        }\n      });\n    },\n    true\n  );\n}\n\nDetachEventBehavior.$inject = [\"bpmnReplace\", \"injector\"];\n\ninherits(DetachEventBehavior, CommandInterceptor);\n\nDetachEventBehavior.prototype.replaceShape = function (shape) {\n  let eventDefinition = getEventDefinition(shape),\n    intermediateEvent;\n\n  if (eventDefinition) {\n    intermediateEvent = {\n      type: \"bpmn:IntermediateCatchEvent\",\n      eventDefinitionType: eventDefinition.$type,\n    };\n  } else {\n    intermediateEvent = {\n      type: \"bpmn:IntermediateThrowEvent\",\n    };\n  }\n\n  return this._bpmnReplace.replaceElement(shape, intermediateEvent, {\n    layoutConnection: false,\n  });\n};\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  let businessObject = getBusinessObject(element),\n    eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) && is(shape, \"bpmn:BoundaryEvent\") && !host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n","import inherits from \"inherits\";\n\nimport { assign, filter, find, isNumber } from \"min-dash\";\n\nimport { getMid } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getApproxIntersection } from \"diagram-js/lib/util/LineIntersection\";\n\nexport default function DropOnFlowBehavior(eventBus, bpmnRules, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Reconnect start / end of a connection after\n   * dropping an element on a flow.\n   */\n\n  function insertShape(shape, targetFlow, positionOrBounds) {\n    let waypoints = targetFlow.waypoints,\n      waypointsBefore,\n      waypointsAfter,\n      dockingPoint,\n      // source,\n      // target,\n      incomingConnection,\n      outgoingConnection,\n      oldOutgoing = shape.outgoing.slice(),\n      oldIncoming = shape.incoming.slice();\n\n    let mid;\n\n    if (isNumber(positionOrBounds.width)) {\n      mid = getMid(positionOrBounds);\n    } else {\n      mid = positionOrBounds;\n    }\n\n    let intersection = getApproxIntersection(waypoints, mid);\n\n    if (intersection) {\n      waypointsBefore = waypoints.slice(0, intersection.index);\n      waypointsAfter = waypoints.slice(\n        intersection.index + (intersection.bendpoint ? 1 : 0)\n      );\n\n      // due to inaccuracy intersection might have been found\n      if (!waypointsBefore.length || !waypointsAfter.length) {\n        return;\n      }\n\n      dockingPoint = intersection.bendpoint\n        ? waypoints[intersection.index]\n        : mid;\n\n      // if last waypointBefore is inside shape's bounds, ignore docking point\n      if (\n        !isPointInsideBBox(shape, waypointsBefore[waypointsBefore.length - 1])\n      ) {\n        waypointsBefore.push(copy(dockingPoint));\n      }\n\n      // if first waypointAfter is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsAfter[0])) {\n        waypointsAfter.unshift(copy(dockingPoint));\n      }\n    }\n\n    // source = targetFlow.source;\n    // target = targetFlow.target;\n\n    // if (bpmnRules.canConnect(source, shape, targetFlow)) {\n    //   // reconnect source -> inserted shape\n    //   modeling.reconnectEnd(targetFlow, shape, waypointsBefore || mid);\n\n    //   incomingConnection = targetFlow;\n    // }\n\n    // if (bpmnRules.canConnect(shape, target, targetFlow)) {\n    //   if (!incomingConnection) {\n    //     // reconnect inserted shape -> end\n    //     modeling.reconnectStart(targetFlow, shape, waypointsAfter || mid);\n\n    //     outgoingConnection = targetFlow;\n    //   } else {\n    //     outgoingConnection = modeling.connect(shape, target, {\n    //       type: targetFlow.type,\n    //       waypoints: waypointsAfter,\n    //     });\n    //   }\n    // }\n\n    let duplicateConnections = [].concat(\n      (incomingConnection &&\n        filter(oldIncoming, function (connection) {\n          return connection.source === incomingConnection.source;\n        })) ||\n        [],\n\n      (outgoingConnection &&\n        filter(oldOutgoing, function (connection) {\n          return connection.target === outgoingConnection.target;\n        })) ||\n        []\n    );\n\n    if (duplicateConnections.length) {\n      modeling.removeElements(duplicateConnections);\n    }\n  }\n\n  this.preExecute(\n    \"elements.move\",\n    function (context) {\n      let newParent = context.newParent,\n        shapes = context.shapes,\n        delta = context.delta,\n        shape = shapes[0];\n\n      if (!shape || !newParent) {\n        return;\n      }\n\n      // if the new parent is a connection,\n      // change it to the new parent's parent\n      if (newParent && newParent.waypoints) {\n        context.newParent = newParent = newParent.parent;\n      }\n\n      let shapeMid = getMid(shape);\n      let newShapeMid = {\n        x: shapeMid.x + delta.x,\n        y: shapeMid.y + delta.y,\n      };\n\n      // find a connection which intersects with the\n      // element's mid point\n      let connection = find(newParent.children, function (element) {\n        let canInsert = bpmnRules.canInsert(shapes, element);\n\n        return (\n          canInsert && getApproxIntersection(element.waypoints, newShapeMid)\n        );\n      });\n\n      if (connection) {\n        context.targetFlow = connection;\n        context.position = newShapeMid;\n      }\n    },\n    true\n  );\n\n  this.postExecuted(\n    \"elements.move\",\n    function (context) {\n      let shapes = context.shapes,\n        targetFlow = context.targetFlow,\n        position = context.position;\n\n      if (targetFlow) {\n        insertShape(shapes[0], targetFlow, position);\n      }\n    },\n    true\n  );\n\n  this.preExecute(\n    \"shape.create\",\n    function (context) {\n      let parent = context.parent,\n        shape = context.shape;\n\n      if (bpmnRules.canInsert(shape, parent)) {\n        context.targetFlow = parent;\n        context.parent = parent.parent;\n      }\n    },\n    true\n  );\n\n  this.postExecuted(\n    \"shape.create\",\n    function (context) {\n      let shape = context.shape,\n        targetFlow = context.targetFlow,\n        positionOrBounds = context.position;\n\n      if (targetFlow) {\n        insertShape(shape, targetFlow, positionOrBounds);\n      }\n    },\n    true\n  );\n}\n\ninherits(DropOnFlowBehavior, CommandInterceptor);\n\nDropOnFlowBehavior.$inject = [\"eventBus\", \"bpmnRules\", \"modeling\"];\n\n// helpers /////////////////////\n\nfunction isPointInsideBBox(bbox, point) {\n  let x = point.x,\n    y = point.y;\n\n  return (\n    x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height\n  );\n}\n\nfunction copy(obj) {\n  return assign({}, obj);\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nexport default function EventBasedGatewayBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Remove existing sequence flows of event-based target before connecting\n   * from event-based gateway.\n   */\n  this.preExecuted(\"connection.create\", function (event) {\n    let context = event.context,\n      source = context.source,\n      target = context.target,\n      existingIncomingConnections = target.incoming.slice();\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (is(source, \"bpmn:EventBasedGateway\") && target.incoming.length) {\n      existingIncomingConnections\n        .filter(isSequenceFlow)\n        .forEach(function (sequenceFlow) {\n          modeling.removeConnection(sequenceFlow);\n        });\n    }\n  });\n\n  /**\n   *  After replacing shape with event-based gateway, remove incoming sequence\n   *  flows of event-based targets which do not belong to event-based gateway\n   *  source.\n   */\n  this.preExecuted(\"shape.replace\", function (event) {\n    let newShape = event.context.newShape,\n      newShapeTargets,\n      newShapeTargetsIncomingSequenceFlows;\n\n    if (!is(newShape, \"bpmn:EventBasedGateway\")) {\n      return;\n    }\n\n    newShapeTargets = newShape.outgoing\n      .filter(isSequenceFlow)\n      .map(function (sequenceFlow) {\n        return sequenceFlow.target;\n      });\n\n    newShapeTargetsIncomingSequenceFlows = newShapeTargets.reduce(function (\n      sequenceFlows,\n      target\n    ) {\n      let incomingSequenceFlows = target.incoming.filter(isSequenceFlow);\n\n      return sequenceFlows.concat(incomingSequenceFlows);\n    },\n    []);\n\n    newShapeTargetsIncomingSequenceFlows.forEach(function (sequenceFlow) {\n      if (sequenceFlow.source !== newShape) {\n        modeling.removeConnection(sequenceFlow);\n      }\n    });\n  });\n}\n\nEventBasedGatewayBehavior.$inject = [\"eventBus\", \"modeling\"];\n\ninherits(EventBasedGatewayBehavior, CommandInterceptor);\n\n// helpers //////////////////////\n\nfunction isSequenceFlow(connection) {\n  return is(connection, \"bpmn:SequenceFlow\");\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove,\n} from \"diagram-js/lib/util/Collections\";\n\nimport { getBusinessObject, is } from \"../../../util/ModelUtil\";\n\nimport { createCategoryValue } from \"./util/CategoryUtil\";\n\nlet HIGH_PRIORITY = 2000;\n\n/**\n * BPMN specific Group behavior\n */\nexport default function GroupBehavior(\n  bpmnFactory,\n  canvas,\n  elementRegistry,\n  eventBus,\n  injector,\n  moddleCopy\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  /**\n   * Gets process definitions\n   *\n   * @return {ModdleElement} definitions\n   */\n  function getDefinitions() {\n    let rootElement = canvas.getRootElement(),\n      businessObject = getBusinessObject(rootElement);\n\n    return businessObject.$parent;\n  }\n\n  /**\n   * Removes a referenced category value for a given group shape\n   *\n   * @param {djs.model.Shape} shape\n   */\n  function removeReferencedCategoryValue(shape) {\n    let businessObject = getBusinessObject(shape),\n      categoryValue = businessObject.categoryValueRef;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    let category = categoryValue.$parent;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    collectionRemove(category.categoryValue, categoryValue);\n\n    // cleanup category if it is empty\n    if (category && !category.categoryValue.length) {\n      removeCategory(category);\n    }\n  }\n\n  /**\n   * Removes a given category from the definitions\n   *\n   * @param {ModdleElement} category\n   */\n  function removeCategory(category) {\n    let definitions = getDefinitions();\n\n    collectionRemove(definitions.get(\"rootElements\"), category);\n  }\n\n  /**\n   * Returns all group element in the current registry\n   *\n   * @return {Array<djs.model.shape>} a list of group shapes\n   */\n  function getGroupElements() {\n    return elementRegistry.filter(function (e) {\n      return is(e, \"bpmn:Group\");\n    });\n  }\n\n  /**\n   * Returns true if given categoryValue is referenced in one of the given elements\n   *\n   * @param {Array<djs.model.shape>} elements\n   * @param {ModdleElement} categoryValue\n   * @return {Boolean}\n   */\n  function isReferenced(elements, categoryValue) {\n    return elements.some(function (e) {\n      let businessObject = getBusinessObject(e);\n\n      return (\n        businessObject.categoryValueRef &&\n        businessObject.categoryValueRef === categoryValue\n      );\n    });\n  }\n\n  /**\n   * remove referenced category + value when group was deleted\n   */\n  this.executed(\"shape.delete\", function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:Group\")) {\n      let businessObject = getBusinessObject(shape),\n        categoryValueRef = businessObject.categoryValueRef,\n        groupElements = getGroupElements();\n\n      if (!isReferenced(groupElements, categoryValueRef)) {\n        removeReferencedCategoryValue(shape);\n      }\n    }\n  });\n\n  /**\n   * re-attach removed category\n   */\n  this.reverted(\"shape.delete\", function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:Group\")) {\n      let businessObject = getBusinessObject(shape),\n        categoryValueRef = businessObject.categoryValueRef,\n        definitions = getDefinitions(),\n        category = categoryValueRef ? categoryValueRef.$parent : null;\n\n      collectionAdd(category.get(\"categoryValue\"), categoryValueRef);\n      collectionAdd(definitions.get(\"rootElements\"), category);\n    }\n  });\n\n  /**\n   * create new category + value when group was created\n   */\n  this.execute(\"shape.create\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      businessObject = getBusinessObject(shape);\n\n    if (is(businessObject, \"bpmn:Group\") && !businessObject.categoryValueRef) {\n      let definitions = getDefinitions(),\n        categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n      // link the reference to the Group\n      businessObject.categoryValueRef = categoryValue;\n    }\n  });\n\n  this.revert(\"shape.create\", function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:Group\")) {\n      removeReferencedCategoryValue(shape);\n\n      delete getBusinessObject(shape).categoryValueRef;\n    }\n  });\n\n  // copy bpmn:CategoryValue when copying element\n  eventBus.on(\"moddleCopy.canCopyProperty\", HIGH_PRIORITY, function (context) {\n    let property = context.property,\n      categoryValue;\n\n    if (is(property, \"bpmn:CategoryValue\")) {\n      categoryValue = createCategoryValue(getDefinitions(), bpmnFactory);\n\n      // return copy of category\n      return moddleCopy.copyElement(property, categoryValue);\n    }\n  });\n}\n\nGroupBehavior.$inject = [\n  \"bpmnFactory\",\n  \"canvas\",\n  \"elementRegistry\",\n  \"eventBus\",\n  \"injector\",\n  \"moddleCopy\",\n];\n\ninherits(GroupBehavior, CommandInterceptor);\n","/**\n * Returns the intersection between two line segments a and b.\n *\n * @param {Point} l1s\n * @param {Point} l1e\n * @param {Point} l2s\n * @param {Point} l2e\n *\n * @return {Point}\n */\nexport default function lineIntersect(l1s, l1e, l2s, l2e) {\n  // if the lines intersect, the result contains the x and y of the\n  // intersection (treating the lines as infinite) and booleans for\n  // whether line segment 1 or line segment 2 contain the point\n  let denominator, a, b, c, numerator;\n\n  denominator =\n    (l2e.y - l2s.y) * (l1e.x - l1s.x) - (l2e.x - l2s.x) * (l1e.y - l1s.y);\n\n  if (denominator === 0) {\n    return null;\n  }\n\n  a = l1s.y - l2s.y;\n  b = l1s.x - l2s.x;\n  numerator = (l2e.x - l2s.x) * a - (l2e.y - l2s.y) * b;\n\n  c = numerator / denominator;\n\n  // if we cast these lines infinitely in\n  // both directions, they intersect here\n  return {\n    x: Math.round(l1s.x + c * (l1e.x - l1s.x)),\n    y: Math.round(l1s.y + c * (l1e.y - l1s.y)),\n  };\n}\n","import { getMid } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport lineIntersect from \"./util/LineIntersect\";\n\n/**\n * Fix broken dockings after DI imports.\n *\n * @param {EventBus} eventBus\n */\nexport default function ImportDockingFix(eventBus) {\n  function adjustDocking(startPoint, nextPoint, elementMid) {\n    let elementTop = {\n      x: elementMid.x,\n      y: elementMid.y - 50,\n    };\n\n    let elementLeft = {\n      x: elementMid.x - 50,\n      y: elementMid.y,\n    };\n\n    let verticalIntersect = lineIntersect(\n        startPoint,\n        nextPoint,\n        elementMid,\n        elementTop\n      ),\n      horizontalIntersect = lineIntersect(\n        startPoint,\n        nextPoint,\n        elementMid,\n        elementLeft\n      );\n\n    // original is horizontal or vertical center cross intersection\n    let centerIntersect;\n\n    if (verticalIntersect && horizontalIntersect) {\n      if (\n        getDistance(verticalIntersect, elementMid) >\n        getDistance(horizontalIntersect, elementMid)\n      ) {\n        centerIntersect = horizontalIntersect;\n      } else {\n        centerIntersect = verticalIntersect;\n      }\n    } else {\n      centerIntersect = verticalIntersect || horizontalIntersect;\n    }\n\n    startPoint.original = centerIntersect;\n  }\n\n  function fixDockings(connection) {\n    let waypoints = connection.waypoints;\n\n    adjustDocking(waypoints[0], waypoints[1], getMid(connection.source));\n\n    adjustDocking(\n      waypoints[waypoints.length - 1],\n      waypoints[waypoints.length - 2],\n      getMid(connection.target)\n    );\n  }\n\n  eventBus.on(\"bpmnElement.added\", function (e) {\n    let element = e.element;\n\n    if (element.waypoints) {\n      fixDockings(element);\n    }\n  });\n}\n\nImportDockingFix.$inject = [\"eventBus\"];\n\n// helpers //////////////////////\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getBusinessObject } from \"../../../util/ModelUtil\";\n\nimport { isAny } from \"../util/ModelingUtil\";\n\n/**\n * A component that makes sure that each created or updated\n * Pool and Lane is assigned an isHorizontal property set to true.\n *\n * @param {EventBus} eventBus\n */\nexport default function IsHorizontalFix(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  let elementTypesToUpdate = [\"bpmn:Participant\", \"bpmn:Lane\"];\n\n  this.executed(\n    [\"shape.move\", \"shape.create\", \"shape.resize\"],\n    function (event) {\n      let bo = getBusinessObject(event.context.shape);\n\n      if (isAny(bo, elementTypesToUpdate) && !bo.di.get(\"isHorizontal\")) {\n        // set attribute directly to avoid modeling#updateProperty side effects\n        bo.di.set(\"isHorizontal\", true);\n      }\n    }\n  );\n}\n\nIsHorizontalFix.$inject = [\"eventBus\"];\n\ninherits(IsHorizontalFix, CommandInterceptor);\n","/**\n * Returns the length of a vector\n *\n * @param {Vector}\n * @return {Float}\n */\nexport function vectorLength(v) {\n  return Math.sqrt(Math.pow(v.x, 2) + Math.pow(v.y, 2));\n}\n\n/**\n * Calculates the angle between a line a the yAxis\n *\n * @param {Array}\n * @return {Float}\n */\nexport function getAngle(line) {\n  // return value is between 0, 180 and -180, -0\n  // @janstuemmel: maybe replace return a/b with b/a\n  return Math.atan((line[1].y - line[0].y) / (line[1].x - line[0].x));\n}\n\n/**\n * Rotates a vector by a given angle\n *\n * @param {Vector}\n * @param {Float} Angle in radians\n * @return {Vector}\n */\nexport function rotateVector(vector, angle) {\n  return !angle\n    ? vector\n    : {\n        x: Math.cos(angle) * vector.x - Math.sin(angle) * vector.y,\n        y: Math.sin(angle) * vector.x + Math.cos(angle) * vector.y,\n      };\n}\n\n/**\n * Solves a 2D equation system\n * a + r*b = c, where a,b,c are 2D vectors\n *\n * @param {Vector}\n * @param {Vector}\n * @param {Vector}\n * @return {Float}\n */\nfunction solveLambaSystem(a, b, c) {\n  // the 2d system\n  let system = [\n    { n: a[0] - c[0], lambda: b[0] },\n    { n: a[1] - c[1], lambda: b[1] },\n  ];\n\n  // solve\n  let n = system[0].n * b[0] + system[1].n * b[1],\n    l = system[0].lambda * b[0] + system[1].lambda * b[1];\n\n  return -n / l;\n}\n\n/**\n * Position of perpendicular foot\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Point} the perpendicular foot position\n */\nexport function perpendicularFoot(point, line) {\n  let a = line[0],\n    b = line[1];\n\n  // relative position of b from a\n  let bd = { x: b.x - a.x, y: b.y - a.y };\n\n  // solve equation system to the parametrized vectors param real value\n  let r = solveLambaSystem([a.x, a.y], [bd.x, bd.y], [point.x, point.y]);\n\n  return { x: a.x + r * bd.x, y: a.y + r * bd.y };\n}\n\n/**\n * Calculates the distance between a point and a line\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Float} distance\n */\nexport function getDistancePointLine(point, line) {\n  let pfPoint = perpendicularFoot(point, line);\n\n  // distance vector\n  let connectionVector = {\n    x: pfPoint.x - point.x,\n    y: pfPoint.y - point.y,\n  };\n\n  return vectorLength(connectionVector);\n}\n\n/**\n * Calculates the distance between two points\n *\n * @param {Point}\n * @param {Point}\n * @return {Float} distance\n */\nexport function getDistancePointPoint(point1, point2) {\n  return vectorLength({\n    x: point1.x - point2.x,\n    y: point1.y - point2.y,\n  });\n}\n","let sqrt = Math.sqrt,\n  min = Math.min,\n  max = Math.max,\n  abs = Math.abs;\n\n/**\n * Calculate the square (power to two) of a number.\n *\n * @param {Number} n\n *\n * @return {Number}\n */\nfunction sq(n) {\n  return Math.pow(n, 2);\n}\n\n/**\n * Get distance between two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Number}\n */\nfunction getDistance(p1, p2) {\n  return sqrt(sq(p1.x - p2.x) + sq(p1.y - p2.y));\n}\n\n/**\n * Return the attachment of the given point on the specified line.\n *\n * The attachment is either a bendpoint (attached to the given point)\n * or segment (attached to a location on a line segment) attachment:\n *\n * ```javascript\n * let pointAttachment = {\n *   type: 'bendpoint',\n *   bendpointIndex: 3,\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n *\n * let segmentAttachment = {\n *   type: 'segment',\n *   segmentIndex: 2,\n *   relativeLocation: 0.31, // attach point location between 0 (at start) and 1 (at end)\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n * ```\n *\n * @param {Point} point\n * @param {Array<Point>} line\n *\n * @return {Object} attachment\n */\nexport function getAttachment(point, line) {\n  let idx = 0,\n    segmentStart,\n    segmentEnd,\n    segmentStartDistance,\n    segmentEndDistance,\n    attachmentPosition,\n    minDistance,\n    intersections,\n    attachment,\n    attachmentDistance,\n    closestAttachmentDistance,\n    closestAttachment;\n\n  for (idx = 0; idx < line.length - 1; idx++) {\n    segmentStart = line[idx];\n    segmentEnd = line[idx + 1];\n\n    if (pointsEqual(segmentStart, segmentEnd)) {\n      intersections = [segmentStart];\n    } else {\n      segmentStartDistance = getDistance(point, segmentStart);\n      segmentEndDistance = getDistance(point, segmentEnd);\n\n      minDistance = min(segmentStartDistance, segmentEndDistance);\n\n      intersections = getCircleSegmentIntersections(\n        segmentStart,\n        segmentEnd,\n        point,\n        minDistance\n      );\n    }\n\n    if (intersections.length < 1) {\n      throw new Error(\"expected between [1, 2] circle -> line intersections\");\n    }\n\n    // one intersection -> bendpoint attachment\n    if (intersections.length === 1) {\n      attachment = {\n        type: \"bendpoint\",\n        position: intersections[0],\n        segmentIndex: idx,\n        bendpointIndex: pointsEqual(segmentStart, intersections[0])\n          ? idx\n          : idx + 1,\n      };\n    }\n\n    // two intersections -> segment attachment\n    if (intersections.length === 2) {\n      attachmentPosition = mid(intersections[0], intersections[1]);\n\n      attachment = {\n        type: \"segment\",\n        position: attachmentPosition,\n        segmentIndex: idx,\n        relativeLocation:\n          getDistance(segmentStart, attachmentPosition) /\n          getDistance(segmentStart, segmentEnd),\n      };\n    }\n\n    attachmentDistance = getDistance(attachment.position, point);\n\n    if (!closestAttachment || closestAttachmentDistance > attachmentDistance) {\n      closestAttachment = attachment;\n      closestAttachmentDistance = attachmentDistance;\n    }\n  }\n\n  return closestAttachment;\n}\n\n/**\n * Gets the intersection between a circle and a line segment.\n *\n * @param {Point} s1 segment start\n * @param {Point} s2 segment end\n * @param {Point} cc circle center\n * @param {Number} cr circle radius\n *\n * @return {Array<Point>} intersections\n */\nfunction getCircleSegmentIntersections(s1, s2, cc, cr) {\n  let baX = s2.x - s1.x;\n  let baY = s2.y - s1.y;\n  let caX = cc.x - s1.x;\n  let caY = cc.y - s1.y;\n\n  let a = baX * baX + baY * baY;\n  let bBy2 = baX * caX + baY * caY;\n  let c = caX * caX + caY * caY - cr * cr;\n\n  let pBy2 = bBy2 / a;\n  let q = c / a;\n\n  let disc = pBy2 * pBy2 - q;\n\n  // check against negative value to work around\n  // negative, very close to zero results (-4e-15)\n  // being produced in some environments\n  if (disc < 0 && disc > -0.000001) {\n    disc = 0;\n  }\n\n  if (disc < 0) {\n    return [];\n  }\n\n  // if disc == 0 ... dealt with later\n  let tmpSqrt = sqrt(disc);\n  let abScalingFactor1 = -pBy2 + tmpSqrt;\n  let abScalingFactor2 = -pBy2 - tmpSqrt;\n\n  let i1 = {\n    x: s1.x - baX * abScalingFactor1,\n    y: s1.y - baY * abScalingFactor1,\n  };\n\n  if (disc === 0) {\n    // abScalingFactor1 == abScalingFactor2\n    return [i1];\n  }\n\n  let i2 = {\n    x: s1.x - baX * abScalingFactor2,\n    y: s1.y - baY * abScalingFactor2,\n  };\n\n  // return only points on line segment\n  return [i1, i2].filter(function (p) {\n    return isPointInSegment(p, s1, s2);\n  });\n}\n\nfunction isPointInSegment(p, segmentStart, segmentEnd) {\n  return (\n    fenced(p.x, segmentStart.x, segmentEnd.x) &&\n    fenced(p.y, segmentStart.y, segmentEnd.y)\n  );\n}\n\nfunction fenced(n, rangeStart, rangeEnd) {\n  // use matching threshold to work around\n  // precision errors in intersection computation\n\n  return (\n    n >= min(rangeStart, rangeEnd) - EQUAL_THRESHOLD &&\n    n <= max(rangeStart, rangeEnd) + EQUAL_THRESHOLD\n  );\n}\n\n/**\n * Calculate mid of two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Point}\n */\nfunction mid(p1, p2) {\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2,\n  };\n}\n\nlet EQUAL_THRESHOLD = 0.1;\n\nfunction pointsEqual(p1, p2) {\n  return (\n    abs(p1.x - p2.x) <= EQUAL_THRESHOLD && abs(p1.y - p2.y) <= EQUAL_THRESHOLD\n  );\n}\n","import { getDistancePointPoint, rotateVector, getAngle } from \"./GeometricUtil\";\n\nimport { getAttachment } from \"./LineAttachmentUtil\";\n\nimport { roundPoint } from \"diagram-js/lib/layout/LayoutUtil\";\n\nexport function findNewLabelLineStartIndex(\n  oldWaypoints,\n  newWaypoints,\n  attachment,\n  hints\n) {\n  let index = attachment.segmentIndex;\n\n  let offset = newWaypoints.length - oldWaypoints.length;\n\n  // segmentMove happened\n  if (hints.segmentMove) {\n    let oldSegmentStartIndex = hints.segmentMove.segmentStartIndex,\n      newSegmentStartIndex = hints.segmentMove.newSegmentStartIndex;\n\n    // if label was on moved segment return new segment index\n    if (index === oldSegmentStartIndex) {\n      return newSegmentStartIndex;\n    }\n\n    // label is after new segment index\n    if (index >= newSegmentStartIndex) {\n      return index + offset < newSegmentStartIndex\n        ? newSegmentStartIndex\n        : index + offset;\n    }\n\n    // if label is before new segment index\n    return index;\n  }\n\n  // bendpointMove happened\n  if (hints.bendpointMove) {\n    let insert = hints.bendpointMove.insert,\n      bendpointIndex = hints.bendpointMove.bendpointIndex,\n      newIndex;\n\n    // waypoints length didnt change\n    if (offset === 0) {\n      return index;\n    }\n\n    // label behind new/removed bendpoint\n    if (index >= bendpointIndex) {\n      newIndex = insert ? index + 1 : index - 1;\n    }\n\n    // label before new/removed bendpoint\n    if (index < bendpointIndex) {\n      newIndex = index;\n\n      // decide label should take right or left segment\n      if (\n        insert &&\n        attachment.type !== \"bendpoint\" &&\n        bendpointIndex - 1 === index\n      ) {\n        let rel = relativePositionMidWaypoint(newWaypoints, bendpointIndex);\n\n        if (rel < attachment.relativeLocation) {\n          newIndex++;\n        }\n      }\n    }\n\n    return newIndex;\n  }\n\n  // start/end changed\n  if (offset === 0) {\n    return index;\n  }\n\n  if (hints.connectionStart) {\n    return index === 0 ? 0 : null;\n  }\n\n  if (hints.connectionEnd) {\n    return index === oldWaypoints.length - 2 ? newWaypoints.length - 2 : null;\n  }\n\n  // if nothing fits, return null\n  return null;\n}\n\n/**\n * Calculate the required adjustment (move delta) for the given label\n * after the connection waypoints got updated.\n *\n * @param {djs.model.Label} label\n * @param {Array<Point>} newWaypoints\n * @param {Array<Point>} oldWaypoints\n * @param {Object} hints\n *\n * @return {Point} delta\n */\nexport function getLabelAdjustment(label, newWaypoints, oldWaypoints, hints) {\n  let x = 0,\n    y = 0;\n\n  let labelPosition = getLabelMid(label);\n\n  // get closest attachment\n  let attachment = getAttachment(labelPosition, oldWaypoints),\n    oldLabelLineIndex = attachment.segmentIndex,\n    newLabelLineIndex = findNewLabelLineStartIndex(\n      oldWaypoints,\n      newWaypoints,\n      attachment,\n      hints\n    );\n\n  if (newLabelLineIndex === null) {\n    return { x: x, y: y };\n  }\n\n  // should never happen\n  // TODO(@janstuemmel): throw an error here when connectionSegmentMove is refactored\n  if (newLabelLineIndex < 0 || newLabelLineIndex > newWaypoints.length - 2) {\n    return { x: x, y: y };\n  }\n\n  let oldLabelLine = getLine(oldWaypoints, oldLabelLineIndex),\n    newLabelLine = getLine(newWaypoints, newLabelLineIndex),\n    oldFoot = attachment.position;\n\n  let relativeFootPosition = getRelativeFootPosition(oldLabelLine, oldFoot),\n    angleDelta = getAngleDelta(oldLabelLine, newLabelLine);\n\n  // special rule if label on bendpoint\n  if (attachment.type === \"bendpoint\") {\n    let offset = newWaypoints.length - oldWaypoints.length,\n      oldBendpointIndex = attachment.bendpointIndex,\n      oldBendpoint = oldWaypoints[oldBendpointIndex];\n\n    // bendpoint position hasn't changed, return same position\n    if (newWaypoints.indexOf(oldBendpoint) !== -1) {\n      return { x: x, y: y };\n    }\n\n    // new bendpoint and old bendpoint have same index, then just return the offset\n    if (offset === 0) {\n      let newBendpoint = newWaypoints[oldBendpointIndex];\n\n      return {\n        x: newBendpoint.x - attachment.position.x,\n        y: newBendpoint.y - attachment.position.y,\n      };\n    }\n\n    // if bendpoints get removed\n    if (\n      offset < 0 &&\n      oldBendpointIndex !== 0 &&\n      oldBendpointIndex < oldWaypoints.length - 1\n    ) {\n      relativeFootPosition = relativePositionMidWaypoint(\n        oldWaypoints,\n        oldBendpointIndex\n      );\n    }\n  }\n\n  let newFoot = {\n    x:\n      (newLabelLine[1].x - newLabelLine[0].x) * relativeFootPosition +\n      newLabelLine[0].x,\n    y:\n      (newLabelLine[1].y - newLabelLine[0].y) * relativeFootPosition +\n      newLabelLine[0].y,\n  };\n\n  // the rotated vector to label\n  let newLabelVector = rotateVector(\n    {\n      x: labelPosition.x - oldFoot.x,\n      y: labelPosition.y - oldFoot.y,\n    },\n    angleDelta\n  );\n\n  // the new relative position\n  x = newFoot.x + newLabelVector.x - labelPosition.x;\n  y = newFoot.y + newLabelVector.y - labelPosition.y;\n\n  return roundPoint({\n    x: x,\n    y: y,\n  });\n}\n\n// HELPERS //////////////////////\n\nfunction relativePositionMidWaypoint(waypoints, idx) {\n  let distanceSegment1 = getDistancePointPoint(\n      waypoints[idx - 1],\n      waypoints[idx]\n    ),\n    distanceSegment2 = getDistancePointPoint(\n      waypoints[idx],\n      waypoints[idx + 1]\n    );\n\n  let relativePosition =\n    distanceSegment1 / (distanceSegment1 + distanceSegment2);\n\n  return relativePosition;\n}\n\nfunction getLabelMid(label) {\n  return {\n    x: label.x + label.width / 2,\n    y: label.y + label.height / 2,\n  };\n}\n\nfunction getAngleDelta(l1, l2) {\n  let a1 = getAngle(l1),\n    a2 = getAngle(l2);\n  return a2 - a1;\n}\n\nfunction getLine(waypoints, idx) {\n  return [waypoints[idx], waypoints[idx + 1]];\n}\n\nfunction getRelativeFootPosition(line, foot) {\n  let length = getDistancePointPoint(line[0], line[1]),\n    lengthToFoot = getDistancePointPoint(line[0], foot);\n\n  return length === 0 ? 0 : lengthToFoot / length;\n}\n","import { assign } from \"min-dash\";\n\nimport inherits from \"inherits\";\n\nimport { is, getBusinessObject } from \"../../../util/ModelUtil\";\n\nimport {\n  isLabelExternal,\n  getExternalLabelMid,\n  hasExternalLabel,\n  isLabel,\n} from \"../../../util/LabelUtil\";\n\nimport { getLabel } from \"../../label-editing/LabelUtil\";\n\nimport { getLabelAdjustment } from \"./util/LabelLayoutUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getNewAttachPoint } from \"diagram-js/lib/util/AttachUtil\";\n\nimport { getMid, roundPoint } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { delta } from \"diagram-js/lib/util/PositionUtil\";\n\nimport { sortBy } from \"min-dash\";\n\nimport { getDistancePointLine, perpendicularFoot } from \"./util/GeometricUtil\";\n\nlet DEFAULT_LABEL_DIMENSIONS = {\n  width: 90,\n  height: 20,\n};\n\nlet NAME_PROPERTY = \"name\";\nlet TEXT_PROPERTY = \"text\";\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {BpmnFactory} bpmnFactory\n * @param {TextRenderer} textRenderer\n */\nexport default function LabelBehavior(\n  eventBus,\n  modeling,\n  bpmnFactory,\n  textRenderer\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  // update label if name property was updated\n  this.postExecute(\"element.updateProperties\", function (e) {\n    let context = e.context,\n      element = context.element,\n      properties = context.properties;\n\n    if (NAME_PROPERTY in properties) {\n      modeling.updateLabel(element, properties[NAME_PROPERTY]);\n    }\n\n    if (TEXT_PROPERTY in properties && is(element, \"bpmn:TextAnnotation\")) {\n      let newBounds = textRenderer.getTextAnnotationBounds(\n        {\n          x: element.x,\n          y: element.y,\n          width: element.width,\n          height: element.height,\n        },\n        properties[TEXT_PROPERTY] || \"\"\n      );\n\n      modeling.updateLabel(element, properties.text, newBounds);\n    }\n  });\n\n  // create label shape after shape/connection was created\n  this.postExecute([\"shape.create\", \"connection.create\"], function (e) {\n    let context = e.context,\n      hints = context.hints || {};\n\n    if (hints.createElementsBehavior === false) {\n      return;\n    }\n\n    let element = context.shape || context.connection,\n      businessObject = element.businessObject;\n\n    if (isLabel(element) || !isLabelExternal(element)) {\n      return;\n    }\n\n    // only create label if attribute available\n    if (!getLabel(element)) {\n      return;\n    }\n\n    let labelCenter = getExternalLabelMid(element);\n\n    // we don't care about x and y\n    let labelDimensions = textRenderer.getExternalLabelBounds(\n      DEFAULT_LABEL_DIMENSIONS,\n      getLabel(element)\n    );\n\n    modeling.createLabel(element, labelCenter, {\n      id: businessObject.id + \"_label\",\n      businessObject: businessObject,\n      width: labelDimensions.width,\n      height: labelDimensions.height,\n    });\n  });\n\n  // update label after label shape was deleted\n  this.postExecute(\"shape.delete\", function (event) {\n    let context = event.context,\n      labelTarget = context.labelTarget,\n      hints = context.hints || {};\n\n    // check if label\n    if (labelTarget && hints.unsetLabel !== false) {\n      modeling.updateLabel(labelTarget, null, null, { removeShape: false });\n    }\n  });\n\n  // update di information on label creation\n  this.postExecute([\"label.create\"], function (event) {\n    let context = event.context,\n      element = context.shape,\n      businessObject,\n      di;\n\n    // we want to trigger on real labels only\n    if (!element.labelTarget) {\n      return;\n    }\n\n    // we want to trigger on BPMN elements only\n    if (!is(element.labelTarget || element, \"bpmn:BaseElement\")) {\n      return;\n    }\n\n    businessObject = element.businessObject;\n    di = businessObject.di;\n\n    if (!di.label) {\n      di.label = bpmnFactory.create(\"bpmndi:BPMNLabel\", {\n        bounds: bpmnFactory.create(\"dc:Bounds\"),\n      });\n    }\n\n    assign(di.label.bounds, {\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height,\n    });\n  });\n\n  function getVisibleLabelAdjustment(event) {\n    let context = event.context,\n      connection = context.connection,\n      label = connection.label,\n      hints = assign({}, context.hints),\n      newWaypoints = context.newWaypoints || connection.waypoints,\n      oldWaypoints = context.oldWaypoints;\n\n    if (typeof hints.startChanged === \"undefined\") {\n      hints.startChanged = !!hints.connectionStart;\n    }\n\n    if (typeof hints.endChanged === \"undefined\") {\n      hints.endChanged = !!hints.connectionEnd;\n    }\n\n    return getLabelAdjustment(label, newWaypoints, oldWaypoints, hints);\n  }\n\n  this.postExecute(\n    [\"connection.layout\", \"connection.updateWaypoints\"],\n    function (event) {\n      let context = event.context,\n        hints = context.hints || {};\n\n      if (hints.labelBehavior === false) {\n        return;\n      }\n\n      let connection = context.connection,\n        label = connection.label,\n        labelAdjustment;\n\n      // handle missing label as well as the case\n      // that the label parent does not exist (yet),\n      // because it is being pasted / created via multi element create\n      //\n      // Cf. https://github.com/bpmn-io/bpmn-js/pull/1227\n      if (!label || !label.parent) {\n        return;\n      }\n\n      labelAdjustment = getVisibleLabelAdjustment(event);\n\n      modeling.moveShape(label, labelAdjustment);\n    }\n  );\n\n  // keep label position on shape replace\n  this.postExecute([\"shape.replace\"], function (event) {\n    let context = event.context,\n      newShape = context.newShape,\n      oldShape = context.oldShape;\n\n    let businessObject = getBusinessObject(newShape);\n\n    if (\n      businessObject &&\n      isLabelExternal(businessObject) &&\n      oldShape.label &&\n      newShape.label\n    ) {\n      newShape.label.x = oldShape.label.x;\n      newShape.label.y = oldShape.label.y;\n    }\n  });\n\n  // move external label after resizing\n  this.postExecute(\"shape.resize\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      newBounds = context.newBounds,\n      oldBounds = context.oldBounds;\n\n    if (hasExternalLabel(shape)) {\n      let label = shape.label,\n        labelMid = getMid(label),\n        edges = asEdges(oldBounds);\n\n      // get nearest border point to label as reference point\n      let referencePoint = getReferencePoint(labelMid, edges);\n\n      let delta = getReferencePointDelta(referencePoint, oldBounds, newBounds);\n\n      modeling.moveShape(label, delta);\n    }\n  });\n}\n\ninherits(LabelBehavior, CommandInterceptor);\n\nLabelBehavior.$inject = [\"eventBus\", \"modeling\", \"bpmnFactory\", \"textRenderer\"];\n\n// helpers //////////////////////\n\n/**\n * Calculates a reference point delta relative to a new position\n * of a certain element's bounds\n *\n * @param {Point} point\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @return {Delta} delta\n */\nexport function getReferencePointDelta(referencePoint, oldBounds, newBounds) {\n  let newReferencePoint = getNewAttachPoint(\n    referencePoint,\n    oldBounds,\n    newBounds\n  );\n\n  return roundPoint(delta(newReferencePoint, referencePoint));\n}\n\n/**\n * Generates the nearest point (reference point) for a given point\n * onto given set of lines\n *\n * @param {Array<Point, Point>} lines\n * @param {Point} point\n *\n * @param {Point}\n */\nexport function getReferencePoint(point, lines) {\n  if (!lines.length) {\n    return;\n  }\n\n  let nearestLine = getNearestLine(point, lines);\n\n  return perpendicularFoot(point, nearestLine);\n}\n\n/**\n * Convert the given bounds to a lines array containing all edges\n *\n * @param {Bounds|Point} bounds\n *\n * @return Array<Point>\n */\nexport function asEdges(bounds) {\n  return [\n    [\n      // top\n      {\n        x: bounds.x,\n        y: bounds.y,\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y,\n      },\n    ],\n    [\n      // right\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y,\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0),\n      },\n    ],\n    [\n      // bottom\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0),\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0),\n      },\n    ],\n    [\n      // left\n      {\n        x: bounds.x,\n        y: bounds.y,\n      },\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0),\n      },\n    ],\n  ];\n}\n\n/**\n * Returns the nearest line for a given point by distance\n * @param {Point} point\n * @param Array<Point> lines\n *\n * @return Array<Point>\n */\nfunction getNearestLine(point, lines) {\n  let distances = lines.map(function (l) {\n    return {\n      line: l,\n      distance: getDistancePointLine(point, l),\n    };\n  });\n\n  let sorted = sortBy(distances, \"distance\");\n\n  return sorted[0].line;\n}\n","import { is } from \"../../../util/ModelUtil\";\n\nlet COLLAB_ERR_MSG = \"flow elements must be children of pools/participants\",\n  PROCESS_ERR_MSG =\n    \"participants cannot be pasted onto a non-empty process diagram\";\n\nexport default function ModelingFeedback(eventBus, tooltips, translate) {\n  function showError(position, message, timeout) {\n    tooltips.add({\n      position: {\n        x: position.x + 5,\n        y: position.y + 5,\n      },\n      type: \"error\",\n      timeout: timeout || 2000,\n      html: \"<div>\" + message + \"</div>\",\n    });\n  }\n\n  eventBus.on([\"shape.move.rejected\", \"create.rejected\"], function (event) {\n    let context = event.context,\n      shape = context.shape,\n      target = context.target;\n\n    if (is(target, \"bpmn:Collaboration\") && is(shape, \"bpmn:FlowNode\")) {\n      showError(event, translate(COLLAB_ERR_MSG));\n    }\n  });\n\n  eventBus.on([\"elements.paste.rejected\"], function (event) {\n    let context = event.context,\n      position = context.position,\n      target = context.target;\n\n    if (is(target, \"bpmn:Collaboration\")) {\n      showError(position, translate(COLLAB_ERR_MSG));\n    }\n\n    if (is(target, \"bpmn:Process-action\")) {\n      showError(position, translate(PROCESS_ERR_MSG), 3000);\n    }\n  });\n}\n\nModelingFeedback.$inject = [\"eventBus\", \"tooltips\", \"translate\"];\n","import { forEach, find, matchPattern } from \"min-dash\";\n\nimport inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nexport default function ReplaceConnectionBehavior(\n  eventBus,\n  modeling,\n  bpmnRules,\n  injector\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  let dragging = injector.get(\"dragging\", false);\n\n  function fixConnection(connection) {\n    let source = connection.source,\n      target = connection.target,\n      parent = connection.parent;\n\n    // do not do anything if connection\n    // is already deleted (may happen due to other\n    // behaviors plugged-in before)\n    if (!parent) {\n      return;\n    }\n\n    let replacementType, remove;\n\n    /**\n     * Check if incoming or outgoing connections\n     * can stay or could be substituted with an\n     * appropriate replacement.\n     *\n     * This holds true for SequenceFlow <> MessageFlow.\n     */\n\n    if (is(connection, \"bpmn:SequenceFlow\")) {\n      if (!bpmnRules.canConnectSequenceFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectMessageFlow(source, target)) {\n        replacementType = \"bpmn:MessageFlow\";\n      }\n    }\n\n    // transform message flows into sequence flows, if possible\n\n    if (is(connection, \"bpmn:MessageFlow\")) {\n      if (!bpmnRules.canConnectMessageFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectSequenceFlow(source, target)) {\n        replacementType = \"bpmn:SequenceFlow\";\n      }\n    }\n\n    if (\n      is(connection, \"bpmn:Association\") &&\n      !bpmnRules.canConnectAssociation(source, target)\n    ) {\n      remove = true;\n    }\n\n    // remove invalid connection,\n    // unless it has been removed already\n    if (remove) {\n      modeling.removeConnection(connection);\n    }\n\n    // replace SequenceFlow <> MessageFlow\n\n    if (replacementType) {\n      modeling.connect(source, target, {\n        type: replacementType,\n        waypoints: connection.waypoints.slice(),\n      });\n    }\n  }\n\n  function replaceReconnectedConnection(event) {\n    let context = event.context,\n      connection = context.connection,\n      source = context.newSource || connection.source,\n      target = context.newTarget || connection.target,\n      allowed,\n      replacement;\n\n    allowed = bpmnRules.canConnect(source, target);\n\n    if (!allowed || allowed.type === connection.type) {\n      return;\n    }\n\n    replacement = modeling.connect(source, target, {\n      type: allowed.type,\n      waypoints: connection.waypoints.slice(),\n    });\n\n    // remove old connection\n    modeling.removeConnection(connection);\n\n    // replace connection in context to reconnect end/start\n    context.connection = replacement;\n\n    if (dragging) {\n      cleanDraggingSelection(connection, replacement);\n    }\n  }\n\n  // monkey-patch selection saved in dragging in order to re-select it when operation is finished\n  function cleanDraggingSelection(oldConnection, newConnection) {\n    let context = dragging.context(),\n      previousSelection = context && context.payload.previousSelection,\n      index;\n\n    // do nothing if not dragging or no selection was present\n    if (!previousSelection || !previousSelection.length) {\n      return;\n    }\n\n    index = previousSelection.indexOf(oldConnection);\n\n    if (index === -1) {\n      return;\n    }\n\n    previousSelection.splice(index, 1, newConnection);\n  }\n\n  // lifecycle hooks\n\n  this.postExecuted(\n    \"elements.move\",\n    function (context) {\n      let closure = context.closure,\n        allConnections = closure.allConnections;\n\n      forEach(allConnections, fixConnection);\n    },\n    true\n  );\n\n  this.preExecute(\"connection.reconnect\", replaceReconnectedConnection);\n\n  this.postExecuted(\"element.updateProperties\", function (event) {\n    let context = event.context,\n      properties = context.properties,\n      element = context.element,\n      businessObject = element.businessObject,\n      connection;\n\n    // remove condition on change to default\n    if (properties.default) {\n      connection = find(\n        element.outgoing,\n        matchPattern({ id: element.businessObject.default.id })\n      );\n\n      if (connection) {\n        modeling.updateProperties(connection, {\n          conditionExpression: undefined,\n        });\n      }\n    }\n\n    // remove default from source on change to conditional\n    if (\n      properties.conditionExpression &&\n      businessObject.sourceRef.default === businessObject\n    ) {\n      modeling.updateProperties(element.source, { default: undefined });\n    }\n  });\n}\n\ninherits(ReplaceConnectionBehavior, CommandInterceptor);\n\nReplaceConnectionBehavior.$inject = [\n  \"eventBus\",\n  \"modeling\",\n  \"bpmnRules\",\n  \"injector\",\n];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\n/**\n * BPMN specific remove behavior\n */\nexport default function RemoveParticipantBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * morph collaboration diagram into process diagram\n   * after the last participant has been removed\n   */\n\n  this.preExecute(\n    \"shape.delete\",\n    function (context) {\n      let shape = context.shape,\n        parent = shape.parent;\n\n      // activate the behavior if the shape to be removed\n      // is a participant\n      if (is(shape, \"bpmn:Participant\")) {\n        context.collaborationRoot = parent;\n      }\n    },\n    true\n  );\n\n  this.postExecute(\n    \"shape.delete\",\n    function (context) {\n      let collaborationRoot = context.collaborationRoot;\n\n      if (\n        collaborationRoot &&\n        !collaborationRoot.businessObject.participants.length\n      ) {\n        // replace empty collaboration with process diagram\n        modeling.makeProcess();\n      }\n    },\n    true\n  );\n}\n\nRemoveParticipantBehavior.$inject = [\"eventBus\", \"modeling\"];\n\ninherits(RemoveParticipantBehavior, CommandInterceptor);\n","import inherits from \"inherits\";\n\nimport { forEach } from \"min-dash\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { isEventLoop } from \"../../../util/DiUtil\";\n\n/**\n * BPMN-specific replace behavior.\n */\nexport default function ReplaceElementBehaviour(\n  bpmnReplace,\n  bpmnRules,\n  elementRegistry,\n  injector,\n  modeling,\n  selection\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n  this._elementRegistry = elementRegistry;\n  this._selection = selection;\n\n  // replace elements on move\n  this.postExecuted(\n    [\"elements.move\"],\n    500,\n    function (event) {\n      let context = event.context,\n        target = context.newParent,\n        newHost = context.newHost,\n        elements = [];\n\n      forEach(context.closure.topLevel, function (topLevelElements) {\n        if (isEventLoop(topLevelElements)) {\n          elements = elements.concat(topLevelElements.children);\n        } else {\n          elements = elements.concat(topLevelElements);\n        }\n      });\n\n      // set target to host if attaching\n      if (elements.length === 1 && newHost) {\n        target = newHost;\n      }\n\n      let canReplace = bpmnRules.canReplace(elements, target);\n\n      if (canReplace) {\n        this.replaceElements(elements, canReplace.replacements, newHost);\n      }\n    },\n    this\n  );\n\n  // update attachments on host replace\n  this.postExecute(\n    [\"shape.replace\"],\n    1500,\n    function (e) {\n      let context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape,\n        attachers = oldShape.attachers,\n        canReplace;\n\n      if (attachers && attachers.length) {\n        canReplace = bpmnRules.canReplace(attachers, newShape);\n\n        this.replaceElements(attachers, canReplace.replacements);\n      }\n    },\n    this\n  );\n\n  // keep ID on shape replace\n  this.postExecuted([\"shape.replace\"], 1500, function (e) {\n    let context = e.context,\n      oldShape = context.oldShape,\n      newShape = context.newShape;\n\n    modeling.unclaimId(oldShape.businessObject.id, oldShape.businessObject);\n    modeling.updateProperties(newShape, { id: oldShape.id });\n  });\n}\n\ninherits(ReplaceElementBehaviour, CommandInterceptor);\n\nReplaceElementBehaviour.prototype.replaceElements = function (\n  elements,\n  newElements\n) {\n  let elementRegistry = this._elementRegistry,\n    bpmnReplace = this._bpmnReplace,\n    selection = this._selection;\n\n  forEach(newElements, function (replacement) {\n    let newElement = {\n      type: replacement.newElementType,\n    };\n\n    let oldElement = elementRegistry.get(replacement.oldElementId);\n\n    let idx = elements.indexOf(oldElement);\n\n    elements[idx] = bpmnReplace.replaceElement(oldElement, newElement, {\n      select: false,\n    });\n  });\n\n  if (newElements) {\n    selection.select(elements);\n  }\n};\n\nReplaceElementBehaviour.$inject = [\n  \"bpmnReplace\",\n  \"bpmnRules\",\n  \"elementRegistry\",\n  \"injector\",\n  \"modeling\",\n  \"selection\",\n];\n","import { is } from \"../../../../util/ModelUtil\";\n\nimport { asTRBL } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { collectLanes, getLanesRoot } from \"../../util/LaneUtil\";\n\nlet abs = Math.abs,\n  min = Math.min,\n  max = Math.max;\n\nfunction addToTrbl(trbl, attr, value, choice) {\n  let current = trbl[attr];\n\n  // make sure to set the value if it does not exist\n  // or apply the correct value by comparing against\n  // choice(value, currentValue)\n  trbl[attr] = current === undefined ? value : choice(value, current);\n}\n\nfunction addMin(trbl, attr, value) {\n  return addToTrbl(trbl, attr, value, min);\n}\n\nfunction addMax(trbl, attr, value) {\n  return addToTrbl(trbl, attr, value, max);\n}\n\nlet LANE_MIN_HEIGHT = 60,\n  LANE_MIN_WIDTH = 300,\n  LANE_RIGHT_PADDING = 20,\n  LANE_LEFT_PADDING = 50,\n  LANE_TOP_PADDING = 20,\n  LANE_BOTTOM_PADDING = 20;\n\nexport function getParticipantResizeConstraints(\n  laneShape,\n  resizeDirection,\n  balanced\n) {\n  let lanesRoot = getLanesRoot(laneShape);\n\n  let isFirst = true,\n    isLast = true;\n\n  // max top/bottom size for lanes\n  let allLanes = collectLanes(lanesRoot, [lanesRoot]);\n\n  let laneTrbl = asTRBL(laneShape);\n\n  let maxTrbl = {},\n    minTrbl = {};\n\n  if (/e/.test(resizeDirection)) {\n    minTrbl.right = laneTrbl.left + LANE_MIN_WIDTH;\n  } else if (/w/.test(resizeDirection)) {\n    minTrbl.left = laneTrbl.right - LANE_MIN_WIDTH;\n  }\n\n  allLanes.forEach(function (other) {\n    let otherTrbl = asTRBL(other);\n\n    if (/n/.test(resizeDirection)) {\n      if (otherTrbl.top < laneTrbl.top - 10) {\n        isFirst = false;\n      }\n\n      // max top size (based on next element)\n      if (balanced && abs(laneTrbl.top - otherTrbl.bottom) < 10) {\n        addMax(maxTrbl, \"top\", otherTrbl.top + LANE_MIN_HEIGHT);\n      }\n\n      // min top size (based on self or nested element)\n      if (abs(laneTrbl.top - otherTrbl.top) < 5) {\n        addMin(minTrbl, \"top\", otherTrbl.bottom - LANE_MIN_HEIGHT);\n      }\n    }\n\n    if (/s/.test(resizeDirection)) {\n      if (otherTrbl.bottom > laneTrbl.bottom + 10) {\n        isLast = false;\n      }\n\n      // max bottom size (based on previous element)\n      if (balanced && abs(laneTrbl.bottom - otherTrbl.top) < 10) {\n        addMin(maxTrbl, \"bottom\", otherTrbl.bottom - LANE_MIN_HEIGHT);\n      }\n\n      // min bottom size (based on self or nested element)\n      if (abs(laneTrbl.bottom - otherTrbl.bottom) < 5) {\n        addMax(minTrbl, \"bottom\", otherTrbl.top + LANE_MIN_HEIGHT);\n      }\n    }\n  });\n\n  // max top/bottom/left/right size based on flow nodes\n  let flowElements = lanesRoot.children.filter(function (s) {\n    return (\n      !s.hidden &&\n      !s.waypoints &&\n      (is(s, \"bpmn:FlowElement\") || is(s, \"bpmn:Artifact\"))\n    );\n  });\n\n  flowElements.forEach(function (flowElement) {\n    let flowElementTrbl = asTRBL(flowElement);\n\n    if (isFirst && /n/.test(resizeDirection)) {\n      addMin(minTrbl, \"top\", flowElementTrbl.top - LANE_TOP_PADDING);\n    }\n\n    if (/e/.test(resizeDirection)) {\n      addMax(minTrbl, \"right\", flowElementTrbl.right + LANE_RIGHT_PADDING);\n    }\n\n    if (isLast && /s/.test(resizeDirection)) {\n      addMax(minTrbl, \"bottom\", flowElementTrbl.bottom + LANE_BOTTOM_PADDING);\n    }\n\n    if (/w/.test(resizeDirection)) {\n      addMin(minTrbl, \"left\", flowElementTrbl.left - LANE_LEFT_PADDING);\n    }\n  });\n\n  return {\n    min: minTrbl,\n    max: maxTrbl,\n  };\n}\n","import { is } from \"../../../util/ModelUtil\";\n\nimport { isExpanded } from \"../../../util/DiUtil\";\n\nimport { getParticipantResizeConstraints } from \"./util/ResizeUtil\";\n\nconst HIGH_PRIORITY = 1500;\n\nexport const PARTICIPANT_MIN_DIMENSIONS = { width: 300, height: 150 };\n\nexport const SUB_PROCESS_MIN_DIMENSIONS = { width: 140, height: 120 };\n\nexport const TEXT_ANNOTATION_MIN_DIMENSIONS = { width: 50, height: 30 };\n\n/**\n * Set minimum bounds/resize constraints on resize.\n *\n * @param {EventBus} eventBus\n */\nexport default function ResizeBehavior(eventBus) {\n  eventBus.on(\"resize.start\", HIGH_PRIORITY, function (event) {\n    let context = event.context,\n      shape = context.shape,\n      direction = context.direction,\n      balanced = context.balanced;\n\n    if (is(shape, \"bpmn:Lane\") || is(shape, \"bpmn:Participant\")) {\n      context.resizeConstraints = getParticipantResizeConstraints(\n        shape,\n        direction,\n        balanced\n      );\n    }\n\n    if (is(shape, \"bpmn:Participant\")) {\n      context.minDimensions = PARTICIPANT_MIN_DIMENSIONS;\n    }\n\n    if (is(shape, \"bpmn:Loop\") && isExpanded(shape)) {\n      context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\n    }\n\n    if (is(shape, \"bpmn:Conditional\") && isExpanded(shape)) {\n      context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\n    }\n\n    if (is(shape, \"bpmn:TextAnnotation\")) {\n      context.minDimensions = TEXT_ANNOTATION_MIN_DIMENSIONS;\n    }\n  });\n}\n\nResizeBehavior.$inject = [\"eventBus\"];\n","import { is } from \"../../../util/ModelUtil\";\n\nimport { roundBounds } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { hasPrimaryModifier } from \"diagram-js/lib/util/Mouse\";\n\nconst SLIGHTLY_HIGHER_PRIORITY = 1001;\n\n/**\n * Invoke {@link Modeling#resizeLane} instead of\n * {@link Modeling#resizeShape} when resizing a Lane\n * or Participant shape.\n */\nexport default function ResizeLaneBehavior(eventBus, modeling) {\n  eventBus.on(\"resize.start\", SLIGHTLY_HIGHER_PRIORITY + 500, function (event) {\n    let context = event.context,\n      shape = context.shape;\n\n    if (is(shape, \"bpmn:Lane\") || is(shape, \"bpmn:Participant\")) {\n      // should we resize the opposite lane(s) in\n      // order to compensate for the resize operation?\n      context.balanced = !hasPrimaryModifier(event);\n    }\n  });\n\n  /**\n   * Intercept resize end and call resize lane function instead.\n   */\n  eventBus.on(\"resize.end\", SLIGHTLY_HIGHER_PRIORITY, function (event) {\n    let context = event.context,\n      shape = context.shape,\n      canExecute = context.canExecute,\n      newBounds = context.newBounds;\n\n    if (is(shape, \"bpmn:Lane\") || is(shape, \"bpmn:Participant\")) {\n      if (canExecute) {\n        // ensure we have actual pixel values for new bounds\n        // (important when zoom level was > 1 during move)\n        newBounds = roundBounds(newBounds);\n\n        // perform the actual resize\n        modeling.resizeLane(shape, newBounds, context.balanced);\n      }\n\n      // stop propagation\n      return false;\n    }\n  });\n}\n\nResizeLaneBehavior.$inject = [\"eventBus\", \"modeling\"];\n","import inherits from \"inherits\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport lineIntersect from \"./util/LineIntersect\";\n\nexport default function RemoveElementBehavior(eventBus, bpmnRules, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Combine sequence flows when deleting an element\n   * if there is one incoming and one outgoing\n   * sequence flow\n   */\n  this.preExecute(\"shape.delete\", function (e) {\n    let shape = e.context.shape;\n\n    // only handle [a] -> [shape] -> [b] patterns\n    if (shape.incoming.length !== 1 || shape.outgoing.length !== 1) {\n      return;\n    }\n\n    let inConnection = shape.incoming[0],\n      outConnection = shape.outgoing[0];\n\n    // only handle sequence flows\n    if (\n      !is(inConnection, \"bpmn:SequenceFlow\") ||\n      !is(outConnection, \"bpmn:SequenceFlow\")\n    ) {\n      return;\n    }\n\n    if (\n      bpmnRules.canConnect(\n        inConnection.source,\n        outConnection.target,\n        inConnection\n      )\n    ) {\n      // compute new, combined waypoints\n      let newWaypoints = getNewWaypoints(\n        inConnection.waypoints,\n        outConnection.waypoints\n      );\n\n      modeling.reconnectEnd(inConnection, outConnection.target, newWaypoints);\n    }\n  });\n}\n\ninherits(RemoveElementBehavior, CommandInterceptor);\n\nRemoveElementBehavior.$inject = [\"eventBus\", \"bpmnRules\", \"modeling\"];\n\n// helpers //////////////////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}\n\nfunction getNewWaypoints(inWaypoints, outWaypoints) {\n  let intersection = lineIntersect(\n    getDocking(inWaypoints[inWaypoints.length - 2]),\n    getDocking(inWaypoints[inWaypoints.length - 1]),\n    getDocking(outWaypoints[1]),\n    getDocking(outWaypoints[0])\n  );\n\n  if (intersection) {\n    return [].concat(\n      inWaypoints.slice(0, inWaypoints.length - 1),\n      [intersection],\n      outWaypoints.slice(1)\n    );\n  } else {\n    return [\n      getDocking(inWaypoints[0]),\n      getDocking(outWaypoints[outWaypoints.length - 1]),\n    ];\n  }\n}\n","import { forEach } from \"min-dash\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport { isExpanded } from \"../../../util/DiUtil\";\n\nimport {\n  PARTICIPANT_MIN_DIMENSIONS,\n  SUB_PROCESS_MIN_DIMENSIONS,\n  TEXT_ANNOTATION_MIN_DIMENSIONS,\n} from \"./ResizeBehavior\";\n\nexport default function SpaceToolBehavior(eventBus) {\n  eventBus.on(\"spaceTool.getMinDimensions\", function (context) {\n    let shapes = context.shapes,\n      minDimensions = {};\n\n    forEach(shapes, function (shape) {\n      let id = shape.id;\n\n      if (is(shape, \"bpmn:Participant\")) {\n        minDimensions[id] = PARTICIPANT_MIN_DIMENSIONS;\n      }\n\n      if (is(shape, \"bpmn:Loop\") && isExpanded(shape)) {\n        minDimensions[id] = SUB_PROCESS_MIN_DIMENSIONS;\n      }\n\n      if (is(shape, \"bpmn:Conditional\") && isExpanded(shape)) {\n        context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\n      }\n      if (is(shape, \"bpmn:TextAnnotation\")) {\n        minDimensions[id] = TEXT_ANNOTATION_MIN_DIMENSIONS;\n      }\n    });\n\n    return minDimensions;\n  });\n}\n\nSpaceToolBehavior.$inject = [\"eventBus\"];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\nimport { isExpanded } from \"../../../util/DiUtil.js\";\n\n/**\n * Add start event replacing element with expanded sub process.\n *\n * @param {Injector} injector\n * @param {Modeling} modeling\n */\nexport default function SubProcessStartEventBehavior(injector, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.postExecuted(\"shape.replace\", function (event) {\n    let oldShape = event.context.oldShape,\n      newShape = event.context.newShape;\n\n    if (\n      !is(newShape, \"bpmn:Loop\") ||\n      !is(newShape, \"bpmn:Conditional\") ||\n      !is(oldShape, \"bpmn:Task\") ||\n      !isExpanded(newShape)\n    ) {\n      return;\n    }\n\n    let position = getStartEventPosition(newShape);\n\n    modeling.createShape({ type: \"bpmn:StartEvent\" }, position, newShape);\n  });\n}\n\nSubProcessStartEventBehavior.$inject = [\"injector\", \"modeling\"];\n\ninherits(SubProcessStartEventBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getStartEventPosition(shape) {\n  return {\n    x: shape.x + shape.width / 6,\n    y: shape.y + shape.height / 2,\n  };\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getBusinessObject, is } from \"../../../util/ModelUtil\";\n\nimport { computeChildrenBBox } from \"diagram-js/lib/features/resize/ResizeUtil\";\n\nconst LOW_PRIORITY = 500;\n\nexport default function ToggleElementCollapseBehaviour(\n  eventBus,\n  elementFactory,\n  modeling,\n  resize\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  function hideEmptyLabels(children) {\n    if (children.length) {\n      children.forEach(function (child) {\n        if (child.type === \"label\" && !child.businessObject.name) {\n          child.hidden = true;\n        }\n      });\n    }\n  }\n\n  function expandedBounds(shape, defaultSize) {\n    let children = shape.children,\n      newBounds = defaultSize,\n      visibleElements,\n      visibleBBox;\n\n    visibleElements = filterVisible(children).concat([shape]);\n\n    visibleBBox = computeChildrenBBox(visibleElements);\n\n    if (visibleBBox) {\n      // center to visibleBBox with max(defaultSize, childrenBounds)\n      newBounds.width = Math.max(visibleBBox.width, newBounds.width);\n      newBounds.height = Math.max(visibleBBox.height, newBounds.height);\n\n      newBounds.x = visibleBBox.x + (visibleBBox.width - newBounds.width) / 2;\n      newBounds.y = visibleBBox.y + (visibleBBox.height - newBounds.height) / 2;\n    } else {\n      // center to collapsed shape with defaultSize\n      newBounds.x = shape.x + (shape.width - newBounds.width) / 2;\n      newBounds.y = shape.y + (shape.height - newBounds.height) / 2;\n    }\n\n    return newBounds;\n  }\n\n  function collapsedBounds(shape, defaultSize) {\n    return {\n      x: shape.x + (shape.width - defaultSize.width) / 2,\n      y: shape.y + (shape.height - defaultSize.height) / 2,\n      width: defaultSize.width,\n      height: defaultSize.height,\n    };\n  }\n\n  this.executed([\"shape.toggleCollapse\"], LOW_PRIORITY, function (e) {\n    let context = e.context,\n      shape = context.shape;\n\n    if (!is(shape, \"bpmn:Loop\")) {\n      return;\n    }\n\n    if (!shape.collapsed) {\n      // all children got made visible through djs, hide empty labels\n      hideEmptyLabels(shape.children);\n\n      // remove collapsed marker\n      getBusinessObject(shape).di.isExpanded = true;\n    } else {\n      // place collapsed marker\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.reverted([\"shape.toggleCollapse\"], LOW_PRIORITY, function (e) {\n    let context = e.context;\n    let shape = context.shape;\n\n    // revert removing/placing collapsed marker\n    if (!shape.collapsed) {\n      getBusinessObject(shape).di.isExpanded = true;\n    } else {\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.postExecuted([\"shape.toggleCollapse\"], LOW_PRIORITY, function (e) {\n    let shape = e.context.shape,\n      defaultSize = elementFactory._getDefaultSize(shape),\n      newBounds;\n\n    if (shape.collapsed) {\n      // resize to default size of collapsed shapes\n      newBounds = collapsedBounds(shape, defaultSize);\n    } else {\n      // resize to bounds of max(visible children, defaultSize)\n      newBounds = expandedBounds(shape, defaultSize);\n    }\n\n    modeling.resizeShape(shape, newBounds, null, {\n      autoResize: shape.collapsed ? false : \"nwse\",\n    });\n  });\n}\n\ninherits(ToggleElementCollapseBehaviour, CommandInterceptor);\n\nToggleElementCollapseBehaviour.$inject = [\n  \"eventBus\",\n  \"elementFactory\",\n  \"modeling\",\n];\n\n// helpers //////////////////////\n\nfunction filterVisible(elements) {\n  return elements.filter(function (e) {\n    return !e.hidden;\n  });\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\nimport { isExpanded } from \"../../../util/DiUtil\";\nimport { isLabel } from \"../../../util/LabelUtil\";\n\n/**\n * Unclaims model IDs on element deletion.\n *\n * @param {Canvas} canvas\n * @param {Injector} injector\n * @param {Moddle} moddle\n * @param {Modeling} modeling\n */\nexport default function UnclaimIdBehavior(canvas, injector, moddle, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute(\"shape.delete\", function (event) {\n    let context = event.context,\n      shape = context.shape,\n      shapeBo = shape.businessObject;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (is(shape, \"bpmn:Participant\") && isExpanded(shape)) {\n      moddle.ids.unclaim(shapeBo.processRef.id);\n    }\n\n    modeling.unclaimId(shapeBo.id, shapeBo);\n  });\n\n  this.preExecute(\"connection.delete\", function (event) {\n    let context = event.context,\n      connection = context.connection,\n      connectionBo = connection.businessObject;\n\n    modeling.unclaimId(connectionBo.id, connectionBo);\n  });\n\n  this.preExecute(\"canvas.updateRoot\", function () {\n    let rootElement = canvas.getRootElement(),\n      rootElementBo = rootElement.businessObject;\n\n    moddle.ids.unclaim(rootElementBo.id);\n  });\n}\n\ninherits(UnclaimIdBehavior, CommandInterceptor);\n\nUnclaimIdBehavior.$inject = [\"canvas\", \"injector\", \"moddle\", \"modeling\"];\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nconst LOW_PRIORITY = 500,\n  HIGH_PRIORITY = 5000;\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function UpdateFlowNodeRefsBehavior(\n  eventBus,\n  modeling,\n  translate\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Ok, this is it:\n   *\n   * We have to update the Lane#flowNodeRefs _and_\n   * FlowNode#lanes with every FlowNode move/resize and\n   * Lane move/resize.\n   *\n   * We want to group that stuff to recompute containments\n   * as efficient as possible.\n   *\n   * Yea!\n   */\n\n  // the update context\n  let context;\n\n  function initContext() {\n    context = context || new UpdateContext();\n    context.enter();\n\n    return context;\n  }\n\n  function getContext() {\n    if (!context) {\n      throw new Error(translate(\"out of bounds release\"));\n    }\n\n    return context;\n  }\n\n  function releaseContext() {\n    if (!context) {\n      throw new Error(translate(\"out of bounds release\"));\n    }\n\n    let triggerUpdate = context.leave();\n\n    if (triggerUpdate) {\n      modeling.updateLaneRefs(context.flowNodes, context.lanes);\n\n      context = null;\n    }\n\n    return triggerUpdate;\n  }\n\n  let laneRefUpdateEvents = [\n    \"spaceTool\",\n    \"lane.add\",\n    \"lane.resize\",\n    \"lane.split\",\n    \"elements.create\",\n    \"elements.delete\",\n    \"elements.move\",\n    \"shape.create\",\n    \"shape.delete\",\n    \"shape.move\",\n    \"shape.resize\",\n  ];\n\n  // listen to a lot of stuff to group lane updates\n\n  this.preExecute(laneRefUpdateEvents, HIGH_PRIORITY, function (event) {\n    initContext();\n  });\n\n  this.postExecuted(laneRefUpdateEvents, LOW_PRIORITY, function (event) {\n    releaseContext();\n  });\n\n  // Mark flow nodes + lanes that need an update\n\n  this.preExecute(\n    [\"shape.create\", \"shape.move\", \"shape.delete\", \"shape.resize\"],\n    function (event) {\n      let context = event.context,\n        shape = context.shape;\n\n      let updateContext = getContext();\n\n      // no need to update labels\n      if (shape.labelTarget) {\n        return;\n      }\n\n      if (is(shape, \"bpmn:Lane\")) {\n        updateContext.addLane(shape);\n      }\n\n      if (is(shape, \"bpmn:FlowNode\")) {\n        updateContext.addFlowNode(shape);\n      }\n    }\n  );\n}\n\nUpdateFlowNodeRefsBehavior.$inject = [\"eventBus\", \"modeling\", \"translate\"];\n\ninherits(UpdateFlowNodeRefsBehavior, CommandInterceptor);\n\nfunction UpdateContext() {\n  this.flowNodes = [];\n  this.lanes = [];\n\n  this.counter = 0;\n\n  this.addLane = function (lane) {\n    this.lanes.push(lane);\n  };\n\n  this.addFlowNode = function (flowNode) {\n    this.flowNodes.push(flowNode);\n  };\n\n  this.enter = function () {\n    this.counter++;\n  };\n\n  this.leave = function () {\n    this.counter--;\n\n    return !this.counter;\n  };\n}\n","import inherits from \"inherits\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport { getBusinessObject, is } from \"../../../util/ModelUtil\";\n\n/**\n * A behavior that unsets the Default property of\n * sequence flow source on element delete, if the\n * removed element is the Gateway or Task's default flow.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function DeleteSequenceFlowBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute(\"connection.delete\", function (event) {\n    let context = event.context,\n      connection = context.connection,\n      source = connection.source;\n\n    if (isDefaultFlow(connection, source)) {\n      modeling.updateProperties(source, {\n        default: null,\n      });\n    }\n  });\n}\n\ninherits(DeleteSequenceFlowBehavior, CommandInterceptor);\n\nDeleteSequenceFlowBehavior.$inject = [\"eventBus\", \"modeling\"];\n\n// helpers //////////////////////\n\nfunction isDefaultFlow(connection, source) {\n  if (!is(connection, \"bpmn:SequenceFlow\")) {\n    return false;\n  }\n\n  let sourceBo = getBusinessObject(source),\n    sequenceFlow = getBusinessObject(connection);\n\n  return sourceBo.get(\"default\") === sequenceFlow;\n}\n","import AdaptiveLabelPositioningBehavior from \"./AdaptiveLabelPositioningBehavior\";\nimport AppendBehavior from \"./AppendBehavior\";\nimport AssociationBehavior from \"./AssociationBehavior\";\nimport AttachEventBehavior from \"./AttachEventBehavior\";\nimport BoundaryEventBehavior from \"./BoundaryEventBehavior\";\nimport RootElementReferenceBehavior from \"./RootElementReferenceBehavior\";\nimport CreateBehavior from \"./CreateBehavior\";\nimport FixHoverBehavior from \"./FixHoverBehavior\";\nimport CreateDataObjectBehavior from \"./CreateDataObjectBehavior\";\nimport CreateParticipantBehavior from \"./CreateParticipantBehavior\";\nimport DataInputAssociationBehavior from \"./DataInputAssociationBehavior\";\nimport DataStoreBehavior from \"./DataStoreBehavior\";\nimport DeleteLaneBehavior from \"./DeleteLaneBehavior\";\nimport DetachEventBehavior from \"./DetachEventBehavior\";\nimport DropOnFlowBehavior from \"./DropOnFlowBehavior\";\nimport EventBasedGatewayBehavior from \"./EventBasedGatewayBehavior\";\nimport GroupBehavior from \"./GroupBehavior\";\nimport ImportDockingFix from \"./ImportDockingFix\";\nimport IsHorizontalFix from \"./IsHorizontalFix\";\nimport LabelBehavior from \"./LabelBehavior\";\nimport ModelingFeedback from \"./ModelingFeedback\";\nimport ReplaceConnectionBehavior from \"./ReplaceConnectionBehavior\";\nimport RemoveParticipantBehavior from \"./RemoveParticipantBehavior\";\nimport ReplaceElementBehaviour from \"./ReplaceElementBehaviour\";\nimport ResizeBehavior from \"./ResizeBehavior\";\nimport ResizeLaneBehavior from \"./ResizeLaneBehavior\";\nimport RemoveElementBehavior from \"./RemoveElementBehavior\";\nimport SpaceToolBehavior from \"./SpaceToolBehavior\";\nimport SubProcessStartEventBehavior from \"./SubProcessStartEventBehavior\";\nimport ToggleElementCollapseBehaviour from \"./ToggleElementCollapseBehaviour\";\nimport UnclaimIdBehavior from \"./UnclaimIdBehavior\";\nimport UpdateFlowNodeRefsBehavior from \"./UpdateFlowNodeRefsBehavior\";\nimport UnsetDefaultFlowBehavior from \"./UnsetDefaultFlowBehavior\";\n\nexport default {\n  __init__: [\n    \"adaptiveLabelPositioningBehavior\",\n    \"appendBehavior\",\n    \"associationBehavior\",\n    \"attachEventBehavior\",\n    \"boundaryEventBehavior\",\n    \"rootElementReferenceBehavior\",\n    \"createBehavior\",\n    \"fixHoverBehavior\",\n    \"createDataObjectBehavior\",\n    \"createParticipantBehavior\",\n    \"dataStoreBehavior\",\n    \"dataInputAssociationBehavior\",\n    \"deleteLaneBehavior\",\n    \"detachEventBehavior\",\n    \"dropOnFlowBehavior\",\n    \"eventBasedGatewayBehavior\",\n    \"groupBehavior\",\n    \"importDockingFix\",\n    \"isHorizontalFix\",\n    \"labelBehavior\",\n    \"modelingFeedback\",\n    \"removeElementBehavior\",\n    \"removeParticipantBehavior\",\n    \"replaceConnectionBehavior\",\n    \"replaceElementBehaviour\",\n    \"resizeBehavior\",\n    \"resizeLaneBehavior\",\n    \"toggleElementCollapseBehaviour\",\n    \"spaceToolBehavior\",\n    \"subProcessStartEventBehavior\",\n    \"unclaimIdBehavior\",\n    \"unsetDefaultFlowBehavior\",\n    \"updateFlowNodeRefsBehavior\",\n  ],\n  adaptiveLabelPositioningBehavior: [\"type\", AdaptiveLabelPositioningBehavior],\n  appendBehavior: [\"type\", AppendBehavior],\n  associationBehavior: [\"type\", AssociationBehavior],\n  attachEventBehavior: [\"type\", AttachEventBehavior],\n  boundaryEventBehavior: [\"type\", BoundaryEventBehavior],\n  rootElementReferenceBehavior: [\"type\", RootElementReferenceBehavior],\n  createBehavior: [\"type\", CreateBehavior],\n  fixHoverBehavior: [\"type\", FixHoverBehavior],\n  createDataObjectBehavior: [\"type\", CreateDataObjectBehavior],\n  createParticipantBehavior: [\"type\", CreateParticipantBehavior],\n  dataInputAssociationBehavior: [\"type\", DataInputAssociationBehavior],\n  dataStoreBehavior: [\"type\", DataStoreBehavior],\n  deleteLaneBehavior: [\"type\", DeleteLaneBehavior],\n  detachEventBehavior: [\"type\", DetachEventBehavior],\n  dropOnFlowBehavior: [\"type\", DropOnFlowBehavior],\n  eventBasedGatewayBehavior: [\"type\", EventBasedGatewayBehavior],\n  groupBehavior: [\"type\", GroupBehavior],\n  importDockingFix: [\"type\", ImportDockingFix],\n  isHorizontalFix: [\"type\", IsHorizontalFix],\n  labelBehavior: [\"type\", LabelBehavior],\n  modelingFeedback: [\"type\", ModelingFeedback],\n  replaceConnectionBehavior: [\"type\", ReplaceConnectionBehavior],\n  removeParticipantBehavior: [\"type\", RemoveParticipantBehavior],\n  replaceElementBehaviour: [\"type\", ReplaceElementBehaviour],\n  resizeBehavior: [\"type\", ResizeBehavior],\n  resizeLaneBehavior: [\"type\", ResizeLaneBehavior],\n  removeElementBehavior: [\"type\", RemoveElementBehavior],\n  toggleElementCollapseBehaviour: [\"type\", ToggleElementCollapseBehaviour],\n  spaceToolBehavior: [\"type\", SpaceToolBehavior],\n  subProcessStartEventBehavior: [\"type\", SubProcessStartEventBehavior],\n  unclaimIdBehavior: [\"type\", UnclaimIdBehavior],\n  updateFlowNodeRefsBehavior: [\"type\", UpdateFlowNodeRefsBehavior],\n  unsetDefaultFlowBehavior: [\"type\", UnsetDefaultFlowBehavior],\n};\n","import { getOrientation } from \"diagram-js/lib/layout/LayoutUtil\";\n\nexport function getBoundaryAttachment(position, targetBounds) {\n  let orientation = getOrientation(position, targetBounds, -15);\n\n  if (orientation !== \"intersect\") {\n    return orientation;\n  } else {\n    return null;\n  }\n}\n","import { every, find, forEach, some } from \"min-dash\";\n\nimport inherits from \"inherits\";\n\nimport { is, getBusinessObject } from \"../../util/ModelUtil\";\n\nimport { getParent, isAny } from \"../modeling/util/ModelingUtil\";\n\nimport { isLabel } from \"../../util/LabelUtil\";\n\nimport {\n  isExpanded,\n  isEventLoop,\n  isInterrupting,\n  hasErrorEventDefinition,\n  hasEscalationEventDefinition,\n  hasCompensateEventDefinition,\n} from \"../../util/DiUtil\";\n\nimport RuleProvider from \"diagram-js/lib/features/rules/RuleProvider\";\n\nimport { getBoundaryAttachment as isBoundaryAttachment } from \"../snapping/BpmnSnappingUtil\";\n\n/**\n * BPMN specific modeling rule\n */\nexport default function BpmnRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(BpmnRules, RuleProvider);\n\nBpmnRules.$inject = [\"eventBus\"];\n\nBpmnRules.prototype.init = function () {\n  this.addRule(\"connection.start\", function (context) {\n    let source = context.source;\n\n    return canStartConnection(source);\n  });\n\n  this.addRule(\"connection.create\", function (context) {\n    let source = context.source,\n      target = context.target,\n      hints = context.hints || {},\n      targetParent = hints.targetParent,\n      targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // newly created boundary events\n    // to boundary events\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      return canConnect(source, target);\n    } finally {\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n  });\n\n  this.addRule(\"connection.reconnect\", function (context) {\n    let connection = context.connection,\n      source = context.source,\n      target = context.target;\n\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule(\"connection.updateWaypoints\", function (context) {\n    return {\n      type: context.connection.type,\n    };\n  });\n\n  this.addRule(\"shape.resize\", function (context) {\n    let shape = context.shape,\n      newBounds = context.newBounds;\n\n    return canResize(shape, newBounds);\n  });\n\n  this.addRule(\"elements.create\", function (context) {\n    let elements = context.elements,\n      position = context.position,\n      target = context.target;\n\n    return every(elements, function (element) {\n      if (isConnection(element)) {\n        return canConnect(element.source, element.target, element);\n      }\n\n      if (element.host) {\n        return canAttach(element, element.host, null, position);\n      }\n\n      return canCreate(element, target, null, position);\n    });\n  });\n\n  this.addRule(\"elements.move\", function (context) {\n    let target = context.target,\n      shapes = context.shapes,\n      position = context.position;\n\n    return (\n      canAttach(shapes, target, null, position) ||\n      canReplace(shapes, target, position) ||\n      canMove(shapes, target, position) ||\n      canInsert(shapes, target, position)\n    );\n  });\n\n  this.addRule(\"shape.create\", function (context) {\n    return canCreate(\n      context.shape,\n      context.target,\n      context.source,\n      context.position\n    );\n  });\n\n  this.addRule(\"shape.attach\", function (context) {\n    return canAttach(context.shape, context.target, null, context.position);\n  });\n\n  this.addRule(\"element.copy\", function (context) {\n    let element = context.element,\n      elements = context.elements;\n\n    return canCopy(elements, element);\n  });\n};\n\nBpmnRules.prototype.canConnectMessageFlow = canConnectMessageFlow;\n\nBpmnRules.prototype.canConnectSequenceFlow = canConnectSequenceFlow;\n\nBpmnRules.prototype.canConnectDataAssociation = canConnectDataAssociation;\n\nBpmnRules.prototype.canConnectAssociation = canConnectAssociation;\n\nBpmnRules.prototype.canMove = canMove;\n\nBpmnRules.prototype.canAttach = canAttach;\n\nBpmnRules.prototype.canReplace = canReplace;\n\nBpmnRules.prototype.canDrop = canDrop;\n\nBpmnRules.prototype.canInsert = canInsert;\n\nBpmnRules.prototype.canCreate = canCreate;\n\nBpmnRules.prototype.canConnect = canConnect;\n\nBpmnRules.prototype.canResize = canResize;\n\nBpmnRules.prototype.canCopy = canCopy;\n\n/**\n * Utility functions for rule checking\n */\n\n/**\n * Checks if given element can be used for starting connection.\n *\n * @param  {Element} source\n * @return {Boolean}\n */\nfunction canStartConnection(element) {\n  if (nonExistingOrLabel(element)) {\n    return null;\n  }\n\n  return isAny(element, [\n    \"bpmn:FlowNode\",\n    \"bpmn:InteractionNode\",\n    \"bpmn:DataObjectReference\",\n    \"bpmn:DataStoreReference\",\n  ]);\n}\n\nfunction nonExistingOrLabel(element) {\n  return !element || isLabel(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction getOrganizationalParent(element) {\n  do {\n    if (is(element, \"bpmn:Process-action\")) {\n      return getBusinessObject(element);\n    }\n\n    if (is(element, \"bpmn:Participant\")) {\n      return (\n        getBusinessObject(element).processRef || getBusinessObject(element)\n      );\n    }\n  } while ((element = element.parent));\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, \"bpmn:TextAnnotation\");\n}\n\nfunction isGroup(element) {\n  return is(element, \"bpmn:Group\") && !element.labelTarget;\n}\n\nfunction isCompensationBoundary(element) {\n  return (\n    is(element, \"bpmn:BoundaryEvent\") &&\n    hasEventDefinition(element, \"bpmn:CompensateEventDefinition\")\n  );\n}\n\nfunction isForCompensation(e) {\n  return getBusinessObject(e).isForCompensation;\n}\n\nfunction isSameOrganization(a, b) {\n  let parentA = getOrganizationalParent(a),\n    parentB = getOrganizationalParent(b);\n\n  return parentA === parentB;\n}\n\nfunction isMessageFlowSource(element) {\n  return (\n    is(element, \"bpmn:InteractionNode\") &&\n    (!is(element, \"bpmn:Event\") ||\n      (is(element, \"bpmn:ThrowEvent\") &&\n        hasEventDefinitionOrNone(element, \"bpmn:MessageEventDefinition\")))\n  );\n}\n\nfunction isMessageFlowTarget(element) {\n  return (\n    is(element, \"bpmn:InteractionNode\") &&\n    !isForCompensation(element) &&\n    (!is(element, \"bpmn:Event\") ||\n      (is(element, \"bpmn:CatchEvent\") &&\n        hasEventDefinitionOrNone(element, \"bpmn:MessageEventDefinition\")))\n  );\n}\n\nfunction getScopeParent(element) {\n  let parent = element;\n\n  while ((parent = parent.parent)) {\n    if (is(parent, \"bpmn:FlowElementsContainer\")) {\n      return getBusinessObject(parent);\n    }\n\n    if (is(parent, \"bpmn:Participant\")) {\n      return getBusinessObject(parent).processRef;\n    }\n  }\n\n  return null;\n}\n\nfunction isSameScope(a, b) {\n  let scopeParentA = getScopeParent(a),\n    scopeParentB = getScopeParent(b);\n\n  return scopeParentA === scopeParentB;\n}\n\nfunction hasEventDefinition(element, eventDefinition) {\n  let bo = getBusinessObject(element);\n\n  return !!find(bo.eventDefinitions || [], function (definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction hasEventDefinitionOrNone(element, eventDefinition) {\n  let bo = getBusinessObject(element);\n\n  return (bo.eventDefinitions || []).every(function (definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction isSequenceFlowSource(element) {\n  return (\n    is(element, \"bpmn:FlowNode\") &&\n    !is(element, \"bpmn:EndEvent\") &&\n    !isEventLoop(element) &&\n    !(\n      is(element, \"bpmn:IntermediateThrowEvent\") &&\n      hasEventDefinition(element, \"bpmn:LinkEventDefinition\")\n    ) &&\n    !isCompensationBoundary(element) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isSequenceFlowTarget(element) {\n  return (\n    is(element, \"bpmn:FlowNode\") &&\n    !is(element, \"bpmn:StartEvent\") &&\n    !is(element, \"bpmn:BoundaryEvent\") &&\n    !isEventLoop(element) &&\n    !(\n      is(element, \"bpmn:IntermediateCatchEvent\") &&\n      hasEventDefinition(element, \"bpmn:LinkEventDefinition\")\n    ) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isEventBasedTarget(element) {\n  return (\n    is(element, \"bpmn:ReceiveTask\") ||\n    (is(element, \"bpmn:IntermediateCatchEvent\") &&\n      (hasEventDefinition(element, \"bpmn:MessageEventDefinition\") ||\n        hasEventDefinition(element, \"bpmn:TimerEventDefinition\") ||\n        hasEventDefinition(element, \"bpmn:ConditionalEventDefinition\") ||\n        hasEventDefinition(element, \"bpmn:SignalEventDefinition\")))\n  );\n}\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n\nfunction getParents(element) {\n  let parents = [];\n\n  while (element) {\n    element = element.parent;\n\n    if (element) {\n      parents.push(element);\n    }\n  }\n\n  return parents;\n}\n\nfunction isParent(possibleParent, element) {\n  let allParents = getParents(element);\n  return allParents.indexOf(possibleParent) !== -1;\n}\n\nfunction canConnect(source, target, connection) {\n  if (nonExistingOrLabel(source) || nonExistingOrLabel(target)) {\n    return null;\n  }\n\n  if (!is(connection, \"bpmn:DataAssociation\")) {\n    if (canConnectMessageFlow(source, target)) {\n      return { type: \"bpmn:MessageFlow\" };\n    }\n\n    if (canConnectSequenceFlow(source, target)) {\n      return { type: \"bpmn:SequenceFlow\" };\n    }\n  }\n\n  let connectDataAssociation = canConnectDataAssociation(source, target);\n\n  if (connectDataAssociation) {\n    return connectDataAssociation;\n  }\n\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return {\n      type: \"bpmn:Association\",\n      associationDirection: \"One\",\n    };\n  }\n\n  if (canConnectAssociation(source, target)) {\n    return {\n      type: \"bpmn:Association\",\n    };\n  }\n\n  return false;\n}\n\n/**\n * Can an element be dropped into the target element\n *\n * @return {Boolean}\n */\nfunction canDrop(element, target, position) {\n  // can move labels and groups everywhere\n  if (isLabel(element) || isGroup(element)) {\n    return true;\n  }\n\n  // disallow to create elements on collapsed pools\n  if (is(target, \"bpmn:Participant\") && !isExpanded(target)) {\n    return false;\n  }\n\n  // allow to create new participants on\n  // existing collaboration and process diagrams\n  if (is(element, \"bpmn:Participant\")) {\n    return (\n      is(target, \"bpmn:Process-action\") || is(target, \"bpmn:Collaboration\")\n    );\n  }\n\n  // allow moving DataInput / DataOutput within its original container only\n  if (isAny(element, [\"bpmn:DataInput\", \"bpmn:DataOutput\"])) {\n    if (element.parent) {\n      return target === element.parent;\n    }\n  }\n\n  // allow creating lanes on participants and other lanes only\n  if (is(element, \"bpmn:Lane\")) {\n    return is(target, \"bpmn:Participant\") || is(target, \"bpmn:Lane\");\n  }\n\n  // disallow dropping boundary events which cannot replace with intermediate event\n  if (is(element, \"bpmn:BoundaryEvent\") && !isDroppableBoundaryEvent(element)) {\n    return false;\n  }\n\n  // drop flow elements onto flow element containers\n  // and participants\n  if (\n    is(element, \"bpmn:FlowElement\") &&\n    !is(element, \"bpmn:DataStoreReference\")\n  ) {\n    if (is(target, \"bpmn:FlowElementsContainer\")) {\n      return isExpanded(target);\n    }\n\n    return isAny(target, [\"bpmn:Participant\", \"bpmn:Lane\"]);\n  }\n\n  // account for the fact that data associations are always\n  // rendered and moved to top (Process or Collaboration level)\n  //\n  // artifacts may be placed wherever, too\n  if (\n    isAny(element, [\n      \"bpmn:Artifact\",\n      \"bpmn:DataAssociation\",\n      \"bpmn:DataStoreReference\",\n    ])\n  ) {\n    return isAny(target, [\n      \"bpmn:Collaboration\",\n      \"bpmn:Lane\",\n      \"bpmn:Participant\",\n      \"bpmn:Process-action\",\n      \"bpmn:Loop\",\n      \"bpmn:Conditional\",\n    ]);\n  }\n\n  if (is(element, \"bpmn:MessageFlow\")) {\n    return (\n      is(target, \"bpmn:Collaboration\") ||\n      element.source.parent === target ||\n      element.target.parent === target\n    );\n  }\n\n  return false;\n}\n\nfunction isDroppableBoundaryEvent(event) {\n  return (\n    getBusinessObject(event).cancelActivity &&\n    (hasNoEventDefinition(event) ||\n      hasCommonBoundaryIntermediateEventDefinition(event))\n  );\n}\n\nfunction isBoundaryEvent(element) {\n  return !isLabel(element) && is(element, \"bpmn:BoundaryEvent\");\n}\n\nfunction isLane(element) {\n  return is(element, \"bpmn:Lane\");\n}\n\n/**\n * We treat IntermediateThrowEvents as boundary events during create,\n * this must be reflected in the rules.\n */\nfunction isBoundaryCandidate(element) {\n  if (isBoundaryEvent(element)) {\n    return true;\n  }\n\n  if (\n    is(element, \"bpmn:IntermediateThrowEvent\") &&\n    hasNoEventDefinition(element)\n  ) {\n    return true;\n  }\n\n  return (\n    is(element, \"bpmn:IntermediateCatchEvent\") &&\n    hasCommonBoundaryIntermediateEventDefinition(element)\n  );\n}\n\nfunction hasNoEventDefinition(element) {\n  let bo = getBusinessObject(element);\n\n  return bo && !(bo.eventDefinitions && bo.eventDefinitions.length);\n}\n\nfunction hasCommonBoundaryIntermediateEventDefinition(element) {\n  return hasOneOfEventDefinitions(element, [\n    \"bpmn:MessageEventDefinition\",\n    \"bpmn:TimerEventDefinition\",\n    \"bpmn:SignalEventDefinition\",\n    \"bpmn:ConditionalEventDefinition\",\n  ]);\n}\n\nfunction hasOneOfEventDefinitions(element, eventDefinitions) {\n  return eventDefinitions.some(function (definition) {\n    return hasEventDefinition(element, definition);\n  });\n}\n\nfunction isReceiveTaskAfterEventBasedGateway(element) {\n  return (\n    is(element, \"bpmn:ReceiveTask\") &&\n    find(element.incoming, function (incoming) {\n      return is(incoming.source, \"bpmn:EventBasedGateway\");\n    })\n  );\n}\n\nfunction canAttach(elements, target, source, position) {\n  if (!Array.isArray(elements)) {\n    elements = [elements];\n  }\n\n  // only (re-)attach one element at a time\n  if (elements.length !== 1) {\n    return false;\n  }\n\n  let element = elements[0];\n\n  // do not attach labels\n  if (isLabel(element)) {\n    return false;\n  }\n\n  // only handle boundary events\n  if (!isBoundaryCandidate(element)) {\n    return false;\n  }\n\n  // disallow drop on event sub processes\n  if (isEventLoop(target)) {\n    return false;\n  }\n\n  // only allow drop on non compensation activities\n  if (!is(target, \"bpmn:Activity\") || isForCompensation(target)) {\n    return false;\n  }\n\n  // only attach to loop border\n  if (position && !isBoundaryAttachment(position, target)) {\n    return false;\n  }\n\n  // do not attach on receive tasks after event based gateways\n  if (isReceiveTaskAfterEventBasedGateway(target)) {\n    return false;\n  }\n\n  return \"attach\";\n}\n\n/**\n * Defines how to replace elements for a given target.\n *\n * Returns an array containing all elements which will be replaced.\n *\n * @example\n *\n *  [{ id: 'IntermediateEvent_2',\n *     type: 'bpmn:StartEvent'\n *   },\n *   { id: 'IntermediateEvent_5',\n *     type: 'bpmn:EndEvent'\n *   }]\n *\n * @param  {Array} elements\n * @param  {Object} target\n *\n * @return {Object} an object containing all elements which have to be replaced\n */\nfunction canReplace(elements, target, position) {\n  if (!target) {\n    return false;\n  }\n\n  let canExecute = {\n    replacements: [],\n  };\n\n  forEach(elements, function (element) {\n    if (!isEventLoop(target)) {\n      if (\n        is(element, \"bpmn:StartEvent\") &&\n        element.type !== \"label\" &&\n        canDrop(element, target)\n      ) {\n        // replace a non-interrupting start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (!isInterrupting(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: \"bpmn:StartEvent\",\n          });\n        }\n\n        // replace an error/escalation/compensate start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (\n          hasErrorEventDefinition(element) ||\n          hasEscalationEventDefinition(element) ||\n          hasCompensateEventDefinition(element)\n        ) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: \"bpmn:StartEvent\",\n          });\n        }\n      }\n    }\n\n    if (!is(target, \"bpmn:Transaction\")) {\n      if (\n        hasEventDefinition(element, \"bpmn:CancelEventDefinition\") &&\n        element.type !== \"label\"\n      ) {\n        if (is(element, \"bpmn:EndEvent\") && canDrop(element, target)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: \"bpmn:EndEvent\",\n          });\n        }\n\n        if (\n          is(element, \"bpmn:BoundaryEvent\") &&\n          canAttach(element, target, null, position)\n        ) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: \"bpmn:BoundaryEvent\",\n          });\n        }\n      }\n    }\n  });\n\n  return canExecute.replacements.length ? canExecute : false;\n}\n\nfunction canMove(elements, target) {\n  // do not move selection containing lanes\n  if (some(elements, isLane)) {\n    return false;\n  }\n\n  // allow default move check to start move operation\n  if (!target) {\n    return true;\n  }\n\n  return elements.every(function (element) {\n    return canDrop(element, target);\n  });\n}\n\nfunction canCreate(shape, target, source, position) {\n  if (!target) {\n    return false;\n  }\n\n  if (isLabel(shape) || isGroup(shape)) {\n    return true;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  // ensure we do not drop the element\n  // into source\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  return canDrop(shape, target, position) || canInsert(shape, target, position);\n}\n\nfunction canResize(shape, newBounds) {\n  if (is(shape, \"bpmn:Loop\")) {\n    return (\n      isExpanded(shape) &&\n      (!newBounds || (newBounds.width >= 100 && newBounds.height >= 80))\n    );\n  }\n\n  if (is(shape, \"bpmn:Conditional\")) {\n    return (\n      isExpanded(shape) &&\n      (!newBounds || (newBounds.width >= 100 && newBounds.height >= 80))\n    );\n  }\n\n  if (is(shape, \"bpmn:Lane\")) {\n    return !newBounds || (newBounds.width >= 130 && newBounds.height >= 60);\n  }\n\n  if (is(shape, \"bpmn:Participant\")) {\n    return !newBounds || (newBounds.width >= 250 && newBounds.height >= 50);\n  }\n\n  if (isTextAnnotation(shape)) {\n    return true;\n  }\n\n  if (isGroup(shape)) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Check, whether one side of the relationship\n * is a text annotation.\n */\nfunction isOneTextAnnotation(source, target) {\n  let sourceTextAnnotation = isTextAnnotation(source),\n    targetTextAnnotation = isTextAnnotation(target);\n\n  return (\n    (sourceTextAnnotation || targetTextAnnotation) &&\n    sourceTextAnnotation !== targetTextAnnotation\n  );\n}\n\nfunction canConnectAssociation(source, target) {\n  // do not connect connections\n  if (isConnection(source) || isConnection(target)) {\n    return false;\n  }\n\n  // compensation boundary events are exception\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return true;\n  }\n\n  // don't connect parent <-> child\n  if (isParent(target, source) || isParent(source, target)) {\n    return false;\n  }\n\n  // allow connection of associations between <!TextAnnotation> and <TextAnnotation>\n  if (isOneTextAnnotation(source, target)) {\n    return true;\n  }\n\n  // can connect associations where we can connect\n  // data associations, too (!)\n  return !!canConnectDataAssociation(source, target);\n}\n\nfunction canConnectMessageFlow(source, target) {\n  // during connect user might move mouse out of canvas\n  // https://github.com/bpmn-io/bpmn-js/issues/1033\n  if (getRootElement(source) && !getRootElement(target)) {\n    return false;\n  }\n\n  return (\n    isMessageFlowSource(source) &&\n    isMessageFlowTarget(target) &&\n    !isSameOrganization(source, target)\n  );\n}\n\nfunction canConnectSequenceFlow(source, target) {\n  if (\n    isEventBasedTarget(target) &&\n    target.incoming.length > 0 &&\n    areOutgoingEventBasedGatewayConnections(target.incoming) &&\n    !is(source, \"bpmn:EventBasedGateway\")\n  ) {\n    return false;\n  }\n\n  return (\n    isSequenceFlowSource(source) &&\n    isSequenceFlowTarget(target) &&\n    isSameScope(source, target) &&\n    !(is(source, \"bpmn:EventBasedGateway\") && !isEventBasedTarget(target))\n  );\n}\n\nfunction canConnectDataAssociation(source, target) {\n  if (\n    isAny(source, [\"bpmn:DataObjectReference\", \"bpmn:DataStoreReference\"]) &&\n    isAny(target, [\"bpmn:Activity\", \"bpmn:ThrowEvent\"])\n  ) {\n    return { type: \"bpmn:DataInputAssociation\" };\n  }\n\n  if (\n    isAny(target, [\"bpmn:DataObjectReference\", \"bpmn:DataStoreReference\"]) &&\n    isAny(source, [\"bpmn:Activity\", \"bpmn:CatchEvent\"])\n  ) {\n    return { type: \"bpmn:DataOutputAssociation\" };\n  }\n\n  return false;\n}\n\nfunction canInsert(shape, flow, position) {\n  if (!flow) {\n    return false;\n  }\n\n  if (Array.isArray(shape)) {\n    if (shape.length !== 1) {\n      return false;\n    }\n\n    shape = shape[0];\n  }\n\n  if (flow.source === shape || flow.target === shape) {\n    return false;\n  }\n\n  // return true if we can drop on the\n  // underlying flow parent\n  //\n  // at this point we are not really able to talk\n  // about connection rules (yet)\n\n  return (\n    isAny(flow, [\"bpmn:SequenceFlow\", \"bpmn:MessageFlow\"]) &&\n    !isLabel(flow) &&\n    is(shape, \"bpmn:FlowNode\") &&\n    !is(shape, \"bpmn:BoundaryEvent\") &&\n    canDrop(shape, flow.parent, position)\n  );\n}\n\nfunction includes(elements, element) {\n  return elements && element && elements.indexOf(element) !== -1;\n}\n\nfunction canCopy(elements, element) {\n  if (isLabel(element)) {\n    return true;\n  }\n\n  if (is(element, \"bpmn:Lane\") && !includes(elements, element.parent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isOutgoingEventBasedGatewayConnection(connection) {\n  if (connection && connection.source) {\n    return is(connection.source, \"bpmn:EventBasedGateway\");\n  }\n}\n\nfunction areOutgoingEventBasedGatewayConnections(connections) {\n  connections = connections || [];\n\n  return connections.some(isOutgoingEventBasedGatewayConnection);\n}\n\nfunction getRootElement(element) {\n  return (\n    getParent(element, \"bpmn:Process-action\") ||\n    getParent(element, \"bpmn:Collaboration\")\n  );\n}\n","import RulesModule from \"diagram-js/lib/features/rules\";\n\nimport BpmnRules from \"./BpmnRules\";\n\nexport default {\n  __depends__: [RulesModule],\n  __init__: [\"bpmnRules\"],\n  bpmnRules: [\"type\", BpmnRules],\n};\n","import { getDi } from \"../../draw/BpmnRenderUtil\";\nimport { getBusinessObject } from \"../../util/ModelUtil\";\n\nimport { filter, map } from \"min-dash\";\n\nimport { selfAndAllChildren } from \"diagram-js/lib/util/Elements\";\n\nlet HIGH_PRIORITY = 2000;\n\nexport default function BpmnDiOrdering(eventBus, canvas) {\n  eventBus.on(\"saveXML.start\", HIGH_PRIORITY, orderDi);\n\n  function orderDi() {\n    let root = canvas.getRootElement(),\n      rootDi = getBusinessObject(root).di,\n      elements,\n      diElements;\n\n    elements = selfAndAllChildren([root], false);\n\n    // only bpmndi:Shape and bpmndi:Edge can be direct children of bpmndi:Plane\n    elements = filter(elements, function (element) {\n      return element !== root && !element.labelTarget;\n    });\n\n    diElements = map(elements, getDi);\n\n    rootDi.set(\"planeElement\", diElements);\n  }\n}\n\nBpmnDiOrdering.$inject = [\"eventBus\", \"canvas\"];\n","import BpmnDiOrdering from \"./BpmnDiOrdering\";\n\nexport default {\n  __init__: [\"bpmnDiOrdering\"],\n  bpmnDiOrdering: [\"type\", BpmnDiOrdering],\n};\n","import inherits from \"inherits\";\n\nimport OrderingProvider from \"diagram-js/lib/features/ordering/OrderingProvider\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\nimport { findIndex, find } from \"min-dash\";\n\n/**\n * a simple ordering provider that makes sure:\n *\n * (0) labels and groups are rendered always on top\n * (1) elements are ordered by a {level} property\n */\nexport default function BpmnOrderingProvider(eventBus, canvas, translate) {\n  OrderingProvider.call(this, eventBus);\n\n  let orders = [\n    { type: \"bpmn:Loop\", order: { level: 6 } },\n    {\n      type: \"bpmn:SequenceFlow\",\n      order: {\n        level: 3,\n        containers: [\"bpmn:Participant\", \"bpmn:FlowElementsContainer\"],\n      },\n    },\n\n    // handle DataAssociation(s) like message flows and render them always on top\n    {\n      type: \"bpmn:DataAssociation\",\n      order: {\n        level: 9,\n        containers: [\"bpmn:Collaboration\", \"bpmn:Process-action\"],\n      },\n    },\n    {\n      type: \"bpmn:MessageFlow\",\n      order: {\n        level: 9,\n        containers: [\"bpmn:Collaboration\"],\n      },\n    },\n    {\n      type: \"bpmn:Association\",\n      order: {\n        level: 6,\n        containers: [\n          \"bpmn:Participant\",\n          \"bpmn:FlowElementsContainer\",\n          \"bpmn:Collaboration\",\n        ],\n      },\n    },\n    { type: \"bpmn:BoundaryEvent\", order: { level: 8 } },\n    {\n      type: \"bpmn:Group\",\n      order: {\n        level: 10,\n        containers: [\"bpmn:Collaboration\", \"bpmn:Process-action\"],\n      },\n    },\n    { type: \"bpmn:FlowElement\", order: { level: 5 } },\n    { type: \"bpmn:Participant\", order: { level: -2 } },\n    { type: \"bpmn:Lane\", order: { level: -1 } },\n  ];\n\n  function computeOrder(element) {\n    if (element.labelTarget) {\n      return { level: 10 };\n    }\n\n    let entry = find(orders, function (o) {\n      return isAny(element, [o.type]);\n    });\n\n    return (entry && entry.order) || { level: 1 };\n  }\n\n  function getOrder(element) {\n    let order = element.order;\n\n    if (!order) {\n      element.order = order = computeOrder(element);\n    }\n\n    return order;\n  }\n\n  function findActualParent(element, newParent, containers) {\n    let actualParent = newParent;\n\n    while (actualParent) {\n      if (isAny(actualParent, containers)) {\n        break;\n      }\n\n      actualParent = actualParent.parent;\n    }\n\n    if (!actualParent) {\n      throw new Error(\n        translate(\"no parent for {element} in {parent}\", {\n          element: element.id,\n          parent: newParent.id,\n        })\n      );\n    }\n\n    return actualParent;\n  }\n\n  this.getOrdering = function (element, newParent) {\n    // render labels always on top\n    if (element.labelTarget) {\n      return {\n        parent: canvas.getRootElement(),\n        index: -1,\n      };\n    }\n\n    let elementOrder = getOrder(element);\n\n    if (elementOrder.containers) {\n      newParent = findActualParent(element, newParent, elementOrder.containers);\n    }\n\n    let currentIndex = newParent.children.indexOf(element);\n\n    let insertIndex = findIndex(newParent.children, function (child) {\n      // do not compare with labels, they are created\n      // in the wrong order (right after elements) during import and\n      // mess up the positioning.\n      if (!element.labelTarget && child.labelTarget) {\n        return false;\n      }\n\n      return elementOrder.level < getOrder(child).level;\n    });\n\n    // if the element is already in the child list at\n    // a smaller index, we need to adjust the insert index.\n    // this takes into account that the element is being removed\n    // before being re-inserted\n    if (insertIndex !== -1) {\n      if (currentIndex !== -1 && currentIndex < insertIndex) {\n        insertIndex -= 1;\n      }\n    }\n\n    return {\n      index: insertIndex,\n      parent: newParent,\n    };\n  };\n}\n\nBpmnOrderingProvider.$inject = [\"eventBus\", \"canvas\", \"translate\"];\n\ninherits(BpmnOrderingProvider, OrderingProvider);\n","import translate from \"diagram-js/lib/i18n/translate\";\n\nimport BpmnOrderingProvider from \"./BpmnOrderingProvider\";\n\nexport default {\n  __depends__: [translate],\n  __init__: [\"bpmnOrderingProvider\"],\n  bpmnOrderingProvider: [\"type\", BpmnOrderingProvider],\n};\n","import { map, assign, pick } from \"min-dash\";\n\nimport { isAny } from \"./util/ModelingUtil\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nexport default function BpmnFactory(moddle) {\n  this._model = moddle;\n}\n\nBpmnFactory.$inject = [\"moddle\"];\n\nBpmnFactory.prototype._needsId = function (element) {\n  return isAny(element, [\n    \"bpmn:RootElement\",\n    \"bpmn:FlowElement\",\n    \"bpmn:MessageFlow\",\n    \"bpmn:DataAssociation\",\n    \"bpmn:Artifact\",\n    \"bpmn:Participant\",\n    \"bpmn:Lane\",\n    \"bpmn:LaneSet\",\n    \"bpmn:Process-action\",\n    \"bpmn:Collaboration\",\n    \"bpmndi:BPMNShape\",\n    \"bpmndi:BPMNEdge\",\n    \"bpmndi:BPMNDiagram\",\n    \"bpmndi:BPMNPlane\",\n    \"bpmn:Property\",\n    \"bpmn:CategoryValue\",\n  ]);\n};\n\nBpmnFactory.prototype._ensureId = function (element) {\n  // generate semantic ids for elements\n  // bpmn:SequenceFlow -> SequenceFlow_ID\n  let prefix;\n\n  if (is(element, \"bpmn:Mapper\")) {\n    prefix = \"Mapper\";\n  } else if (is(element, \"bpmn:Query\")) {\n    prefix = \"Query\";\n  } else if (is(element, \"bpmn:Function\")) {\n    prefix = \"Function\";\n  } else if (is(element, \"bpmn:Loop\")) {\n    prefix = \"Loop\";\n  } else if (is(element, \"bpmn:Conditional\")) {\n    prefix = \"Condition\";\n  } else if (is(element, \"bpmn:Activity\")) {\n    prefix = \"Activity\";\n  } else if (is(element, \"bpmn:Event\")) {\n    prefix = \"Event\";\n  } else if (is(element, \"bpmn:Gateway\")) {\n    prefix = \"Gateway\";\n  } else if (isAny(element, [\"bpmn:SequenceFlow\", \"bpmn:MessageFlow\"])) {\n    prefix = \"Flow\";\n  } else {\n    prefix = (element.$type || \"\").replace(/^[^:]*:/g, \"\");\n  }\n\n  prefix += \"_\";\n\n  if (!element.id && this._needsId(element)) {\n    element.id = this._model.ids.nextPrefixed(prefix, element);\n  }\n};\n\nBpmnFactory.prototype.create = function (type, attrs) {\n  let element = this._model.create(type, attrs || {});\n\n  this._ensureId(element);\n\n  return element;\n};\n\nBpmnFactory.prototype.createDiLabel = function () {\n  return this.create(\"bpmndi:BPMNLabel\", {\n    bounds: this.createDiBounds(),\n  });\n};\n\nBpmnFactory.prototype.createDiShape = function (semantic, bounds, attrs) {\n  return this.create(\n    \"bpmndi:BPMNShape\",\n    assign(\n      {\n        bpmnElement: semantic,\n        bounds: this.createDiBounds(bounds),\n      },\n      attrs\n    )\n  );\n};\n\nBpmnFactory.prototype.createDiBounds = function (bounds) {\n  return this.create(\"dc:Bounds\", bounds);\n};\n\nBpmnFactory.prototype.createDiWaypoints = function (waypoints) {\n  let self = this;\n\n  return map(waypoints, function (pos) {\n    return self.createDiWaypoint(pos);\n  });\n};\n\nBpmnFactory.prototype.createDiWaypoint = function (point) {\n  return this.create(\"dc:Point\", pick(point, [\"x\", \"y\"]));\n};\n\nBpmnFactory.prototype.createDiEdge = function (semantic, waypoints, attrs) {\n  return this.create(\n    \"bpmndi:BPMNEdge\",\n    assign(\n      {\n        bpmnElement: semantic,\n      },\n      attrs\n    )\n  );\n};\n\nBpmnFactory.prototype.createDiPlane = function (semantic) {\n  return this.create(\"bpmndi:BPMNPlane\", {\n    bpmnElement: semantic,\n  });\n};\n","import { assign, forEach } from \"min-dash\";\n\nimport inherits from \"inherits\";\n\nimport {\n  remove as collectionRemove,\n  add as collectionAdd,\n} from \"diagram-js/lib/util/Collections\";\n\nimport { Label } from \"diagram-js/lib/model\";\n\nimport { getBusinessObject, is } from \"../../util/ModelUtil\";\n\nimport { isAny } from \"./util/ModelingUtil\";\n\nimport CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\n/**\n * A handler responsible for updating the underlying BPMN 2.0 XML + DI\n * once changes on the diagram happen\n */\nexport default function BpmnUpdater(\n  eventBus,\n  bpmnFactory,\n  connectionDocking,\n  translate\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  this._bpmnFactory = bpmnFactory;\n  this._translate = translate;\n\n  let self = this;\n\n  // connection cropping //////////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    let context = e.context,\n      hints = context.hints || {},\n      connection;\n\n    if (!context.cropped && hints.createElementsBehavior !== false) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\"connection.layout\", \"connection.create\"], cropConnection);\n\n  this.reverted([\"connection.layout\"], function (e) {\n    delete e.context.cropped;\n  });\n\n  // BPMN + DI update //////////////////////\n\n  // update parent\n  function updateParent(e) {\n    let context = e.context;\n\n    self.updateParent(context.shape || context.connection, context.oldParent);\n  }\n\n  function reverseUpdateParent(e) {\n    let context = e.context;\n\n    let element = context.shape || context.connection,\n      // oldParent is the (old) new parent, because we are undoing\n      oldParent = context.parent || context.newParent;\n\n    self.updateParent(element, oldParent);\n  }\n\n  this.executed(\n    [\n      \"shape.move\",\n      \"shape.create\",\n      \"shape.delete\",\n      \"connection.create\",\n      \"connection.move\",\n      \"connection.delete\",\n    ],\n    ifBpmn(updateParent)\n  );\n\n  this.reverted(\n    [\n      \"shape.move\",\n      \"shape.create\",\n      \"shape.delete\",\n      \"connection.create\",\n      \"connection.move\",\n      \"connection.delete\",\n    ],\n    ifBpmn(reverseUpdateParent)\n  );\n\n  /*\n   * ## Updating Parent\n   *\n   * When morphing a Process into a Collaboration or vice-versa,\n   * make sure that both the *semantic* and *di* parent of each element\n   * is updated.\n   *\n   */\n  function updateRoot(event) {\n    let context = event.context,\n      oldRoot = context.oldRoot,\n      children = oldRoot.children;\n\n    forEach(children, function (child) {\n      if (is(child, \"bpmn:BaseElement\")) {\n        self.updateParent(child);\n      }\n    });\n  }\n\n  this.executed([\"canvas.updateRoot\"], updateRoot);\n  this.reverted([\"canvas.updateRoot\"], updateRoot);\n\n  // update bounds\n  function updateBounds(e) {\n    let shape = e.context.shape;\n\n    if (!is(shape, \"bpmn:BaseElement\")) {\n      return;\n    }\n\n    self.updateBounds(shape);\n  }\n\n  this.executed(\n    [\"shape.move\", \"shape.create\", \"shape.resize\"],\n    ifBpmn(function (event) {\n      // exclude labels because they're handled separately during shape.changed\n      if (event.context.shape.type === \"label\") {\n        return;\n      }\n\n      updateBounds(event);\n    })\n  );\n\n  this.reverted(\n    [\"shape.move\", \"shape.create\", \"shape.resize\"],\n    ifBpmn(function (event) {\n      // exclude labels because they're handled separately during shape.changed\n      if (event.context.shape.type === \"label\") {\n        return;\n      }\n\n      updateBounds(event);\n    })\n  );\n\n  // Handle labels separately. This is necessary, because the label bounds have to be updated\n  // every time its shape changes, not only on move, create and resize.\n  eventBus.on(\"shape.changed\", function (event) {\n    if (event.element.type === \"label\") {\n      updateBounds({ context: { shape: event.element } });\n    }\n  });\n\n  // attach / detach connection\n  function updateConnection(e) {\n    self.updateConnection(e.context);\n  }\n\n  this.executed(\n    [\n      \"connection.create\",\n      \"connection.move\",\n      \"connection.delete\",\n      \"connection.reconnect\",\n    ],\n    ifBpmn(updateConnection)\n  );\n\n  this.reverted(\n    [\n      \"connection.create\",\n      \"connection.move\",\n      \"connection.delete\",\n      \"connection.reconnect\",\n    ],\n    ifBpmn(updateConnection)\n  );\n\n  // update waypoints\n  function updateConnectionWaypoints(e) {\n    self.updateConnectionWaypoints(e.context.connection);\n  }\n\n  this.executed(\n    [\"connection.layout\", \"connection.move\", \"connection.updateWaypoints\"],\n    ifBpmn(updateConnectionWaypoints)\n  );\n\n  this.reverted(\n    [\"connection.layout\", \"connection.move\", \"connection.updateWaypoints\"],\n    ifBpmn(updateConnectionWaypoints)\n  );\n\n  // update conditional/default flows\n  this.executed(\n    \"connection.reconnect\",\n    ifBpmn(function (event) {\n      let context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n      // remove condition from connection on reconnect to new source\n      // if new source can NOT have condional sequence flow\n      if (\n        connectionBo.conditionExpression &&\n        !isAny(newSourceBo, [\n          \"bpmn:Activity\",\n          \"bpmn:ExclusiveGateway\",\n          \"bpmn:InclusiveGateway\",\n        ])\n      ) {\n        context.oldConditionExpression = connectionBo.conditionExpression;\n\n        delete connectionBo.conditionExpression;\n      }\n\n      // remove default from old source flow on reconnect to new source\n      // if source changed\n      if (oldSource !== newSource && oldSourceBo.default === connectionBo) {\n        context.oldDefault = oldSourceBo.default;\n\n        delete oldSourceBo.default;\n      }\n    })\n  );\n\n  this.reverted(\n    \"connection.reconnect\",\n    ifBpmn(function (event) {\n      let context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n      // add condition to connection on revert reconnect to new source\n      if (context.oldConditionExpression) {\n        connectionBo.conditionExpression = context.oldConditionExpression;\n      }\n\n      // add default to old source on revert reconnect to new source\n      if (context.oldDefault) {\n        oldSourceBo.default = context.oldDefault;\n\n        delete newSourceBo.default;\n      }\n    })\n  );\n\n  // update attachments\n  function updateAttachment(e) {\n    self.updateAttachment(e.context);\n  }\n\n  this.executed([\"element.updateAttachment\"], ifBpmn(updateAttachment));\n  this.reverted([\"element.updateAttachment\"], ifBpmn(updateAttachment));\n}\n\ninherits(BpmnUpdater, CommandInterceptor);\n\nBpmnUpdater.$inject = [\n  \"eventBus\",\n  \"bpmnFactory\",\n  \"connectionDocking\",\n  \"translate\",\n];\n\n// implementation //////////////////////\n\nBpmnUpdater.prototype.updateAttachment = function (context) {\n  let shape = context.shape,\n    businessObject = shape.businessObject,\n    host = shape.host;\n\n  businessObject.attachedToRef = host && host.businessObject;\n};\n\nBpmnUpdater.prototype.updateParent = function (element, oldParent) {\n  // do not update BPMN 2.0 label parent\n  if (element instanceof Label) {\n    return;\n  }\n\n  // data stores in collaborations are handled separately by DataStoreBehavior\n  if (\n    is(element, \"bpmn:DataStoreReference\") &&\n    element.parent &&\n    is(element.parent, \"bpmn:Collaboration\")\n  ) {\n    return;\n  }\n\n  let parentShape = element.parent;\n\n  let businessObject = element.businessObject,\n    parentBusinessObject = parentShape && parentShape.businessObject,\n    parentDi = parentBusinessObject && parentBusinessObject.di;\n\n  if (is(element, \"bpmn:FlowNode\")) {\n    this.updateFlowNodeRefs(\n      businessObject,\n      parentBusinessObject,\n      oldParent && oldParent.businessObject\n    );\n  }\n\n  if (is(element, \"bpmn:DataOutputAssociation\")) {\n    if (element.source) {\n      parentBusinessObject = element.source.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  if (is(element, \"bpmn:DataInputAssociation\")) {\n    if (element.target) {\n      parentBusinessObject = element.target.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  this.updateSemanticParent(businessObject, parentBusinessObject);\n\n  if (is(element, \"bpmn:DataObjectReference\") && businessObject.dataObjectRef) {\n    this.updateSemanticParent(\n      businessObject.dataObjectRef,\n      parentBusinessObject\n    );\n  }\n\n  this.updateDiParent(businessObject.di, parentDi);\n};\n\nBpmnUpdater.prototype.updateBounds = function (shape) {\n  let di = shape.businessObject.di;\n\n  let target = shape instanceof Label ? this._getLabel(di) : di;\n\n  let bounds = target.bounds;\n\n  if (!bounds) {\n    bounds = this._bpmnFactory.createDiBounds();\n    target.set(\"bounds\", bounds);\n  }\n\n  assign(bounds, {\n    x: shape.x,\n    y: shape.y,\n    width: shape.width,\n    height: shape.height,\n  });\n};\n\nBpmnUpdater.prototype.updateFlowNodeRefs = function (\n  businessObject,\n  newContainment,\n  oldContainment\n) {\n  if (oldContainment === newContainment) {\n    return;\n  }\n\n  let oldRefs, newRefs;\n\n  if (is(oldContainment, \"bpmn:Lane\")) {\n    oldRefs = oldContainment.get(\"flowNodeRef\");\n    collectionRemove(oldRefs, businessObject);\n  }\n\n  if (is(newContainment, \"bpmn:Lane\")) {\n    newRefs = newContainment.get(\"flowNodeRef\");\n    collectionAdd(newRefs, businessObject);\n  }\n};\n\n// update existing sourceElement and targetElement di information\nBpmnUpdater.prototype.updateDiConnection = function (di, newSource, newTarget) {\n  if (di.sourceElement && di.sourceElement.bpmnElement !== newSource) {\n    di.sourceElement = newSource && newSource.di;\n  }\n\n  if (di.targetElement && di.targetElement.bpmnElement !== newTarget) {\n    di.targetElement = newTarget && newTarget.di;\n  }\n};\n\nBpmnUpdater.prototype.updateDiParent = function (di, parentDi) {\n  if (parentDi && !is(parentDi, \"bpmndi:BPMNPlane\")) {\n    parentDi = parentDi.$parent;\n  }\n\n  if (di.$parent === parentDi) {\n    return;\n  }\n\n  let planeElements = (parentDi || di.$parent).get(\"planeElement\");\n\n  if (parentDi) {\n    planeElements.push(di);\n    di.$parent = parentDi;\n  } else {\n    collectionRemove(planeElements, di);\n    di.$parent = null;\n  }\n};\n\nfunction getDefinitions(element) {\n  while (element && !is(element, \"bpmn:Process-actions\")) {\n    element = element.$parent;\n  }\n\n  return element;\n}\n\nBpmnUpdater.prototype.getLaneSet = function (container) {\n  let laneSet, laneSets;\n\n  // bpmn:Lane\n  if (is(container, \"bpmn:Lane\")) {\n    laneSet = container.childLaneSet;\n\n    if (!laneSet) {\n      laneSet = this._bpmnFactory.create(\"bpmn:LaneSet\");\n      container.childLaneSet = laneSet;\n      laneSet.$parent = container;\n    }\n\n    return laneSet;\n  }\n\n  // bpmn:Participant\n  if (is(container, \"bpmn:Participant\")) {\n    container = container.processRef;\n  }\n\n  // bpmn:FlowElementsContainer\n  laneSets = container.get(\"laneSets\");\n  laneSet = laneSets[0];\n\n  if (!laneSet) {\n    laneSet = this._bpmnFactory.create(\"bpmn:LaneSet\");\n    laneSet.$parent = container;\n    laneSets.push(laneSet);\n  }\n\n  return laneSet;\n};\n\nBpmnUpdater.prototype.updateSemanticParent = function (\n  businessObject,\n  newParent,\n  visualParent\n) {\n  let containment,\n    translate = this._translate;\n\n  if (businessObject.$parent === newParent) {\n    return;\n  }\n\n  if (\n    is(businessObject, \"bpmn:DataInput\") ||\n    is(businessObject, \"bpmn:DataOutput\")\n  ) {\n    if (is(newParent, \"bpmn:Participant\") && \"processRef\" in newParent) {\n      newParent = newParent.processRef;\n    }\n\n    // already in correct ioSpecification\n    if (\n      \"ioSpecification\" in newParent &&\n      newParent.ioSpecification === businessObject.$parent\n    ) {\n      return;\n    }\n  }\n\n  if (is(businessObject, \"bpmn:Lane\")) {\n    if (newParent) {\n      newParent = this.getLaneSet(newParent);\n    }\n\n    containment = \"lanes\";\n  } else if (is(businessObject, \"bpmn:FlowElement\")) {\n    if (newParent) {\n      if (is(newParent, \"bpmn:Participant\")) {\n        newParent = newParent.processRef;\n      } else if (is(newParent, \"bpmn:Lane\")) {\n        do {\n          // unwrap Lane -> LaneSet -> (Lane | FlowElementsContainer)\n          newParent = newParent.$parent.$parent;\n        } while (is(newParent, \"bpmn:Lane\"));\n      }\n    }\n\n    containment = \"flowElements\";\n  } else if (is(businessObject, \"bpmn:Artifact\")) {\n    while (\n      newParent &&\n      !is(newParent, \"bpmn:Process-action\") &&\n      !is(newParent, \"bpmn:Loop\") &&\n      !is(newParent, \"bpmn:Conditional\") &&\n      !is(newParent, \"bpmn:Collaboration\")\n    ) {\n      if (is(newParent, \"bpmn:Participant\")) {\n        newParent = newParent.processRef;\n        break;\n      } else {\n        newParent = newParent.$parent;\n      }\n    }\n\n    containment = \"artifacts\";\n  } else if (is(businessObject, \"bpmn:MessageFlow\")) {\n    containment = \"messageFlows\";\n  } else if (is(businessObject, \"bpmn:Participant\")) {\n    containment = \"participants\";\n\n    // make sure the participants process is properly attached / detached\n    // from the XML document\n\n    let process = businessObject.processRef,\n      definitions;\n\n    if (process) {\n      definitions = getDefinitions(businessObject.$parent || newParent);\n\n      if (businessObject.$parent) {\n        collectionRemove(definitions.get(\"rootElements\"), process);\n        process.$parent = null;\n      }\n\n      if (newParent) {\n        collectionAdd(definitions.get(\"rootElements\"), process);\n        process.$parent = definitions;\n      }\n    }\n  } else if (is(businessObject, \"bpmn:DataOutputAssociation\")) {\n    containment = \"dataOutputAssociations\";\n  } else if (is(businessObject, \"bpmn:DataInputAssociation\")) {\n    containment = \"dataInputAssociations\";\n  }\n\n  if (!containment) {\n    throw new Error(\n      translate(\"no parent for {element} in {parent}\", {\n        element: businessObject.id,\n        parent: newParent.id,\n      })\n    );\n  }\n\n  let children;\n\n  if (businessObject.$parent) {\n    // remove from old parent\n    children = businessObject.$parent.get(containment);\n    collectionRemove(children, businessObject);\n  }\n\n  if (!newParent) {\n    businessObject.$parent = null;\n  } else {\n    // add to new parent\n    children = newParent.get(containment);\n    children.push(businessObject);\n    businessObject.$parent = newParent;\n  }\n\n  if (visualParent) {\n    let diChildren = visualParent.get(containment);\n\n    collectionRemove(children, businessObject);\n\n    if (newParent) {\n      if (!diChildren) {\n        diChildren = [];\n        newParent.set(containment, diChildren);\n      }\n\n      diChildren.push(businessObject);\n    }\n  }\n};\n\nBpmnUpdater.prototype.updateConnectionWaypoints = function (connection) {\n  connection.businessObject.di.set(\n    \"waypoint\",\n    this._bpmnFactory.createDiWaypoints(connection.waypoints)\n  );\n};\n\nBpmnUpdater.prototype.updateConnection = function (context) {\n  let connection = context.connection,\n    businessObject = getBusinessObject(connection),\n    newSource = getBusinessObject(connection.source),\n    newTarget = getBusinessObject(connection.target),\n    visualParent;\n\n  if (!is(businessObject, \"bpmn:DataAssociation\")) {\n    let inverseSet = is(businessObject, \"bpmn:SequenceFlow\");\n\n    if (businessObject.sourceRef !== newSource) {\n      if (inverseSet) {\n        collectionRemove(\n          businessObject.sourceRef && businessObject.sourceRef.get(\"outgoing\"),\n          businessObject\n        );\n\n        if (newSource && newSource.get(\"outgoing\")) {\n          newSource.get(\"outgoing\").push(businessObject);\n        }\n      }\n\n      businessObject.sourceRef = newSource;\n    }\n\n    if (businessObject.targetRef !== newTarget) {\n      if (inverseSet) {\n        collectionRemove(\n          businessObject.targetRef && businessObject.targetRef.get(\"incoming\"),\n          businessObject\n        );\n\n        if (newTarget && newTarget.get(\"incoming\")) {\n          newTarget.get(\"incoming\").push(businessObject);\n        }\n      }\n\n      businessObject.targetRef = newTarget;\n    }\n  } else if (is(businessObject, \"bpmn:DataInputAssociation\")) {\n    // handle obnoxious isMsome sourceRef\n    businessObject.get(\"sourceRef\")[0] = newSource;\n\n    visualParent = context.parent || context.newParent || newTarget;\n\n    this.updateSemanticParent(businessObject, newTarget, visualParent);\n  } else if (is(businessObject, \"bpmn:DataOutputAssociation\")) {\n    visualParent = context.parent || context.newParent || newSource;\n\n    this.updateSemanticParent(businessObject, newSource, visualParent);\n\n    // targetRef = new target\n    businessObject.targetRef = newTarget;\n  }\n\n  this.updateConnectionWaypoints(connection);\n\n  this.updateDiConnection(businessObject.di, newSource, newTarget);\n};\n\n// helpers //////////////////////\n\nBpmnUpdater.prototype._getLabel = function (di) {\n  if (!di.label) {\n    di.label = this._bpmnFactory.createDiLabel();\n  }\n\n  return di.label;\n};\n\n/**\n * Make sure the event listener is only called\n * if the touched element is a BPMN element.\n *\n * @param  {Function} fn\n * @return {Function} guarded function\n */\nfunction ifBpmn(fn) {\n  return function (event) {\n    let context = event.context,\n      element = context.shape || context.connection;\n\n    if (is(element, \"bpmn:BaseElement\")) {\n      fn(event);\n    }\n  };\n}\n","import { assign, forEach, isObject } from \"min-dash\";\n\nimport inherits from \"inherits\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nimport { isExpanded } from \"../../util/DiUtil\";\n\nimport BaseElementFactory from \"diagram-js/lib/core/ElementFactory\";\n\nimport { DEFAULT_LABEL_SIZE } from \"../../util/LabelUtil\";\n\n/**\n * A bpmn-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(bpmnFactory, moddle, translate) {\n  BaseElementFactory.call(this);\n\n  this._bpmnFactory = bpmnFactory;\n  this._moddle = moddle;\n  this._translate = translate;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\nElementFactory.$inject = [\"bpmnFactory\", \"moddle\", \"translate\"];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function (elementType, attrs) {\n  // no special magic for labels,\n  // we assume their businessObjects have already been created\n  // and wired via attrs\n  if (elementType === \"label\") {\n    return this.baseCreate(\n      elementType,\n      assign({ type: \"label\" }, DEFAULT_LABEL_SIZE, attrs)\n    );\n  }\n\n  return this.createBpmnElement(elementType, attrs);\n};\n\nElementFactory.prototype.createBpmnElement = function (elementType, attrs) {\n  let size,\n    translate = this._translate;\n\n  attrs = attrs || {};\n\n  let businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error(translate(\"no shape type specified\"));\n    }\n\n    businessObject = this._bpmnFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === \"root\") {\n      businessObject.di = this._bpmnFactory.createDiPlane(businessObject, [], {\n        id: businessObject.id + \"_di\",\n      });\n    } else if (elementType === \"connection\") {\n      businessObject.di = this._bpmnFactory.createDiEdge(businessObject, [], {\n        id: businessObject.id + \"_di\",\n      });\n    } else {\n      businessObject.di = this._bpmnFactory.createDiShape(\n        businessObject,\n        {},\n        {\n          id: businessObject.id + \"_di\",\n        }\n      );\n    }\n  }\n\n  if (is(businessObject, \"bpmn:Group\")) {\n    attrs = assign(\n      {\n        isFrame: true,\n      },\n      attrs\n    );\n  }\n\n  if (attrs.di) {\n    assign(businessObject.di, attrs.di);\n\n    delete attrs.di;\n  }\n\n  applyAttributes(businessObject, attrs, [\n    \"processRef\",\n    \"isInterrupting\",\n    \"associationDirection\",\n    \"isForCompensation\",\n  ]);\n\n  if (attrs.isExpanded) {\n    applyAttribute(businessObject.di, attrs, \"isExpanded\");\n  }\n\n  if (is(businessObject, \"bpmn:ExclusiveGateway\")) {\n    businessObject.di.isMarkerVisible = true;\n  }\n\n  if (is(businessObject, \"bpmn:Query\")) {\n    businessObject.di.isMarkerVisible = true;\n  }\n\n  let eventDefinitions, newEventDefinition;\n\n  if (attrs.eventDefinitionType) {\n    eventDefinitions = businessObject.get(\"eventDefinitions\") || [];\n    newEventDefinition = this._bpmnFactory.create(attrs.eventDefinitionType);\n\n    if (attrs.eventDefinitionType === \"bpmn:ConditionalEventDefinition\") {\n      newEventDefinition.condition = this._bpmnFactory.create(\n        \"bpmn:FormalExpression\"\n      );\n    }\n\n    eventDefinitions.push(newEventDefinition);\n\n    newEventDefinition.$parent = businessObject;\n    businessObject.eventDefinitions = eventDefinitions;\n\n    delete attrs.eventDefinitionType;\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign(\n    {\n      businessObject: businessObject,\n      id: businessObject.id,\n    },\n    size,\n    attrs\n  );\n\n  return this.baseCreate(elementType, attrs);\n};\n\nElementFactory.prototype._getDefaultSize = function (semantic) {\n  if (is(semantic, \"bpmn:Loop\")) {\n    if (isExpanded(semantic)) {\n      return { width: 350, height: 200 };\n    } else {\n      return { width: 100, height: 80 };\n    }\n  }\n\n  if (is(semantic, \"bpmn:Conditional\")) {\n    if (isExpanded(semantic)) {\n      return { width: 350, height: 200 };\n    } else {\n      return { width: 100, height: 80 };\n    }\n  }\n\n  if (is(semantic, \"bpmn:Task\")) {\n    return { width: 100, height: 80 };\n  }\n\n  if (is(semantic, \"bpmn:Gateway\")) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, \"bpmn:Event\")) {\n    return { width: 36, height: 36 };\n  }\n\n  if (is(semantic, \"bpmn:Participant\")) {\n    if (isExpanded(semantic)) {\n      return { width: 600, height: 250 };\n    } else {\n      return { width: 400, height: 60 };\n    }\n  }\n\n  if (is(semantic, \"bpmn:Lane\")) {\n    return { width: 400, height: 100 };\n  }\n\n  if (is(semantic, \"bpmn:DataObjectReference\")) {\n    return { width: 36, height: 50 };\n  }\n\n  if (is(semantic, \"bpmn:DataStoreReference\")) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, \"bpmn:TextAnnotation\")) {\n    return { width: 100, height: 30 };\n  }\n\n  if (is(semantic, \"bpmn:Group\")) {\n    return { width: 300, height: 300 };\n  }\n\n  return { width: 100, height: 80 };\n};\n\n/**\n * Create participant.\n *\n * @param {boolean|Object} [attrs] attrs\n *\n * @returns {djs.model.Shape}\n */\nElementFactory.prototype.createParticipantShape = function (attrs) {\n  if (!isObject(attrs)) {\n    attrs = { isExpanded: attrs };\n  }\n\n  attrs = assign({ type: \"bpmn:Participant\" }, attrs || {});\n\n  // participants are expanded by default\n  if (attrs.isExpanded !== false) {\n    attrs.processRef = this._bpmnFactory.create(\"bpmn:Process-action\");\n  }\n\n  return this.createShape(attrs);\n};\n\n// helpers //////////////////////\n\n/**\n * Apply attributes from a map to the given element,\n * remove attribute from the map on application.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {Array<String>} attributeNames name of attributes to apply\n */\nfunction applyAttributes(element, attrs, attributeNames) {\n  forEach(attributeNames, function (property) {\n    if (attrs[property] !== undefined) {\n      applyAttribute(element, attrs, property);\n    }\n  });\n}\n\n/**\n * Apply named property to element and drain it from the attrs\n * collection.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {String} attributeName to apply\n */\nfunction applyAttribute(element, attrs, attributeName) {\n  element[attributeName] = attrs[attributeName];\n\n  delete attrs[attributeName];\n}\n","import { reduce, keys, forEach, assign } from \"min-dash\";\n\nimport { getBusinessObject } from \"../../../util/ModelUtil\";\n\nconst DEFAULT_FLOW = \"default\",\n  ID = \"id\",\n  DI = \"di\";\n\nlet NULL_DIMENSIONS = {\n  width: 0,\n  height: 0,\n};\n\n/**\n * A handler that implements a BPMN 2.0 property update.\n *\n * This should be used to set simple properties on elements with\n * an underlying BPMN business object.\n *\n * Use respective diagram-js provided handlers if you would\n * like to perform automated modeling.\n */\nexport default function UpdatePropertiesHandler(\n  elementRegistry,\n  moddle,\n  translate,\n  modeling,\n  textRenderer\n) {\n  this._elementRegistry = elementRegistry;\n  this._moddle = moddle;\n  this._translate = translate;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n}\n\nUpdatePropertiesHandler.$inject = [\n  \"elementRegistry\",\n  \"moddle\",\n  \"translate\",\n  \"modeling\",\n  \"textRenderer\",\n];\n\n// api //////////////////////\n\n/**\n * Updates a BPMN element with a list of new properties\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element to update\n * @param {Object} context.properties a list of properties to set on the element's\n *                                    businessObject (the BPMN model element)\n *\n * @return {Array<djs.model.Base>} the updated element\n */\nUpdatePropertiesHandler.prototype.execute = function (context) {\n  let element = context.element,\n    changed = [element],\n    translate = this._translate;\n\n  if (!element) {\n    throw new Error(translate(\"element required\"));\n  }\n\n  let elementRegistry = this._elementRegistry,\n    ids = this._moddle.ids;\n\n  let businessObject = element.businessObject,\n    properties = unwrapBusinessObjects(context.properties),\n    oldProperties =\n      context.oldProperties || getProperties(businessObject, properties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(businessObject[ID]);\n\n    elementRegistry.updateId(element, properties[ID]);\n\n    ids.claim(properties[ID], businessObject);\n  }\n\n  // correctly indicate visual changes on default flow updates\n  if (DEFAULT_FLOW in properties) {\n    if (properties[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(properties[DEFAULT_FLOW].id));\n    }\n\n    if (businessObject[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(businessObject[DEFAULT_FLOW].id));\n    }\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\nUpdatePropertiesHandler.prototype.postExecute = function (context) {\n  let element = context.element,\n    label = element.label;\n\n  let text = label && getBusinessObject(label).name;\n\n  if (!text) {\n    return;\n  }\n\n  // get layouted text bounds and resize external\n  // external label accordingly\n  let newLabelBounds = this._textRenderer.getExternalLabelBounds(label, text);\n\n  this._modeling.resizeShape(label, newLabelBounds, NULL_DIMENSIONS);\n};\n\n/**\n * Reverts the update on a BPMN elements properties.\n *\n * @param  {Object} context\n *\n * @return {djs.model.Base} the updated element\n */\nUpdatePropertiesHandler.prototype.revert = function (context) {\n  let element = context.element,\n    properties = context.properties,\n    oldProperties = context.oldProperties,\n    businessObject = element.businessObject,\n    elementRegistry = this._elementRegistry,\n    ids = this._moddle.ids;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(properties[ID]);\n\n    elementRegistry.updateId(element, oldProperties[ID]);\n\n    ids.claim(oldProperties[ID], businessObject);\n  }\n\n  return context.changed;\n};\n\nfunction isIdChange(properties, businessObject) {\n  return ID in properties && properties[ID] !== businessObject[ID];\n}\n\nfunction getProperties(businessObject, properties) {\n  let propertyNames = keys(properties);\n\n  return reduce(\n    propertyNames,\n    function (result, key) {\n      // handle DI separately\n      if (key !== DI) {\n        result[key] = businessObject.get(key);\n      } else {\n        result[key] = getDiProperties(businessObject.di, keys(properties.di));\n      }\n\n      return result;\n    },\n    {}\n  );\n}\n\nfunction getDiProperties(di, propertyNames) {\n  return reduce(\n    propertyNames,\n    function (result, key) {\n      result[key] = di.get(key);\n\n      return result;\n    },\n    {}\n  );\n}\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function (value, key) {\n    if (key !== DI) {\n      businessObject.set(key, value);\n    } else {\n      // only update, if businessObject.di exists\n      if (businessObject.di) {\n        setDiProperties(businessObject.di, value);\n      }\n    }\n  });\n}\n\nfunction setDiProperties(di, properties) {\n  forEach(properties, function (value, key) {\n    di.set(key, value);\n  });\n}\n\nlet referencePropertyNames = [\"default\"];\n\n/**\n * Make sure we unwrap the actual business object\n * behind diagram element that may have been\n * passed as arguments.\n *\n * @param  {Object} properties\n *\n * @return {Object} unwrappedProps\n */\nfunction unwrapBusinessObjects(properties) {\n  let unwrappedProps = assign({}, properties);\n\n  referencePropertyNames.forEach(function (name) {\n    if (name in properties) {\n      unwrappedProps[name] = getBusinessObject(unwrappedProps[name]);\n    }\n  });\n\n  return unwrappedProps;\n}\n","import {\n  add as collectionAdd,\n  remove as collectionRemove,\n} from \"diagram-js/lib/util/Collections\";\n\nexport default function UpdateCanvasRootHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nUpdateCanvasRootHandler.$inject = [\"canvas\", \"modeling\"];\n\nUpdateCanvasRootHandler.prototype.execute = function (context) {\n  let canvas = this._canvas;\n\n  let newRoot = context.newRoot,\n    newRootBusinessObject = newRoot.businessObject,\n    oldRoot = canvas.getRootElement(),\n    oldRootBusinessObject = oldRoot.businessObject,\n    bpmnDefinitions = oldRootBusinessObject.$parent,\n    diPlane = oldRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(newRoot, true);\n\n  // (2) update root elements\n  collectionAdd(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = bpmnDefinitions;\n\n  collectionRemove(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = null;\n\n  // (3) wire di\n  oldRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = newRootBusinessObject;\n  newRootBusinessObject.di = diPlane;\n\n  context.oldRoot = oldRoot;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};\n\nUpdateCanvasRootHandler.prototype.revert = function (context) {\n  let canvas = this._canvas;\n\n  let newRoot = context.newRoot,\n    newRootBusinessObject = newRoot.businessObject,\n    oldRoot = context.oldRoot,\n    oldRootBusinessObject = oldRoot.businessObject,\n    bpmnDefinitions = newRootBusinessObject.$parent,\n    diPlane = newRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(oldRoot, true);\n\n  // (2) update root elements\n  collectionRemove(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = null;\n\n  collectionAdd(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = bpmnDefinitions;\n\n  // (3) wire di\n  newRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = oldRootBusinessObject;\n  oldRootBusinessObject.di = diPlane;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};\n","import { filter } from \"min-dash\";\n\nimport { eachElement } from \"diagram-js/lib/util/Elements\";\n\nimport {\n  getLanesRoot,\n  getChildLanes,\n  LANE_INDENTATION,\n} from \"../util/LaneUtil\";\n\n/**\n * A handler that allows us to add a new lane\n * above or below an existing one.\n *\n * @param {Modeling} modeling\n * @param {SpaceTool} spaceTool\n */\nexport default function AddLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nAddLaneHandler.$inject = [\"modeling\", \"spaceTool\"];\n\nAddLaneHandler.prototype.preExecute = function (context) {\n  let spaceTool = this._spaceTool,\n    modeling = this._modeling;\n\n  let shape = context.shape,\n    location = context.location;\n\n  let lanesRoot = getLanesRoot(shape);\n\n  let isRoot = lanesRoot === shape,\n    laneParent = isRoot ? shape : shape.parent;\n\n  let existingChildLanes = getChildLanes(laneParent);\n\n  // (0) add a lane if we currently got none and are adding to root\n  if (!existingChildLanes.length) {\n    modeling.createShape(\n      { type: \"bpmn:Lane\" },\n      {\n        x: shape.x + LANE_INDENTATION,\n        y: shape.y,\n        width: shape.width - LANE_INDENTATION,\n        height: shape.height,\n      },\n      laneParent\n    );\n  }\n\n  // (1) collect affected elements to create necessary space\n  let allAffected = [];\n\n  eachElement(lanesRoot, function (element) {\n    allAffected.push(element);\n\n    // handle element labels in the diagram root\n    if (element.label) {\n      allAffected.push(element.label);\n    }\n\n    if (element === shape) {\n      return [];\n    }\n\n    return filter(element.children, function (c) {\n      return c !== shape;\n    });\n  });\n\n  let offset = location === \"top\" ? -120 : 120,\n    lanePosition = location === \"top\" ? shape.y : shape.y + shape.height,\n    spacePos = lanePosition + (location === \"top\" ? 10 : -10),\n    direction = location === \"top\" ? \"n\" : \"s\";\n\n  let adjustments = spaceTool.calculateAdjustments(\n    allAffected,\n    \"y\",\n    offset,\n    spacePos\n  );\n\n  spaceTool.makeSpace(\n    adjustments.movingShapes,\n    adjustments.resizingShapes,\n    { x: 0, y: offset },\n    direction,\n    spacePos\n  );\n\n  // (2) create new lane at open space\n  context.newLane = modeling.createShape(\n    { type: \"bpmn:Lane\" },\n    {\n      x: shape.x + (isRoot ? LANE_INDENTATION : 0),\n      y: lanePosition - (location === \"top\" ? 120 : 0),\n      width: shape.width - (isRoot ? LANE_INDENTATION : 0),\n      height: 120,\n    },\n    laneParent\n  );\n};\n","import { getChildLanes, LANE_INDENTATION } from \"../util/LaneUtil\";\n\n/**\n * A handler that splits a lane into a number of sub-lanes,\n * creating new sub lanes, if necessary.\n *\n * @param {Modeling} modeling\n */\nexport default function SplitLaneHandler(modeling, translate) {\n  this._modeling = modeling;\n  this._translate = translate;\n}\n\nSplitLaneHandler.$inject = [\"modeling\", \"translate\"];\n\nSplitLaneHandler.prototype.preExecute = function (context) {\n  let modeling = this._modeling,\n    translate = this._translate;\n\n  let shape = context.shape,\n    newLanesCount = context.count;\n\n  let childLanes = getChildLanes(shape),\n    existingLanesCount = childLanes.length;\n\n  if (existingLanesCount > newLanesCount) {\n    throw new Error(\n      translate(\"more than {count} child lanes\", { count: newLanesCount })\n    );\n  }\n\n  let newLanesHeight = Math.round(shape.height / newLanesCount);\n\n  // Iterate from top to bottom in child lane order,\n  // resizing existing lanes and creating new ones\n  // so that they split the parent proportionally.\n  //\n  // Due to rounding related errors, the bottom lane\n  // needs to take up all the remaining space.\n  let laneY, laneHeight, laneBounds, newLaneAttrs, idx;\n\n  for (idx = 0; idx < newLanesCount; idx++) {\n    laneY = shape.y + idx * newLanesHeight;\n\n    // if bottom lane\n    if (idx === newLanesCount - 1) {\n      laneHeight = shape.height - newLanesHeight * idx;\n    } else {\n      laneHeight = newLanesHeight;\n    }\n\n    laneBounds = {\n      x: shape.x + LANE_INDENTATION,\n      y: laneY,\n      width: shape.width - LANE_INDENTATION,\n      height: laneHeight,\n    };\n\n    if (idx < existingLanesCount) {\n      // resize existing lane\n      modeling.resizeShape(childLanes[idx], laneBounds);\n    } else {\n      // create a new lane at position\n      newLaneAttrs = {\n        type: \"bpmn:Lane\",\n      };\n\n      modeling.createShape(newLaneAttrs, laneBounds, shape);\n    }\n  }\n};\n","import { is } from \"../../../util/ModelUtil\";\n\nimport { getLanesRoot, computeLanesResize } from \"../util/LaneUtil\";\n\nimport { eachElement } from \"diagram-js/lib/util/Elements\";\n\nimport { asTRBL } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { substractTRBL } from \"diagram-js/lib/features/resize/ResizeUtil\";\n\n/**\n * A handler that resizes a lane.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nResizeLaneHandler.$inject = [\"modeling\", \"spaceTool\"];\n\nResizeLaneHandler.prototype.preExecute = function (context) {\n  let shape = context.shape,\n    newBounds = context.newBounds,\n    balanced = context.balanced;\n\n  if (balanced !== false) {\n    this.resizeBalanced(shape, newBounds);\n  } else {\n    this.resizeSpace(shape, newBounds);\n  }\n};\n\n/**\n * Resize balanced, adjusting next / previous lane sizes.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeBalanced = function (shape, newBounds) {\n  let modeling = this._modeling;\n\n  let resizeNeeded = computeLanesResize(shape, newBounds);\n\n  // resize the lane\n  modeling.resizeShape(shape, newBounds);\n\n  // resize other lanes as needed\n  resizeNeeded.forEach(function (r) {\n    modeling.resizeShape(r.shape, r.newBounds);\n  });\n};\n\n/**\n * Resize, making actual space and moving below / above elements.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeSpace = function (shape, newBounds) {\n  let spaceTool = this._spaceTool;\n\n  let shapeTrbl = asTRBL(shape),\n    newTrbl = asTRBL(newBounds);\n\n  let trblDiff = substractTRBL(newTrbl, shapeTrbl);\n\n  let lanesRoot = getLanesRoot(shape);\n\n  let allAffected = [],\n    allLanes = [];\n\n  eachElement(lanesRoot, function (element) {\n    allAffected.push(element);\n\n    if (is(element, \"bpmn:Lane\") || is(element, \"bpmn:Participant\")) {\n      allLanes.push(element);\n    }\n\n    return element.children;\n  });\n\n  let change, spacePos, direction, offset, adjustments;\n\n  if (trblDiff.bottom || trblDiff.top) {\n    change = trblDiff.bottom || trblDiff.top;\n    spacePos =\n      shape.y +\n      (trblDiff.bottom ? shape.height : 0) +\n      (trblDiff.bottom ? -10 : 10);\n    direction = trblDiff.bottom ? \"s\" : \"n\";\n\n    offset = trblDiff.top > 0 || trblDiff.bottom < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(\n      allAffected,\n      \"y\",\n      offset,\n      spacePos\n    );\n\n    spaceTool.makeSpace(\n      adjustments.movingShapes,\n      adjustments.resizingShapes,\n      { x: 0, y: change },\n      direction\n    );\n  }\n\n  if (trblDiff.left || trblDiff.right) {\n    change = trblDiff.right || trblDiff.left;\n    spacePos =\n      shape.x +\n      (trblDiff.right ? shape.width : 0) +\n      (trblDiff.right ? -10 : 100);\n    direction = trblDiff.right ? \"e\" : \"w\";\n\n    offset = trblDiff.left > 0 || trblDiff.right < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(\n      allLanes,\n      \"x\",\n      offset,\n      spacePos\n    );\n\n    spaceTool.makeSpace(\n      adjustments.movingShapes,\n      adjustments.resizingShapes,\n      { x: change, y: 0 },\n      direction\n    );\n  }\n};\n","import { collectLanes, getLanesRoot } from \"../util/LaneUtil\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove,\n} from \"diagram-js/lib/util/Collections\";\n\nimport { asTRBL } from \"diagram-js/lib/layout/LayoutUtil\";\n\nconst FLOW_NODE_REFS_ATTR = \"flowNodeRef\",\n  LANES_ATTR = \"lanes\";\n\n/**\n * A handler that updates lane refs on changed elements\n */\nexport default function UpdateFlowNodeRefsHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateFlowNodeRefsHandler.$inject = [\"elementRegistry\"];\n\nUpdateFlowNodeRefsHandler.prototype.computeUpdates = function (\n  flowNodeShapes,\n  laneShapes\n) {\n  let handledNodes = [];\n\n  let updates = [];\n\n  let participantCache = {};\n\n  let allFlowNodeShapes = [];\n\n  function isInLaneShape(element, laneShape) {\n    let laneTrbl = asTRBL(laneShape);\n\n    let elementMid = {\n      x: element.x + element.width / 2,\n      y: element.y + element.height / 2,\n    };\n\n    return (\n      elementMid.x > laneTrbl.left &&\n      elementMid.x < laneTrbl.right &&\n      elementMid.y > laneTrbl.top &&\n      elementMid.y < laneTrbl.bottom\n    );\n  }\n\n  function addFlowNodeShape(flowNodeShape) {\n    if (handledNodes.indexOf(flowNodeShape) === -1) {\n      allFlowNodeShapes.push(flowNodeShape);\n      handledNodes.push(flowNodeShape);\n    }\n  }\n\n  function getAllLaneShapes(flowNodeShape) {\n    let root = getLanesRoot(flowNodeShape);\n\n    if (!participantCache[root.id]) {\n      participantCache[root.id] = collectLanes(root);\n    }\n\n    return participantCache[root.id];\n  }\n\n  function getNewLanes(flowNodeShape) {\n    if (!flowNodeShape.parent) {\n      return [];\n    }\n\n    let allLaneShapes = getAllLaneShapes(flowNodeShape);\n\n    return allLaneShapes\n      .filter(function (l) {\n        return isInLaneShape(flowNodeShape, l);\n      })\n      .map(function (shape) {\n        return shape.businessObject;\n      });\n  }\n\n  laneShapes.forEach(function (laneShape) {\n    let root = getLanesRoot(laneShape);\n\n    if (!root || handledNodes.indexOf(root) !== -1) {\n      return;\n    }\n\n    let children = root.children.filter(function (c) {\n      return is(c, \"bpmn:FlowNode\");\n    });\n\n    children.forEach(addFlowNodeShape);\n\n    handledNodes.push(root);\n  });\n\n  flowNodeShapes.forEach(addFlowNodeShape);\n\n  allFlowNodeShapes.forEach(function (flowNodeShape) {\n    let flowNode = flowNodeShape.businessObject;\n\n    let lanes = flowNode.get(LANES_ATTR),\n      remove = lanes.slice(),\n      add = getNewLanes(flowNodeShape);\n\n    updates.push({ flowNode: flowNode, remove: remove, add: add });\n  });\n\n  return updates;\n};\n\nUpdateFlowNodeRefsHandler.prototype.execute = function (context) {\n  let updates = context.updates;\n\n  if (!updates) {\n    updates = context.updates = this.computeUpdates(\n      context.flowNodeShapes,\n      context.laneShapes\n    );\n  }\n\n  updates.forEach(function (update) {\n    let flowNode = update.flowNode,\n      lanes = flowNode.get(LANES_ATTR);\n\n    // unwire old\n    update.remove.forEach(function (oldLane) {\n      collectionRemove(lanes, oldLane);\n      collectionRemove(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire new\n    update.add.forEach(function (newLane) {\n      collectionAdd(lanes, newLane);\n      collectionAdd(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n\nUpdateFlowNodeRefsHandler.prototype.revert = function (context) {\n  let updates = context.updates;\n\n  updates.forEach(function (update) {\n    let flowNode = update.flowNode,\n      lanes = flowNode.get(LANES_ATTR);\n\n    // unwire new\n    update.add.forEach(function (newLane) {\n      collectionRemove(lanes, newLane);\n      collectionRemove(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire old\n    update.remove.forEach(function (oldLane) {\n      collectionAdd(lanes, oldLane);\n      collectionAdd(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n","export default function IdClaimHandler(moddle) {\n  this._moddle = moddle;\n}\n\nIdClaimHandler.$inject = [\"moddle\"];\n\nIdClaimHandler.prototype.execute = function (context) {\n  let ids = this._moddle.ids,\n    id = context.id,\n    element = context.element,\n    claiming = context.claiming;\n\n  if (claiming) {\n    ids.claim(id, element);\n  } else {\n    ids.unclaim(id);\n  }\n};\n\n/**\n * Command revert implementation.\n */\nIdClaimHandler.prototype.revert = function (context) {\n  let ids = this._moddle.ids,\n    id = context.id,\n    element = context.element,\n    claiming = context.claiming;\n\n  if (claiming) {\n    ids.unclaim(id);\n  } else {\n    ids.claim(id, element);\n  }\n};\n","import { assign, forEach } from \"min-dash\";\n\nlet DEFAULT_COLORS = {\n  fill: undefined,\n  stroke: undefined,\n};\n\nexport default function SetColorHandler(commandStack) {\n  this._commandStack = commandStack;\n}\n\nSetColorHandler.$inject = [\"commandStack\"];\n\nSetColorHandler.prototype.postExecute = function (context) {\n  let elements = context.elements,\n    colors = context.colors || DEFAULT_COLORS;\n\n  let self = this;\n\n  let di = {};\n\n  if (\"fill\" in colors) {\n    assign(di, { fill: colors.fill });\n  }\n\n  if (\"stroke\" in colors) {\n    assign(di, { stroke: colors.stroke });\n  }\n\n  forEach(elements, function (element) {\n    self._commandStack.execute(\"element.updateProperties\", {\n      element: element,\n      properties: {\n        di: di,\n      },\n    });\n  });\n};\n","import { setLabel, getLabel } from \"../LabelUtil\";\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel,\n} from \"../../../util/LabelUtil\";\n\nimport { is } from \"../../../util/ModelUtil\";\n\nlet NULL_DIMENSIONS = {\n  width: 0,\n  height: 0,\n};\n\n/**\n * A handler that updates the text of a BPMN element.\n */\nexport default function UpdateLabelHandler(modeling, textRenderer) {\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {String} text\n   */\n  function setText(element, text) {\n    // external label if present\n    let label = element.label || element;\n\n    let labelTarget = element.labelTarget || element;\n\n    setLabel(label, text, labelTarget !== label);\n\n    return [label, labelTarget];\n  }\n\n  function preExecute(ctx) {\n    let element = ctx.element,\n      businessObject = element.businessObject,\n      newLabel = ctx.newLabel;\n\n    if (\n      !isLabel(element) &&\n      isLabelExternal(element) &&\n      !hasExternalLabel(element) &&\n      !isEmptyText(newLabel)\n    ) {\n      // create label\n      let paddingTop = 7;\n\n      let labelCenter = getExternalLabelMid(element);\n\n      labelCenter = {\n        x: labelCenter.x,\n        y: labelCenter.y + paddingTop,\n      };\n\n      modeling.createLabel(element, labelCenter, {\n        id: businessObject.id + \"_label\",\n        businessObject: businessObject,\n      });\n    }\n  }\n\n  function execute(ctx) {\n    ctx.oldLabel = getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  function postExecute(ctx) {\n    let element = ctx.element,\n      label = element.label || element,\n      newLabel = ctx.newLabel,\n      newBounds = ctx.newBounds,\n      hints = ctx.hints || {};\n\n    if (isLabel(label) && isEmptyText(newLabel)) {\n      if (hints.removeShape !== false) {\n        modeling.removeShape(label, { unsetLabel: false });\n      }\n\n      return;\n    }\n\n    // ignore internal labels for elements except text annotations\n    if (!isLabelExternal(element) && !is(element, \"bpmn:TextAnnotation\")) {\n      return;\n    }\n\n    let text = getLabel(label);\n\n    // resize element based on label _or_ pre-defined bounds\n    if (typeof newBounds === \"undefined\") {\n      newBounds = textRenderer.getExternalLabelBounds(label, text);\n    }\n\n    // setting newBounds to false or _null_ will\n    // disable the postExecute resize operation\n    if (newBounds) {\n      modeling.resizeShape(label, newBounds, NULL_DIMENSIONS);\n    }\n  }\n\n  // API\n\n  this.preExecute = preExecute;\n  this.execute = execute;\n  this.revert = revert;\n  this.postExecute = postExecute;\n}\n\nUpdateLabelHandler.$inject = [\"modeling\", \"textRenderer\"];\n\n// helpers ///////////////////////\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}\n","import inherits from \"inherits\";\n\nimport BaseModeling from \"diagram-js/lib/features/modeling/Modeling\";\n\nimport UpdatePropertiesHandler from \"./cmd/UpdatePropertiesHandler\";\nimport UpdateCanvasRootHandler from \"./cmd/UpdateCanvasRootHandler\";\nimport AddLaneHandler from \"./cmd/AddLaneHandler\";\nimport SplitLaneHandler from \"./cmd/SplitLaneHandler\";\nimport ResizeLaneHandler from \"./cmd/ResizeLaneHandler\";\nimport UpdateFlowNodeRefsHandler from \"./cmd/UpdateFlowNodeRefsHandler\";\nimport IdClaimHandler from \"./cmd/IdClaimHandler\";\nimport SetColorHandler from \"./cmd/SetColorHandler\";\n\nimport UpdateLabelHandler from \"../label-editing/cmd/UpdateLabelHandler\";\n\n/**\n * BPMN 2.0 modeling features activator\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n * @param {BpmnRules} bpmnRules\n */\nexport default function Modeling(\n  eventBus,\n  elementFactory,\n  commandStack,\n  bpmnRules\n) {\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n\n  this._bpmnRules = bpmnRules;\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [\"eventBus\", \"elementFactory\", \"commandStack\", \"bpmnRules\"];\n\nModeling.prototype.getHandlers = function () {\n  let handlers = BaseModeling.prototype.getHandlers.call(this);\n\n  handlers[\"element.updateProperties\"] = UpdatePropertiesHandler;\n  handlers[\"canvas.updateRoot\"] = UpdateCanvasRootHandler;\n  handlers[\"lane.add\"] = AddLaneHandler;\n  handlers[\"lane.resize\"] = ResizeLaneHandler;\n  handlers[\"lane.split\"] = SplitLaneHandler;\n  handlers[\"lane.updateRefs\"] = UpdateFlowNodeRefsHandler;\n  handlers[\"id.updateClaim\"] = IdClaimHandler;\n  handlers[\"element.setColor\"] = SetColorHandler;\n  handlers[\"element.updateLabel\"] = UpdateLabelHandler;\n\n  return handlers;\n};\n\nModeling.prototype.updateLabel = function (\n  element,\n  newLabel,\n  newBounds,\n  hints\n) {\n  this._commandStack.execute(\"element.updateLabel\", {\n    element: element,\n    newLabel: newLabel,\n    newBounds: newBounds,\n    hints: hints || {},\n  });\n};\n\nModeling.prototype.connect = function (source, target, attrs, hints) {\n  let bpmnRules = this._bpmnRules;\n\n  if (!attrs) {\n    attrs = bpmnRules.canConnect(source, target);\n  }\n\n  if (!attrs) {\n    return;\n  }\n\n  return this.createConnection(source, target, attrs, source.parent, hints);\n};\n\nModeling.prototype.updateProperties = function (element, properties) {\n  this._commandStack.execute(\"element.updateProperties\", {\n    element: element,\n    properties: properties,\n  });\n};\n\nModeling.prototype.resizeLane = function (laneShape, newBounds, balanced) {\n  this._commandStack.execute(\"lane.resize\", {\n    shape: laneShape,\n    newBounds: newBounds,\n    balanced: balanced,\n  });\n};\n\nModeling.prototype.addLane = function (targetLaneShape, location) {\n  let context = {\n    shape: targetLaneShape,\n    location: location,\n  };\n\n  this._commandStack.execute(\"lane.add\", context);\n\n  return context.newLane;\n};\n\nModeling.prototype.splitLane = function (targetLane, count) {\n  this._commandStack.execute(\"lane.split\", {\n    shape: targetLane,\n    count: count,\n  });\n};\n\n/**\n * Transform the current diagram into a collaboration.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeCollaboration = function () {\n  let collaborationElement = this._create(\"root\", {\n    type: \"bpmn:Collaboration\",\n  });\n\n  let context = {\n    newRoot: collaborationElement,\n  };\n\n  this._commandStack.execute(\"canvas.updateRoot\", context);\n\n  return collaborationElement;\n};\n\nModeling.prototype.updateLaneRefs = function (flowNodeShapes, laneShapes) {\n  this._commandStack.execute(\"lane.updateRefs\", {\n    flowNodeShapes: flowNodeShapes,\n    laneShapes: laneShapes,\n  });\n};\n\n/**\n * Transform the current diagram into a process.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeProcess = function () {\n  let processElement = this._create(\"root\", {\n    type: \"bpmn:Process-action\",\n  });\n\n  let context = {\n    newRoot: processElement,\n  };\n\n  this._commandStack.execute(\"canvas.updateRoot\", context);\n};\n\nModeling.prototype.claimId = function (id, moddleElement) {\n  this._commandStack.execute(\"id.updateClaim\", {\n    id: id,\n    element: moddleElement,\n    claiming: true,\n  });\n};\n\nModeling.prototype.unclaimId = function (id, moddleElement) {\n  this._commandStack.execute(\"id.updateClaim\", {\n    id: id,\n    element: moddleElement,\n  });\n};\n\nModeling.prototype.setColor = function (elements, colors) {\n  if (!elements.length) {\n    elements = [elements];\n  }\n\n  this._commandStack.execute(\"element.setColor\", {\n    elements: elements,\n    colors: colors,\n  });\n};\n","import inherits from \"inherits\";\n\nimport { assign } from \"min-dash\";\n\nimport BaseLayouter from \"diagram-js/lib/layout/BaseLayouter\";\n\nimport {\n  repairConnection,\n  withoutRedundantPoints,\n} from \"diagram-js/lib/layout/ManhattanLayout\";\n\nimport { getMid, getOrientation } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { isExpanded } from \"../../util/DiUtil\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nlet ATTACH_ORIENTATION_PADDING = -10,\n  BOUNDARY_TO_HOST_THRESHOLD = 40;\n\nlet oppositeOrientationMapping = {\n  top: \"bottom\",\n  \"top-right\": \"bottom-left\",\n  \"top-left\": \"bottom-right\",\n  right: \"left\",\n  bottom: \"top\",\n  \"bottom-right\": \"top-left\",\n  \"bottom-left\": \"top-right\",\n  left: \"right\",\n};\n\nlet orientationDirectionMapping = {\n  top: \"t\",\n  right: \"r\",\n  bottom: \"b\",\n  left: \"l\",\n};\n\nexport default function BpmnLayouter() {}\n\ninherits(BpmnLayouter, BaseLayouter);\n\nBpmnLayouter.prototype.layoutConnection = function (connection, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  let source = hints.source || connection.source,\n    target = hints.target || connection.target,\n    waypoints = hints.waypoints || connection.waypoints,\n    connectionStart = hints.connectionStart,\n    connectionEnd = hints.connectionEnd;\n\n  let manhattanOptions, updatedWaypoints;\n\n  if (!connectionStart) {\n    connectionStart = getConnectionDocking(waypoints && waypoints[0], source);\n  }\n\n  if (!connectionEnd) {\n    connectionEnd = getConnectionDocking(\n      waypoints && waypoints[waypoints.length - 1],\n      target\n    );\n  }\n\n  // TODO(nikku): support vertical modeling\n  // and invert preferredLayouts accordingly\n\n  if (\n    is(connection, \"bpmn:Association\") ||\n    is(connection, \"bpmn:DataAssociation\")\n  ) {\n    if (waypoints && !isCompensationAssociation(source, target)) {\n      return [].concat([connectionStart], waypoints.slice(1, -1), [\n        connectionEnd,\n      ]);\n    }\n  }\n\n  if (is(connection, \"bpmn:MessageFlow\")) {\n    manhattanOptions = getMessageFlowManhattanOptions(source, target);\n  } else if (\n    is(connection, \"bpmn:SequenceFlow\") ||\n    isCompensationAssociation(source, target)\n  ) {\n    // layout all connection between flow elements h:h, except for\n    // (1) outgoing of boundary events -> layout based on attach orientation and target orientation\n    // (2) incoming/outgoing of gateways -> v:h for outgoing, h:v for incoming\n    // (3) loops\n    if (source === target) {\n      manhattanOptions = {\n        preferredLayouts: getLoopPreferredLayout(source, connection),\n      };\n    } else if (is(source, \"bpmn:BoundaryEvent\")) {\n      manhattanOptions = {\n        preferredLayouts: getBoundaryEventPreferredLayouts(\n          source,\n          target,\n          connectionEnd\n        ),\n      };\n    } else if (is(source, \"bpmn:Gateway\")) {\n      manhattanOptions = {\n        preferredLayouts: [\"v:h\"],\n      };\n    } else if (is(target, \"bpmn:Gateway\")) {\n      manhattanOptions = {\n        preferredLayouts: [\"h:v\"],\n      };\n    } else {\n      manhattanOptions = {\n        preferredLayouts: [\"h:h\"],\n      };\n    }\n  }\n\n  if (manhattanOptions) {\n    manhattanOptions = assign(manhattanOptions, hints);\n\n    updatedWaypoints = withoutRedundantPoints(\n      repairConnection(\n        source,\n        target,\n        connectionStart,\n        connectionEnd,\n        waypoints,\n        manhattanOptions\n      )\n    );\n  }\n\n  return updatedWaypoints || [connectionStart, connectionEnd];\n};\n\n// helpers //////////\n\nfunction getAttachOrientation(attachedElement) {\n  let hostElement = attachedElement.host;\n\n  return getOrientation(\n    getMid(attachedElement),\n    hostElement,\n    ATTACH_ORIENTATION_PADDING\n  );\n}\n\nfunction getMessageFlowManhattanOptions(source, target) {\n  return {\n    preferredLayouts: [\"straight\", \"v:v\"],\n    preserveDocking: getMessageFlowPreserveDocking(source, target),\n  };\n}\n\nfunction getMessageFlowPreserveDocking(source, target) {\n  // (1) docking element connected to participant has precedence\n  if (is(target, \"bpmn:Participant\")) {\n    return \"source\";\n  }\n\n  if (is(source, \"bpmn:Participant\")) {\n    return \"target\";\n  }\n\n  // (2) docking element connected to expanded sub-process has precedence\n  if (isExpandedLoop(target)) {\n    return \"source\";\n  }\n\n  if (isExpandedLoop(source)) {\n    return \"target\";\n  }\n\n  // (3) docking event has precedence\n  if (is(target, \"bpmn:Event\")) {\n    return \"target\";\n  }\n\n  if (is(source, \"bpmn:Event\")) {\n    return \"source\";\n  }\n\n  return null;\n}\n\nfunction getConnectionDocking(point, shape) {\n  return point ? point.original || point : getMid(shape);\n}\n\nfunction isCompensationAssociation(source, target) {\n  return (\n    is(target, \"bpmn:Activity\") &&\n    is(source, \"bpmn:BoundaryEvent\") &&\n    target.businessObject.isForCompensation\n  );\n}\n\nfunction isExpandedLoop(element) {\n  return is(element, \"bpmn:Loop\") && isExpanded(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction isAnyOrientation(orientation, orientations) {\n  return orientations.indexOf(orientation) !== -1;\n}\n\nfunction getHorizontalOrientation(orientation) {\n  let matches = /right|left/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction getVerticalOrientation(orientation) {\n  let matches = /top|bottom/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction isOppositeOrientation(a, b) {\n  return oppositeOrientationMapping[a] === b;\n}\n\nfunction isOppositeHorizontalOrientation(a, b) {\n  let horizontalOrientation = getHorizontalOrientation(a);\n\n  let oppositeHorizontalOrientation =\n    oppositeOrientationMapping[horizontalOrientation];\n\n  return b.indexOf(oppositeHorizontalOrientation) !== -1;\n}\n\nfunction isOppositeVerticalOrientation(a, b) {\n  let verticalOrientation = getVerticalOrientation(a);\n\n  let oppositeVerticalOrientation =\n    oppositeOrientationMapping[verticalOrientation];\n\n  return b.indexOf(oppositeVerticalOrientation) !== -1;\n}\n\nfunction isHorizontalOrientation(orientation) {\n  return orientation === \"right\" || orientation === \"left\";\n}\n\nfunction getLoopPreferredLayout(source, connection) {\n  let waypoints = connection.waypoints;\n\n  let orientation =\n    waypoints && waypoints.length && getOrientation(waypoints[0], source);\n\n  if (orientation === \"top\") {\n    return [\"t:r\"];\n  } else if (orientation === \"right\") {\n    return [\"r:b\"];\n  } else if (orientation === \"left\") {\n    return [\"l:t\"];\n  }\n\n  return [\"b:l\"];\n}\n\nfunction getBoundaryEventPreferredLayouts(source, target, end) {\n  let sourceMid = getMid(source),\n    targetMid = getMid(target),\n    attachOrientation = getAttachOrientation(source),\n    sourceLayout,\n    targetLayout;\n\n  let isLoop = isSame(source.host, target);\n\n  let attachedToSide = isAnyOrientation(attachOrientation, [\n    \"top\",\n    \"right\",\n    \"bottom\",\n    \"left\",\n  ]);\n\n  let targetOrientation = getOrientation(targetMid, sourceMid, {\n    x: source.width / 2 + target.width / 2,\n    y: source.height / 2 + target.height / 2,\n  });\n\n  if (isLoop) {\n    return getBoundaryEventLoopLayout(\n      attachOrientation,\n      attachedToSide,\n      source,\n      target,\n      end\n    );\n  }\n\n  // source layout\n  sourceLayout = getBoundaryEventSourceLayout(\n    attachOrientation,\n    targetOrientation,\n    attachedToSide\n  );\n\n  // target layout\n  targetLayout = getBoundaryEventTargetLayout(\n    attachOrientation,\n    targetOrientation,\n    attachedToSide\n  );\n\n  return [sourceLayout + \":\" + targetLayout];\n}\n\nfunction getBoundaryEventLoopLayout(\n  attachOrientation,\n  attachedToSide,\n  source,\n  target,\n  end\n) {\n  let orientation = attachedToSide\n      ? attachOrientation\n      : getVerticalOrientation(attachOrientation),\n    sourceLayout = orientationDirectionMapping[orientation],\n    targetLayout;\n\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n      targetLayout = shouldConnectToSameSide(\"y\", source, target, end)\n        ? \"h\"\n        : \"b\";\n    } else {\n      targetLayout = shouldConnectToSameSide(\"x\", source, target, end)\n        ? \"v\"\n        : \"l\";\n    }\n  } else {\n    targetLayout = \"v\";\n  }\n\n  return [sourceLayout + \":\" + targetLayout];\n}\n\nfunction shouldConnectToSameSide(axis, source, target, end) {\n  let threshold = BOUNDARY_TO_HOST_THRESHOLD;\n\n  return !(\n    areCloseOnAxis(axis, end, target, threshold) ||\n    areCloseOnAxis(\n      axis,\n      end,\n      {\n        x: target.x + target.width,\n        y: target.y + target.height,\n      },\n      threshold\n    ) ||\n    areCloseOnAxis(axis, end, getMid(source), threshold)\n  );\n}\n\nfunction areCloseOnAxis(axis, a, b, threshold) {\n  return Math.abs(a[axis] - b[axis]) < threshold;\n}\n\nfunction getBoundaryEventSourceLayout(\n  attachOrientation,\n  targetOrientation,\n  attachedToSide\n) {\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    return orientationDirectionMapping[attachOrientation];\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // same vertical or opposite horizontal orientation\n  if (\n    isSame(\n      getVerticalOrientation(attachOrientation),\n      getVerticalOrientation(targetOrientation)\n    ) ||\n    isOppositeOrientation(\n      getHorizontalOrientation(attachOrientation),\n      getHorizontalOrientation(targetOrientation)\n    )\n  ) {\n    return orientationDirectionMapping[\n      getVerticalOrientation(attachOrientation)\n    ];\n  }\n\n  // fallback\n  return orientationDirectionMapping[\n    getHorizontalOrientation(attachOrientation)\n  ];\n}\n\nfunction getBoundaryEventTargetLayout(\n  attachOrientation,\n  targetOrientation,\n  attachedToSide\n) {\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n      // orientation is right or left\n\n      // opposite horizontal orientation or same orientation\n      if (\n        isOppositeHorizontalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return \"h\";\n      }\n\n      // fallback\n      return \"v\";\n    } else {\n      // orientation is top or bottom\n\n      // opposite vertical orientation or same orientation\n      if (\n        isOppositeVerticalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return \"v\";\n      }\n\n      // fallback\n      return \"h\";\n    }\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // orientation is right, left\n  // or same vertical orientation but also right or left\n  if (\n    isHorizontalOrientation(targetOrientation) ||\n    (isSame(\n      getVerticalOrientation(attachOrientation),\n      getVerticalOrientation(targetOrientation)\n    ) &&\n      getHorizontalOrientation(targetOrientation))\n  ) {\n    return \"h\";\n  } else {\n    return \"v\";\n  }\n}\n","import BehaviorModule from \"./behavior\";\nimport RulesModule from \"../rules\";\nimport DiOrderingModule from \"../di-ordering\";\nimport OrderingModule from \"../ordering\";\nimport ReplaceModule from \"../replace\";\n\nimport CommandModule from \"diagram-js/lib/command\";\nimport TooltipsModule from \"diagram-js/lib/features/tooltips\";\nimport LabelSupportModule from \"diagram-js/lib/features/label-support\";\nimport AttachSupportModule from \"diagram-js/lib/features/attach-support\";\nimport SelectionModule from \"diagram-js/lib/features/selection\";\nimport ChangeSupportModule from \"diagram-js/lib/features/change-support\";\nimport SpaceToolModule from \"diagram-js/lib/features/space-tool\";\n\nimport BpmnFactory from \"./BpmnFactory\";\nimport BpmnUpdater from \"./BpmnUpdater\";\nimport ElementFactory from \"./ElementFactory\";\nimport Modeling from \"./Modeling\";\nimport BpmnLayouter from \"./BpmnLayouter\";\nimport CroppingConnectionDocking from \"diagram-js/lib/layout/CroppingConnectionDocking\";\n\nexport default {\n  __init__: [\"modeling\", \"bpmnUpdater\"],\n  __depends__: [\n    BehaviorModule,\n    RulesModule,\n    DiOrderingModule,\n    OrderingModule,\n    ReplaceModule,\n    CommandModule,\n    TooltipsModule,\n    LabelSupportModule,\n    AttachSupportModule,\n    SelectionModule,\n    ChangeSupportModule,\n    SpaceToolModule,\n  ],\n  bpmnFactory: [\"type\", BpmnFactory],\n  bpmnUpdater: [\"type\", BpmnUpdater],\n  elementFactory: [\"type\", ElementFactory],\n  modeling: [\"type\", Modeling],\n  layouter: [\"type\", BpmnLayouter],\n  connectionDocking: [\"type\", CroppingConnectionDocking],\n};\n","import { assign } from \"min-dash\";\n\n/**\n * A palette provider for BPMN 2.0 elements.\n */\nexport default function PaletteProvider(\n  palette,\n  create,\n  elementFactory,\n  spaceTool,\n  lassoTool,\n  handTool,\n  globalConnect,\n  translate\n) {\n  this._palette = palette;\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._spaceTool = spaceTool;\n  this._lassoTool = lassoTool;\n  this._handTool = handTool;\n  this._globalConnect = globalConnect;\n  this._translate = translate;\n\n  palette.registerProvider(this);\n}\n\nPaletteProvider.$inject = [\n  \"palette\",\n  \"create\",\n  \"elementFactory\",\n  \"spaceTool\",\n  \"lassoTool\",\n  \"handTool\",\n  \"globalConnect\",\n  \"translate\",\n];\n\nPaletteProvider.prototype.getPaletteEntries = function (element) {\n  let actions = {},\n    create = this._create,\n    elementFactory = this._elementFactory,\n    spaceTool = this._spaceTool,\n    lassoTool = this._lassoTool,\n    handTool = this._handTool,\n    globalConnect = this._globalConnect,\n    translate = this._translate;\n\n  function createAction(type, group, className, title, options) {\n    function createListener(event) {\n      let shape = elementFactory.createShape(assign({ type: type }, options));\n\n      if (options) {\n        shape.businessObject.di.isExpanded = options.isExpanded;\n      }\n\n      create.start(event, shape);\n    }\n\n    let shortType = type.replace(/^bpmn:/, \"\");\n\n    return {\n      group: group,\n      className: className,\n      title: title || translate(\"Create {type}\", { type: shortType }),\n      action: {\n        dragstart: createListener,\n        click: createListener,\n      },\n    };\n  }\n\n  function createLoop(event) {\n    let loop = elementFactory.createShape({\n      type: \"bpmn:Loop\",\n      x: 0,\n      y: 0,\n      isExpanded: true,\n    });\n\n    let startEvent = elementFactory.createShape({\n      type: \"bpmn:StartEvent\",\n      x: 40,\n      y: 82,\n      parent: loop,\n    });\n\n    create.start(event, [loop, startEvent], {\n      hints: {\n        autoSelect: [startEvent],\n      },\n    });\n  }\n\n  function createParticipant(event) {\n    create.start(event, elementFactory.createParticipantShape());\n  }\n\n  assign(actions, {\n    \"hand-tool\": {\n      group: \"tools\",\n      className: \"bpmn-icon-hand-tool\",\n      title: translate(\"Activate the hand tool\"),\n      action: {\n        click: function (event) {\n          handTool.activateHand(event);\n        },\n      },\n    },\n    \"lasso-tool\": {\n      group: \"tools\",\n      className: \"bpmn-icon-lasso-tool\",\n      title: translate(\"Activate the lasso tool\"),\n      action: {\n        click: function (event) {\n          lassoTool.activateSelection(event);\n        },\n      },\n    },\n    \"space-tool\": {\n      group: \"tools\",\n      className: \"bpmn-icon-space-tool\",\n      title: translate(\"Activate the create/remove space tool\"),\n      action: {\n        click: function (event) {\n          spaceTool.activateSelection(event);\n        },\n      },\n    },\n    \"global-connect-tool\": {\n      group: \"tools\",\n      className: \"bpmn-icon-connection-multi\",\n      title: translate(\"Activate the global connect tool\"),\n      action: {\n        click: function (event) {\n          globalConnect.toggle(event);\n        },\n      },\n    },\n    \"tool-separator\": {\n      group: \"tools\",\n      separator: true,\n    },\n    \"create.start-event\": createAction(\n      \"bpmn:StartEvent\",\n      \"event\",\n      \"bpmn-icon-start-event-none\",\n      translate(\"Create StartEvent\")\n    ),\n    \"create.intermediate-event\": createAction(\n      \"bpmn:IntermediateThrowEvent\",\n      \"event\",\n      \"bpmn-icon-intermediate-event-none\",\n      translate(\"Create Intermediate/Boundary Event\")\n    ),\n    \"create.end-event\": createAction(\n      \"bpmn:EndEvent\",\n      \"event\",\n      \"bpmn-icon-end-event-none\",\n      translate(\"Create EndEvent\")\n    ),\n    \"create.exclusive-gateway\": createAction(\n      \"bpmn:ExclusiveGateway\",\n      \"gateway\",\n      \"bpmn-icon-gateway-none\",\n      translate(\"Create Gateway\")\n    ),\n    \"create.task\": createAction(\n      \"bpmn:Task\",\n      \"activity\",\n      \"bpmn-icon-task\",\n      translate(\"Create Task\")\n    ),\n    \"create.data-object\": createAction(\n      \"bpmn:DataObjectReference\",\n      \"data-object\",\n      \"bpmn-icon-data-object\",\n      translate(\"Create DataObjectReference\")\n    ),\n    \"create.data-store\": createAction(\n      \"bpmn:DataStoreReference\",\n      \"data-store\",\n      \"bpmn-icon-data-store\",\n      translate(\"Create DataStoreReference\")\n    ),\n    \"create.loop\": {\n      group: \"activity\",\n      className: \"bpmn-icon-loop-expanded\",\n      title: translate(\"Create Loop\"),\n      action: {\n        dragstart: createLoop,\n        click: createLoop,\n      },\n    },\n    \"create.participant-expanded\": {\n      group: \"collaboration\",\n      className: \"bpmn-icon-participant\",\n      title: translate(\"Create Pool/Participant\"),\n      action: {\n        dragstart: createParticipant,\n        click: createParticipant,\n      },\n    },\n    \"create.group\": createAction(\n      \"bpmn:Group\",\n      \"artifact\",\n      \"bpmn-icon-group\",\n      translate(\"Create Group\")\n    ),\n  });\n\n  return actions;\n};\n","import PaletteModule from \"diagram-js/lib/features/palette\";\nimport CreateModule from \"diagram-js/lib/features/create\";\nimport SpaceToolModule from \"diagram-js/lib/features/space-tool\";\nimport LassoToolModule from \"diagram-js/lib/features/lasso-tool\";\nimport HandToolModule from \"diagram-js/lib/features/hand-tool\";\nimport GlobalConnectModule from \"diagram-js/lib/features/global-connect\";\nimport translate from \"diagram-js/lib/i18n/translate\";\n\nimport PaletteProvider from \"./PaletteProvider\";\n\nexport default {\n  __depends__: [\n    PaletteModule,\n    CreateModule,\n    SpaceToolModule,\n    LassoToolModule,\n    HandToolModule,\n    GlobalConnectModule,\n    translate,\n  ],\n  __init__: [\"paletteProvider\"],\n  paletteProvider: [\"type\", PaletteProvider],\n};\n","import CommandInterceptor from \"diagram-js/lib/command/CommandInterceptor\";\n\nimport inherits from \"inherits\";\n\nimport cssEscape from \"css.escape\";\n\nimport { assign, forEach } from \"min-dash\";\n\nimport { query as domQuery } from \"min-dom\";\n\nimport { attr as svgAttr } from \"tiny-svg\";\n\nlet LOW_PRIORITY = 250;\n\nexport default function BpmnReplacePreview(\n  eventBus,\n  elementRegistry,\n  elementFactory,\n  canvas,\n  previewSupport\n) {\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Replace the visuals of all elements in the context which can be replaced\n   *\n   * @param  {Object} context\n   */\n  function replaceVisual(context) {\n    let replacements = context.canExecute.replacements;\n\n    forEach(replacements, function (replacement) {\n      let id = replacement.oldElementId;\n\n      let newElement = {\n        type: replacement.newElementType,\n      };\n\n      // if the visual of the element is already replaced\n      if (context.visualReplacements[id]) {\n        return;\n      }\n\n      let element = elementRegistry.get(id);\n\n      assign(newElement, { x: element.x, y: element.y });\n\n      // create a temporary shape\n      let tempShape = elementFactory.createShape(newElement);\n\n      canvas.addShape(tempShape, element.parent);\n\n      // select the original SVG element related to the element and hide it\n      let gfx = domQuery(\n        '[data-element-id=\"' + cssEscape(element.id) + '\"]',\n        context.dragGroup\n      );\n\n      if (gfx) {\n        svgAttr(gfx, { display: \"none\" });\n      }\n\n      // clone the gfx of the temporary shape and add it to the drag group\n      let dragger = previewSupport.addDragger(tempShape, context.dragGroup);\n\n      context.visualReplacements[id] = dragger;\n\n      canvas.removeShape(tempShape);\n    });\n  }\n\n  /**\n   * Restore the original visuals of the previously replaced elements\n   *\n   * @param  {Object} context\n   */\n  function restoreVisual(context) {\n    let visualReplacements = context.visualReplacements;\n\n    forEach(visualReplacements, function (dragger, id) {\n      let originalGfx = domQuery(\n        '[data-element-id=\"' + cssEscape(id) + '\"]',\n        context.dragGroup\n      );\n\n      if (originalGfx) {\n        svgAttr(originalGfx, { display: \"inline\" });\n      }\n\n      dragger.remove();\n\n      if (visualReplacements[id]) {\n        delete visualReplacements[id];\n      }\n    });\n  }\n\n  eventBus.on(\"shape.move.move\", LOW_PRIORITY, function (event) {\n    let context = event.context,\n      canExecute = context.canExecute;\n\n    if (!context.visualReplacements) {\n      context.visualReplacements = {};\n    }\n\n    if (canExecute && canExecute.replacements) {\n      replaceVisual(context);\n    } else {\n      restoreVisual(context);\n    }\n  });\n}\n\nBpmnReplacePreview.$inject = [\n  \"eventBus\",\n  \"elementRegistry\",\n  \"elementFactory\",\n  \"canvas\",\n  \"previewSupport\",\n];\n\ninherits(BpmnReplacePreview, CommandInterceptor);\n","import PreviewSupportModule from \"diagram-js/lib/features/preview-support\";\n\nimport BpmnReplacePreview from \"./BpmnReplacePreview\";\n\nexport default {\n  __depends__: [PreviewSupportModule],\n  __init__: [\"bpmnReplacePreview\"],\n  bpmnReplacePreview: [\"type\", BpmnReplacePreview],\n};\n","import { mid, setSnapped } from \"diagram-js/lib/features/snapping/SnapUtil\";\n\nimport { isCmd } from \"diagram-js/lib/features/keyboard/KeyboardUtil\";\n\nimport { getOrientation } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nimport { isAny } from \"../modeling/util/ModelingUtil\";\n\nimport { some } from \"min-dash\";\n\nlet HIGHER_PRIORITY = 1250;\n\nlet BOUNDARY_TO_HOST_THRESHOLD = 40;\n\nlet TARGET_BOUNDS_PADDING = 20,\n  TASK_BOUNDS_PADDING = 10;\n\nlet TARGET_CENTER_PADDING = 20;\n\nlet AXES = [\"x\", \"y\"];\n\nlet abs = Math.abs;\n\n/**\n * Snap during connect.\n *\n * @param {EventBus} eventBus\n */\nexport default function BpmnConnectSnapping(eventBus) {\n  eventBus.on(\n    [\"connect.hover\", \"connect.move\", \"connect.end\"],\n    HIGHER_PRIORITY,\n    function (event) {\n      let context = event.context,\n        canExecute = context.canExecute,\n        start = context.start,\n        hover = context.hover,\n        source = context.source,\n        target = context.target;\n\n      // do NOT snap on CMD\n      if (event.originalEvent && isCmd(event.originalEvent)) {\n        return;\n      }\n\n      if (!context.initialConnectionStart) {\n        context.initialConnectionStart = context.connectionStart;\n      }\n\n      // snap hover\n      if (canExecute && hover) {\n        snapToShape(event, hover, getTargetBoundsPadding(hover));\n      }\n\n      if (\n        hover &&\n        isAnyType(canExecute, [\n          \"bpmn:Association\",\n          \"bpmn:DataInputAssociation\",\n          \"bpmn:DataOutputAssociation\",\n          \"bpmn:SequenceFlow\",\n        ])\n      ) {\n        context.connectionStart = mid(start);\n\n        // snap hover\n        if (isAny(hover, [\"bpmn:Event\", \"bpmn:Gateway\"])) {\n          snapToPosition(event, mid(hover));\n        }\n\n        // snap hover\n        if (isAny(hover, [\"bpmn:Task\", \"bpmn:Loop\", \"bpmn:Conditional\"])) {\n          snapToTargetMid(event, hover);\n        }\n\n        // snap source and target\n        if (is(source, \"bpmn:BoundaryEvent\") && target === source.host) {\n          snapBoundaryEventLoop(event);\n        }\n      } else if (isType(canExecute, \"bpmn:MessageFlow\")) {\n        if (is(start, \"bpmn:Event\")) {\n          // snap start\n          context.connectionStart = mid(start);\n        }\n\n        if (is(hover, \"bpmn:Event\")) {\n          // snap hover\n          snapToPosition(event, mid(hover));\n        }\n      } else {\n        // un-snap source\n        context.connectionStart = context.initialConnectionStart;\n      }\n    }\n  );\n}\n\nBpmnConnectSnapping.$inject = [\"eventBus\"];\n\n// helpers //////////\n\n// snap to target if event in target\nfunction snapToShape(event, target, padding) {\n  AXES.forEach(function (axis) {\n    let dimensionForAxis = getDimensionForAxis(axis, target);\n\n    if (event[axis] < target[axis] + padding) {\n      setSnapped(event, axis, target[axis] + padding);\n    } else if (event[axis] > target[axis] + dimensionForAxis - padding) {\n      setSnapped(event, axis, target[axis] + dimensionForAxis - padding);\n    }\n  });\n}\n\n// snap to target mid if event in target mid\nfunction snapToTargetMid(event, target) {\n  let targetMid = mid(target);\n\n  AXES.forEach(function (axis) {\n    if (isMid(event, target, axis)) {\n      setSnapped(event, axis, targetMid[axis]);\n    }\n  });\n}\n\n// snap to prevent loop overlapping boundary event\nfunction snapBoundaryEventLoop(event) {\n  let context = event.context,\n    source = context.source,\n    target = context.target;\n\n  if (isReverse(context)) {\n    return;\n  }\n\n  let sourceMid = mid(source),\n    orientation = getOrientation(sourceMid, target, -10),\n    axes = [];\n\n  if (/top|bottom/.test(orientation)) {\n    axes.push(\"x\");\n  }\n\n  if (/left|right/.test(orientation)) {\n    axes.push(\"y\");\n  }\n\n  axes.forEach(function (axis) {\n    let coordinate = event[axis],\n      newCoordinate;\n\n    if (abs(coordinate - sourceMid[axis]) < BOUNDARY_TO_HOST_THRESHOLD) {\n      if (coordinate > sourceMid[axis]) {\n        newCoordinate = sourceMid[axis] + BOUNDARY_TO_HOST_THRESHOLD;\n      } else {\n        newCoordinate = sourceMid[axis] - BOUNDARY_TO_HOST_THRESHOLD;\n      }\n\n      setSnapped(event, axis, newCoordinate);\n    }\n  });\n}\n\nfunction snapToPosition(event, position) {\n  setSnapped(event, \"x\", position.x);\n  setSnapped(event, \"y\", position.y);\n}\n\nfunction isType(attrs, type) {\n  return attrs && attrs.type === type;\n}\n\nfunction isAnyType(attrs, types) {\n  return some(types, function (type) {\n    return isType(attrs, type);\n  });\n}\n\nfunction getDimensionForAxis(axis, element) {\n  return axis === \"x\" ? element.width : element.height;\n}\n\nfunction getTargetBoundsPadding(target) {\n  if (is(target, \"bpmn:Task\")) {\n    return TASK_BOUNDS_PADDING;\n  } else {\n    return TARGET_BOUNDS_PADDING;\n  }\n}\n\nfunction isMid(event, target, axis) {\n  return (\n    event[axis] > target[axis] + TARGET_CENTER_PADDING &&\n    event[axis] <\n      target[axis] + getDimensionForAxis(axis, target) - TARGET_CENTER_PADDING\n  );\n}\n\nfunction isReverse(context) {\n  let hover = context.hover,\n    source = context.source;\n\n  return hover && source && hover === source;\n}\n","import inherits from \"inherits\";\n\nimport CreateMoveSnapping from \"diagram-js/lib/features/snapping/CreateMoveSnapping\";\n\nimport {\n  isSnapped,\n  setSnapped,\n  topLeft,\n  bottomRight,\n} from \"diagram-js/lib/features/snapping/SnapUtil\";\n\nimport { isExpanded } from \"../../util/DiUtil\";\n\nimport { is } from \"../../util/ModelUtil\";\n\nimport { asTRBL, getMid } from \"diagram-js/lib/layout/LayoutUtil\";\n\nimport { getBoundaryAttachment } from \"./BpmnSnappingUtil\";\n\nimport { forEach } from \"min-dash\";\n\nlet HIGH_PRIORITY = 1500;\n\n/**\n * Snap during create and move.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function BpmnCreateMoveSnapping(eventBus, injector) {\n  injector.invoke(CreateMoveSnapping, this);\n\n  // creating first participant\n  eventBus.on(\n    [\"create.move\", \"create.end\"],\n    HIGH_PRIORITY,\n    setSnappedIfConstrained\n  );\n\n  // snap boundary events\n  eventBus.on(\n    [\"create.move\", \"create.end\", \"shape.move.move\", \"shape.move.end\"],\n    HIGH_PRIORITY,\n    function (event) {\n      let context = event.context,\n        canExecute = context.canExecute,\n        target = context.target;\n\n      let canAttach =\n        canExecute && (canExecute === \"attach\" || canExecute.attach);\n\n      if (canAttach && !isSnapped(event)) {\n        snapBoundaryEvent(event, target);\n      }\n    }\n  );\n}\n\ninherits(BpmnCreateMoveSnapping, CreateMoveSnapping);\n\nBpmnCreateMoveSnapping.$inject = [\"eventBus\", \"injector\"];\n\nBpmnCreateMoveSnapping.prototype.initSnap = function (event) {\n  let snapContext = CreateMoveSnapping.prototype.initSnap.call(this, event);\n\n  let shape = event.shape;\n\n  let isMove = !!this._elementRegistry.get(shape.id);\n\n  // snap to docking points\n  forEach(shape.outgoing, function (connection) {\n    let docking = connection.waypoints[0];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(\n      connection.id + \"-docking\",\n      getDockingSnapOrigin(docking, isMove, event)\n    );\n  });\n\n  forEach(shape.incoming, function (connection) {\n    let docking = connection.waypoints[connection.waypoints.length - 1];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(\n      connection.id + \"-docking\",\n      getDockingSnapOrigin(docking, isMove, event)\n    );\n  });\n\n  if (is(shape, \"bpmn:Participant\")) {\n    // snap to borders with higher priority\n    snapContext.setSnapLocations([\"top-left\", \"bottom-right\", \"mid\"]);\n  }\n\n  return snapContext;\n};\n\nBpmnCreateMoveSnapping.prototype.addSnapTargetPoints = function (\n  snapPoints,\n  shape,\n  target\n) {\n  CreateMoveSnapping.prototype.addSnapTargetPoints.call(\n    this,\n    snapPoints,\n    shape,\n    target\n  );\n\n  let snapTargets = this.getSnapTargets(shape, target);\n\n  forEach(snapTargets, function (snapTarget) {\n    // handle TRBL alignment\n    //\n    // * with container elements\n    // * with text annotations\n    if (\n      isContainer(snapTarget) ||\n      areAll([shape, snapTarget], \"bpmn:TextAnnotation\")\n    ) {\n      snapPoints.add(\"top-left\", topLeft(snapTarget));\n      snapPoints.add(\"bottom-right\", bottomRight(snapTarget));\n    }\n  });\n\n  let elementRegistry = this._elementRegistry;\n\n  // snap to docking points if not create mode\n  forEach(shape.incoming, function (connection) {\n    if (elementRegistry.get(shape.id)) {\n      if (!includes(snapTargets, connection.source)) {\n        snapPoints.add(\"mid\", getMid(connection.source));\n      }\n\n      let docking = connection.waypoints[0];\n      snapPoints.add(connection.id + \"-docking\", docking.original || docking);\n    }\n  });\n\n  forEach(shape.outgoing, function (connection) {\n    if (elementRegistry.get(shape.id)) {\n      if (!includes(snapTargets, connection.target)) {\n        snapPoints.add(\"mid\", getMid(connection.target));\n      }\n\n      let docking = connection.waypoints[connection.waypoints.length - 1];\n\n      snapPoints.add(connection.id + \"-docking\", docking.original || docking);\n    }\n  });\n\n  // add sequence flow parents as snap targets\n  if (is(target, \"bpmn:SequenceFlow\")) {\n    snapPoints = this.addSnapTargetPoints(snapPoints, shape, target.parent);\n  }\n\n  return snapPoints;\n};\n\nBpmnCreateMoveSnapping.prototype.getSnapTargets = function (shape, target) {\n  return CreateMoveSnapping.prototype.getSnapTargets\n    .call(this, shape, target)\n    .filter(function (snapTarget) {\n      // do not snap to lanes\n      return !is(snapTarget, \"bpmn:Lane\");\n    });\n};\n\n// helpers //////////\n\nfunction snapBoundaryEvent(event, target) {\n  let targetTRBL = asTRBL(target);\n\n  let direction = getBoundaryAttachment(event, target);\n\n  let context = event.context,\n    shape = context.shape;\n\n  let offset;\n\n  if (shape.parent) {\n    offset = { x: 0, y: 0 };\n  } else {\n    offset = getMid(shape);\n  }\n\n  if (/top/.test(direction)) {\n    setSnapped(event, \"y\", targetTRBL.top - offset.y);\n  } else if (/bottom/.test(direction)) {\n    setSnapped(event, \"y\", targetTRBL.bottom - offset.y);\n  }\n\n  if (/left/.test(direction)) {\n    setSnapped(event, \"x\", targetTRBL.left - offset.x);\n  } else if (/right/.test(direction)) {\n    setSnapped(event, \"x\", targetTRBL.right - offset.x);\n  }\n}\n\nfunction areAll(elements, type) {\n  return elements.every(function (el) {\n    return is(el, type);\n  });\n}\n\nfunction isContainer(element) {\n  if (is(element, \"bpmn:Loop\") && isExpanded(element)) {\n    return true;\n  }\n\n  return is(element, \"bpmn:Participant\");\n}\n\nfunction setSnappedIfConstrained(event) {\n  let context = event.context,\n    createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  let top = createConstraints.top,\n    right = createConstraints.right,\n    bottom = createConstraints.bottom,\n    left = createConstraints.left;\n\n  if ((left && left >= event.x) || (right && right <= event.x)) {\n    setSnapped(event, \"x\", event.x);\n  }\n\n  if ((top && top >= event.y) || (bottom && bottom <= event.y)) {\n    setSnapped(event, \"y\", event.y);\n  }\n}\n\nfunction includes(array, value) {\n  return array.indexOf(value) !== -1;\n}\n\nfunction getDockingSnapOrigin(docking, isMove, event) {\n  return isMove\n    ? {\n        x: docking.x - event.x,\n        y: docking.y - event.y,\n      }\n    : {\n        x: docking.x,\n        y: docking.y,\n      };\n}\n","import BpmnConnectSnapping from \"./BpmnConnectSnapping\";\nimport BpmnCreateMoveSnapping from \"./BpmnCreateMoveSnapping\";\nimport SnappingModule from \"diagram-js/lib/features/snapping\";\n\nexport default {\n  __depends__: [SnappingModule],\n  __init__: [\"connectSnapping\", \"createMoveSnapping\"],\n  connectSnapping: [\"type\", BpmnConnectSnapping],\n  createMoveSnapping: [\"type\", BpmnCreateMoveSnapping],\n};\n","import { map, filter, sortBy } from \"min-dash\";\n\nimport { getLabel } from \"../label-editing/LabelUtil\";\n\n/**\n * Provides ability to search through BPMN elements\n */\nexport default function BpmnSearchProvider(elementRegistry, searchPad, canvas) {\n  this._elementRegistry = elementRegistry;\n  this._canvas = canvas;\n\n  searchPad.registerProvider(this);\n}\n\nBpmnSearchProvider.$inject = [\"elementRegistry\", \"searchPad\", \"canvas\"];\n\n/**\n * Finds all elements that match given pattern\n *\n * <Result> :\n *  {\n *    primaryTokens: <Array<Token>>,\n *    secondaryTokens: <Array<Token>>,\n *    element: <Element>\n *  }\n *\n * <Token> :\n *  {\n *    normal|matched: <String>\n *  }\n *\n * @param  {String} pattern\n * @return {Array<Result>}\n */\nBpmnSearchProvider.prototype.find = function (pattern) {\n  let rootElement = this._canvas.getRootElement();\n\n  let elements = this._elementRegistry.filter(function (element) {\n    if (element.labelTarget) {\n      return false;\n    }\n    return true;\n  });\n\n  // do not include root element\n  elements = filter(elements, function (element) {\n    return element !== rootElement;\n  });\n\n  elements = map(elements, function (element) {\n    return {\n      primaryTokens: matchAndSplit(getLabel(element), pattern),\n      secondaryTokens: matchAndSplit(element.id, pattern),\n      element: element,\n    };\n  });\n\n  // exclude non-matched elements\n  elements = filter(elements, function (element) {\n    return (\n      hasMatched(element.primaryTokens) || hasMatched(element.secondaryTokens)\n    );\n  });\n\n  elements = sortBy(elements, function (element) {\n    return getLabel(element.element) + element.element.id;\n  });\n\n  return elements;\n};\n\nfunction hasMatched(tokens) {\n  let matched = filter(tokens, function (t) {\n    return !!t.matched;\n  });\n\n  return matched.length > 0;\n}\n\nfunction matchAndSplit(text, pattern) {\n  let tokens = [],\n    originalText = text;\n\n  if (!text) {\n    return tokens;\n  }\n\n  text = text.toLowerCase();\n  pattern = pattern.toLowerCase();\n\n  let i = text.indexOf(pattern);\n\n  if (i > -1) {\n    if (i !== 0) {\n      tokens.push({\n        normal: originalText.substr(0, i),\n      });\n    }\n\n    tokens.push({\n      matched: originalText.substr(i, pattern.length),\n    });\n\n    if (pattern.length + i < text.length) {\n      tokens.push({\n        normal: originalText.substr(pattern.length + i, text.length),\n      });\n    }\n  } else {\n    tokens.push({\n      normal: originalText,\n    });\n  }\n\n  return tokens;\n}\n","import SearchPadModule from \"diagram-js/lib/features/search-pad\";\n\nimport BpmnSearchProvider from \"./BpmnSearchProvider\";\n\nexport default {\n  __depends__: [SearchPadModule],\n  __init__: [\"bpmnSearch\"],\n  bpmnSearch: [\"type\", BpmnSearchProvider],\n};\n","import inherits from \"inherits\";\n\nimport BaseModeler from \"./BaseModeler\";\n\nimport Viewer from \"./Viewer\";\nimport NavigatedViewer from \"./NavigatedViewer\";\n\nimport KeyboardMoveModule from \"diagram-js/lib/navigation/keyboard-move\";\nimport MoveCanvasModule from \"diagram-js/lib/navigation/movecanvas\";\nimport TouchModule from \"diagram-js/lib/navigation/touch\";\nimport ZoomScrollModule from \"diagram-js/lib/navigation/zoomscroll\";\n\nimport AlignElementsModule from \"diagram-js/lib/features/align-elements\";\nimport AutoPlaceModule from \"./features/auto-place\";\nimport AutoResizeModule from \"./features/auto-resize\";\nimport AutoScrollModule from \"diagram-js/lib/features/auto-scroll\";\nimport BendpointsModule from \"diagram-js/lib/features/bendpoints\";\nimport ConnectModule from \"diagram-js/lib/features/connect\";\nimport ConnectionPreviewModule from \"diagram-js/lib/features/connection-preview\";\nimport ContextPadModule from \"./features/context-pad\";\nimport CopyPasteModule from \"./features/copy-paste\";\nimport CreateModule from \"diagram-js/lib/features/create\";\nimport DistributeElementsModule from \"./features/distribute-elements\";\nimport EditorActionsModule from \"./features/editor-actions\";\nimport GridSnappingModule from \"./features/grid-snapping\";\nimport InteractionEventsModule from \"./features/interaction-events\";\nimport KeyboardModule from \"./features/keyboard\";\nimport KeyboardMoveSelectionModule from \"diagram-js/lib/features/keyboard-move-selection\";\nimport LabelEditingModule from \"./features/label-editing\";\nimport ModelingModule from \"./features/modeling\";\nimport MoveModule from \"diagram-js/lib/features/move\";\nimport PaletteModule from \"./features/palette\";\nimport ReplacePreviewModule from \"./features/replace-preview\";\nimport ResizeModule from \"diagram-js/lib/features/resize\";\nimport SnappingModule from \"./features/snapping\";\nimport SearchModule from \"./features/search\";\n\nconst initialDiagram = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n  <process-Actions \n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\"\n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\"\n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\"\n  targetNamespace=\"http://bpmn.io/schema/bpmn\"\n  id=\"Definitions_1\">\n  <process-Action id=\"ProcessAction_1\">\n  </process-Action>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n  <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\n  <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\n  <dc:Bounds height=\"36.0\" width=\"36.0\" x=\"173.0\" y=\"102.0\"/>\n  </bpmndi:BPMNShape>\n  </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n  </process-Actions>`;\n\nexport default function Modeler(options) {\n  BaseModeler.call(this, options);\n}\n\ninherits(Modeler, BaseModeler);\n\nModeler.Viewer = Viewer;\nModeler.NavigatedViewer = NavigatedViewer;\n\n/**\n * Create a new diagram to start modeling.\n *\n * @param {Function} [done]\n */\nModeler.prototype.createDiagram = function (done) {\n  return this.importXML(initialDiagram, done);\n};\n\nModeler.prototype._interactionModules = [\n  // non-modeling components\n  KeyboardMoveModule,\n  MoveCanvasModule,\n  TouchModule,\n  ZoomScrollModule,\n];\n\nModeler.prototype._modelingModules = [\n  // modeling components\n  AlignElementsModule,\n  AutoPlaceModule,\n  AutoScrollModule,\n  BendpointsModule,\n  ConnectModule,\n  AutoResizeModule,\n  ConnectionPreviewModule,\n  ContextPadModule,\n  CopyPasteModule,\n  CreateModule,\n  DistributeElementsModule,\n  EditorActionsModule,\n  GridSnappingModule,\n  InteractionEventsModule,\n  KeyboardModule,\n  KeyboardMoveSelectionModule,\n  LabelEditingModule,\n  ModelingModule,\n  MoveModule,\n  PaletteModule,\n  ReplacePreviewModule,\n  ResizeModule,\n  SnappingModule,\n  SearchModule,\n];\n\n// modules the modeler is composed of\n//\n// - viewer modules\n// - interaction modules\n// - modeling modules\n\nModeler.prototype._modules = [].concat(\n  Viewer.prototype._modules,\n  Modeler.prototype._interactionModules,\n  Modeler.prototype._modelingModules\n);\n","let lastCookieString;\nlet lastCookies = {};\n\nfunction readCookie(name) {\n  const cookieString = document.cookie || '';\n  if (cookieString !== lastCookieString) {\n    lastCookieString = cookieString;\n    lastCookies = cookieString.split('; ').reduce((obj, value) => {\n      const parts = value.split('=');\n      obj[parts[0]] = parts[1];\n      return obj;\n    }, {});\n  }\n  return lastCookies[name];\n}\n\nexport class Service {\n  constructor() {\n    const headers = new Headers();\n    headers.append('Accept', 'application/json');\n    headers.append('Content-Type', 'application/json');\n    headers.append('X-Requested-With', 'XMLHttpRequest');\n    headers.append('X-CSRF-Token', readCookie('CSRF-TOKEN'));\n    this.baseURL = process.env.NODE_ENV === 'production' ? '..' : '';\n    this.headers = headers;\n  }\n\n  fetch(url, method, options) {\n    return fetch(url, options)\n        .then((data) => {\n          if (\n            ['head', 'delete'].indexOf(method.toLowerCase()) !== -1 ||\n          !data.ok\n          ) {\n            return data;\n          }\n          const isJSON = data.headers\n              .get('content-type')\n              .includes('application/json');\n          return isJSON ? data.json() : data;\n        })\n        .catch((err) => {\n          throw err;\n        });\n  }\n\n  request(url, config = {}, data = {}) {\n    const options = Object.assign(\n        {\n          method: 'POST',\n          credentials: 'include',\n          headers: this.headers,\n          mode: 'cors',\n          body: JSON.stringify(data),\n        },\n        config,\n    );\n    if (config.method === 'GET') {\n      delete options.body;\n    }\n    return this.fetch(\n        `${this.baseURL}${url.indexOf('/') === 0 ? url : `/${url}`}`,\n        config.method,\n        options,\n    );\n  }\n\n  get(url) {\n    const config = {\n      method: 'GET',\n    };\n    return this.request(`${url}`, config);\n  }\n\n  post(url, data) {\n    const config = {\n      method: 'POST',\n    };\n    return this.request(url, config, data);\n  }\n  delete(entity, id) {\n    const config = {\n      method: 'DELETE',\n    };\n    const url = `ws/rest/${entity}/${id}`;\n    return this.request(url, config);\n  }\n\n  add(entity, record) {\n    const data = {\n      data: record,\n    };\n    const url = `ws/rest/${entity}`;\n    return this.post(url, data);\n  }\n  update(entity, record, id) {\n    const data = {\n      data: record,\n    };\n    const url = `ws/rest/${entity}/${id}`;\n    return this.post(url, data);\n  }\n\n  fetchId(entity, id, data = {}) {\n    const url = `ws/rest/${entity}/${id}/fetch`;\n    return this.post(url, data);\n  }\n\n  search(entity, options) {\n    console.log(options)\n    const data = {\n      offset: 0,\n      ...options,\n    };\n    const url = `ws/rest/${entity}/search`;\n    return this.post(url, data);\n  }\n\n  action(data) {\n    const url = `ws/action`;\n    return this.post(url, data);\n  }\n\n  fields(data) {\n    const url = '/ws/meta/view/fields';\n    return this.post(url, data);\n  }\n\n  view(data) {\n    const url = '/ws/meta/view';\n    return this.post(url, data);\n  }\n\n  fetchFields(entity) {\n    const url = `/ws/meta/fields/${entity}`;\n    return this.get(url);\n  }\n\n  fetchRecord(entity, id, data = {}) {\n    const url = `ws/rest/${entity}/${id}/fetch`;\n    return this.post(url, data);\n  }\n}\n\nexport default new Service();\n","import {\n  red,\n  pink,\n  purple,\n  blue,\n  teal,\n  green,\n  orange,\n  brown,\n  cyan,\n} from '@material-ui/core/colors';\n\nexport const FILL_COLORS = {\n  'bpmn:Task': '#FFE0B2',\n  'bpmn:UserTask': '#c5ebf3',\n  'bpmn:SendTask': '#fddeb3',\n  'bpmn:ReceiveTask': '#fde8b3',\n  'bpmn:ManualTask': '#c5e0fc',\n  'bpmn:BusinessRuleTask': '#f8cfde',\n  'bpmn:ServiceTask': '#c5ece4',\n  'bpmn:ScriptTask': '#ffeed4',\n  'bpmn:CallActivity': '#fee5bf',\n  'bpmn:SubProcess': '#E4EBF8',\n  'bpmn:StartEvent': '#ccecc6',\n  'bpmn:EndEvent': '#ffd4c7',\n  'bpmn:Gateway': '#fdecb3',\n  'bpmn:IntermediateThrowEvent': '#ffe0b3',\n  'bpmn:IntermediateCatchEvent': '#ffe0b3',\n  'bpmn:BoundaryEvent': '#ffe0b3',\n  'bpmn:DataOutputAssociation': '#8095B3',\n  'bpmn:Transaction': '#E4EBF8',\n  'bpmn:DataObjectReference': '#eeceee',\n  'bpmn:DataStoreReference': '#ffcfd4',\n  'bpmn:AdHocSubProcess': '#E4EBF8',\n};\nexport const COLUMNS = [\n  {\n    id: 1,\n    title: 'key',\n  },\n  {\n    id: 2,\n    title: 'value',\n  },\n];\n\nexport const DATA_STORE_TYPES = [\n  'bpmn:DataOutputAssociation',\n  'bpmn:DataObjectReference',\n  'bpmn:DataStoreReference',\n];\nexport const ModelType = {\n  CUSTOM: 'CUSTOM',\n  META: 'META',\n};\nexport const HEADERS_KEYS = [\n  {\n    name: 'Accept',\n  },\n  {\n    name: 'Accept-Charset',\n  },\n  {\n    name: 'Accept-Encoding',\n  },\n  {\n    name: 'Accept-Language',\n  },\n  {\n    name: 'Authorization',\n  },\n  {\n    name: 'Content-MD5',\n  },\n  {\n    name: 'Content-Length',\n  },\n  {\n    name: 'Content-Type',\n  },\n  {\n    name: 'Cookie',\n  },\n  {\n    name: 'Keep-Alive',\n  },\n  {\n    name: 'Connection',\n  },\n  {\n    name: '  Origin',\n  },\n];\n\nexport const HEADERS_VALUES = [\n  {\n    name: 'application/atom+xml',\n  },\n  {\n    name: 'application/ecmascript',\n  },\n  {\n    name: 'application/json',\n  },\n  {\n    name: 'application/javascript',\n  },\n  {\n    name: 'application/pdf',\n  },\n  {\n    name: 'application/xhtml+xml',\n  },\n  {\n    name: 'application/xml',\n  },\n  {\n    name: 'application/zip',\n  },\n  {\n    name: 'application/x-www-form-urlencoded',\n  },\n  {\n    name: 'audio/basic',\n  },\n  {\n    name: 'image/jpeg',\n  },\n  {\n    name: 'image/png',\n  },\n  {\n    name: 'image/svg+xml',\n  },\n  {\n    name: 'text/html',\n  },\n  {\n    name: 'text/plain',\n  },\n  {\n    name: 'multipart/encrypted',\n  },\n  {\n    name: 'text/xml',\n  },\n  {\n    name: 'image/gif',\n  },\n];\n\nexport const STROKE_COLORS = {\n  'bpmn:Task': '#FF9800',\n  'bpmn:UserTask': '#3FBDD6',\n  'bpmn:SendTask': '#F79000',\n  'bpmn:ReceiveTask': '#F8B200',\n  'bpmn:ManualTask': '#3F97F6',\n  'bpmn:BusinessRuleTask': '#E76092',\n  'bpmn:ServiceTask': '#3EBFA5',\n  'bpmn:ScriptTask': '#FF9E0F',\n  'bpmn:CallActivity': '#FBA729',\n  'bpmn:SubProcess': '#6097fc',\n  'bpmn:AdHocSubProcess': '#6097fc',\n  'bpmn:Transaction': '#6097fc',\n  'bpmn:SequenceFlow': '#8095B3',\n  'bpmn:StartEvent': '#55c041',\n  'bpmn:EndEvent': '#ff7043',\n  'bpmn:Gateway': '#f9c000',\n  'bpmn:IntermediateThrowEvent': '#ff9800',\n  'bpmn:IntermediateCatchEvent': '#ff9800',\n  'bpmn:Participant': '#c8c8c8',\n  'bpmn:Lane': '#c8c8c8',\n  'bpmn:Group': '#c8c8c8',\n  'bpmn:Association': '#8095B3',\n  'bpmn:TextAnnotation': '#A9B1BD',\n  'bpmn:BoundaryEvent': '#ff9800',\n  'bpmn:DataObjectReference': '#a80ca8',\n  'bpmn:DataStoreReference': '#e53935',\n  'bpmn:DataOutputAssociation': '#8095B3',\n};\n\nexport const RELATIVE_FILL = {\n  '#5eaeda': '#cfe7f4',\n  '#3fbdd6': '#c5ebf3',\n  '#f79000': '#fddeb3',\n  '#f8b200': '#fde8b3',\n  '#3f97f6': '#c5e0fc',\n  '#e76092': '#f8cfde',\n  '#3ebfa5': '#c5ece4',\n  '#ff9e0f': '#ffeed4',\n  '#fba729': '#fee5bf',\n  '#6097fc': '#e4ebf8',\n  '#55c041': '#ccecc6',\n  '#ff7043': '#ffd4c7',\n  '#f9c000': '#fdecb3',\n  '#ff9800': '#ffe0b3',\n  '#a80ca8': '#eeceee',\n  '#e53935': '#ffcfd4',\n  '#000000': '#ffffff',\n};\n\nexport const USER_TASKS_TYPES = [\n  'bpmn:UserTask',\n  'bpmn:ReceiveTask',\n  'bpmn:CallActivity',\n  'bpmn:SubProcess',\n];\n\nexport const SUBPROCESS_TYPES = [\n  'bpmn:subprocess',\n  'bpmn:transaction',\n  'multiinstancesequential',\n  'multiinstanceparallel',\n];\n\nexport const WKF_COLORS = [\n  {name: 'red', title: 'Red', color: '#f44336'},\n  {name: 'pink', title: 'Pink', color: '#e91e63'},\n  {name: 'purple', title: 'Purple', color: '#9c27b0'},\n  {name: 'deeppurple', title: 'Deep Purple', color: '#673ab7'},\n  {name: 'indigo', title: 'Indigo', color: '#3f51b5'},\n  {name: 'blue', title: 'Blue', color: '#2196f3'},\n  {name: 'lightblue', title: 'Light Blue', color: '#03a9f4'},\n  {name: 'cyan', title: 'Cyan', color: '#00bcd4'},\n  {name: 'teal', title: 'Teal', color: '#009688'},\n  {name: 'green', title: 'Green', color: '#4caf50'},\n  {\n    name: 'lightgreen',\n    title: 'Light Green',\n    color: '#8bc34a',\n    border: 'black',\n  },\n  {name: 'lime', title: 'Lime', color: '#cddc39', border: 'black'},\n  {name: 'yellow', title: 'Yellow', color: '#ffeb3b', border: 'black'},\n  {name: 'amber', title: 'Amber', color: '#ffc107', border: 'black'},\n  {name: 'orange', title: 'Orange', color: '#ff9800', border: 'black'},\n  {name: 'deeporange', title: 'Deep Orange', color: '#ff5722'},\n  {name: 'brown', title: 'Brown', color: '#795548'},\n  {name: 'grey', title: 'Grey', color: '#9e9e9e', border: 'black'},\n  {name: 'bluegrey', title: 'Blue Grey', color: '#607d8b'},\n  {name: 'black', title: 'Black', color: 'black'},\n  {name: 'white', title: 'White', color: 'whitesmoke', border: 'black'},\n];\n\nexport const WKF_FIELDS = [\n  'importOrigin',\n  'code',\n  'diagramXml',\n  'description',\n  'isActive',\n  'wkfTaskConfigList',\n  'deploymentId',\n  'dmnFileSet',\n  'generatedFromCallActivity',\n  'id',\n  'processInstanceId',\n  'previousVersion',\n  'previousVersion.statusSelect',\n  'wkfProcessList',\n  'versionTag',\n  'oldNodes',\n  'version',\n  'attrs',\n  'statusSelect',\n  'name',\n  'wkfStatusColor',\n  'appBuilder',\n];\n\nexport const RELATED_FIELDS = ['name', 'processId', 'wkfProcessConfigList'];\n\nexport const STATUS = {\n  1: 'New',\n  2: 'On going',\n  3: 'Terminated',\n};\n\nexport const COLORS = [\n  blue[600],\n  orange[600],\n  green[600],\n  teal[600],\n  purple[600],\n  red[600],\n  pink[600],\n  cyan[600],\n  brown[600],\n  blue[700],\n  orange[700],\n  green[700],\n  teal[700],\n  purple[700],\n  red[700],\n  pink[700],\n  cyan[700],\n  brown[700],\n  blue[800],\n  orange[800],\n  green[800],\n  teal[800],\n  red[800],\n  purple[800],\n  pink[800],\n  cyan[800],\n  brown[800],\n  blue[900],\n  orange[900],\n  green[900],\n  teal[900],\n  purple[900],\n  red[900],\n  pink[900],\n  cyan[900],\n  brown[900],\n  blue[500],\n  orange[500],\n  green[500],\n  teal[500],\n  purple[500],\n  red[500],\n  pink[500],\n  cyan[500],\n  brown[500],\n];\n\nexport const CONDITIONAL_SOURCES = [\n  'bpmn:EventBasedGateway',\n  'bpmn:ExclusiveGateway',\n  'bpmn:InclusiveGateway',\n  'bpmn:ComplexGateway',\n  'bpmn:ParallelGateway',\n  'bpmn:SequenceFlow',\n  'label',\n  'bpmn:IntermediateThrowEvent',\n  'bpmn:Collaboration',\n  'bpmn:Lane',\n  'bpmn:TextAnnotation',\n  'bpmn:MessageFlow',\n  'bpmn:Participant',\n];\n","import Service from './Service';\nimport * as _ from 'lodash';\nimport { getFormName, getItemsByType } from '../utils';\nimport { ModelType } from '../WEB-SERVICE/constants';\n\nexport async function getMetaModal(data) {\n  const res = await Service.search('com.axelor.meta.db.MetaModel', {data});\n  return res && res.data && res.data[0];\n}\nexport async function deleteRequest(id) {\n  const res = await Service.delete('com.axelor.studio.db.WsRequest', id);\n  return await res?.json();\n}\nexport async function deleteConnector(id) {\n  const res = await Service.delete('com.axelor.studio.db.WsConnector', id);\n  return res?.json();\n}\nexport async function deleteAuth(id) {\n  const res = await Service.delete('com.axelor.studio.db.WsAuthenticator', id);\n  return res?.json();\n}\nexport async function addAuth(criteria = {}) {\n  const res = await Service.add(\n      'com.axelor.studio.db.WsAuthenticator',\n      criteria,\n  );\n  return res;\n}\nexport async function addConnector(criteria = {}) {\n  const res = await Service.add('com.axelor.studio.db.WsConnector', criteria);\n  return res;\n}\nexport async function autheticate(criteria) {\n  const res = await Service.action(criteria);\n  return res;\n}\nexport async function runTestConnector(criteria) {\n  const res = await Service.action(criteria);\n  return res;\n}\nexport async function getAuthById(id) {\n  const res = await Service.fetchRecord(\n      'com.axelor.studio.db.WsAuthenticator',\n      id,\n  );\n  return res && res.data &&  res.data[0];\n}\nexport async function getRequestById(id, criteria) {\n  const res = await Service.fetchRecord(\n      'com.axelor.studio.db.WsRequest',\n      id,\n      criteria,\n  );\n  return res && res.data &&  res.data[0];\n}\nexport async function getSubMetaField(\n    model,\n    relationJsonModel,\n    isCollection = false,\n    allowAllFields = false,\n) {\n  if (model === 'com.axelor.meta.db.MetaJsonRecord' && relationJsonModel) {\n    const res = await Service.get(\n        `ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=${relationJsonModel}`,\n    );\n    const result = getResultedFields(res) || [];\n    return (\n      result &&\n      result.filter((r) =>\n        isCollection ?\n          ['many_to_one', 'one_to_many', 'many_to_many'].includes(\n              r.type.toLowerCase(),\n          ) :\n          allowAllFields ?\n          r :\n          ['many_to_one', 'many-to-one'].includes(r.type.toLowerCase()),\n      )\n    );\n  } else {\n    const data = {\n      criteria: [{fieldName: 'fullName', operator: '=', value: model}],\n    };\n    const metaModel = await getMetaModal(data);\n    if (!metaModel) return [];\n    const fields = metaModel && metaModel.metaFields.map((f) => f.name);\n    const res = await Service.fields({\n      fields,\n      model: metaModel.fullName,\n    });\n    const resultFields = res && res.data && res.data.fields;\n    return (\n      resultFields &&\n      resultFields.filter((r) =>\n        isCollection ?\n          ['many_to_one', 'one_to_many', 'many_to_many'].includes(\n              r.type.toLowerCase(),\n          ) :\n          allowAllFields ?\n          r :\n          ['many_to_one', 'many-to-one'].includes(r.type.toLowerCase()),\n      )\n    );\n  }\n}\n\nexport async function getMetaFields(model) {\n  if (!model) return [];\n  if (model.type === 'metaModel') {\n    if (!model.fullName) return [];\n    const res = await Service.get(`ws/meta/fields/${model.fullName}`);\n    const result = getResultedFields(res);\n    return result;\n  } else {\n    if (!model.name) return [];\n    const res = await Service.get(\n        `ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=${model.name}`,\n    );\n    const result = getResultedFields(res);\n    return result || [];\n  }\n}\nexport async function getRecords(modelFullName) {\n  const res = await Service.search(modelFullName, {});\n  return res ? res.data : [];\n}\n\nexport async function getModels(data = {}, metaModalType, dmnModels) {\n  const models =\n    ((!metaModalType || metaModalType === 'metaModel') &&\n      (await getMetaModels(data, true))) ||\n    [];\n  const metaJsonModels =\n    ((!metaModalType || metaModalType === 'metaJsonModel') &&\n      (await getCustomModels(data))) ||\n    [];\n  const allModels = [];\n\n  for (let i = 0; i < models.length; i++) {\n    allModels.push({\n      ...models[i],\n      type: 'metaModel',\n    });\n  }\n  for (let i = 0; i < metaJsonModels.length; i++) {\n    allModels.push({\n      ...metaJsonModels[i],\n      type: 'metaJsonModel',\n    });\n  }\n  if (dmnModels) {\n    for (let i = 0; i < dmnModels.length; i++) {\n      allModels.push({\n        ...dmnModels[i],\n        type: 'dmnModel',\n      });\n    }\n  }\n  return allModels || [];\n}\n\nexport async function getDMNModels(criteria = []) {\n  const res = await Service.search('com.axelor.apps.bpm.db.DmnTable', {\n    data: {\n      criteria,\n    },\n  });\n  const {data = []} = res || {};\n  return data;\n}\n\nexport async function getDMNFields(options) {\n  const res = await Service.search('com.axelor.apps.bpm.db.DmnField', options);\n  const {data = []} = res || {};\n  return data;\n}\n\nconst getResultedFields = (res) => {\n  const responseData = res && res.data;\n  const allFields = responseData && responseData.fields;\n  const jsonFields = Object.values(\n      (responseData && responseData.jsonFields) || [{}],\n  );\n  let result = [];\n  result = allFields || [];\n\n  jsonFields &&\n    jsonFields.forEach((jsonField) => {\n      const nestedFields = Object.values(jsonField || {}) || [];\n      result = [...result, ...nestedFields];\n    });\n  return result;\n};\n\nexport async function getViews(model, criteria = [], type = 'form') {\n  if (!model || !model.name) return [];\n  const options = [\n    {\n      fieldName: 'type',\n      operator: '=',\n      value: type,\n    },\n  ];\n\n  if (model.type === 'metaJsonModel') {\n    options.push({\n      fieldName: 'name',\n      operator: '=',\n      value: `custom-model-${model.name}-${type}`,\n    });\n  } else {\n    if (!model.fullName) return;\n    options.push({\n      fieldName: 'model',\n      operator: '=',\n      value: model.fullName,\n    });\n  }\n\n  const res = await Service.search(`com.axelor.meta.db.MetaView`, {\n    fields: ['name', 'title'],\n    data: {\n      criteria: [...options, ...criteria],\n      operator: 'and',\n    },\n  });\n  const {data = []} = res || {};\n  let views = data.filter((val) => val.name !== null);\n  views = _.uniqBy(views || [], 'name') || [];\n  return views;\n}\n\nexport async function getButtons(models = []) {\n  let buttons = [];\n  const metaModeNames = [];\n  const modelNames = [];\n  if (models.length > 0) {\n    for (let i = 0; i < models.length; i++) {\n      const {type, model, modelFullName} = models[i];\n      let formName = getFormName(model);\n      if (formName === 'fetchAPI') {\n        const views = await getViews({\n          name: model,\n          type,\n          fullName: modelFullName,\n        });\n        if (views && views[0]) {\n          formName = views[0].name;\n        }\n      }\n      if (formName) {\n        if (type === 'metaModel') {\n          metaModeNames.push(modelFullName);\n        }\n        const res = await Service.view({\n          data: {\n            name:\n              type === 'metaModel' ? formName : `custom-model-${model}-form`,\n            type: 'form',\n          },\n          model,\n        });\n        const formView = res && res.data && res.data.view;\n        if (formView) {\n          const btns = getItemsByType(formView, 'button');\n          buttons = [...buttons, ...(btns || [])];\n        }\n      } else {\n        if (type === 'metaJsonModel') {\n          modelNames.push(model);\n        }\n      }\n    }\n    if (metaModeNames && metaModeNames.length > 0) {\n      for (let i = 0; i < metaModeNames.length; i++) {\n        const res = await Service.search(`com.axelor.meta.db.MetaJsonField`, {\n          data: {\n            criteria: [\n              {\n                fieldName: 'model',\n                operator: 'like',\n                value: metaModeNames[i],\n              },\n              {\n                fieldName: 'type',\n                operator: '=',\n                value: 'button',\n              },\n            ],\n            operator: 'and',\n          },\n        });\n        const buttonFields = res && res.data;\n        if (buttonFields && buttonFields.length > 0) {\n          buttons = [...buttons, ...(buttonFields || [])];\n        }\n      }\n    }\n    if (modelNames && modelNames.length > 0) {\n      for (let i = 0; i < modelNames.length; i++) {\n        const res = await Service.get(\n            `ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=${modelNames[i]}`,\n        );\n        const fields = getResultedFields(res);\n        const buttonFields = fields.filter((f) => f.type === 'button');\n        buttons = [...buttons, ...(buttonFields || [])];\n      }\n    }\n    return buttons;\n  }\n}\n\nexport async function getFormViews(formViewNames) {\n  const res = await Service.search('com.axelor.meta.db.MetaView', {\n    data: {\n      _domain:\n        'self.type = :type and self.extension IS NULL and self.name in :names',\n      _domainContext: {\n        type: 'form',\n        names: formViewNames && formViewNames.length > 0 ? formViewNames : [''],\n      },\n    },\n    fields: ['name', 'title', 'model'],\n  });\n  const {data = []} = res || {};\n  return data;\n}\n\nexport async function getMetaModels(criteria = {}) {\n  const res = await Service.search(\"com.axelor.meta.db.MetaModel\", {\n    data: criteria,\n  });\n  if (res && res.status === -1) return [];\n  const { data = [] } = res || {};\n  const defaultForms = data.reduce(async (arrs, item) => {\n    const accumulator = await arrs.then();\n    const formName = getFormName(item.name);\n    if (formName === \"fetchAPI\") {\n      const views = await getViews({\n        ...item,\n        type: \"metaModel\",\n      });\n      if (views && views[0]) {\n        accumulator.push(views[0].name);\n      }\n    } else if (formName) {\n      accumulator.push(formName);\n    }\n    return Promise.resolve(accumulator);\n  }, Promise.resolve([]));\n  const forms = await defaultForms;\n  const formData = await getFormViews(forms);\n  const result = data.reduce(async (arrs, item) => {\n    const accumulator = await arrs.then();\n    const formName = getFormName(item.name);\n    if (formName === \"fetchAPI\") {\n      const views = await getViews({\n        ...item,\n        type: \"metaModel\",\n      });\n      if (views && views[0]) {\n        accumulator.push({ ...item, title: views[0].title });\n      }\n    } else if (formName) {\n      const form = formData.find((f) => f.name === formName);\n      accumulator.push({ ...item, title: form && form.title });\n    }\n    return Promise.resolve(accumulator);\n  }, Promise.resolve([]));\n  return result;\n}\n\nexport async function getCustomModels(criteria = {}) {\n  const res = await Service.search(\"com.axelor.meta.db.MetaJsonModel\", {\n    data: {\n      criteria,\n    },\n  });\n  if (res && res.status === -1) return [];\n  const { data = [] } = res || {};\n  return data\n}\n\nexport async function getAllModels(criteria = {}) {\n  const models = (await getMetaModels(criteria)) || [];\n  const metaJsonModels = (await getCustomModels(criteria)) || [];\n  const data = [...models, ...metaJsonModels];\n  return data;\n}\nexport async function getAllRequest() {\n  const options = {\n    fields: ['name', 'id'],\n  };\n  const res = await Service.search('com.axelor.studio.db.WsRequest', options);\n  return res.data;\n}\nexport async function getApps() {\n  const options = {\n    fields: ['name', 'id'],\n  };\n  const res = await Service.search('com.axelor.studio.db.StudioApp', options);\n  return res.data;\n}\nexport async function getAllConnector() {\n  const options = {\n    fields: ['name', 'id'],\n  };\n  const res = await Service.search('com.axelor.studio.db.WsConnector', options);\n  return res.data;\n}\nexport async function getConnectorById(id, criteria) {\n  const res = await Service.fetchRecord(\n      'com.axelor.studio.db.WsConnector',\n      id,\n      criteria,\n  );\n  return res && res.data && res.data[0] ;\n}\n\nexport async function getRequests(criteria = {}) {\n  const options = {\n    fields: ['name', 'description', 'groovyTemplate', 'parameters'],\n  };\n  const res = await Service.search('com.axelor.studio.db.WsRequest', options);\n  return res.data;\n}\nexport async function getAllAuthentication(criteria = {}) {\n  const options = {\n    fields: ['name', 'id'],\n  };\n  const res = await Service.search(\n      'com.axelor.studio.db.WsAuthenticator',\n      options,\n  );\n  return res.data;\n}\n\nexport async function getAuthenticationById() {\n  const options = {\n    fields: [\n      'name',\n      'id',\n      'studioApp',\n      'isAuthenticated',\n      'version',\n      'refreshTokenResponse',\n      'tokenWsRequest',\n      'authWsRequest',\n      'refreshTokenWsRequest',\n      'tokenResponse',\n      'authTypeSelect',\n    ],\n  };\n  const res = await Service.search(\n      'com.axelor.studio.db.WsAuthenticator',\n      options,\n  );\n  return res.data;\n}\nexport async function getRequestsById(connectorId) {\n  const data = {\n    data: {\n      criteria: [\n        {\n          operator: 'and',\n          criteria: [\n            {\n              fieldName: 'wsConnector.id',\n              operator: '=',\n              value: connectorId,\n            },\n          ],\n        },\n      ],\n    },\n    fields: ['name', 'requestTypeSelect', 'id'],\n  };\n  const res = await Service.search('com.axelor.studio.db.WsRequest', data);\n  return res && res.data && res.data;\n}\n\nexport async function getkeys(elements) {\n  const idFields = [];\n  elements?.forEach((element) => {\n    idFields.push(element.id);\n  });\n  const options = {\n    fields: [\n      'wsKey',\n      'wsValue',\n      'isList',\n      'version',\n      'id',\n      'subWsKeyValueList',\n    ],\n    sortBy: null,\n    data: {\n      _domain: 'self.id in (:_field_ids)',\n      _domainContext: {\n        _field_ids: idFields,\n      },\n      _archived: true,\n    },\n    limit: -1,\n    translate: true,\n  };\n  const res = await Service.search('com.axelor.studio.db.WsKeyValue', options);\n  return res.data;\n}\nexport async function getLabraries(data) {\n  const res = await Service.get('ws/rest/com.axelor.studio.db.Library');\n  return res && res.data;\n}\nexport async function getTransformations(libraryId) {\n  const data = {\n    data: {\n      criteria: [\n        {\n          operator: 'and',\n          criteria: [\n            {\n              fieldName: 'library.id',\n              operator: '=',\n              value: libraryId,\n            },\n          ],\n        },\n      ],\n    },\n    fields: ['name', 'description','multiArg','multiArgType','groovyTemplate', 'parameters'],\n  };\n  const res = await Service.search(\n      'com.axelor.studio.db.Transformation',\n      data,\n  );\n  return res && res.data && res.data;\n}\nexport async function getParams(transformationId) {\n  const data = {\n    data: {\n      criteria: [\n        {\n          operator: 'and',\n          criteria: [\n            {\n              fieldName: 'transformation.id',\n              operator: '=',\n              value: transformationId,\n            },\n          ],\n        },\n      ],\n    },\n    fields: ['name', 'type', 'description',\"isOptional\"],\n  };\n  const res = await Service.search('com.axelor.studio.db.Parameter', data);\n  return res && res.data && res.data;\n}\nexport async function getPackageFields(model) {\n  if (!model) return [];\n  let actionRes = await Service.action(\n    'com.axelor.apps.tool.web.QueryBuilderController:getCommonFields',\n    {\n      model: 'com.axelor.meta.db.MetaModel',\n      data: {\n        context: {\n          package: model,\n        },\n        model: 'com.axelor.meta.db.MetaModel',\n      },\n    }\n  );\n  return actionRes && actionRes.data;\n}\n","import React from 'react';\nimport { getkeys } from './services/api';\n\nconst download = (entity, name) => {\n  const encodedData = encodeURIComponent(entity);\n  const dl = document.createElement('a');\n  document.body.appendChild(dl);\n  dl.setAttribute('href', 'data:image/svg+xml;utf-8,' + encodedData);\n  dl.setAttribute('download', name);\n  dl.click();\n};\nfunction lowerCaseFirstLetter(str) {\n  if (!str) return;\n  return str.charAt(0).toLowerCase() + str.slice(1);\n}\nfunction sortBy(array = [], key) {\n  return array.sort(function (a, b) {\n    const x = a[key];\n    const y = b[key];\n    return x < y ? -1 : x > y ? 1 : 0;\n  });\n}\n\nfunction getGroovyBasicPayload(transformations, model, wsValue) {\n  const params = transformations && transformations[0]?.operation?.parameters;\n  const groovy =\n    transformations && transformations[0]?.operation?.groovyTemplate;\n  if (groovy) {\n    let newGroovy = groovy;\n    newGroovy = newGroovy?.replace(\n      '#{target}',\n      (model?.name && wsValue.name) ? `${model?.name.toLowerCase()}.${wsValue.name}` : `\"${wsValue}\"`,\n    );\n    params?.forEach((param) => {\n      if (transformations[0]?.operation?.multiArg && !param.name) {\n        if (param.type === 'String') {\n          newGroovy = newGroovy?.replace(\n            `#{_multiArg_}`,\n            `\"${param?.value}\"`,\n          );\n        } else newGroovy = newGroovy?.replace(`#{_multiArg_`, param?.value);\n      }\n      else {\n        if (param.type === 'String') {\n          newGroovy = newGroovy?.replaceAll(\n            `#{${param?.name}}`,\n            `\"${param?.value}\"`,\n          );\n        } else newGroovy = newGroovy?.replaceAll(`#{${param?.name}}`, param?.value);\n      }\n    });\n    transformations?.forEach((trans, id) => {\n      if(id !== 0){\n        let gr = trans.operation.groovyTemplate;\n        trans?.operation?.parameters?.forEach((param) => {\n          if (param.type === 'String') {\n            gr = gr?.replaceAll(`#{${param?.name}}`, `\"${param?.value}\"`);\n          } else gr = gr?.replaceAll(`#{${param?.name}}`, param?.value);\n        });\n        newGroovy = gr.replace('#{target}', newGroovy);\n      }\n    });\n    return `\\${${newGroovy}}`;\n  } else if (model?.name && wsValue.name) {\n    return `\\${${model?.name.toLowerCase()}.${wsValue.name}}`;\n  }\n  else return wsValue;\n}\n\nexport const getApiResponseData = (response, { isArrayResponse = true }) => {\n  if (response.data && response.data.object != null) {\n    return response.data.object;\n  }\n  return isArrayResponse\n    ? response?.data?.data\n    : getFirstData(response?.data?.data);\n};\n\nexport const getFirstData = data => {\n  if (data instanceof Array) {\n    return data[0];\n  }\n  return null;\n};\n\nfunction getGroovyListPayload(subKeyValues) {\n  let list = [];\n  subKeyValues.forEach((payModel) => {\n    payModel.payloads.forEach((pay) => {\n      if (!pay?.wsKey && !pay?.payloads) {\n        list = [...list, pay.wsValue];\n      }\n      else if (!pay?.wsKey) {\n        list.push(groovy(pay, payModel));\n      }\n      else list.push({ [pay.wsKey]: groovy(pay, payModel) })\n    });\n  });\n  return list;\n}\n\nasync function fromPayloadsToPayloads(listPayloads) {\n  let list = [];\n  for (const payload of listPayloads) {\n    if (payload?.isList === true) {\n      const wsKey = await getkeys(payload.subWsKeyValueList);\n      const pays = wsKey ?  await fromPayloadsToPayloads(wsKey) :  []\n      list.push({\n        ...payload,\n        wsValue: [{ id: 1, model: '', payloads: pays }],\n      });\n    } else if (!payload.isList && payload.subWsKeyValueList.length !== 0) {\n      const wsKey = await getkeys(payload.subWsKeyValueList);\n      const pays = await fromPayloadsToPayloads(wsKey);\n      payload.payloads = pays;\n      list = [...list, payload];\n    } else {\n      list.push(payload);\n    }\n  }\n  return list;\n}\n\nfunction isBPMQuery(type) {\n  return type === 'bpmQuery' ? true : false;\n}\n\nfunction groovy(element, model) {\n  if (element?.wsValue?.name) {\n    return getGroovyBasicPayload(\n      element.transformations,\n      model,\n      element?.wsValue,\n    );\n  } else if (element.wsValue && !element.isList) {\n    return getGroovyBasicPayload(\n      element.transformations,\n      model,\n      element?.wsValue,\n    );\n  } else if (element.isList) {\n    return getGroovyListPayload(element.wsValue);\n  } else {\n    let object = {};\n    element.payloads?.forEach((pay) => {\n      object[pay.wsKey] = groovy(pay, element.model);\n    });\n    return object;\n  }\n}\n\nexport function useDebounce(cb, duration) {\n  const timer = React.useRef(null);\n\n  const clearTimer = () => timer.current && clearTimeout(timer.current);\n  const setTimer = (cb) => (timer.current = setTimeout(cb, duration));\n\n  React.useEffect(() => {\n    return () => clearTimer();\n  }, []);\n\n  return (...args) => {\n    clearTimer();\n    setTimer(() => cb(...args));\n  };\n}\n\nfunction getItemsByType(view, type) {\n  function collectItems(item) {\n    const { items = [], jsonFields = [] } = item;\n    const allItems = [...items, ...jsonFields];\n    return allItems.reduce(\n      (all, item) => [...all, ...collectItems(item)],\n      item.type === type ? [item] : [],\n    );\n  }\n  return collectItems(view);\n}\n\nfunction getFormName(str) {\n  if (!str) return;\n  const formString = str.match(/[A-Z][a-z]+/g);\n  if (!formString) return;\n  if (formString.join('').trim().length !== str.length) {\n    return 'fetchAPI';\n  }\n  const form = formString && formString.join('-');\n  return `${form.toLowerCase()}-form`;\n}\n\nfunction translate(str) {\n  if (window._t && typeof str === 'string') {\n    return window._t(str);\n  }\n  return str;\n}\n\nfunction pascalToKebabCase(string) {\n  return (\n    string &&\n    string\n      .match(\n        /[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g,\n      )\n      .map((x) => x.toLowerCase())\n      .join('-')\n  );\n}\n\nfunction getBool(val) {\n  if (!val) return false;\n  return !!JSON.parse(String(val).toLowerCase());\n}\n\nexport {\n  download,\n  translate,\n  pascalToKebabCase,\n  getBool,\n  getFormName,\n  getItemsByType,\n  sortBy,\n  lowerCaseFirstLetter,\n  groovy,\n  getGroovyBasicPayload,\n  fromPayloadsToPayloads,\n  isBPMQuery\n};\n","import React, {useEffect, useState} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n  desciption: {\n    height: '200px',\n  },\n  error: {\n    color: '#CC3333',\n  },\n  input: {\n    outline: 0,\n    width: '99%',\n    height: '100%',\n  },\n});\n\nexport default function Description({type, element}) {\n  const classes = useStyles();\n  const [desc, setDesc] = useState('');\n  const updateProperty = (value) => {\n    element.businessObject.description = value;\n  };\n  useEffect(() => {\n    setDesc(element.businessObject.description);\n  }, [element.businessObject.description]);\n  return (\n    <div className={classnames(classes.desciption, type && classes.error)}>\n      <textarea\n        value={desc}\n        className={classes.input}\n        onChange={(e) => setDesc(e.target.value)}\n        onBlur={(e) => updateProperty(e.target.value)}\n      />\n    </div>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport classnames from 'classnames';\nimport TextareaAutosize from '@material-ui/core/TextareaAutosize';\nimport {makeStyles} from '@material-ui/styles';\n\nimport Description from './Description';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    marginTop: 5,\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: \"#666\",\n    marginBottom: 3,\n  },\n  textarea: {\n    'fontFamily': 'Helvetica Neue, Helvetica, Arial, sans-serif',\n    'resize': 'vertical',\n    'borderColor': '#ccc',\n    '&:focus': {\n      boxShadow: 'rgba(82, 180, 21, 0.2) 0px 0px 1px 2px',\n      outline: 'none',\n      borderColor: 'rgb(82, 180, 21)',\n    },\n  },\n  error: {\n    'borderColor': '#cc3333 !important',\n    'background': '#f0c2c2',\n    '&:focus': {\n      boxShadow: 'rgba(204,58,51, 0.2) 0px 0px 1px 2px !important',\n      outline: 'none',\n      borderColor: '#cc3333 !important',\n    },\n  },\n  readOnly: {\n    'borderColor': '#ccc !important',\n    'background': '#E3E3E3',\n    'color': '#7E7E7E',\n    '&:focus': {\n      boxShadow: 'none !important',\n      outline: 'none',\n      borderColor: '#ccc !important',\n    },\n  },\n});\n\nexport default function Textbox({\n  entry,\n  element,\n  rows = 1,\n  bpmnModeler,\n  className,\n  readOnly,\n}) {\n  const classes = useStyles();\n  const {label, description, name, validate, get, set} = entry || {};\n  const [value, setValue] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [isError, setError] = useState(false);\n\n  const setProperty = (value) => {\n    if (set) {\n      set(element, {\n        [name]: value,\n      });\n      setValue(value);\n    } else {\n      const modeling = bpmnModeler.get('modeling');\n      modeling.updateProperties(element, {\n        [name]: value,\n      });\n      element.businessObject[name].expression = value\n      element.businessObject[name].value = null\n    }\n  };\n\n  const getProperty = React.useCallback(() => {\n    if (get) {\n      const values = get(element);\n      return values[name];\n    }\n    return element.businessObject[name]?.expression;\n  }, [element, get, name]);\n\n  const updateProperty = (value) => {\n    setProperty(value);\n    setValue(value);\n    const isError = getValidation();\n    setError(isError);\n  };\n\n  const getValidation = React.useCallback(() => {\n    if (\n      !validate ||\n      ((value === null || value === undefined) && name === 'id')\n    ) {\n      setErrorMessage(null);\n      return false;\n    }\n    const valid = validate(element, {\n      [name]: value === '' ? undefined : value,\n    });\n    if (valid && valid[name]) {\n      setErrorMessage(valid[name]);\n      return true;\n    } else {\n      setErrorMessage(null);\n      return false;\n    }\n  }, [validate, element, value, name]);\n\n  useEffect(() => {\n    const isError = getValidation();\n    setError(isError);\n  }, [getValidation]);\n\n  useEffect(() => {\n    if (!element) return;\n    const value = getProperty(element);\n    setValue(value);\n  }, [element, getProperty, entry]);\n\n  return (\n    <div className={classnames(classes.root, className)}>\n      <label className={classes.label}>{label}</label>\n      <TextareaAutosize\n        id={`camunda_${name}_${Date()}`}\n        value={value || ''}\n        className={classnames(\n            classes.textarea,\n            isError && classes.error,\n            readOnly && classes.readOnly,\n        )}\n        rowsMin={rows}\n        onBlur={(e) => {\n          if (!readOnly) {\n            updateProperty(e.target.value);\n          }\n        }}\n        onChange={(e) => {\n          setValue(e.target.value);\n        }}\n        readOnly={typeof readOnly === 'function' ? readOnly() : readOnly}\n      />\n      {errorMessage && <Description desciption={errorMessage} type=\"error\" />}\n      {description && <Description desciption={description} />}\n    </div>\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {Close} from '@material-ui/icons';\n\nimport Description from './Description';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    marginTop: 5,\n    width: '100%',\n  },\n  error: {\n    'borderColor': '#cc3333 !important',\n    'background': '#f0c2c2',\n    '&:focus': {\n      boxShadow: 'rgba(204,58,51, 0.2) 0px 0px 1px 2px !important',\n      outline: 'none',\n      borderColor: '#cc3333 !important',\n    },\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: \"#666\",\n    marginBottom: 3,\n  },\n  fieldWrapper: {\n    position: 'relative',\n  },\n  input: {\n    'width': 'calc(100% - 35px)',\n    'padding': '3px 28px 3px 6px ',\n    'border': '1px solid #ccc',\n    '&:focus': {\n      boxShadow: 'rgba(82, 180, 21, 0.2) 0px 0px 1px 2px',\n      outline: 'none',\n      borderColor: 'rgb(82, 180, 21)',\n    },\n  },\n  clearButton: {\n    background: 'transparent',\n    border: 'none',\n    top: 0,\n    right: 0,\n    position: 'absolute',\n    height: 23,\n    width: 24,\n    overflow: 'hidden',\n    cursor: 'pointer',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  clear: {\n    fontSize: '1rem',\n  },\n  readOnly: {\n    'borderColor': '#ccc !important',\n    'background': '#E3E3E3',\n    '&:focus': {\n      boxShadow: 'none !important',\n      outline: 'none',\n      borderColor: '#ccc !important',\n    },\n  },\n});\n\nexport default function TextField({\n  entry,\n  element,\n  canRemove = false,\n  rootClass,\n  labelClass,\n  type = 'text',\n  isLabel = true,\n  readOnly = false,\n  bpmnModeler,\n}) {\n  const classes = useStyles();\n  const {label, description, name, modelProperty, set, get} = entry || {};\n  const [value, setValue] = useState(null);\n  const setProperty = (value) => {\n    if (!bpmnModeler) return;\n    const modeling = bpmnModeler.get('modeling');\n    modeling.updateProperties(element, {\n      [name]: value,\n    });\n    element.businessObject[name] = value;\n  };\n\n  const getProperty = React.useCallback(() => {\n    return element.businessObject[name];\n  }, [element, name]);\n\n  const updateProperty = (value) => {\n    if (set) {\n      set(element, {\n        [modelProperty]: value,\n      });\n    } else {\n      setProperty(value);\n    }\n  };\n\n  const handleClear = () => {\n    setValue('');\n    updateProperty(undefined);\n  };\n\n  useEffect(() => {\n    if (!element) return;\n    let value;\n    if (get) {\n      const property = get();\n      value = property && property[modelProperty];\n    } else {\n      value = getProperty();\n    }\n    setValue(value);\n  }, [element, get, getProperty, modelProperty]);\n\n  return (\n    <div className={classnames(classes.root, rootClass)}>\n      {isLabel && (\n        <label className={classnames(classes.label, labelClass)}>{label}</label>\n      )}\n      <div className={classes.fieldWrapper}>\n        <input\n          id={`camunda-${name}_${Date()}`}\n          type={type}\n          readOnly={readOnly}\n          name={name}\n          value={value || ''}\n          onChange={(e) => {\n            setValue(e.target.value);\n          }}\n          className={classnames(classes.input, readOnly && classes.readOnly)}\n          onBlur={(e) => updateProperty(e.target.value)}\n        />\n        {canRemove && value && (\n          <button onClick={handleClear} className={classes.clearButton}>\n            <Close className={classes.clear} />\n          </button>\n        )}\n      </div>\n      {description && <Description desciption={description} />}\n    </div>\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/styles';\n\nimport Description from './Description';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    \n    marginTop: 5,\n  },\n  label: {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    fontWeight: \"bolder\",\n    color: \"#666\",\n    marginBottom: 3,\n  },\n  select: {\n    pointerEvents: 'none',\n  },\n});\n\nexport default function SelectBox({entry, element, onChange}) {\n  const classes = useStyles();\n  const {\n    id,\n    name,\n    emptyParameter,\n    selectOptions,\n    canBeDisabled,\n    canBeHidden,\n    label,\n    modelProperty,\n    description,\n    set,\n    get,\n  } = entry || {};\n  const [options, setOptions] = useState([]);\n  const [selectedOption, setSelectedOption] = useState(null);\n\n  const setProperty = (value) => {\n    element.businessObject[name] = value;\n  };\n\n  const getProperty = React.useCallback(() => {\n    return element.businessObject[name];\n  }, [element, name]);\n\n  const handleChange = (e) => {\n    setSelectedOption(e.target.value);\n    if (!set && !setProperty) return;\n    if (set) {\n      set(element, {\n        [modelProperty]: e.target.value,\n      });\n    } else {\n      setProperty(e.target.value);\n      onChange();\n    }\n  };\n\n  useEffect(() => {\n    if (!element) return;\n    const values = get && get(element);\n    const value = getProperty ?\n      getProperty(element) :\n      values && values[modelProperty];\n    setSelectedOption(value);\n  }, [element, modelProperty, get, getProperty]);\n\n  useEffect(() => {\n    if (typeof selectOptions === 'object') {\n      setOptions(selectOptions);\n    } else {\n      const dynamicOptions = selectOptions(element);\n      if (dynamicOptions) {\n        setOptions(dynamicOptions);\n      }\n    }\n  }, [selectOptions, element]);\n\n  return (\n    <div className={classes.root}>\n      <label htmlFor={`camunda-${id}`} className={classes.label}>\n        {label}\n      </label>\n      <select\n        id={`camunda-${id}-select`}\n        name={modelProperty}\n        data-disable={canBeDisabled ? 'isDisabled' : ''}\n        data-show={canBeHidden ? 'isHidden' : ''}\n        value={selectedOption || ''}\n        onChange={handleChange}\n        className={canBeDisabled ? classes.select : ''}\n      >\n        {options &&\n          options.map((option, index) => (\n            <option value={option.value} key={index}>\n              {option.name ? option.name : ''}{' '}\n            </option>\n          ))}\n        {emptyParameter && <option value=\"\"></option>}\n      </select>\n      {description && <Description desciption={description} />}\n    </div>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {getBool} from '../../utils';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    marginTop: 5,\n  },\n  label: {\n    fontWeight: \"bolder\",\n    color: \"#666\",\n  },\n  checkbox: {\n    margin: '3px 3px 3px 0px',\n  },\n});\n\nexport default function Checkbox({entry, element, className, onChange}) {\n  const classes = useStyles();\n  const {\n    id,\n    name,\n    label,\n    modelProperty,\n    get,\n    set,\n    defaultValue = false,\n  } = entry || {};\n  const [value, setValue] = useState(defaultValue);\n\n  const setProperty = React.useCallback(\n      (value) => {\n        if (value && element?.businessObject?.auth !== 'true') {\n          element.businessObject[name] = value.toString();\n          onChange();\n        }\n      // (value && element?.businessObject?.auth !== \"true\" ) && onChange();\n      },\n      [element.businessObject, name, onChange],\n  );\n\n  const getProperty = React.useCallback(() => {\n    return getBool(\n        element.businessObject[name] || element.businessObject.$attrs[name],\n    );\n  }, [element, name]);\n\n  const updateValue = (e) => {\n    setValue((value) => !value);\n    if (set) {\n      set(element, {\n        [modelProperty]: e.target.checked,\n      });\n    } else {\n      setProperty(e.target.checked);\n    }\n  };\n\n  useEffect(() => {\n    if (!element) return;\n    let value;\n    if (get) {\n      const values = get(element);\n      value = values && values[modelProperty];\n    } else {\n      value = getProperty();\n      setProperty(value);\n    }\n    setValue(value);\n  }, [element, modelProperty, get, getProperty, setProperty]);\n\n  return (\n    <div className={classnames(classes.root, className)}>\n      <input\n        id={`camunda-${id}`}\n        type=\"checkbox\"\n        name={modelProperty}\n        checked={value}\n        onChange={updateValue}\n        className={classes.checkbox}\n      />\n      {label && (\n        <label htmlFor={`camunda-${id}`} className={classes.label}>\n          {label}\n        </label>\n      )}\n    </div>\n  );\n}\n","import React, {useState, useRef, useEffect, useCallback} from 'react';\nimport classnames from 'classnames';\nimport AutoComplete from '@material-ui/lab/Autocomplete';\nimport {TextField, CircularProgress} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/core/styles';\n\nfunction useDebounceEffect(handler, interval) {\n  const isMounted = useRef(false);\n  useEffect(() => {\n    if (isMounted.current) {\n      const timer = setTimeout(() => handler(), interval);\n      return () => clearTimeout(timer);\n    }\n    isMounted.current = true;\n  }, [handler, interval]);\n}\n\nconst useStyles = makeStyles((theme) => ({\n  autoComplete: {\n    '& > div > label': {\n      fontSize: 14,\n    },\n    '& > div > div': {\n      paddingRight: '15px !important',\n    },\n    // margin: \"8px 0px\",\n    'background': 'white',\n    'border': '1px solid #ccc',\n    'padding': '0px 5px',\n  },\n  input: {\n    fontSize: 14,\n    color: theme.palette.common.black,\n    padding: '3px 0 3px !important',\n  },\n  label: {\n    fontSize: 14,\n  },\n  endAdornment: {\n    top: 0,\n  },\n  circularProgress: {\n    color: '#0A73FA',\n  },\n  error: {\n    'borderColor': '#cc3333 !important',\n    'background': '#f0c2c2',\n    '&:focus': {\n      boxShadow: 'rgba(204,58,51, 0.2) 0px 0px 1px 2px !important',\n      outline: 'none',\n      borderColor: '#cc3333 !important',\n    },\n  },\n  errorDescription: {\n    marginTop: 5,\n    color: '#CC3333',\n  },\n  labelTitle: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: '#676767',\n    marginBottom: 3,\n  },\n  container: {\n    marginTop: 10,\n    width: '100%',\n  },\n}));\n\nexport default function SelectComponent({\n  optionLabel = 'name',\n  multiple = false,\n  index,\n  update,\n  criteriaIds,\n  type,\n  options: propOptions,\n  entry,\n  isLabel = false,\n  error = false,\n  className,\n  validate,\n  bpmnModeler,\n  element,\n  onChange,\n}) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [searchText, setsearchText] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [isError, setError] = useState(false);\n  const [value,setValue] = useState(element.businessObject[entry.name])\n  const classes = useStyles();\n  const {name, label, fetchMethod} = entry;\n\n  useEffect(()=>{\n    setValue(element.businessObject[name]);\n  },[element.businessObject, name])\n\n  const setProperty = (value, valueObj) => {\n    setValue(valueObj)\n    if (!bpmnModeler) return;\n    const modeling = bpmnModeler.get('modeling');\n    modeling.updateProperties(element, {\n      [name]: value,\n    });\n    element.businessObject[name] = valueObj;\n    if (onChange) {\n      onChange(valueObj);\n    }\n  };\n\n  const fetchOptions = useCallback(\n      (searchText = '') => {\n        setLoading(true);\n        const criteria = [];\n        if (searchText) {\n          criteria.push({\n            fieldName: optionLabel,\n            operator: 'like',\n            value: searchText,\n          });\n        }\n        if (!fetchMethod || !open) {\n          setLoading(false);\n          return;\n        }\n        return fetchMethod(criteria).then((res) => {\n          if (res) {\n            setOptions(res || []);\n          }\n          setLoading(false)\n        });\n      },\n      [optionLabel, fetchMethod, open],\n  );\n\n  const optionDebounceHandler = React.useCallback(() => {\n    if (searchText) {\n      fetchOptions(searchText, criteriaIds);\n    }\n  }, [fetchOptions, searchText, criteriaIds]);\n\n  useDebounceEffect(optionDebounceHandler, 500);\n\n  const getValidation = React.useCallback(() => {\n    if (\n      !validate ||\n      ((value === null || value === undefined) && name === 'id')\n    ) {\n      setErrorMessage(null);\n      return false;\n    }\n    const valid = validate({\n      [name]: value === '' ? undefined : value,\n    });\n    if (valid && valid[name]) {\n      setErrorMessage(valid[name]);\n      return true;\n    } else {\n      setErrorMessage(null);\n      return false;\n    }\n  }, [validate, value, name]);\n\n  useEffect(() => {\n    const isError = getValidation();\n    setError(isError);\n  }, [getValidation]);\n\n  useEffect(() => {\n    if (!open || (propOptions && propOptions.length < 1)) {\n      setOptions([]);\n    }\n  }, [open, propOptions]);\n\n  useEffect(() => {\n    if (open) {\n      if (propOptions && propOptions.length > 0) {\n        setOptions([...propOptions]);\n      } else {\n        fetchOptions(null, criteriaIds);\n      }\n    }\n  }, [fetchOptions, open, criteriaIds, propOptions]);\n\n  useEffect(() => {\n    if (propOptions) {\n      setLoading(true);\n      setOptions(propOptions);\n      setLoading(false);\n    }\n  }, [propOptions]);\n\n  return (\n    <div className={classes.container}>\n      <label className={classes.labelTitle}>{label}</label>\n      <AutoComplete\n        classes={{\n          inputFocused: classes.input,\n          clearIndicator: classes.input,\n          popupIndicator: classes.input,\n          endAdornment: classes.endAdornment,\n        }}\n        size=\"small\"\n        key={index}\n        open={open}\n        onOpen={(e) => {\n          e && e.stopPropagation();\n          setOpen(true);\n        }}\n        onClose={(e) => {\n          e && e.stopPropagation();\n          setOpen(false);\n        }}\n        onClick={(e) => {\n          e && e.stopPropagation();\n          setOpen(true);\n        }}\n        loading={loading}\n        clearOnEscape\n        autoComplete\n        className={classnames(\n            classes.autoComplete,\n            className,\n            isError && classes.error,\n        )}\n        options={options}\n        multiple={multiple}\n        value={value || null}\n        getOptionSelected={(option, val) => {\n          if (!val) return;\n          let optionName = '';\n          optionName = option[optionLabel] ?\n            optionLabel :\n            option['title'] ?\n            'title' :\n            'name';\n          return option[optionName] === (val.id ? val[optionName] : val);\n        }}\n        onChange={(e, value) => {\n          let values = value;\n          if (type === 'multiple') {\n            values =\n              value &&\n              value.filter(\n                  (val, i, self) =>\n                    i ===\n                  self.findIndex((t) => t[optionLabel] === val[optionLabel]),\n              );\n          }\n          if (update) {\n            update(values, value && value[optionLabel]);\n          } else {\n            setProperty(value && value[optionLabel], value);\n          }\n        }}\n        name={name}\n        onInputChange={(e, val) => setsearchText(val)}\n        renderInput={(params) => (\n          <TextField\n            error={error}\n            helperText={error ? 'Required' : ''}\n            className={isError ? classes.error : ''}\n            fullWidth\n            {...params}\n            InputProps={{\n              ...(params.InputProps || {}),\n              endAdornment: (\n                <React.Fragment>\n                  {loading ? (\n                    <CircularProgress\n                      className={classes.circularProgress}\n                      size={15}\n                    />\n                  ) : null}\n                  {params.InputProps.endAdornment}\n                </React.Fragment>\n              ),\n              onClick: (e) => e && e.stopPropagation(),\n              disableUnderline: true,\n            }}\n            inputProps={{\n              ...(params.inputProps || {}),\n              onClick: (e) => {\n                e && e.stopPropagation();\n                params.inputProps &&\n                  params.inputProps.onClick &&\n                  params.inputProps.onClick(e);\n              },\n            }}\n            InputLabelProps={{\n              className: classes && classes.label,\n            }}\n            label={isLabel ? label : undefined}\n          />\n        )}\n        getOptionLabel={(option) => {\n          let optionName = '';\n          optionName = option[optionLabel] ?\n            option[optionLabel] :\n            option['title'] ?\n            option['title'] :\n            typeof option === 'object' ?\n            '' :\n            option;\n          return optionName;\n        }}\n      />\n      {errorMessage && (\n        <div className={classes.errorDescription}>{errorMessage}</div>\n      )}\n    </div>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport {TextField, CircularProgress} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/styles';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport _uniqueId from 'lodash/uniqueId';\n\nimport {translate, useDebounce} from '../../utils';\n\nconst getKey = (key) => (key === '_selectId' ? 'id' : key);\n\nconst useStyles = makeStyles((theme) => ({\n  listbox: {\n    maxHeight: '300px !important',\n  },\n  input: {\n    width: '100% !important',\n  },\n  inputSelected: {\n    width: '100% !important',\n    color: 'rgba(0, 0, 0, 0.87)',\n    border: '1px solid #e0e0e0',\n    padding: '0px 12px',\n    borderRadius: 25,\n    background: '#e0e0e0',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    textAlign: 'center',\n    fontSize: '0.8125rem',\n  },\n}));\nexport default function AutoComplete(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [selectedValue, setSelectedValue] = useState(props.isMulti ? [] : null);\n  const [inputValue, setInputValue] = useState('');\n  const {\n    name,\n    value,\n    onChange,\n    options: flatOptions,\n    optionLabelKey = 'title',\n    optionValueKey = 'id',\n    isMulti = false,\n    title,\n    fetchAPI,\n    inline,\n    InputProps,\n    error,\n    filterSelectedOptions = false,\n    disableCloseOnSelect = true,\n    readOnly = false,\n    concatValue,\n    isProcessContext = false,\n    inputRootClass = {},\n    ...other\n  } = props;\n\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n\n  const findOption = React.useCallback(\n      (option) => {\n        return (\n          flatOptions &&\n        flatOptions.find(\n            (i) => i && i[getKey(optionValueKey)] === option.trim(),\n        )\n        );\n      },\n      [flatOptions, optionValueKey],\n  );\n\n  async function onInputChange(value = '') {\n    setInputValue(value);\n  }\n\n  const delayChange = useDebounce(onInputChange, 400);\n\n  useEffect(() => {\n    let active = true;\n    if (open) {\n      setOptions([]);\n      setLoading(true);\n      if (fetchAPI) {\n        (async () => {\n          const data = await fetchAPI({search: inputValue});\n          if (active) {\n            setOptions(data);\n            setLoading(false);\n          }\n        })();\n      } else {\n        setOptions(flatOptions);\n        setLoading(false);\n      }\n    }\n    return () => {\n      active = false;\n      setLoading(false);\n    };\n  }, [fetchAPI, flatOptions, inputValue, open]);\n\n  useEffect(() => {\n    if (typeof value === 'string') {\n      const values = value.split(',');\n      setSelectedValue(\n        isMulti ? values.map((v) => findOption(v)) : findOption(values[0]),\n      );\n    } else {\n      setSelectedValue(value ? value : isMulti ? [] : null);\n    }\n  }, [value, isMulti, findOption]);\n\n  function onKeyDown(e) {\n    if (e.key === 'Backspace') {\n      if (\n        selectedValue &&\n        selectedValue[getKey(optionLabelKey)] === inputValue\n      ) {\n        onChange(null, 'backspace');\n      }\n    }\n  }\n\n  function handleChange(item, reason) {\n    if (typeof value === 'string') {\n      isMulti ?\n        onChange(\n            item.map((i) => i && i[getKey(optionValueKey)]).join(',') || [],\n            reason,\n        ) :\n        onChange(item && item[getKey(optionValueKey)], reason);\n    } else {\n      onChange(item, reason);\n    }\n  }\n\n  const checkValue = (option) => {\n    return (option && option.type) === 'metaJsonModel' ?\n      `${\n          option && option[getKey(optionLabelKey)] ?\n            option[getKey(optionLabelKey)] :\n            ''\n      } (Custom model)` || '' :\n      name === 'fieldName' ?\n      `${translate(option && option['title'] ? option['title'] : '')} (${\n        option && option[getKey(optionLabelKey)]\n      })` :\n      option ?\n      option[getKey(optionLabelKey)] &&\n        concatValue &&\n        option[getKey(optionValueKey)] ?\n        `${option[getKey(optionLabelKey)]} (${\n          option[getKey(optionValueKey)]\n        })` :\n        option[getKey(optionLabelKey)] ?\n        option[getKey(optionLabelKey)] :\n        option['name'] ?\n        option['name'] :\n        option['id'] ?\n        option['id'].toString() :\n        '' :\n      '';\n  };\n\n  return (\n    <Autocomplete\n      getOptionSelected={(option, value) => {\n        return isMulti ?\n          option[getKey(optionValueKey)] === value[getKey(optionValueKey)] :\n          checkValue(option) === checkValue(value);\n      }}\n      getOptionLabel={(option) => {\n        return checkValue(option);\n      }}\n      loading={loading}\n      id={_uniqueId('select-widget')}\n      open={open}\n      onOpen={() => setOpen(true)}\n      onClose={() => setOpen(false)}\n      disabled={readOnly}\n      value={\n        selectedValue ?\n          isMulti ?\n            Array.isArray(selectedValue) ?\n              selectedValue :\n              [] :\n            selectedValue :\n          isMulti ?\n          [] :\n          null\n      }\n      onChange={(event, newValue, reason) => handleChange(newValue, reason)}\n      options={options || []}\n      multiple={isMulti}\n      filterSelectedOptions={filterSelectedOptions}\n      onInputChange={(e, value) => delayChange(value)}\n      classes={{\n        option: 'menu-item',\n        input: isProcessContext ?\n          selectedValue ?\n            classes.inputSelected :\n            classes.input :\n          '',\n        inputRoot: inputRootClass,\n      }}\n      renderInput={(params) => {\n        return (\n          <TextField\n            {...params}\n            error={error}\n            label={inline ? '' : title}\n            fullWidth\n            onClick={() => {\n              if (readOnly) return;\n              setOpen(true);\n            }}\n            InputProps={{\n              ...InputProps,\n              ...params.InputProps,\n              endAdornment: (\n                <React.Fragment>\n                  {loading ? (\n                    <CircularProgress\n                      className={classes.circularProgress}\n                      size={15}\n                    />\n                  ) : null}\n                  {params.InputProps.endAdornment}\n                </React.Fragment>\n              ),\n            }}\n            {...(isMulti ? {} : {onKeyDown: onKeyDown})}\n          />\n        );\n      }}\n      {...(isMulti ? {disableCloseOnSelect} : {})}\n      {...other}\n    />\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport {TextField, CircularProgress} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/styles';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport _uniqueId from 'lodash/uniqueId';\n\nconst useStyles = makeStyles((theme) => ({\n  listbox: {\n    maxHeight: '300px !important',\n  },\n  input: {\n    width: '100% !important',\n  },\n  inputSelected: {\n    width: '100% !important',\n    color: 'rgba(0, 0, 0, 0.87)',\n    border: '1px solid #e0e0e0',\n    padding: '0px 12px',\n    borderRadius: 25,\n    background: '#e0e0e0',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    textAlign: 'center',\n    fontSize: '0.8125rem',\n  },\n}));\nexport default function AutoComplete(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const {\n    name,\n    value,\n    onChange,\n    options: flatOptions,\n    optionLabelKey = 'title',\n    isMulti = false,\n    title,\n    fetchAPI,\n    inline,\n    InputProps,\n    error,\n    disableCloseOnSelect = true,\n    readOnly = false,\n    concatValue,\n    inputRootClass = {},\n    ...other\n  } = props;\n\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n\n\n  useEffect(() => {\n    let active = true;\n    if (open) {\n      setOptions([]);\n      setLoading(true);\n      if (fetchAPI) {\n        (async () => {\n          const data = await fetchAPI({search: inputValue});\n          if (active) {\n            setOptions(data);\n            setLoading(false);\n          }\n        })();\n      } else {\n        if(inputValue){\n        let newOptions;\n        if(typeof inputValue === \"object\") newOptions = flatOptions.filter( (value) => {return value?.name?.toLowerCase().includes(inputValue?.name?.toLowerCase())});\n        else newOptions = flatOptions.filter( (value) => {return value?.name?.toLowerCase().includes(inputValue?.toLowerCase())});\n        setOptions(newOptions)\n        }\n        else{\n          setOptions(flatOptions);\n        }\n        setLoading(false);\n      }\n    }\n    return () => {\n      active = false;\n      setLoading(false);\n    };\n  }, [fetchAPI, flatOptions, inputValue, open]);\n\n  return (\n    <Autocomplete\n      loading={loading}\n      id={_uniqueId('select-widget')}\n      open={open}\n      onOpen={() => setOpen(true)}\n      onClose={() => setOpen(false)}\n      freeSolo\n      getOptionLabel={(option) => (option[optionLabelKey] ? option[optionLabelKey] : option)}\n      disabled={readOnly}\n      onChange={(event, newValue, reason) => {setInputValue(newValue);onChange(newValue, reason)}}\n      onInputChange={(value)=>setInputValue(value?.target?.value)}\n      options={options || []}\n      value={value}\n      classes={{\n        option: 'menu-item',\n        inputRoot: inputRootClass,\n      }}\n      renderInput={(params) => {\n        return (\n          <TextField\n            {...params}\n            error={error}\n            label={inline ? '' : title}\n            fullWidth\n            onClick={() => {\n              if (readOnly) return;\n              setOpen(true);\n            }}\n            onChange={(e)=>onChange(e.target.value)}\n            InputProps={{\n              ...InputProps,\n              ...params.InputProps,\n              endAdornment: (\n                <React.Fragment>\n                  {loading ? (\n                    <CircularProgress\n                      className={classes.circularProgress}\n                      size={15}\n                    />\n                  ) : null}\n                  {params.InputProps.endAdornment}\n                </React.Fragment>\n              ),\n            }}\n          />\n        );\n      }}\n      {...(isMulti ? {disableCloseOnSelect} : {})}\n      {...other}\n    />\n  );\n}\n","import React, {useState, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    marginTop: 10,\n  },\n  assignElements: {\n    width: '100%',\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: '#666',\n    marginBottom: 3,\n  },\n  add: {\n    top: '-23px !important',\n    position: 'absolute',\n    height: 23,\n    width: 24,\n    overflow: 'hidden',\n    cursor: 'pointer',\n    backgroundColor: '#f8f8f8',\n    border: '1px solid #ccc',\n    borderBottom: 'none',\n    right: 0,\n  },\n  clear: {\n    top: '-23px !important',\n    position: 'absolute',\n    height: 23,\n    width: 24,\n    overflow: 'hidden',\n    cursor: 'pointer',\n    backgroundColor: '#f8f8f8',\n    border: '1px solid #ccc',\n    borderBottom: 'none',\n    right: 23,\n  },\n  container: {\n    position: 'relative',\n  },\n});\n\nexport default function ExtensionElementTable({\n  entry,\n  options: defaultOptions,\n}) {\n  const classes = useStyles();\n  const {\n    label,\n    defaultSize = 5,\n    id,\n    setOptionLabelValue,\n    createExtensionElement,\n    onSelectionChange,\n    removeExtensionElement,\n  } = entry || {};\n  const [options, setOptions] = useState([]);\n  const [selectedOption, setSelectedOption] = useState(null);\n\n  const addElement = () => {\n    createExtensionElement();\n    const label = setOptionLabelValue(options.length);\n    setOptions((options) => [\n      ...(options || []),\n      {id: options.length, text: label},\n    ]);\n    setSelectedOption(options.length);\n    onSelectionChange(options.length);\n  };\n\n  const handleChange = (e) => {\n    setSelectedOption(e.target.value);\n    onSelectionChange(e.target.value);\n  };\n\n  const removeElement = () => {\n    removeExtensionElement(selectedOption);\n  };\n\n  useEffect(() => {\n    if (defaultOptions) {\n      setOptions(defaultOptions);\n    }\n  }, [defaultOptions]);\n\n  return (\n    <div className={classes.root}>\n      <div>\n        <label htmlFor={`cam-assignElements-${id}`} className={classes.label}>\n          {label}\n        </label>\n        <div className={classes.container}>\n          <select\n            id={`cam-assignElements-${id}`}\n            className={classes.assignElements}\n            name=\"selectedExtensionElement\"\n            size={defaultSize}\n            data-list-entry-container\n            value={selectedOption || ''}\n            onChange={() => {}}\n          >\n            {options &&\n              options.length > 0 &&\n              options.map((option) => (\n                <option\n                  key={option.id}\n                  value={option.id}\n                  onClick={handleChange}\n                >\n                  {option.text}\n                </option>\n              ))}\n          </select>\n          <button\n            className={classes.add}\n            id={`cam-assignElements-create-${id}`}\n            onClick={addElement}\n          >\n            <span>+</span>\n          </button>\n          <button\n            className={classes.clear}\n            id={`cam-assignElements-remove-${id}`}\n            onClick={removeElement}\n          >\n            <span style={{fontSize: 10}}>X</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { Select } from '.';\nimport { Add, Edit } from '@material-ui/icons';\nimport { makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme) => ({\n    header: {\n        width: '100%',\n        display:'flex',\n    },\n    icon: {\n        color: 'green',\n        width: '1.6em',\n        height: '1.2em',\n    }\n}));\n\nexport default function SelectComponent({ entry, element, bpmnModeler, onChange, addButton, editButton\n}) {\n    const classes = useStyles();\n    const { edit = true,change = true} = entry\n    return (\n        <div className={classes.header}>\n            <Select\n                entry={entry}\n                element={element}\n                bpmnModeler={bpmnModeler}\n                onChange={change ? onChange : null}\n            />\n            {edit &&\n                <Add\n                    className={classes.icon}\n                    style={{ marginTop: 'auto', marginBottom: 4 }}\n                    onClick={addButton}\n                />}\n            {edit &&\n                <Edit\n                    className={classes.icon}\n                    style={{ marginTop: 'auto', marginBottom: 4 }}\n                    onClick={editButton}\n                />\n            }\n\n        </div>\n    );\n}\n","import React from \"react\";\nimport classnames from \"classnames\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport { Select, FormControl, InputLabel } from \"@material-ui/core\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  },\n  select: {\n    width: \"150px\",\n  },\n}));\n\nexport default function Selection({\n  name,\n  value = \"\",\n  onChange,\n  options,\n  title,\n  className,\n  disableUnderline = false,\n  ...rest\n}) {\n  const classes = useStyles();\n  return (\n    <FormControl className={classnames(classes.formControl, className)}>\n      <InputLabel>{title}</InputLabel>\n      <Select\n        disableUnderline={disableUnderline}\n        value={value}\n        onChange={(e) => onChange(e.target.value)}\n        name={name}\n        style={{ marginRight: 8 }}\n        classes={{ select: classnames(classes.select, className) }}\n        {...rest}\n      >\n        {options &&\n          Array.isArray(options) &&\n          options.map(({ name, title }, index) => (\n            <MenuItem value={name} key={index}>\n              {title}\n            </MenuItem>\n          ))}\n      </Select>\n    </FormControl>\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Input from \"@material-ui/core/Input\";\nimport classnames from \"classnames\";\nimport { TextField } from \"@material-ui/core\";\n\nfunction InputField({\n  name,\n  title,\n  autoTitle,\n  value = \"\",\n  onChange,\n  onBlur,\n  readOnly,\n  inline,\n  InputProps,\n  style,\n  disableUnderline = false,\n  className,\n  ...other\n}) {\n  if (inline) {\n    return (\n      <Input\n        style={{ width: \"100%\", ...style }}\n        className={className}\n        placeholder={title}\n        inputProps={{ \"aria-label\": title, disableUnderline }}\n        name={name}\n        onChange={(e) => onChange(e.target.value)}\n        onBlur={onBlur}\n        autoComplete=\"off\"\n        readOnly={readOnly}\n        disabled={readOnly}\n        value={value || \"\"}\n        {...other}\n      />\n    );\n  }\n  return (\n    <TextField\n      id={`filled-${name}`}\n      label={title || autoTitle}\n      name={name}\n      style={{ width: \"100%\", ...style }}\n      onChange={(e) => onChange(e.target.value)}\n      onBlur={onBlur}\n      autoComplete=\"off\"\n      InputProps={{ readOnly, ...InputProps, disableUnderline }}\n      value={value || \"\"}\n      className={classnames(other.className, className)}\n      {...other}\n    />\n  );\n}\n\nInputField.propTypes = {\n  name: PropTypes.string,\n  title: PropTypes.string,\n  value: PropTypes.string,\n  onChange: PropTypes.func,\n  readOnly: PropTypes.bool,\n  multiline: PropTypes.bool,\n  rows: PropTypes.number,\n};\n\nInputField.defaultProps = {\n  rows: 3,\n  readOnly: false,\n};\nexport default InputField;\n","import React from \"react\";\nimport classnames from \"classnames\";\nimport Button from \"@material-ui/core/Button\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme) => ({\n  button: {\n    color: \"#0275d8\",\n    textTransform: \"none\",\n  },\n  buttonLabel: {\n    maxHeight: 30,\n  },\n}));\n\nfunction ButtonComp({ title, Icon, onClick, className }) {\n  const classes = useStyles();\n  if (!title) {\n    return (\n      <IconButton\n        size=\"medium\"\n        onClick={onClick}\n        className={classnames(classes.button, className)}\n        style={{ padding: \"0px 12px\" }}\n      >\n        <Icon fontSize=\"small\" />\n      </IconButton>\n    );\n  }\n\n  if (!Icon) {\n    return (\n      <Button\n        className={classnames(classes.button, classes.buttonLabel, className)}\n        onClick={onClick}\n      >\n        {title}\n      </Button>\n    );\n  }\n\n  return (\n    <Button\n      className={classnames(classes.button, classes.buttonLabel, className)}\n      endIcon={<Icon />}\n      onClick={onClick}\n    >\n      {title}\n    </Button>\n  );\n}\n\nexport default ButtonComp;\n","import React, { useState, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Input from \"./input\";\n\nfunction NumberField({\n  type = \"integer\",\n  title,\n  onChange,\n  value = 0,\n  readOnly,\n  scale = 2,\n  customeFormat,\n  onBlur: blur,\n  className,\n  disableUnderline,\n  ...other\n}) {\n  let [val, setVal] = useState(value);\n\n  const formatValue = useCallback(\n    (value) => Number(Number(value).toFixed(type === \"integer\" ? 0 : scale)),\n    [type, scale]\n  );\n\n  React.useEffect(() => {\n    setVal(formatValue(value));\n  }, [value, setVal, formatValue]);\n\n  function onBlur(e) {\n    onChange(formatValue(val));\n    setVal(formatValue(val));\n    blur && blur(e);\n  }\n  return (\n    <Input\n      className={className}\n      onChange={setVal}\n      title={title}\n      type={\"number\"}\n      value={`${val}`}\n      onBlur={onBlur}\n      disableUnderline={disableUnderline}\n      {...other}\n    />\n  );\n}\nNumberField.propTypes = {\n  name: PropTypes.string,\n  title: PropTypes.string,\n  type: PropTypes.string,\n  onChange: PropTypes.func,\n  readOnly: PropTypes.bool,\n  scale: PropTypes.number,\n  customeFormat: PropTypes.object,\n};\n\nNumberField.defaultProps = {\n  readOnly: false,\n};\nexport default NumberField;\n","const combinator = [\n  { name: \"and\", title: \"AND\" },\n  { name: \"or\", title: \"OR\" },\n];\n\nconst map_combinator = {\n  and: \"&&\",\n  or: \"||\",\n};\n\nconst map_bpm_combinator = {\n  and: \"and\",\n  or: \"or\",\n};\n\nconst expressionType = [\n  // { name: \"JS\", title: \"JS\" },\n  { name: \"GROOVY\", title: \"GROOVY\" },\n];\n\nconst join_operator = {\n  JS: \".\",\n  GROOVY: \"?.\",\n  BPM: \".\",\n};\n\nconst dateFormat = {\n  date: \"DD/MM/YYYY\",\n  time: \"HH:mm:ss\",\n  datetime: \"DD/MM/YYYY HH:mm\",\n};\n\nconst positive_operators = [\n  \"=\",\n  \">=\",\n  \"<=\",\n  \">\",\n  \"<\",\n  \"like\",\n  \"isNull\",\n  \"between\",\n  \"contains\",\n  \"in\",\n  \"isTrue\",\n];\n\nconst query_custom_types = [\n  \"many_to_many\",\n  \"many-to-many\",\n  \"json_many_to_many\",\n  \"json-many-to-many\",\n  \"one_to_one\",\n  \"one-to-one\",\n  \"json_one_to_one\",\n  \"json-one-to-one\",\n  \"enum\",\n];\n\nconst allowed_types = [\n  \"long\",\n  \"decimal\",\n  \"date\",\n  \"time\",\n  \"datetime\",\n  \"enum\",\n  \"text\",\n  \"integer\",\n  \"boolean\",\n  \"many_to_many\",\n  \"many-to-many\",\n  \"json_many_to_many\",\n  \"json-many-to-many\",\n  \"many_to_one\",\n  \"many-to-one\",\n  \"json_many_to_one\",\n  \"json-many-to-one\",\n  \"one_to_one\",\n  \"one-to-one\",\n  \"json_one_to_one\",\n  \"json-one-to-one\",\n  \"string\",\n];\n\nconst operators_by_type = {\n  enum: [\"=\", \"!=\", \"isNull\", \"isNotNull\"],\n  text: [\"like\", \"notLike\", \"isNull\", \"isNotNull\"],\n  integer: [\n    \"=\",\n    \"!=\",\n    \">=\",\n    \"<=\",\n    \">\",\n    \"<\",\n    \"between\",\n    \"notBetween\",\n    \"isNull\",\n    \"isNotNull\",\n  ],\n  boolean: [\"isTrue\", \"isFalse\"],\n  button: [\"=\"],\n};\n\nconst map_operator_groovy = {\n  \"=\": \"==\",\n  \"!=\": \"!=\",\n  \">\": \">\",\n  \">=\": \">=\",\n  \"<\": \"<\",\n  \"<=\": \"<=\",\n  isNotNull: \"!= null\",\n  isNull: \"== null\",\n  isTrue: \"==\",\n  isFalse: \"==\",\n  in: \"contains\",\n  notIn: \"contains\",\n  like: \"contains\",\n  notLike: \"contains\",\n  contains: \"contains\",\n  notContains: \"contains\",\n};\n\nconst map_operator_bpm = {\n  \"=\": \"=\",\n  \"!=\": \"!=\",\n  \">\": \">\",\n  \">=\": \">=\",\n  \"<\": \"<\",\n  \"<=\": \"<=\",\n  isNotNull: \"is NOT NULL\",\n  isNull: \"is NULL\",\n  isTrue: \"is\",\n  isFalse: \"is\",\n  in: \"IN\",\n  notIn: \"NOT IN\",\n  like: \"LIKE\",\n  notLike: \"NOT LIKE\",\n  contains: \"MEMBER OF\",\n  notContains: \"NOT MEMBER OF\",\n};\n\nconst map_operator_js = {\n  \"=\": \"===\",\n  \"!=\": \"!==\",\n  \">\": \">\",\n  \">=\": \">=\",\n  \"<\": \"<\",\n  \"<=\": \"<=\",\n  in: \"in\",\n  notIn: \"in\",\n  like: \"LIKE\",\n  notLike: \"NOT LIKE\",\n  isNotNull: \"!== null\",\n  isNull: \"=== null\",\n  isTrue: \"===\",\n  isFalse: \"===\",\n};\n\nconst map_operator = {\n  JS: map_operator_js,\n  GROOVY: map_operator_groovy,\n  BPM: map_operator_bpm,\n};\n\nconst operators = [\n  { name: \"=\", title: \"equals\" },\n  { name: \"!=\", title: \"not equal\" },\n  { name: \">\", title: \"greater than\" },\n  { name: \">=\", title: \"greater or equal\" },\n  { name: \"<\", title: \"less than\" },\n  { name: \"<=\", title: \"less or equal\" },\n  { name: \"in\", title: \"in\" },\n  { name: \"between\", title: \"between\" },\n  { name: \"notBetween\", title: \"not Between\" },\n  { name: \"notIn\", title: \"not in\" },\n  { name: \"isNull\", title: \"is null\" },\n  { name: \"isNotNull\", title: \"is not null\" },\n  { name: \"like\", title: \"contains\" },\n  { name: \"notLike\", title: \"doesn't contain\" },\n  { name: \"isTrue\", title: \"is true\" },\n  { name: \"isFalse\", title: \"is false\" },\n  { name: \"contains\", title: \"contains\" },\n  { name: \"notContains\", title: \"not contains\" },\n];\n\nexport {\n  combinator,\n  expressionType,\n  operators,\n  operators_by_type,\n  map_operator,\n  map_combinator,\n  dateFormat,\n  join_operator,\n  map_operator_bpm,\n  map_bpm_combinator,\n  positive_operators,\n  allowed_types,\n  query_custom_types,\n};\n","import React, { useState } from \"react\";\nimport MomentUtils from \"@date-io/moment\";\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardTimePicker,\n  KeyboardDateTimePicker,\n  KeyboardDatePicker,\n} from \"@material-ui/pickers\";\nimport { dateFormat } from \"../extra/data\";\n\nconst PICKERS = {\n  date: KeyboardDatePicker,\n  time: KeyboardTimePicker,\n  datetime: KeyboardDateTimePicker,\n};\n\nfunction DateTimePicker({\n  inline,\n  type = \"date\",\n  disableUnderline = false,\n  className,\n  ...props\n}) {\n  const [open, setOpen] = useState(false);\n  let valueRef = React.useRef();\n  const { name, title, format, error, onChange, ...other } = props;\n  const Picker = PICKERS[type];\n\n  function onKeyDown(e) {\n    if (e.keyCode === 40) setOpen(true);\n  }\n\n  function onClose() {\n    onChange(valueRef.current);\n    setOpen(false);\n  }\n\n  return (\n    <MuiPickersUtilsProvider utils={MomentUtils}>\n      <Picker\n        autoOk={true}\n        open={open}\n        ampm={false}\n        views={\n          type === \"date\"\n            ? [\"date\"]\n            : type === \"datetime\"\n            ? [\"date\", \"hours\", \"minutes\"]\n            : type === \"time\"\n            ? [\"hours\", \"minutes\", \"seconds\"]\n            : [\"date\"]\n        }\n        InputProps={{\n          disableUnderline,\n        }}\n        onChange={(value) => {\n          valueRef.current = value;\n          onChange(value);\n        }}\n        PopoverProps={{\n          anchorOrigin: { vertical: \"bottom\", horizontal: \"left\" },\n          transformOrigin: { vertical: \"top\", horizontal: \"left\" },\n        }}\n        disableToolbar\n        variant=\"inline\"\n        {...(inline ? { invalidDateMessage: \"\" } : {})}\n        className={className}\n        style={{ width: \"100%\", ...(inline ? { margin: 0 } : {}) }}\n        label={inline ? \"\" : title}\n        format={format || dateFormat[type]}\n        {...(type !== \"time\" ? { animateYearScrolling: false } : {})}\n        {...other}\n        onKeyDown={onKeyDown}\n        onClose={onClose}\n        onOpen={() => setOpen(true)}\n      />\n    </MuiPickersUtilsProvider>\n  );\n}\n\nexport default DateTimePicker;\n","import React, { useEffect, useState } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Popper from '@material-ui/core/Popper';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Chip from '@material-ui/core/Chip';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { makeStyles } from '@material-ui/styles';\nimport _uniqueId from 'lodash/uniqueId';\n\nimport { translate, useDebounce } from '../../../utils';\n\nconst useStyles = makeStyles(theme => ({\n  listbox: {\n    maxHeight: '300px !important',\n  },\n  chip: {\n    '&.MuiChip-outlined .MuiChip-deleteIconSmall': {\n      color: '#0275d8',\n    },\n    border: '1px solid #0275d8',\n    color: '#0275d8',\n  },\n  popper: {\n    width: 'auto !important',\n  },\n}));\nexport default function AutoComplete(props) {\n  const [open, setOpen] = useState(false);\n  const [options, setOptions] = useState([]);\n  const [selectedValue, setSelectedValue] = useState(props.isMulti ? [] : null);\n  const [inputValue, setInputValue] = useState('');\n  const {\n    name,\n    value,\n    onChange,\n    options: flatOptions,\n    optionLabelKey = 'title',\n    optionValueKey = 'id',\n    isMulti = false,\n    title,\n    fetchAPI,\n    inline,\n    InputProps,\n    error,\n    filterSelectedOptions = false,\n    disableCloseOnSelect = true,\n    readOnly = false,\n    className,\n    classes: $classes,\n    ...other\n  } = props;\n\n  const classes = useStyles();\n  const [loading, setLoading] = useState(false);\n\n  const findOption = React.useCallback(\n    option => {\n      return (\n        flatOptions &&\n        flatOptions.find(i => i && i[optionValueKey] === option.trim())\n      );\n    },\n    [flatOptions, optionValueKey]\n  );\n\n  async function onInputChange(value = '') {\n    setInputValue(value);\n  }\n\n  const delayChange = useDebounce(onInputChange, 400);\n\n  useEffect(() => {\n    let active = true;\n    if (open) {\n      setLoading(true);\n      if (fetchAPI) {\n        (async () => {\n          const data = await fetchAPI({ search: inputValue });\n          if (active) {\n            setOptions(data);\n            setLoading(false);\n          }\n        })();\n      } else {\n        setOptions(flatOptions);\n        setLoading(false);\n      }\n    }\n    return () => {\n      active = false;\n      setLoading(false);\n    };\n  }, [fetchAPI, flatOptions, inputValue, open]);\n\n  useEffect(() => {\n    if (typeof value === 'string') {\n      const values = value.split(',');\n      setSelectedValue(\n        isMulti ? values.map(v => findOption(v)) : findOption(values[0])\n      );\n    } else {\n      setSelectedValue(value ? value : isMulti ? [] : null);\n    }\n  }, [value, isMulti, findOption]);\n\n  function onKeyDown(e) {\n    if (e.key === 'Backspace') {\n      if (selectedValue && selectedValue[optionLabelKey] === inputValue) {\n        onChange(null);\n      }\n    }\n  }\n\n  function handleChange(item) {\n    if (typeof value === 'string') {\n      isMulti\n        ? onChange(item.map(i => i && i[optionValueKey]).join(',') || [])\n        : onChange(item && item[optionValueKey]);\n    } else {\n      onChange(item);\n    }\n  }\n\n  const checkValue = option => {\n    return (option && option.type) === 'metaJsonModel'\n      ? `${option && option.title} (${\n          option && option[optionLabelKey] ? option[optionLabelKey] : ''\n        }) (Custom model)` || ''\n      : name === 'fieldName'\n      ? `${translate(option && option['title'] ? option['title'] : '')} (${\n          option && option[optionLabelKey]\n        })`\n      : (option && option.type) === 'metaModel'\n      ? `${option && option.title ? option.title : ''} (${\n          option && option[optionLabelKey] ? option[optionLabelKey] : ''\n        })` || ''\n      : option\n      ? option[optionLabelKey]\n        ? option[optionLabelKey]\n        : option['id']\n        ? option['id'].toString()\n        : ''\n      : '';\n  };\n\n  return (\n    <Autocomplete\n      getOptionSelected={(option, value) => {\n        return isMulti\n          ? option[optionValueKey] === value[optionValueKey]\n          : checkValue(option) === checkValue(value);\n      }}\n      getOptionLabel={option => {\n        return checkValue(option);\n      }}\n      className={className}\n      loading={loading}\n      id={_uniqueId('select-widget')}\n      open={open}\n      onOpen={() => setOpen(true)}\n      onClose={() => setOpen(false)}\n      disabled={readOnly}\n      value={\n        selectedValue\n          ? isMulti\n            ? Array.isArray(selectedValue)\n              ? selectedValue\n              : []\n            : selectedValue\n          : isMulti\n          ? []\n          : null\n      }\n      renderTags={(value, getTagProps) =>\n        value.map((option, index) => (\n          <Chip\n            variant=\"outlined\"\n            label={option[optionLabelKey]}\n            size=\"small\"\n            classes={{\n              root: classes.chip,\n            }}\n            {...getTagProps({ index })}\n          />\n        ))\n      }\n      onChange={(event, newValue) => handleChange(newValue)}\n      options={options || []}\n      multiple={isMulti}\n      filterSelectedOptions={filterSelectedOptions}\n      onInputChange={(e, value) => delayChange(value)}\n      classes={{\n        ...$classes,\n        option: 'menu-item',\n        listbox: classes.listbox,\n        popper: options && options.length > 0 && classes.popper,\n      }}\n      PopperComponent={CustomPopper}\n      renderInput={params => {\n        return (\n          <TextField\n            {...params}\n            error={error}\n            label={inline ? '' : title}\n            fullWidth\n            onClick={() => {\n              if (readOnly) return;\n              setOpen(true);\n            }}\n            InputProps={{\n              ...InputProps,\n              ...params.InputProps,\n              // disableUnderline: true,\n              endAdornment: (\n                <React.Fragment>\n                  {loading ? (\n                    <CircularProgress\n                      className={classes.circularProgress}\n                      size={15}\n                    />\n                  ) : null}\n                  {params.InputProps.endAdornment}\n                </React.Fragment>\n              ),\n            }}\n            {...(isMulti ? {} : { onKeyDown: onKeyDown })}\n          />\n        );\n      }}\n      {...(isMulti ? { disableCloseOnSelect } : {})}\n      {...other}\n    />\n  );\n}\n\nfunction CustomPopper(props) {\n  return <Popper {...props} placement=\"bottom-start\" />;\n}\n","import React from 'react';\nimport TimelineContent from '@material-ui/lab/TimelineContent';\nimport TimelineItem from '@material-ui/lab/TimelineItem';\nimport TimelineSeparator from '@material-ui/lab/TimelineSeparator';\nimport TimelineConnector from '@material-ui/lab/TimelineConnector';\nimport Timeline from '@material-ui/lab/Timeline';\nimport TimelineDot from '@material-ui/lab/TimelineDot';\nimport TimelineOppositeContent from '@material-ui/lab/TimelineOppositeContent';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n  timeline: {\n    height: '100%',\n    width: '100%',\n    padding: 0,\n    margin: 0,\n  },\n  timelineOppositeContent: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    padding: 0,\n    maxWidth: 80,\n  },\n  timelineItem: {\n    minHeight: '100%',\n  },\n  timelineDot: {\n    borderColor: '#0275d8',\n  },\n  timelineConnector: {\n    backgroundColor: '#0275d8',\n  },\n}));\n\nexport default function TimelineComponent({ title, children, isBPMN }) {\n  const classes = useStyles();\n  return (\n    <Timeline\n      align=\"alternate\"\n      className={classes.timeline}\n      style={isBPMN && { height: `calc(100% - 40px)` }}\n    >\n      <TimelineItem className={classes.timelineItem}>\n        <TimelineOppositeContent className={classes.timelineOppositeContent}>\n          {title}\n        </TimelineOppositeContent>\n        <TimelineSeparator>\n          <TimelineDot variant=\"outlined\" className={classes.timelineDot} />\n          <TimelineConnector className={classes.timelineConnector} />\n        </TimelineSeparator>\n        <TimelineContent>{children}</TimelineContent>\n      </TimelineItem>\n    </Timeline>\n  );\n}\n","import services from \"../../../services/Service\";\n\nconst joinURL = (model, subURL) => {\n  return `ws/rest/${model}/${subURL}`;\n};\n\nclass AxelorService {\n  constructor(props = {}) {\n    this.model = props.model;\n  }\n\n  search({ fields, sortBy, data, limit, offset }) {\n    const _subURL = `search`;\n    const url = joinURL(this.model, _subURL);\n    return services.post(url, { fields, sortBy, data, limit, offset });\n  }\n\n  fetch(id, data) {\n    const _subURL = `${id}/fetch`;\n    const url = joinURL(this.model, _subURL);\n    return services.post(url, data);\n  }\n\n  view(data) {\n    const url = \"/ws/meta/view\";\n    return services.post(url, data);\n  }\n\n  fields(data) {\n    const url = \"/ws/meta/view/fields\";\n    return services.post(url, data);\n  }\n\n  save(data, spread = false) {\n    const url = joinURL(this.model, \"\");\n    return services.post(url, { ...(spread ? data : { data }) });\n  }\n\n  removeAll(records) {\n    const url = joinURL(this.model, \"removeAll\");\n    return services.post(url, { records });\n  }\n\n  action(name, data) {\n    const url = `/ws/action/${name}`;\n    return services.post(url, { ...data, model: this.model });\n  }\n}\n\nexport default AxelorService;\n","import AxelorService from \"./axelor.rest\";\nimport services from \"../../../services/Service\";\nimport { sortBy } from \"../../../utils\";\nimport { getButtons } from \"../../../services/api\";\nimport { allowed_types, query_custom_types } from \"../extra/data\";\n\nconst metaModalService = new AxelorService({\n  model: \"com.axelor.meta.db.MetaModel\",\n});\n\nconst metaFieldService = new AxelorService({\n  model: \"com.axelor.meta.db.MetaField\",\n});\n\nexport async function getMetaModals({ search = \"\" }) {\n  const data = {\n    ...(search ? { name: search } : {}),\n  };\n  const fields = [\"name\", \"fullName\", \"metaFields\"];\n  return metaModalService\n    .search({ data, fields })\n    .then(({ data = [] }) => data);\n}\n\nconst getResultedFields = (\n  res,\n  isQuery,\n  isM2OField,\n  isContextValue = false\n) => {\n  const responseData = res && res.data;\n  const allFields = responseData && responseData.fields;\n  const jsonFields = Object.values(\n    (responseData && responseData.jsonFields) || [{}]\n  );\n  let result = [];\n  result =\n    (allFields &&\n      allFields.filter(\n        (f) => !f.json && allowed_types.includes((f.type || \"\").toLowerCase())\n      )) ||\n    [];\n\n  jsonFields &&\n    jsonFields.forEach((jsonField) => {\n      const nestedFields = Object.values(jsonField || {}) || [];\n      let fields =\n        nestedFields.filter(\n          (a) =>\n            allowed_types.includes((a.type || \"\").toLowerCase()) &&\n            (a.type === \"many-to-many\" ? a.targetName : true)\n        ) || [];\n      if (isQuery && !isContextValue) {\n        fields =\n          fields.filter(\n            (f) =>\n              ![\n                ...query_custom_types,\n                ...(isM2OField\n                  ? [\n                      \"many_to_one\",\n                      \"json_many_to_one\",\n                      \"many-to-one\",\n                      \"json-many-to-one\",\n                    ]\n                  : []),\n              ].includes((f.type || \"\").toLowerCase())\n          ) || [];\n      }\n      result = [...result, ...fields];\n    });\n  return result;\n};\n\nexport async function getMetaFields(model, isQuery) {\n  if (!model) return [];\n  if (model.type === \"metaModel\") {\n    let res = await services.get(\n      `ws/meta/fields/${\n        model.fullName ? model.fullName : `${model.packageName}.${model.name}`\n      }`\n    );\n    let result = getResultedFields(res, isQuery);\n    const zonedDateTimeFieldsRes = await services.search(\n      \"com.axelor.meta.db.MetaField\",\n      {\n        data: {\n          _domain: `self.metaModel.name = '${model.name}' AND self.typeName = 'ZonedDateTime'`,\n          _domainContext: {\n            _model: \"com.axelor.meta.db.MetaField\",\n          },\n        },\n        fields: [\"name\", \"typeName\", \"metaModel\"],\n      }\n    );\n    const zonedDateTimeFields =\n      zonedDateTimeFieldsRes &&\n      zonedDateTimeFieldsRes.data &&\n      zonedDateTimeFieldsRes.data.length > 0 &&\n      zonedDateTimeFieldsRes.data.map((f) => f.name);\n    if (\n      zonedDateTimeFields &&\n      zonedDateTimeFields.length > 0 &&\n      result &&\n      result.length > 0\n    ) {\n      result.forEach((field) => {\n        if (zonedDateTimeFields.includes(field.name)) {\n          field.typeName = \"ZonedDateTime\";\n        }\n      });\n      return result;\n    }\n    return result;\n  } else {\n    const res = await services.get(\n      `ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=${model.name}`\n    );\n    let result = getResultedFields(res, isQuery);\n    return sortBy(result, \"sequence\") || [];\n  }\n}\n\nexport async function getMetaModal(data) {\n  const res = await metaModalService.search({ data });\n  return res && res.data && res.data[0];\n}\n\nexport async function getSubMetaField(\n  model,\n  isM2MFields = true,\n  isQuery = false,\n  relationJsonModel,\n  isM2OField = false,\n  isContextValue,\n  isAllowedButtons = false\n) {\n  if (model === \"com.axelor.meta.db.MetaJsonRecord\" && relationJsonModel) {\n    const res = await services.get(\n      `ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=${relationJsonModel}`\n    );\n    let result =\n      getResultedFields(res, isQuery, isM2OField, isContextValue) || [];\n    result = result.filter(\n      (a) =>\n        allowed_types.includes((a.type || \"\").toLowerCase()) &&\n        (isQuery ? !a.json : true) &&\n        ((a.type || \"\").toLowerCase() === \"many-to-many\" ? a.targetName : true)\n    );\n    if (isAllowedButtons) {\n      const buttons = await getButtons([\n        {\n          model: relationJsonModel,\n          type: \"metaJsonModel\",\n          modelFullName: model,\n        },\n      ]);\n      result = [...(result || []), ...(buttons || [])];\n    }\n    if (!isM2MFields && result && result.length > 0) {\n      return result.filter(\n        (f) =>\n          ![\"many_to_many\", \"json_many_to_many\"].includes(\n            (f && (f.type || \"\")).toLowerCase().replaceAll(\"-\", \"_\")\n          )\n      );\n    }\n    return sortBy(result, \"sequence\") || [];\n  } else {\n    const data = {\n      criteria: [{ fieldName: \"fullName\", operator: \"=\", value: model }],\n    };\n    const metaModel = await getMetaModal(data);\n    if (!metaModel) return [];\n    const fields = metaModel && metaModel.metaFields.map((f) => f.name);\n    const res = await metaFieldService.fields({\n      fields,\n      model: metaModel.fullName,\n    });\n    let resultFields = res && res.data && res.data.fields;\n    resultFields = resultFields.filter(\n      (a) =>\n        allowed_types.includes((a.type || \"\").toLowerCase()) &&\n        (isQuery ? !a.json : true) &&\n        (a.type === \"many-to-many\" ? a.targetName : true)\n    );\n    if (isAllowedButtons) {\n      const buttons = await getButtons([\n        {\n          model: metaModel && metaModel.name,\n          type: \"metaModel\",\n          modelFullName: metaModel && metaModel.fullName,\n        },\n      ]);\n      resultFields = [...(resultFields || []), ...(buttons || [])];\n    }\n    if (!isM2MFields && resultFields && resultFields.length > 0) {\n      return resultFields.filter(\n        (f) =>\n          ![\"many_to_many\", \"json_many_to_many\"].includes(\n            (f && (f.type || \"\")).toLowerCase().replaceAll(\"-\", \"_\")\n          )\n      );\n    }\n    return resultFields;\n  }\n}\n\nexport async function getData(model) {\n  const modelService = new AxelorService({ model });\n  const res = await modelService.search({});\n  if (res && res.status === -1) return [];\n  return res && res.data;\n}\n\nexport async function getCustomModelData(jsonModel) {\n  const res = await services.search(\"com.axelor.meta.db.MetaJsonRecord\", {\n    data: {\n      criteria: [{ fieldName: \"jsonModel\", operator: \"=\", value: jsonModel }],\n      operator: \"and\",\n    },\n  });\n  if (res && res.status === -1) return [];\n  return res && res.data;\n}\n\nexport async function getNameField(jsonModel) {\n  const res = await services.search(\"com.axelor.meta.db.MetaJsonField\", {\n    data: {\n      criteria: [\n        { fieldName: \"jsonModel\", operator: \"=\", value: jsonModel },\n        { fieldName: \"nameField\", operator: \"=\", value: true },\n      ],\n      operator: \"and\",\n    },\n    fields: [\"name\"],\n  });\n  if (res && res.status > -1) {\n    return res.data && res.data[0];\n  }\n}\n","import React from \"react\";\n\nexport function useDebounce(cb, duration) {\n  const timer = React.useRef(null);\n\n  const clearTimer = () => timer.current && clearTimeout(timer.current);\n  const setTimer = (cb) => (timer.current = setTimeout(cb, duration));\n\n  React.useEffect(() => {\n    return () => clearTimer();\n  }, []);\n\n  return (...args) => {\n    clearTimer();\n    setTimer(() => cb(...args));\n  };\n}\n\nexport function isBPMQuery(type) {\n  return type === \"bpmQuery\" ? true : false;\n}\n\nexport function lowerCaseFirstLetter(str) {\n  if (!str) return;\n  return str.charAt(0).toLowerCase() + str.slice(1);\n}\n\nexport function upperCaseFirstLetter(str) {\n  if (!str) return;\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nexport function getBO(bo) {\n  if (\n    bo &&\n    (bo.$type === \"bpmn:SubProcess\" || bo.$type === \"bpmn:Transaction\")\n  ) {\n    return getBO(bo.$parent);\n  }\n  return bo;\n}\n\nexport function getProcessConfig(element, processConfigs) {\n  if (processConfigs) {\n    return {\n      criteria: [\n        {\n          fieldName: \"name\",\n          operator: \"IN\",\n          value:\n            processConfigs && processConfigs.length > 0 ? processConfigs : [\"\"],\n        },\n      ],\n      operator: \"or\",\n    };\n  }\n  if (!element) return null;\n  let bo = getBO(element && element.businessObject);\n  bo = bo && bo.$parent;\n  if (element && element.type === \"bpmn:Process\") {\n    bo = element.businessObject;\n  } else if (\n    bo &&\n    (bo.$type === \"bpmn:SubProcess\" || bo.$type === \"bpmn:Transaction\")\n  ) {\n    bo = getBO(bo.$parent);\n  } else if (\n    (element && element.businessObject && element.businessObject.$type) ===\n    \"bpmn:Participant\"\n  ) {\n    bo = element && element.businessObject && element.businessObject.processRef;\n  }\n  const extensionElements = bo && bo.extensionElements;\n  const noOptions = {\n    criteria: [\n      {\n        fieldName: \"name\",\n        operator: \"IN\",\n        value: [\"\"],\n      },\n    ],\n  };\n  if (!extensionElements || !extensionElements.values) return noOptions;\n  const processConfigurations = extensionElements.values.find(\n    (e) => e.$type === \"camunda:ProcessConfiguration\"\n  );\n  const metaModels = [],\n    metaJsonModels = [];\n  if (\n    !processConfigurations &&\n    !processConfigurations.processConfigurationParameters\n  )\n    return noOptions;\n  processConfigurations.processConfigurationParameters.forEach((config) => {\n    if (config.metaModel) {\n      metaModels.push(config.metaModel);\n    } else if (config.metaJsonModel) {\n      metaJsonModels.push(config.metaJsonModel);\n    }\n  });\n  let value = [...metaModels, ...metaJsonModels];\n  const data = {\n    criteria: [\n      {\n        fieldName: \"name\",\n        operator: \"IN\",\n        value: value && value.length > 0 ? value : [\"\"],\n      },\n    ],\n    operator: \"or\",\n  };\n  return data;\n}\n\nexport const getJsonExpression = (field, prefix, fieldName) => {\n  const { type, jsonField, targetName } = field;\n  switch (type) {\n    case \"text\":\n    case \"string\":\n    case \"date\":\n    case \"datetime\":\n    case \"time\":\n      return `json_extract_text(${prefix}.${jsonField},'${fieldName}')`;\n    case \"many-to-one\":\n    case \"json-many-to-one\":\n    case \"many_to_one\":\n    case \"json_many_to_one\":\n      if (!targetName) {\n        return `json_extract_text(${prefix}.${jsonField},'${fieldName}')`;\n      }\n      return `json_extract_text(${prefix}.${jsonField},'${fieldName}','${targetName}')`;\n    case \"integer\":\n      return `json_extract_integer(${prefix}.${jsonField},'${fieldName}')`;\n    case \"decimal\":\n      return `json_extract_decimal(${prefix}.${jsonField},'${fieldName}')`;\n    case \"boolean\":\n      return `json_extract_boolean(${prefix}.${jsonField},'${fieldName}')`;\n    default:\n      break;\n  }\n};\n\nexport const join_operator = {\n  JS: \".\",\n  GROOVY: \"?.\",\n  BPM: \".\",\n};\n","const COMBINATOR = [\n  { name: 'and', title: 'AND' },\n  { name: 'or', title: 'OR' },\n];\n\nconst MAP_COMBINATOR = {\n  and: '&&',\n  or: '||',\n};\n\nconst MAP_BPM_COMBINATOR = {\n  and: 'and',\n  or: 'or',\n};\n\nconst EXPRESSION_TYPE = [\n  // { name: \"JS\", title: \"JS\" },\n  { name: 'GROOVY', title: 'GROOVY' },\n];\n\nconst JOIN_OPERATOR = {\n  JS: '.',\n  GROOVY: '?.',\n  BPM: '.',\n};\n\nconst DATE_FORMAT = {\n  date: 'DD/MM/YYYY',\n  time: 'HH:mm:ss',\n  datetime: 'DD/MM/YYYY HH:mm',\n};\n\nconst POSITIVE_OPERATORS = [\n  '=',\n  '>=',\n  '<=',\n  '>',\n  '<',\n  'like',\n  'isNull',\n  'between',\n  'contains',\n  'in',\n  'isTrue',\n];\n\nconst QUERY_CUSTOM_TYPES = [\n  'many_to_many',\n  'many-to-many',\n  'json_many_to_many',\n  'json-many-to-many',\n  'one_to_one',\n  'one-to-one',\n  'json_one_to_one',\n  'json-one-to-one',\n  'enum',\n];\n\n/**\n * Hide m2m fields at the moment\n */\nconst ALLOWED_TYPES = [\n  'long',\n  'decimal',\n  'date',\n  'time',\n  'datetime',\n  'enum',\n  'text',\n  'integer',\n  'boolean',\n  // \"many_to_many\",\n  // \"many-to-many\",\n  // \"json_many_to_many\",\n  // \"json-many-to-many\",\n  'many_to_one',\n  'many-to-one',\n  'json_many_to_one',\n  'json-many-to-one',\n  'one_to_one',\n  'one-to-one',\n  'json_one_to_one',\n  'json-one-to-one',\n  'string',\n];\n\nconst OPERATORS_BY_TYPE = {\n  enum: ['=', '!=', 'isNull', 'isNotNull'],\n  text: ['like', 'notLike', 'isNull', 'isNotNull'],\n  integer: [\n    '=',\n    '!=',\n    '>=',\n    '<=',\n    '>',\n    '<',\n    'between',\n    'notBetween',\n    'isNull',\n    'isNotNull',\n  ],\n  boolean: ['isTrue', 'isFalse', 'isNull', 'isNotNull'],\n  button: ['='],\n  menu_item: ['='],\n};\n\nconst addOperatorByType = (keys, value) =>\n  keys.map(key => (OPERATORS_BY_TYPE[key] = value));\n\naddOperatorByType(\n  ['long', 'decimal', 'date', 'time', 'datetime'],\n  OPERATORS_BY_TYPE.integer\n);\naddOperatorByType(['one_to_many', 'json_one_to_many'], OPERATORS_BY_TYPE.text);\naddOperatorByType(\n  ['many_to_many', 'json_many_to_many'],\n  ['in', 'notIn', 'isNull', 'contains', 'notContains']\n);\naddOperatorByType(\n  ['many_to_one', 'one_to_one', 'json_many_to_one', 'json_one_to_one'],\n  ['=', '!=', 'in', 'notIn', 'isNull', 'isNotNull']\n);\n\naddOperatorByType(\n  ['string'],\n  ['=', '!=', 'isNull', 'isNotNull', 'like', 'notLike']\n);\n\nconst MAP_OPERATOR_GROOVY = {\n  '=': '==',\n  '!=': '!=',\n  '>': '>',\n  '>=': '>=',\n  '<': '<',\n  '<=': '<=',\n  isNotNull: '!= null',\n  isNull: '== null',\n  isTrue: '==',\n  isFalse: '==',\n  in: 'contains',\n  notIn: 'contains',\n  like: 'contains',\n  notLike: 'contains',\n  contains: 'contains',\n  notContains: 'contains',\n};\n\nconst MAP_OPERATOR_BPM = {\n  '=': '=',\n  '!=': '!=',\n  '>': '>',\n  '>=': '>=',\n  '<': '<',\n  '<=': '<=',\n  isNotNull: 'is NOT NULL',\n  isNull: 'is NULL',\n  isTrue: 'is',\n  isFalse: 'is',\n  in: 'IN',\n  notIn: 'NOT IN',\n  like: 'LIKE',\n  notLike: 'NOT LIKE',\n  contains: 'MEMBER OF',\n  notContains: 'NOT MEMBER OF',\n};\n\nconst MAP_OPERATOR_JS = {\n  '=': '===',\n  '!=': '!==',\n  '>': '>',\n  '>=': '>=',\n  '<': '<',\n  '<=': '<=',\n  in: 'in',\n  notIn: 'in',\n  like: 'LIKE',\n  notLike: 'NOT LIKE',\n  isNotNull: '!== null',\n  isNull: '=== null',\n  isTrue: '===',\n  isFalse: '===',\n};\n\nconst MAP_OPERATOR = {\n  JS: MAP_OPERATOR_JS,\n  GROOVY: MAP_OPERATOR_GROOVY,\n  BPM: MAP_OPERATOR_BPM,\n};\n\nconst MANY_TO_ONE_TYPES = [\n  'many-to-one',\n  'json-many-to-one',\n  'many_to_one',\n  'json_many_to_one',\n];\n\nconst RELATIONAL_TYPES = [\n  'many-to-one',\n  'one-to-many',\n  'one-to-one',\n  'many-to-many',\n  'json-many-to-one',\n  'json-one-to-many',\n  'json-one-to-one',\n  'json-many-to-many',\n];\n\nconst OPERATORS = [\n  { name: '=', title: 'equals' },\n  { name: '!=', title: 'not equal' },\n  { name: '>', title: 'greater than' },\n  { name: '>=', title: 'greater or equal' },\n  { name: '<', title: 'less than' },\n  { name: '<=', title: 'less or equal' },\n  { name: 'in', title: 'in' },\n  { name: 'between', title: 'between' },\n  { name: 'notBetween', title: 'not Between' },\n  { name: 'notIn', title: 'not in' },\n  { name: 'isNull', title: 'is null' },\n  { name: 'isNotNull', title: 'is not null' },\n  { name: 'like', title: 'contains' },\n  { name: 'notLike', title: \"doesn't contain\" },\n  { name: 'isTrue', title: 'is true' },\n  { name: 'isFalse', title: 'is false' },\n  { name: 'contains', title: 'contains' },\n  { name: 'notContains', title: 'not contains' },\n];\n\nexport {\n  COMBINATOR,\n  EXPRESSION_TYPE,\n  OPERATORS,\n  OPERATORS_BY_TYPE,\n  MAP_OPERATOR,\n  MAP_COMBINATOR,\n  DATE_FORMAT,\n  JOIN_OPERATOR,\n  MAP_OPERATOR_BPM,\n  MAP_BPM_COMBINATOR,\n  POSITIVE_OPERATORS,\n  ALLOWED_TYPES,\n  QUERY_CUSTOM_TYPES,\n  MANY_TO_ONE_TYPES,\n  RELATIONAL_TYPES,\n};\n","import React, { useEffect, useState } from \"react\";\nimport classnames from \"classnames\";\nimport { IconButton, Tooltip } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { Selection } from \"./components\";\nimport { getSubMetaField } from \"./services/api\";\nimport { isBPMQuery } from \"./extra/util\";\nimport { translate } from \"../../utils\";\nimport { JOIN_OPERATOR } from \"./constants\";\n\nconst useStyles = makeStyles(() => ({\n  MuiAutocompleteRoot: {\n    width: '250px',\n    marginRight: '10px',\n  },\n  iconButton: {\n    marginRight: 10,\n  },\n  icon: {\n    color: '#0275d8',\n  },\n}));\n\nexport default function FieldEditor({\n  initValue = '',\n  getMetaFields,\n  editor,\n  onChange,\n  value,\n  classNames,\n  expression: parentExpression = 'GROOVY',\n  type,\n  isParent = false,\n  isBPM,\n  isField,\n  setInitialField = () => {},\n  isAllowButtons = false,\n}) {\n  const { fieldName = '', allField = [] } = value || {};\n  const [fields, setFields] = useState([]);\n  const classes = useStyles();\n  const isContextValue = isField === 'context' && isBPMQuery(type) && isBPM;\n  const expression = isBPMQuery(type) ? 'BPM' : parentExpression;\n  const [isShow, setShow] = useState(null);\n\n  const values = React.useMemo(() => {\n    return (\n      fieldName &&\n      JOIN_OPERATOR[expression] &&\n      fieldName.split(isContextValue ? '?.' : JOIN_OPERATOR[expression])\n    );\n  }, [isContextValue, fieldName, expression]);\n\n  const [startValue] = values || [];\n  const hasManyValues =\n    fieldName && isParent && fields && fields.some(x => x.name === startValue);\n  const relationModel =\n    hasManyValues && (fields.find(x => x.name === startValue) || {}).target;\n  const relationJsonModel =\n    hasManyValues && (fields.find(x => x.name === startValue) || {}).jsonTarget;\n  const fieldType = ((fields && fields.find(x => x.name === startValue)) || {})\n    .type;\n  const isM2MField =\n    allField &&\n    allField.length > 0 &&\n    allField.find(f =>\n      ['many_to_many', 'json_many_to_many'].includes(\n        (f && (f.type || '')).toLowerCase().replaceAll('-', '_')\n      )\n    );\n  const isM2OField =\n    allField &&\n    allField.length > 0 &&\n    allField.find(f =>\n      ['many_to_one', 'json_many_to_one'].includes(\n        (f && (f.type || '')).toLowerCase().replaceAll('-', '_')\n      )\n    );\n  const isOneToOne = ['one_to_one', 'json_one_to_one'].includes(\n    (fieldType || '').toLowerCase().replaceAll('-', '_')\n  );\n\n  const getUpdatedValue = () => {\n    let spiltedValues = initValue && initValue.split(JOIN_OPERATOR[expression]);\n    return (\n      spiltedValues &&\n      spiltedValues.length > 0 &&\n      (spiltedValues.filter(Boolean) || []).join(JOIN_OPERATOR[expression])\n    );\n  };\n\n  function handleChange(value) {\n    const isRelationalField =\n      value && fields.some(x => x.name === value.name && x.target);\n    if (isBPM) {\n      let allFields;\n      let newFieldName = isParent\n        ? value && value.name\n          ? `${initValue}${value.name}`\n          : `${getUpdatedValue()}`\n        : value && value.name\n        ? `${\n            isRelationalField\n              ? isContextValue\n                ? '?.'\n                : JOIN_OPERATOR[expression]\n              : ''\n          }${initValue}${value.name}`\n        : '';\n      if (value && allField.findIndex(f => f.name === value.name) <= -1) {\n        let fieldNames =\n          (newFieldName || '').split(\n            isContextValue ? '?.' : JOIN_OPERATOR[expression]\n          ) || [];\n        let filterFields =\n          (allField && allField.filter(f => fieldNames.includes(f.name))) || [];\n        allFields = [...filterFields, value];\n      } else {\n        let fields = [...(allField || [])];\n        let fieldNames = (fieldName || '').split(\n          isContextValue ? '?.' : JOIN_OPERATOR[expression]\n        );\n        fieldNames &&\n          fieldNames.length > 0 &&\n          fieldNames.forEach(fName => {\n            let index = fields.findIndex(f => f.name === fName);\n            if (index > -1) {\n              fields.splice(index, 1);\n            }\n          });\n        allFields = fields;\n      }\n      onChange(\n        {\n          name: 'fieldName',\n          value,\n          fieldNameValue: newFieldName ? newFieldName : undefined,\n          allField: allFields,\n          isShow,\n        },\n        editor\n      );\n      return;\n    }\n    let newFieldName = isParent\n      ? `${initValue}${value ? value.name : ''}`\n      : value\n      ? value.name\n      : ''\n      ? `${isRelationalField ? JOIN_OPERATOR[expression] : ''}${initValue}${\n          value ? value.name : ''\n        }`\n      : '';\n    newFieldName = isBPMQuery(type)\n      ? value && value.name\n        ? newFieldName\n        : newFieldName.slice(0, -1)\n      : newFieldName;\n    onChange(\n      {\n        name: 'fieldName',\n        value: newFieldName,\n      },\n      editor\n    );\n    onChange({ name: 'fieldType', value: (value && value.type) || '' }, editor);\n    onChange({ name: 'field', value }, editor);\n    onChange({ name: 'isShow', value: isShow }, editor);\n    if (value && allField.findIndex(f => f.name === value.name) <= -1) {\n      let fieldNames =\n        (newFieldName || '').split(JOIN_OPERATOR[expression]) || [];\n      let allFields =\n        (allField && allField.filter(f => fieldNames.includes(f.name))) || [];\n      onChange({ name: 'allField', value: [...allFields, value] }, editor);\n    } else {\n      let fields = [...(allField || [])];\n      let fieldNames = (fieldName || '').split(JOIN_OPERATOR[expression]);\n      let initValues =\n        `${initValue}${JOIN_OPERATOR[expression]}${startValue}`.split(\n          JOIN_OPERATOR[expression]\n        );\n      fieldNames &&\n        fieldNames.length > 0 &&\n        fieldNames.forEach(fName => {\n          let index = fields.findIndex(f => f.name === fName);\n          if (index > -1 && !(initValues || []).includes(fName)) {\n            fields.splice(index, 1);\n          }\n        });\n      if (fieldNames && fieldNames.length === 1) {\n        fields = fields && fields.filter(f => f.name !== fieldNames[0]);\n      }\n      onChange({ name: 'allField', value: fields }, editor);\n      onChange({ name: 'fieldValue', value: null }, editor);\n      if (fields && fields.length === 1) {\n        const val = fields[0];\n        onChange({ name: 'fieldType', value: (val && val.type) || '' }, editor);\n        onChange({ name: 'field', value: val }, editor);\n        setInitialField();\n      } else {\n        const val = fields[fields.length - 1];\n        onChange({ name: 'fieldType', value: (val && val.type) || '' }, editor);\n        onChange({ name: 'field', value: val }, editor);\n        setInitialField();\n      }\n    }\n  }\n  const transformValue =\n    (fields && fields.find(f => f.name === startValue)) ||\n    (allField && allField.find(f => f.name === startValue));\n\n  const isM2MFields = !isBPMQuery(type)\n    ? isM2MField &&\n      values &&\n      values.length > 0 &&\n      values.includes(isM2MField.name) &&\n      values[0] !== isM2MField.name\n    : true;\n\n  const fetchSubFields = React.useCallback(() => {\n    return getSubMetaField(\n      relationModel,\n      isM2MFields,\n      isBPMQuery(type),\n      relationJsonModel,\n      isM2OField,\n      isBPM,\n      isAllowButtons\n    );\n  }, [\n    relationModel,\n    isM2MFields,\n    type,\n    relationJsonModel,\n    isM2OField,\n    isBPM,\n    isAllowButtons,\n  ]);\n\n  useEffect(() => {\n    const isName =\n      values &&\n      values.slice(1) &&\n      values.slice(1).join(isContextValue ? '?.' : JOIN_OPERATOR[expression]);\n    setShow(\n      isName && !['toLocalDateTime()', 'getTarget()'].includes(isName)\n        ? true\n        : false\n    );\n  }, [values, isContextValue, expression]);\n\n  useEffect(() => {\n    (async () => {\n      const data = await getMetaFields();\n      setFields(data);\n    })();\n  }, [getMetaFields]);\n\n  return (\n    <React.Fragment>\n      <Selection\n        name=\"fieldName\"\n        title=\"Field Name\"\n        placeholder=\"field name\"\n        options={fields}\n        optionLabelKey=\"name\"\n        onChange={handleChange}\n        value={transformValue}\n        classes={{\n          root: classnames(\n            classes.MuiAutocompleteRoot,\n            classNames && classNames.root\n          ),\n        }}\n      />\n      {hasManyValues && relationModel && (\n        <React.Fragment>\n          {isShow && !isOneToOne && (\n            <IconButton\n              size=\"small\"\n              onClick={() => {\n                setShow(isShow => !isShow);\n                if (allField && allField.length > 0 && startValue) {\n                  const previousField = allField.find(\n                    f => f.name === startValue\n                  );\n                  handleChange({\n                    ...(previousField || {}),\n                  });\n                }\n              }}\n              className={classes.iconButton}\n            >\n              <Tooltip title={translate('Remove sub field')}>\n                <CloseIcon className={classes.icon} fontSize=\"small\" />\n              </Tooltip>\n            </IconButton>\n          )}\n          {(isShow || isOneToOne) && (\n            <FieldEditor\n              getMetaFields={fetchSubFields}\n              editor={editor}\n              initValue={`${initValue}${startValue}${\n                isContextValue ? '?.' : JOIN_OPERATOR[expression]\n              }`}\n              value={{\n                fieldName: values\n                  .slice(1)\n                  .join(isContextValue ? '?.' : JOIN_OPERATOR[expression]),\n                allField,\n              }}\n              onChange={onChange}\n              classNames={classNames}\n              expression={expression}\n              type={type}\n              isParent={relationModel ? true : false}\n              isBPM={isBPM}\n              setInitialField={setInitialField}\n              isField={isField}\n              isAllowButtons={isAllowButtons}\n            />\n          )}\n          {!isShow && !isOneToOne && (\n            <IconButton\n              size=\"small\"\n              onClick={() => setShow(isShow => !isShow)}\n              className={classes.iconButton}\n            >\n              <Tooltip title={translate('Add sub field')}>\n                <ArrowForwardIcon className={classes.icon} fontSize=\"small\" />\n              </Tooltip>\n            </IconButton>\n          )}\n        </React.Fragment>\n      )}\n    </React.Fragment>\n  );\n}\n\n","import React, { useEffect, useState } from \"react\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport Paper from \"@material-ui/core/Paper\";\nimport classNames from \"classnames\";\nimport moment from \"moment\";\nimport {\n  Radio,\n  RadioGroup,\n  FormControlLabel,\n  IconButton,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Close, ArrowForward } from \"@material-ui/icons\";\nimport {\n  TimelineContent,\n  TimelineItem,\n  TimelineConnector,\n  TimelineSeparator,\n  Timeline,\n  TimelineOppositeContent,\n  TimelineDot,\n} from \"@material-ui/lab\";\n\nimport { getModels } from \"../../services/api\";\nimport {\n  Select,\n  Button,\n  Selection,\n  DateTimePicker,\n  NumberField,\n  InputField,\n} from \"./components\";\nimport {\n  combinator,\n  operators,\n  operators_by_type,\n  dateFormat,\n  join_operator,\n  allowed_types,\n} from \"./extra/data\";\nimport {\n  getCustomModelData,\n  getNameField,\n  getData,\n  getMetaFields as getMetaFieldsAPI,\n} from \"./services/api\";\nimport { isBPMQuery, lowerCaseFirstLetter } from \"./extra/util\";\nimport FieldEditor from \"./field-editor\";\nimport { translate } from \"../../utils\";\n\nconst useStyles = makeStyles((theme) => ({\n  Container: {\n    display: \"flex\",\n  },\n  rulesGroupHeader: {\n    display: \"flex\",\n  },\n  paper: {\n    margin: theme.spacing(1, 0),\n    padding: theme.spacing(3, 2),\n    overflow: \"auto\",\n  },\n  rules: {\n    display: \"flex\",\n    alignItems: \"flex-end\",\n    justifyContent: \"flex-start\",\n    marginBottom: 15,\n  },\n  MuiAutocompleteRoot: {\n    width: \"250px\",\n    marginRight: \"10px\",\n  },\n  disabled: {\n    pointerEvents: \"none\",\n    opacity: 0.5,\n  },\n  valueFrom: {\n    fontSize: 12,\n    color: \"rgba(0, 0, 0, 0.54)\",\n    fontFamily: '\"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\n  },\n  radio: {\n    padding: \"1px 9px\",\n    color: \"#0275d8\",\n    \"&.MuiRadio-colorSecondary.Mui-checked\": {\n      color: \"#0275d8\",\n    },\n  },\n  operators: {\n    minWidth: 75,\n  },\n  iconButton: {\n    marginRight: 10,\n  },\n  timelineConnector: {\n    backgroundColor: \"#0275d8\",\n  },\n  combinator: {\n    width: \"fit-content\",\n  },\n  icon: {\n    color: \"#0275d8\",\n  },\n  timeline: {\n    height: \"100%\",\n    padding: 0,\n    margin: 0,\n  },\n  timelineOppositeContent: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"flex-end\",\n    maxWidth: 60,\n    padding: 0,\n  },\n}));\n\nasync function fetchField(metaModals, type) {\n  const isQuery = isBPMQuery(type);\n  const allFields = (await getMetaFieldsAPI(metaModals, isQuery)) || [];\n  return allFields.filter(\n    (a) =>\n      allowed_types.includes((a.type || \"\").toLowerCase()) &&\n      (isQuery ? !a.json : true)\n  );\n}\n\nfunction RenderRelationalWidget(props) {\n  const { operator, editor, internalProps, parentType } = props;\n  const { onChange, value, ...rest } = internalProps;\n  const classes = useStyles();\n  const { field = {} } = rest;\n  const { targetName, target, targetModel, model, jsonTarget } = field;\n  const [nameField, setNameField] = useState(null);\n  const fetchData = async () => {\n    let data;\n    if (model === \"com.axelor.meta.db.MetaJsonRecord\" && jsonTarget) {\n      data = await getCustomModelData(jsonTarget);\n      let fieldData = await getNameField(jsonTarget);\n      setNameField(fieldData && fieldData.name);\n    } else {\n      data = await getData(target || targetModel);\n    }\n    return data;\n  };\n  if ([\"like\", \"notLike\"].includes(operator)) {\n    return (\n      <InputField\n        name=\"fieldValue\"\n        onChange={(value) => {\n          let isNameField;\n          if (typeof value !== \"string\" && !isBPMQuery(parentType)) {\n            isNameField =\n              value && value.length > 0\n                ? value && value.find((v) => v && targetName && v[targetName])\n                : value && value[targetName];\n            onChange(\n              { name: \"nameField\", value: isNameField ? nameField : \"id\" },\n              editor\n            );\n          }\n          onChange({ name: \"fieldValue\", value: value }, editor);\n        }}\n        margin=\"none\"\n        style={{ marginTop: \"15px\", width: \"250px !important\" }}\n        value={value}\n        {...rest}\n      />\n    );\n  } else if (\n    [\"contains\", \"notContains\", \"in\", \"notIn\", \"=\", \"!=\"].includes(operator)\n  ) {\n    return (\n      <Selection\n        name=\"fieldValue\"\n        title=\"Value\"\n        placeholder=\"Value\"\n        fetchAPI={fetchData}\n        isMulti={\n          (isBPMQuery(parentType) &&\n            [\"contains\", \"notContains\"].includes(operator)) ||\n          [\"=\", \"!=\"].includes(operator)\n            ? false\n            : true\n        }\n        optionLabelKey={targetName}\n        onChange={(value) => {\n          let isNameField;\n          if (typeof value !== \"string\" && !isBPMQuery(parentType)) {\n            isNameField =\n              value && value.length > 0\n                ? value && value.find((v) => v && targetName && v[targetName])\n                : value && value[targetName];\n            onChange(\n              { name: \"nameField\", value: isNameField ? nameField : \"id\" },\n              editor\n            );\n          }\n          onChange({ name: \"fieldValue\", value: value }, editor);\n        }}\n        value={value || []}\n        classes={{ root: classes.MuiAutocompleteRoot }}\n      />\n    );\n  } else {\n    return null;\n  }\n}\n\nfunction RenderSimpleWidget(props) {\n  const { Component, operator, editor, internalProps } = props;\n  const { onChange, value, value2, classes, style, targetName, ...rest } =\n    internalProps;\n  if ([\"=\", \"!=\", \">\", \">=\", \"<\", \"<=\", \"like\", \"notLike\"].includes(operator)) {\n    return (\n      <Component\n        name=\"fieldValue\"\n        onChange={(value) =>\n          onChange({ name: \"fieldValue\", value: value }, editor)\n        }\n        value={value}\n        style={style}\n        {...rest}\n      />\n    );\n  } else if ([\"between\", \"notBetween\"].includes(operator)) {\n    return (\n      <React.Fragment>\n        <Component\n          name=\"fieldValue\"\n          style={{ marginRight: 8, ...style }}\n          onChange={(value) => onChange({ name: \"fieldValue\", value }, editor)}\n          value={value}\n          {...rest}\n        />\n\n        <Component\n          name=\"fieldValue2\"\n          onChange={(value) =>\n            onChange({ name: \"fieldValue2\", value: value }, editor)\n          }\n          value={value2}\n          style={style}\n          {...rest}\n        />\n      </React.Fragment>\n    );\n  } else if ([\"in\", \"notIn\"].includes(operator)) {\n    return (\n      <Selection\n        name=\"fieldValue\"\n        title=\"Value\"\n        placeholder=\"Value\"\n        isMulti={true}\n        optionLabelKey={targetName}\n        onChange={(val) => {\n          onChange({ name: \"fieldValue\", value: val }, editor);\n        }}\n        value={value || []}\n        classes={{ root: classes.MuiAutocompleteRoot }}\n        optionValueKey=\"name\"\n        {...rest}\n      />\n    );\n  } else {\n    return null;\n  }\n}\n\nfunction RenderWidget({\n  type,\n  operator,\n  onChange,\n  value,\n  classes,\n  parentType,\n  editor,\n  ...rest\n}) {\n  const props = {\n    value: value.fieldValue,\n    value2: value.fieldValue2,\n    onChange,\n    ...rest,\n  };\n\n  let options = [],\n    widgetProps = {};\n  switch (type) {\n    case \"one_to_one\":\n    case \"many_to_one\":\n    case \"many_to_many\":\n    case \"one_to_many\":\n    case \"json_one_to_one\":\n    case \"json_many_to_one\":\n    case \"json_many_to_many\":\n    case \"json_one_to_many\":\n      return (\n        <RenderRelationalWidget\n          operator={operator}\n          editor={editor}\n          internalProps={{ ...props }}\n          parentType={parentType}\n        />\n      );\n    case \"date\":\n    case \"time\":\n    case \"datetime\":\n      const stringToDate = (value) =>\n        value ? moment(value, dateFormat[type]) : null;\n      return (\n        <RenderSimpleWidget\n          Component={DateTimePicker}\n          operator={operator}\n          editor={editor}\n          internalProps={{\n            type,\n            value: stringToDate(value.fieldValue),\n            value2: stringToDate(value.fieldValue2),\n            onChange: ({ name, value }, index) =>\n              onChange(\n                { name, value: value && value.format(dateFormat[type]) },\n                index\n              ),\n            ...rest,\n            margin: \"none\",\n            classes,\n            style: { marginTop: \"15px\", width: \"250px !important\" },\n          }}\n        />\n      );\n    case \"integer\":\n    case \"long\":\n    case \"decimal\":\n    case \"double\":\n      options =\n        rest.field.selectionList &&\n        rest.field.selectionList.map(({ title, value, data }) => ({\n          name: (data && data.value) || value,\n          title: title,\n        }));\n\n      widgetProps = {\n        Component: options ? Select : NumberField,\n        operator,\n        editor,\n        internalProps: {\n          ...(options\n            ? { options, classes, ...props }\n            : {\n                type,\n                ...props,\n                margin: \"none\",\n                classes,\n                style: { marginTop: \"15px\", width: \"250px !important\" },\n              }),\n        },\n      };\n      return <RenderSimpleWidget {...widgetProps} />;\n    case \"enum\":\n      options = rest.field.selectionList.map(({ title, value, data }) => ({\n        name: (data && data.value) || value,\n        title: title,\n      }));\n      return (\n        <RenderSimpleWidget\n          Component={Select}\n          operator={operator}\n          editor={editor}\n          internalProps={{\n            options,\n            classes,\n            ...props,\n          }}\n        />\n      );\n    default:\n      options =\n        rest.field &&\n        rest.field.selectionList &&\n        rest.field.selectionList.map(({ title, value, data }) => ({\n          name: (data && data.value) || value,\n          title: title,\n        }));\n      widgetProps = {\n        Component: options ? Select : InputField,\n        operator,\n        editor,\n        internalProps: {\n          ...(options\n            ? { options, classes, ...props }\n            : {\n                classes,\n                ...props,\n                margin: \"none\",\n                style: { marginTop: \"15px\", width: \"250px !important\" },\n              }),\n        },\n      };\n      return <RenderSimpleWidget {...widgetProps} />;\n  }\n}\n\nfunction Rule(props) {\n  const {\n    getMetaFields,\n    onChange,\n    onRemoveRule,\n    editor,\n    value,\n    expression,\n    parentType,\n    parentMetaModal,\n    isAllowButtons = false,\n  } = props;\n  const {\n    fieldType = \"\",\n    field,\n    operator,\n    fieldValue,\n    fieldValue2 = \"\",\n    isRelationalValue,\n    relatedValueModal,\n    relatedValueFieldName,\n    relatedElseValueModal,\n    relatedElseValueFieldName,\n    isShowMetaModelField: showMetaModelField,\n    isShowElseMetaModelField: showElseMetaModelField,\n  } = value;\n  const classes = useStyles();\n  const type = fieldType && fieldType.toLowerCase().replaceAll(\"-\", \"_\");\n  const [isField, setField] = useState(\n    isRelationalValue ? isRelationalValue : \"none\"\n  );\n  const [metaModal, setMetaModal] = useState(relatedValueModal || null);\n  const [isShowMetaModelField, setIsShowMetaModelField] = useState(\n    showMetaModelField || false\n  );\n  const [elseMetaModal, setElseMetaModal] = useState(\n    relatedElseValueModal || null\n  );\n  const [isShowElseMetaModelField, setIsShowElseMetaModelField] = useState(\n    showElseMetaModelField || false\n  );\n\n  const getValue = (val) => {\n    if (val && typeof val === \"string\") {\n      let values = val.toString().split(\".\");\n      if (values && values.length > 1) {\n        return values.slice(1).join(\".\");\n      } else {\n        return val;\n      }\n    } else {\n      return;\n    }\n  };\n\n  const [elseNameValue, setElseNameValue] = useState(null);\n  const [nameValue, setNameValue] = useState(null);\n\n  const addOperatorByType = (keys, value) => {\n    keys.map((key) => (operators_by_type[key] = value));\n  };\n\n  addOperatorByType(\n    [\"long\", \"decimal\", \"double\", \"date\", \"time\", \"datetime\"],\n    operators_by_type.integer\n  );\n  addOperatorByType(\n    [\"one_to_many\", \"json_one_to_many\"],\n    operators_by_type.text\n  );\n  addOperatorByType(\n    [\"many_to_many\", \"json_many_to_many\"],\n    [\"in\", \"notIn\", \"isNull\", \"contains\", \"notContains\"]\n  );\n  addOperatorByType(\n    [\"many_to_one\", \"one_to_one\", \"json_many_to_one\", \"json_one_to_one\"],\n    [\"=\", \"!=\", \"in\", \"notIn\", \"isNull\", \"isNotNull\"]\n  );\n\n  addOperatorByType(\n    [\"string\"],\n    [\"=\", \"!=\", \"isNull\", \"isNotNull\", \"like\", \"notLike\"]\n  );\n\n  let operatorsOptions = operators.filter((item) => {\n    let operatorType = type;\n    if (operatorType === \"\" && value.fieldName && value.allField.length > 0) {\n      let parentField = value.allField.find((f) => f.name === value.fieldName);\n      operatorType = ((parentField && parentField.type) || \"\").toLowerCase();\n    }\n    return (operators_by_type[operatorType] || []).includes(item.name);\n  });\n\n  const handleChange = (name, value) => {\n    onChange({ name, value }, editor);\n  };\n\n  useEffect(() => {\n    setField(isRelationalValue ? isRelationalValue : \"none\");\n    setMetaModal(relatedValueModal || null);\n    setIsShowMetaModelField(showMetaModelField || false);\n    setElseMetaModal(relatedElseValueModal || null);\n    setIsShowElseMetaModelField(showElseMetaModelField || false);\n  }, [\n    isRelationalValue,\n    relatedValueModal,\n    showMetaModelField,\n    relatedElseValueModal,\n    showElseMetaModelField,\n  ]);\n\n  useEffect(() => {\n    const {\n      fieldValue,\n      allField = [],\n      fieldValue2 = \"\",\n      isRelationalValue,\n      relatedValueModal,\n      relatedValueFieldName,\n      relatedElseValueModal,\n      relatedElseValueFieldName,\n      isShowMetaModelField: showMetaModelField,\n      isShowElseMetaModelField: showElseMetaModelField,\n    } = value;\n    setElseNameValue({\n      allField: allField,\n      field: relatedElseValueFieldName,\n      fieldName:\n        getValue(fieldValue2) ||\n        (relatedElseValueFieldName && relatedElseValueFieldName.name),\n      fieldType: relatedElseValueFieldName && relatedElseValueFieldName.type,\n      fieldValue: null,\n      fieldValue2: null,\n      operator: null,\n      isRelationalValue: isRelationalValue ? isRelationalValue : \"none\",\n      relatedValueFieldName: relatedValueFieldName,\n      relatedValueModal: relatedValueModal,\n      relatedElseValueFieldName: relatedElseValueFieldName,\n      relatedElseValueModal: relatedElseValueModal,\n      isShow: showElseMetaModelField,\n    });\n    setNameValue({\n      allField: allField,\n      field: relatedValueFieldName,\n      fieldName:\n        getValue(fieldValue) ||\n        (relatedValueFieldName && relatedValueFieldName.fieldName),\n      fieldType: relatedValueFieldName && relatedValueFieldName.type,\n      fieldValue: null,\n      fieldValue2: null,\n      operator: null,\n      isRelationalValue: isRelationalValue ? isRelationalValue : \"none\",\n      relatedValueFieldName: relatedValueFieldName,\n      relatedValueModal: relatedValueModal,\n      isShow: showMetaModelField,\n    });\n  }, [value]);\n\n  return (\n    <div className={classes.rules}>\n      <FieldEditor\n        getMetaFields={getMetaFields}\n        isField={isField}\n        editor={editor}\n        onChange={onChange}\n        value={value}\n        expression={expression}\n        type={parentType}\n        isParent={true}\n        isAllowButtons={isAllowButtons}\n        setInitialField={() => {\n          setField(\"none\");\n        }}\n      />\n      <React.Fragment>\n        <Select\n          name=\"operator\"\n          title=\"Operator\"\n          options={\n            field && field.selectionList\n              ? operators.filter((o) =>\n                  (isField && isField !== \"none\"\n                    ? [\"=\", \"!=\", \"isNull\", \"isNotNull\"]\n                    : [\"=\", \"!=\", \"isNull\", \"isNotNull\", \"in\", \"notIn\"]\n                  ).includes(o.name)\n                )\n              : isField && isField !== \"none\"\n              ? operatorsOptions.filter(\n                  (o) => o.name !== \"in\" && o.name !== \"notIn\"\n                )\n              : operatorsOptions\n          }\n          onChange={(value) => {\n            onChange({ name: \"operator\", value }, editor);\n            setField(null);\n          }}\n          value={operator}\n          className={classes.operators}\n        />\n        {operator &&\n          field.type !== \"button\" &&\n          ![\"isNull\", \"isNotNull\", \"isTrue\", \"isFalse\"].includes(operator) && (\n            <RadioGroup\n              aria-label=\"radioType\"\n              name=\"radioType\"\n              value={isField || \"none\"}\n              onChange={(e) => {\n                setField(e.target.value);\n                setNameValue({\n                  fieldValue: null,\n                });\n                handleChange(\"fieldValue\", null);\n                setElseNameValue({\n                  fieldValue2: null,\n                });\n                handleChange(\"fieldValue2\", null);\n                if (\n                  e.target.value &&\n                  (operator === \"in\" || operator === \"notIn\")\n                ) {\n                  onChange({ name: \"operator\", value: undefined }, editor);\n                  setField(null);\n                }\n                if (e.target.value) {\n                  handleChange(\n                    \"isRelationalValue\",\n                    e.target.value === \"none\" ? null : e.target.value\n                  );\n                  handleChange(\"fieldValue\", null);\n                  handleChange(\"fieldValue2\", null);\n                  if (e.target.value === \"self\") {\n                    setMetaModal(parentMetaModal);\n                    setElseMetaModal(parentMetaModal);\n                    handleChange(\"relatedValueModal\", parentMetaModal);\n                    handleChange(\"relatedElseValueModal\", parentMetaModal);\n                  } else {\n                    setMetaModal(null);\n                    setElseMetaModal(null);\n                    setIsShowElseMetaModelField(false);\n                    setIsShowMetaModelField(false);\n                    handleChange(\"relatedValueModal\", null);\n                    handleChange(\"relatedElseValueModal\", null);\n                  }\n                } else {\n                  handleChange(\"relatedValueFieldName\", null);\n                  handleChange(\"relatedValueModal\", null);\n                  handleChange(\"relatedElseValueFieldName\", null);\n                  handleChange(\"relatedElseValueModal\", null);\n                }\n              }}\n            >\n              <label className={classes.valueFrom}>Value from</label>\n              <FormControlLabel\n                value=\"self\"\n                control={<Radio className={classes.radio} size=\"small\" />}\n                label=\"Self\"\n              />\n              <FormControlLabel\n                value=\"context\"\n                control={<Radio className={classes.radio} size=\"small\" />}\n                label=\"Context\"\n              />\n              <FormControlLabel\n                value=\"none\"\n                control={<Radio className={classes.radio} size=\"small\" />}\n                label=\"None\"\n              />\n            </RadioGroup>\n          )}\n      </React.Fragment>\n      {isField &&\n      isField !== \"none\" &&\n      operator &&\n      ![\"isNull\", \"isNotNull\", \"isTrue\", \"isFalse\"].includes(operator) ? (\n        <React.Fragment>\n          {isField === \"context\" && (\n            <React.Fragment>\n              <Selection\n                name=\"metaModal\"\n                title=\"Model\"\n                placeholder=\"Model\"\n                fetchAPI={() => getModels()}\n                optionLabelKey=\"name\"\n                onChange={(e) => {\n                  setMetaModal(e);\n                  if (e) {\n                    setNameValue({\n                      fieldValue: lowerCaseFirstLetter(e.name),\n                    });\n                    handleChange(\"relatedValueModal\", e);\n                    handleChange(\"fieldValue\", lowerCaseFirstLetter(e.name));\n                  } else {\n                    setNameValue({\n                      fieldValue: null,\n                    });\n                    handleChange(\"fieldValue\", null);\n                  }\n                }}\n                value={metaModal}\n                classes={{ root: classes.MuiAutocompleteRoot }}\n              />\n              {isShowMetaModelField && isField === \"context\" && (\n                <IconButton\n                  size=\"small\"\n                  onClick={() => {\n                    setIsShowMetaModelField(false);\n                    handleChange(\"isShowMetaModelField\", false);\n                    if (!metaModal) return;\n                    const model = metaModal.name;\n                    setNameValue({\n                      fieldValue: lowerCaseFirstLetter(model),\n                    });\n                    handleChange(\"relatedValueModal\", metaModal);\n                    handleChange(\"fieldValue\", lowerCaseFirstLetter(model));\n                  }}\n                  className={classes.iconButton}\n                >\n                  <Tooltip title={translate(\"Remove sub field\")}>\n                    <Close color=\"primary\" fontSize=\"small\" />\n                  </Tooltip>\n                </IconButton>\n              )}\n            </React.Fragment>\n          )}\n          {(isShowMetaModelField || isField === \"self\") && (\n            <FieldEditor\n              getMetaFields={() =>\n                isField === \"context\"\n                  ? fetchField(metaModal, parentType)\n                  : getMetaFields()\n              }\n              editor={editor}\n              isField={isField}\n              onChange={(\n                { value, fieldNameValue, allField, isShow },\n                editor\n              ) => {\n                setNameValue({\n                  allField: allField,\n                  field: value,\n                  fieldName: fieldNameValue,\n                  fieldType: value && value.type,\n                  fieldValue: null,\n                  fieldValue2: null,\n                  operator: null,\n                  isRelationalValue: isField === \"none\" ? null : isField,\n                  relatedValueFieldName: null,\n                  relatedValueModal: null,\n                  isShow,\n                  isShowMetaModelField,\n                });\n                handleChange(\n                  \"isRelationalValue\",\n                  isField === \"none\" ? null : isField\n                );\n                handleChange(\"relatedValueFieldName\", value);\n                handleChange(\"relatedValueModal\", metaModal);\n                let isBPM = isBPMQuery(parentType);\n                const isContextValue = isField === \"context\" && isBPM;\n                handleChange(\n                  \"fieldValue\",\n                  fieldNameValue\n                    ? (parentMetaModal && parentMetaModal.id) ===\n                      (metaModal && metaModal.id)\n                      ? isBPM\n                        ? `self.${fieldNameValue}`\n                        : `${lowerCaseFirstLetter(\n                            (metaModal && metaModal.name) ||\n                              (parentMetaModal && parentMetaModal.name) ||\n                              \"self\"\n                          )}${\n                            isContextValue\n                              ? \"?.\"\n                              : join_operator[isBPM ? \"BPM\" : expression]\n                          }${fieldNameValue}${\n                            value && value.typeName && !isBPM\n                              ? `${\n                                  isContextValue\n                                    ? \"?.\"\n                                    : join_operator[expression]\n                                }toLocalDateTime()`\n                              : \"\"\n                          }`\n                      : `${lowerCaseFirstLetter(\n                          (metaModal && metaModal.name) ||\n                            (parentMetaModal && parentMetaModal.name) ||\n                            isBPM\n                            ? \"self\"\n                            : \"\"\n                        )}${\n                          isContextValue\n                            ? \"?.\"\n                            : join_operator[isBPM ? \"BPM\" : expression]\n                        }${fieldNameValue}${\n                          value &&\n                          [\n                            \"json-many-to-one\",\n                            \"MANY_TO_ONE\",\n                            \"many-to-one\",\n                          ].includes(value.type) &&\n                          isBPM &&\n                          isField === \"context\"\n                            ? `${\n                                isContextValue\n                                  ? \"?.\"\n                                  : join_operator[expression]\n                              }getTarget()`\n                            : \"\"\n                        }${\n                          value && value.typeName && !isBPM\n                            ? `${\n                                isContextValue\n                                  ? \"?.\"\n                                  : join_operator[expression]\n                              }toLocalDateTime()`\n                            : \"\"\n                        }`\n                    : undefined\n                );\n              }}\n              value={nameValue}\n              expression={expression}\n              type={parentType}\n              isParent={true}\n              isBPM={true}\n            />\n          )}\n          {!isShowMetaModelField && metaModal && isField === \"context\" && (\n            <IconButton\n              size=\"small\"\n              onClick={() => {\n                setIsShowMetaModelField(true);\n                handleChange(\"isShowMetaModelField\", true);\n              }}\n              className={classes.iconButton}\n            >\n              <Tooltip title={translate(\"Add sub field\")}>\n                <ArrowForward className={classes.icon} fontSize=\"small\" />\n              </Tooltip>\n            </IconButton>\n          )}\n          {[\"between\", \"notBetween\"].includes(operator) && (\n            <React.Fragment>\n              {isField === \"context\" && (\n                <React.Fragment>\n                  <Selection\n                    name=\"metaModal\"\n                    title=\"Meta Modal Else\"\n                    placeholder=\"meta modal\"\n                    fetchAPI={() => getModels()}\n                    optionLabelKey=\"name\"\n                    onChange={(e) => {\n                      setElseMetaModal(e);\n                      if (e) {\n                        setElseNameValue({\n                          fieldValue2: lowerCaseFirstLetter(e.name),\n                        });\n                        handleChange(\"relatedElseValueModal\", e);\n                        handleChange(\n                          \"fieldValue2\",\n                          lowerCaseFirstLetter(e.name)\n                        );\n                      } else {\n                        setElseNameValue({\n                          fieldValue2: null,\n                        });\n                        handleChange(\"fieldValue2\", null);\n                      }\n                    }}\n                    value={elseMetaModal}\n                    classes={{ root: classes.MuiAutocompleteRoot }}\n                  />\n                  {isShowElseMetaModelField && isField === \"context\" && (\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => {\n                        setIsShowElseMetaModelField(false);\n                        handleChange(\"isShowElseMetaModelField\", false);\n                        if (!elseMetaModal) return;\n                        const model = elseMetaModal.name;\n                        setNameValue({\n                          fieldValue: lowerCaseFirstLetter(model),\n                        });\n                        handleChange(\"relatedElseValueModal\", elseMetaModal);\n                        handleChange(\n                          \"fieldValue2\",\n                          lowerCaseFirstLetter(model)\n                        );\n                      }}\n                      className={classes.iconButton}\n                    >\n                      <Tooltip title={translate(\"Remove sub field\")}>\n                        <Close color=\"primary\" fontSize=\"small\" />\n                      </Tooltip>\n                    </IconButton>\n                  )}\n                </React.Fragment>\n              )}\n              {(isShowElseMetaModelField || isField === \"self\") && (\n                <FieldEditor\n                  getMetaFields={() => fetchField(elseMetaModal, type)}\n                  editor={editor}\n                  isField={isField}\n                  onChange={(\n                    { value, fieldNameValue, allField, isShow },\n                    editor\n                  ) => {\n                    setElseNameValue({\n                      allField: allField,\n                      field: value,\n                      fieldName: fieldNameValue,\n                      fieldType: value && value.type,\n                      fieldValue: null,\n                      fieldValue2: null,\n                      operator: null,\n                      isRelationalValue: isField === \"none\" ? null : isField,\n                      relatedValueFieldName: relatedValueFieldName,\n                      relatedValueModal: relatedElseValueModal,\n                      relatedElseValueFieldName: relatedElseValueFieldName,\n                      relatedElseValueModal: relatedElseValueModal,\n                      isShow,\n                      isShowMetaModelField,\n                      isShowElseMetaModelField,\n                    });\n                    handleChange(\"relatedElseValueFieldName\", value);\n                    handleChange(\"relatedElseValueModal\", elseMetaModal);\n                    let isBPM = isBPMQuery(parentType);\n                    const isContextValue = isField === \"context\" && isBPM;\n                    handleChange(\n                      \"fieldValue2\",\n                      fieldNameValue\n                        ? (parentMetaModal && parentMetaModal.id) ===\n                          (elseMetaModal && elseMetaModal.id)\n                          ? isBPM\n                            ? `self.${fieldNameValue}`\n                            : `${lowerCaseFirstLetter(\n                                metaModal &&\n                                  metaModal.name &&\n                                  parentMetaModal &&\n                                  parentMetaModal.name\n                              )}${\n                                isContextValue\n                                  ? \"?.\"\n                                  : join_operator[isBPM ? \"BPM\" : expression]\n                              }${fieldNameValue}${\n                                value && value.typeName && !isBPM\n                                  ? `${\n                                      isContextValue\n                                        ? \"?.\"\n                                        : join_operator[expression]\n                                    }toLocalDateTime()`\n                                  : \"\"\n                              }`\n                          : `${lowerCaseFirstLetter(\n                              elseMetaModal && elseMetaModal.name\n                            )}${\n                              isContextValue\n                                ? \"?.\"\n                                : join_operator[isBPM ? \"BPM\" : expression]\n                            }${fieldNameValue}${\n                              value &&\n                              [\n                                \"json-many-to-one\",\n                                \"MANY_TO_ONE\",\n                                \"many-to-one\",\n                              ].includes(value.type) &&\n                              isBPM &&\n                              isField === \"context\"\n                                ? `${\n                                    isContextValue\n                                      ? \"?.\"\n                                      : join_operator[expression]\n                                  }getTarget()`\n                                : \"\"\n                            }${\n                              value && value.typeName && !isBPM\n                                ? `${\n                                    isContextValue\n                                      ? \"?.\"\n                                      : join_operator[expression]\n                                  }toLocalDateTime()`\n                                : \"\"\n                            }`\n                        : undefined\n                    );\n                  }}\n                  value={elseNameValue}\n                  expression={expression}\n                  type={parentType}\n                  isParent={true}\n                  isBPM={true}\n                />\n              )}\n              {!isShowElseMetaModelField &&\n                elseMetaModal &&\n                isField === \"context\" && (\n                  <IconButton\n                    size=\"small\"\n                    onClick={() => {\n                      setIsShowElseMetaModelField(true);\n                      handleChange(\"isShowElseMetaModelField\", true);\n                    }}\n                    className={classes.iconButton}\n                  >\n                    <Tooltip title={translate(\"Add sub field\")}>\n                      <ArrowForward className={classes.icon} fontSize=\"small\" />\n                    </Tooltip>\n                  </IconButton>\n                )}\n            </React.Fragment>\n          )}\n        </React.Fragment>\n      ) : (\n        operator &&\n        (field.type === \"button\" ? (\n          <Select\n            name=\"fieldValue\"\n            onChange={(value) =>\n              onChange({ name: \"fieldValue\", value: value }, editor)\n            }\n            value={fieldValue}\n            options={[\n              { name: true, title: \"true\" },\n              { name: false, title: \"false\" },\n            ]}\n            className={classes.operators}\n          />\n        ) : (\n          <RenderWidget\n            type={type}\n            parentType={parentType}\n            operator={operator}\n            onChange={(e, editor) => {\n              onChange(e, editor);\n              handleChange(\"isRelationalValue\", null);\n              handleChange(\"relatedValueFieldName\", null);\n              handleChange(\"relatedValueModal\", null);\n            }}\n            value={{ fieldValue, fieldValue2 }}\n            classes={classes}\n            editor={editor}\n            field={field}\n          />\n        ))\n      )}\n      <Button Icon={DeleteIcon} onClick={onRemoveRule} />\n    </div>\n  );\n}\n\nexport default function Editor({\n  onAddGroup,\n  isRemoveGroup,\n  onRemoveGroup,\n  onAddRule,\n  onRemoveRule,\n  editor = {},\n  getChildEditors,\n  onChange,\n  getMetaFields,\n  isDisable,\n  expression,\n  type,\n  parentMetaModal,\n  element,\n  isAllowButtons = false,\n}) {\n  const classes = useStyles();\n  const [isBPM, setBPM] = useState(false);\n  const { id, rules = [] } = editor;\n  const childEditors = getChildEditors(editor.id);\n\n  useEffect(() => {\n    const isBPM = isBPMQuery(type);\n    setBPM(isBPM);\n  }, [type]);\n\n  return (\n    <Paper\n      variant=\"outlined\"\n      className={classNames(classes.paper, isDisable && classes.disabled)}\n    >\n      <div className={classNames(classes.rulesGroupHeader)}>\n        <Timeline align=\"alternate\" className={classes.timeline}>\n          <TimelineItem>\n            <TimelineOppositeContent\n              className={classes.timelineOppositeContent}\n            >\n              <Select\n                name=\"combinator\"\n                className={classes.combinator}\n                disableUnderline={true}\n                options={combinator}\n                value={editor.combinator || \"and\"}\n                onChange={(value) =>\n                  onChange({ name: \"combinator\", value }, editor)\n                }\n              />\n            </TimelineOppositeContent>\n            <TimelineSeparator>\n              <TimelineDot\n                variant=\"outlined\"\n                style={{ borderColor: \"#0275d8\" }}\n              />\n              <TimelineConnector className={classes.timelineConnector} />\n            </TimelineSeparator>\n            <TimelineContent>\n              <Button\n                title=\"Add Group\"\n                Icon={AddIcon}\n                onClick={() => onAddGroup(id)}\n              />\n              {isRemoveGroup && (\n                <Button\n                  title=\"Remove Group\"\n                  Icon={DeleteIcon}\n                  onClick={() => onRemoveGroup(id)}\n                />\n              )}\n              {rules.map((rule, i) => (\n                <React.Fragment key={i}>\n                  <Rule\n                    getMetaFields={getMetaFields}\n                    onRemoveRule={() => onRemoveRule(editor.id, i)}\n                    onChange={(e, editor) => onChange(e, editor, i)}\n                    editor={editor}\n                    value={rule}\n                    expression={expression}\n                    parentType={type}\n                    isBPM={isBPM}\n                    parentMetaModal={parentMetaModal}\n                    element={element}\n                    isAllowButtons={isAllowButtons}\n                  />\n                </React.Fragment>\n              ))}\n              <Button\n                title=\"Add Rule\"\n                Icon={AddIcon}\n                onClick={() => onAddRule(id)}\n              />\n              {childEditors.map((editor, i) => (\n                <React.Fragment key={editor.id}>\n                  <Editor\n                    isRemoveGroup={true}\n                    onAddGroup={onAddGroup}\n                    onRemoveGroup={onRemoveGroup}\n                    onAddRule={onAddRule}\n                    onRemoveRule={onRemoveRule}\n                    getChildEditors={getChildEditors}\n                    getMetaFields={getMetaFields}\n                    onChange={(e, editor, i) => onChange(e, editor, i)}\n                    editor={editor}\n                    type={type}\n                    element={element}\n                    expression={expression}\n                    isAllowButtons={isAllowButtons}\n                  />\n                </React.Fragment>\n              ))}\n            </TimelineContent>\n          </TimelineItem>\n        </Timeline>\n      </div>\n    </Paper>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport produce from \"immer\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Paper } from \"@material-ui/core\";\nimport { getBusinessObject, is } from \"bpmn-js/lib/util/ModelUtil\";\n\nimport Editor from \"./editor\";\nimport { Selection } from \"../components\";\nimport { getMetaFields } from \"./services/api\";\nimport {\n  getButtons,\n  getModels,\n  getDMNModels,\n  getDMNFields,\n} from \"../../services/api\";\nimport { allowed_types } from \"./extra/data\";\nimport { getProcessConfig, isBPMQuery } from \"./extra/util\";\n\n\n\nconst useStyles = makeStyles((theme) => ({\n  Container: {\n    display: \"flex\",\n  },\n  rulesGroupHeader: {\n    display: \"flex\",\n  },\n  paper: {\n    margin: theme.spacing(1),\n    padding: theme.spacing(3, 2),\n  },\n  rules: {\n    display: \"flex\",\n  },\n  MuiAutocompleteRoot: {\n    width: \"100%\",\n    marginRight: \"10px\",\n  },\n  MuiAutocompleteRoot1: {\n    width: \"500px\",\n  },\n  title: {\n    flexGrow: 1,\n  },\n  disabled: {\n    pointerEvents: \"none\",\n    opacity: 0.5,\n  },\n  popoverContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    padding: theme.spacing(2),\n  },\n  typography: {\n    display: \"flex\",\n  },\n  popoverHeader: {\n    display: \"flex\",\n    alignItems: \"center\",\n    borderBottom: \"solid 1px #DDD\",\n  },\n}));\n\nlet id = 0;\n\nconst defaultRules = {\n  id,\n  parentId: -1,\n  combinator: \"and\",\n  rules: [{}],\n};\n\nconst defaultState = {\n  rules: [defaultRules],\n};\n\nfunction ExpressionBuilder(props) {\n  const {\n    value = defaultState,\n    setValue,\n    index,\n    element,\n    type,\n    processConfigs,\n    isAllowButtons,\n    bpmnModeler,\n    allowAllModels,\n    defaultModel,\n  } = props;\n\n  const { metaModals: model, rules: r } = value;\n  const [expression] = useState(\"GROOVY\");\n  const [metaModals, setMetaModals] = useState(model || defaultModel);\n  const [rules, setRules] = useState(r);\n  const classes = useStyles();\n\n  const getDMNValues = async () => {\n    const refs = [];\n    const elementRegistry = bpmnModeler.get(\"elementRegistry\");\n    const elementProcessId =\n      element.type === \"bpmn:Process\" || element.type === \"bpmn:Participant\"\n        ? element.id\n        : element && element.parent && element.parent.id;\n    const elements = elementRegistry.filter((ele) => {\n      const bo = getBusinessObject(ele);\n      if (\n        bo.decisionRef &&\n        (ele && ele.parent && ele.parent.id) === elementProcessId\n      ) {\n        refs.push(bo.decisionRef);\n      }\n      return (\n        bo.decisionRef &&\n        (ele && ele.parent && ele.parent.id) === elementProcessId\n      );\n    });\n    if (!refs || refs.length <= 0) return;\n    const dmnTables = await getDMNModels([\n      {\n        fieldName: \"decisionId\",\n        operator: \"IN\",\n        value: refs,\n      },\n    ]);\n    const tables =\n      elements &&\n      dmnTables &&\n      elements.map((element) => {\n        const table = dmnTables.find(\n          (t) =>\n            t.decisionId ===\n            (element.businessObject && element.businessObject.decisionRef)\n        );\n        return {\n          ...table,\n          dmnNodeId: element.id,\n          dmnNodeNameId: element.businessObject.name,\n          resultVariable: element.businessObject.resultVariable,\n        };\n      });\n    return tables && tables.filter((t) => t.id);\n  };\n\n  const isDMNAllow = () => {\n    if (!bpmnModeler) return;\n    const elementRegistry = bpmnModeler.get(\"elementRegistry\");\n    const elementProcessId =\n      element.type === \"bpmn:Process\" || element.type === \"bpmn:Participant\"\n        ? element.id\n        : element && element.parent && element.parent.id;\n    const elements = elementRegistry.filter((ele) => {\n      const bo = getBusinessObject(ele);\n      return (\n        is(ele, \"bpmn:BusinessRuleTask\") &&\n        bo &&\n        bo.resultVariable &&\n        bo.decisionRef &&\n        (ele && ele.parent && ele.parent.id) === elementProcessId\n      );\n    });\n    if (elements.length > 0) {\n      return true;\n    }\n  };\n\n  function onAddGroup(parentId) {\n    id = (rules ? rules.length : id) + 1;\n    setRules((state) => [...state, { id, parentId, rules: [] }]);\n  }\n\n  function onRemoveGroup(id) {\n    setRules(\n      produce((draft) => {\n        const index = rules.findIndex((r) => r.id === id);\n        draft.splice(index, 1);\n      })\n    );\n  }\n\n  function onAddRule(editorId, rule = {}) {\n    setRules(\n      produce((draft) => {\n        const editorIndex = rules.findIndex((i) => i.id === editorId);\n        draft[editorIndex].rules = [...draft[editorIndex].rules, rule];\n      })\n    );\n  }\n\n  function onRemoveRule(editorId, index) {\n    setRules(\n      produce((draft) => {\n        const editorIndex = rules.findIndex((i) => i.id === editorId);\n        draft[editorIndex].rules.splice(index, 1);\n      })\n    );\n  }\n\n  const getChildEditors = (parentId) => {\n    return rules.filter((editor) => editor.parentId === parentId);\n  };\n\n  function onChange({ name, value }, editor, index) {\n    setRules(\n      produce((draft) => {\n        const editorIndex = rules.findIndex((i) => i.id === editor.id);\n        if (index >= 0) {\n          Object.assign(\n            (draft[editorIndex].rules[index] = {\n              ...draft[editorIndex].rules[index],\n              [name]: value,\n              ...(name === \"fieldName\"\n                ? {\n                    operator: \"\",\n                    fieldValue: null,\n                    fieldValue2: null,\n                    isRelationalValue: null,\n                    relatedValueFieldName: null,\n                    relatedValueModal: null,\n                  }\n                : {}),\n              ...(name === \"operator\"\n                ? {\n                    fieldValue: null,\n                    fieldValue2: null,\n                    isRelationalValue: null,\n                    relatedValueFieldName: null,\n                    relatedValueModal: null,\n                  }\n                : {}),\n            })\n          );\n        } else {\n          draft[editorIndex][name] = value;\n        }\n      })\n    );\n  }\n\n  async function fetchField() {\n    if (model && model.type === \"dmnModel\") {\n      const dmnFieldIds = model.outputDmnFieldList.map((f) => f.id);\n      if (dmnFieldIds && dmnFieldIds.length > 0) {\n        const dmnFields = await getDMNFields({\n          data: {\n            criteria: [{ fieldName: \"id\", operator: \"IN\", value: dmnFieldIds }],\n          },\n        });\n        return (\n          dmnFields &&\n          dmnFields.map((f) => {\n            return { ...f, type: f.fieldType };\n          })\n        );\n      }\n    }\n    const isQuery = isBPMQuery(type);\n    let allFields = (await getMetaFields(metaModals, isQuery)) || [];\n    if (metaModals && isAllowButtons) {\n      const buttons = await getButtons([\n        {\n          model: metaModals.name,\n          type: metaModals.type,\n          modelFullName: `${metaModals.packageName}.${metaModals.name}`,\n        },\n      ]);\n      allFields = [...(allFields || []), ...(buttons || [])];\n    }\n    return allFields.filter((a) => {\n      return (\n        (isAllowButtons\n          ? [...allowed_types, \"button\"]\n          : allowed_types\n        ).includes((a.type || \"\").toLowerCase()) && (isQuery ? !a.json : true)\n      );\n    });\n  }\n\n  async function fetchModels() {\n    const isDMN = isBPMQuery(type) ? false : isDMNAllow();\n    const dmnModels = isDMN ? await getDMNValues() : undefined;\n    return getModels(\n      isBPMQuery(type) || allowAllModels\n        ? null\n        : getProcessConfig(element, processConfigs),\n      undefined,\n      dmnModels\n    );\n  }\n\n  useEffect(() => {\n    setMetaModals(model || defaultModel);\n    setRules(r);\n  }, [r, model, defaultModel]);\n\n  useEffect(() => {\n    setValue({ metaModals, rules }, index);\n  }, [index, setValue, metaModals, rules]);\n\n  return (\n    <div style={{ width: \"100%\" }}>\n      <Paper variant=\"outlined\" className={classes.paper}>\n        <div\n          style={{ display: \"flex\", width: \"100%\", flexDirection: \"column\" }}\n        >\n          <div style={{ display: \"flex\" }}>\n            <Selection\n              name=\"metaModal\"\n              title=\"Model\"\n              placeholder=\"meta modal\"\n              fetchAPI={fetchModels}\n              optionLabelKey=\"name\"\n              onChange={(e) => {\n                setMetaModals(e);\n                setRules([defaultRules]);\n              }}\n              readOnly={defaultModel ? true : false}\n              value={metaModals}\n              classes={{ root: classes.MuiAutocompleteRoot }}\n            />\n          </div>\n        </div>\n        {rules\n          .filter((e) => e.parentId === -1)\n          .map((editor) => {\n            return (\n              <React.Fragment key={editor.id}>\n                <Editor\n                  onAddGroup={onAddGroup}\n                  onRemoveGroup={onRemoveGroup}\n                  onAddRule={onAddRule}\n                  onRemoveRule={onRemoveRule}\n                  getChildEditors={getChildEditors}\n                  getMetaFields={fetchField}\n                  onChange={(e, editor, index) => onChange(e, editor, index)}\n                  editor={editor}\n                  isDisable={!Boolean(metaModals)}\n                  expression={expression}\n                  type={type}\n                  parentMetaModal={metaModals}\n                  element={element}\n                  processConfigs={processConfigs}\n                  isAllowButtons={isAllowButtons}\n                />\n                <br />\n              </React.Fragment>\n            );\n          })}\n      </Paper>\n    </div>\n  );\n}\n\nexport default ExpressionBuilder;\n","import React, { useEffect, useState } from \"react\";\nimport jsStringEscape from \"js-string-escape\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport {\n  Paper,\n  Dialog,\n  DialogTitle,\n  Checkbox,\n  FormControlLabel,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n  Button as MaterialButton,\n} from \"@material-ui/core\";\nimport {\n  TimelineContent,\n  TimelineItem,\n  TimelineConnector,\n  TimelineSeparator,\n  Timeline,\n  TimelineOppositeContent,\n  TimelineDot,\n} from \"@material-ui/lab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport produce from \"immer\";\nimport moment from \"moment\";\nimport { isEmpty } from \"lodash\";\nimport _ from \"lodash\";\nimport ExpressionComponent from \"./expression-builder\";\nimport {\n  combinator as combinators,\n  map_operator,\n  join_operator,\n  dateFormat,\n  map_combinator,\n  map_bpm_combinator,\n  positive_operators,\n} from \"./extra/data\";\nimport { getModels, getDMNModels } from \"../../services/api\";\nimport {\n  isBPMQuery,\n  lowerCaseFirstLetter,\n  upperCaseFirstLetter,\n  getJsonExpression,\n} from \"./extra/util\";\nimport { translate } from \"../../utils\";\nimport { Button, Select } from \"./components\";\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    margin: theme.spacing(1),\n    padding: theme.spacing(3, 2),\n    width: `calc(100% - 16px)`,\n    display: \"flex\",\n    height: \"calc(100% - 50px)\",\n    overflow: \"auto\",\n  },\n  expressionContainer: {\n    display: \"flex\",\n    alignItems: \"center\",\n    width: \"100%\",\n  },\n  dialogPaper: {\n    maxWidth: \"100%\",\n    maxHeight: \"100%\",\n    resize: \"both\",\n    width: \"70%\",\n    height: 650,\n  },\n  dialog: {\n    minWidth: 300,\n  },\n  root: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-start\",\n    height: \"100%\",\n    overflow: \"hidden\",\n  },\n  combinator: {\n    width: \"fit-content\",\n  },\n  timelineConnector: {\n    backgroundColor: \"#0275d8\",\n  },\n  save: {\n    margin: theme.spacing(1),\n    backgroundColor: \"#0275d8\",\n    borderColor: \"#0267bf\",\n    color: \"white\",\n    \"&:hover\": {\n      backgroundColor: \"#025aa5\",\n      borderColor: \"#014682\",\n      color: \"white\",\n    },\n  },\n  timeline: {\n    width: \"100%\",\n    padding: 0,\n    margin: 0,\n  },\n  timelineOppositeContent: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"flex-end\",\n    maxWidth: 60,\n    padding: 0,\n  },\n  checkbox: {\n    color: \"#0275d8\",\n    \"&.MuiCheckbox-colorSecondary.Mui-checked\": {\n      color: \"#0275d8\",\n    },\n  },\n  timelineItem: {\n    \"&.MuiTimelineItem-missingOppositeContent:before\": {\n      padding: 0,\n    },\n  },\n  expression: {\n    height: \"100%\",\n    width: \"100%\",\n  },\n}));\n\nfunction ExpressionBuilder({\n  handleClose,\n  open,\n  element,\n  setProperty,\n  getExpression,\n  type: parentType = \"expressionBuilder\",\n  title = \"Add Expression\",\n  processConfigs,\n  isAllowButtons = true,\n  allowAllModels = false,\n  bpmnModeler,\n  defaultModel,\n}) {\n  const expression = isBPMQuery(parentType) ? \"BPM\" : \"GROOVY\";\n  const [combinator, setCombinator] = useState(\"and\");\n  const [openAlert, setAlert] = useState(false);\n  const [expressionComponents, setExpressionComponents] = useState([\n    { Component: ExpressionComponent },\n  ]);\n  const [singleResult, setSingleResult] = useState(false);\n  const [generateWithId, setGenerateWithId] = useState(false);\n  const [alertConfig, setAlertConfig] = useState({\n    alertMessage: \"Add all values\",\n    alertTitle: \"Error\",\n  });\n  const [isClose, setClose] = useState(false);\n  const [initialValues, setInitialValues] = useState(null);\n\n  const classes = useStyles();\n  function onAddExpressionEditor() {\n    setExpressionComponents(\n      produce((draft) => {\n        draft.push({ Component: ExpressionComponent.bind({}) });\n      })\n    );\n  }\n\n  function onRemoveExpressionEditor(index) {\n    setExpressionComponents(\n      produce((draft) => {\n        draft.splice(index, 1);\n      })\n    );\n  }\n\n  function getRelationalCondition(\n    rule,\n    initValue = \"\",\n    isParent = false,\n    prefix\n  ) {\n    const map_operators =\n      map_operator[isBPMQuery(parentType) ? \"BPM\" : expression];\n    const { fieldName: propFieldName, operator, allField } = rule;\n    let {\n      fieldValue,\n      fieldValue2,\n      isRelationalValue,\n      relatedValueFieldName,\n      relatedValueModal,\n      relatedElseValueFieldName,\n      relatedElseValueModal,\n      parent,\n      nameField,\n    } = rule;\n    let fieldName = propFieldName;\n    const values =\n      fieldName &&\n      fieldName\n        .split(join_operator[isBPMQuery(parentType) ? \"BPM\" : expression])\n        .filter((f) => f !== \"\");\n\n    const fName = values[0];\n    const field = allField.find((f) => f.name === fName);\n    const { targetName, selectionList, nameField: nameColumn } = field || {};\n    const type =\n      field && field.type && field.type.toLowerCase().replaceAll(\"-\", \"_\");\n    const typeName = field && field.typeName;\n    const nestedFields = (values && values.splice(1)) || [];\n    if (\n      [\n        \"many_to_many\",\n        \"one_to_many\",\n        \"json_many_to_many\",\n        \"json_one_to_many\",\n      ].includes(type)\n    ) {\n      const findRelational = initValue.match(/\\$\\$/g);\n      if (findRelational && findRelational.length > 0) {\n        const str =\n          nestedFields.length >= 1\n            ? `${fName}.find{it->it.$$$$}${\n                positive_operators.includes(operator) ? \" != null\" : \" == null\"\n              }`\n            : `${fName}.${\n                nestedFields.length > 0 ? \"find\" : \"collect\"\n              }{it->it$$$$}${\n                nestedFields.length > 0\n                  ? positive_operators.includes(operator)\n                    ? \" != null\"\n                    : \" == null\"\n                  : \"\"\n              }`;\n        initValue = initValue.replace(/\\$\\$/g, str);\n      } else {\n        const str =\n          nestedFields.length >= 1\n            ? `${fName}.find{it->it.$$}${\n                positive_operators.includes(operator) ? \" != null\" : \" == null\"\n              }`\n            : `${fName}.${\n                nestedFields.length > 0 ? \"find\" : \"collect\"\n              }{it->it$$}${\n                nestedFields.length > 0\n                  ? positive_operators.includes(operator)\n                    ? \" != null\"\n                    : \" == null\"\n                  : \"\"\n              }`;\n        initValue += str;\n      }\n      const nestedFieldName = nestedFields.join(join_operator[expression]);\n      return getRelationalCondition(\n        {\n          fieldName: nestedFieldName,\n          operator,\n          allField,\n          fieldValue,\n          fieldValue2,\n          isRelationalValue,\n          relatedValueFieldName,\n          relatedValueModal,\n          relatedElseValueFieldName,\n          relatedElseValueModal,\n          parent: values && values[0],\n          nameField: nameColumn || nameField,\n        },\n        initValue,\n        nestedFields.length > 1,\n        prefix\n      );\n    } else if (\n      [\n        \"json_many_to_one\",\n        \"json_one_to_one\",\n        \"many_to_one\",\n        \"one_to_one\",\n      ].includes(type)\n    ) {\n      const nestedFieldName = nestedFields.join(join_operator[expression]);\n      const findRelational = initValue.match(/\\$\\$/g);\n      const str =\n        nestedFields.length >= 1\n          ? `${fName}${join_operator[expression]}`\n          : fName;\n      if (findRelational && findRelational.length > 0) {\n        initValue = initValue.replace(/\\$\\$/g, `${str}$$$$`);\n      } else {\n        initValue += `${str}$$`;\n      }\n      return getRelationalCondition(\n        {\n          fieldName: nestedFieldName,\n          operator,\n          allField,\n          fieldValue,\n          fieldValue2,\n          isRelationalValue,\n          relatedValueFieldName,\n          relatedValueModal,\n          relatedElseValueFieldName,\n          relatedElseValueModal,\n          nameField: nameColumn || nameField,\n          parent: values && values[0],\n        },\n        initValue,\n        nestedFields.length > 1,\n        prefix\n      );\n    } else {\n      const isNumber = [\n        \"long\",\n        \"integer\",\n        \"decimal\",\n        \"boolean\",\n        \"button\",\n        \"double\",\n      ].includes(type);\n      const isDateTime = [\"date\", \"time\", \"datetime\"].includes(type);\n\n      if (isNumber) {\n        if (\n          !fieldValue &&\n          fieldValue !== false &&\n          !selectionList &&\n          !isRelationalValue\n        ) {\n          fieldValue = 0;\n        }\n        if ([\"between\", \"notBetween\"].includes(operator) && !fieldValue2) {\n          fieldValue2 = 0;\n        }\n      }\n\n      if (!isRelationalValue && !isNumber && typeof fieldValue !== \"object\") {\n        fieldValue = `'${jsStringEscape(fieldValue)}'`;\n        fieldValue2 = `'${jsStringEscape(fieldValue2)}'`;\n      }\n\n      if (isDateTime) {\n        if (!isRelationalValue) {\n          fieldValue = getDateTimeValue(type, fieldValue);\n          fieldValue2 = getDateTimeValue(type, fieldValue2);\n        }\n        fieldName = typeName ? `${fieldName}?.toLocalDateTime()` : fieldName;\n      }\n      if ([\"in\", \"notIn\"].includes(operator)) {\n        const isManyToManyField = initValue && initValue.includes(\"{it->it$$}\");\n        const field = allField.find((f) => f.name === parent) || {};\n        const value =\n          typeof rule.fieldValue === \"string\"\n            ? rule.fieldValue\n            : rule.fieldValue\n                .map((i) =>\n                  isNumber\n                    ? `${\n                        i[\"nameField\"] ||\n                        i[\"targetName\"] ||\n                        i[\"fullName\"] ||\n                        i[\"name\"] ||\n                        i[\"id\"]\n                      }`\n                    : i[\"nameField\"] ||\n                      i[\"targetName\"] ||\n                      i[\"fullName\"] ||\n                      i[\"name\"]\n                    ? `'${\n                        i[\"nameField\"] ||\n                        i[\"targetName\"] ||\n                        i[\"fullName\"] ||\n                        i[\"name\"]\n                      }'`\n                    : i[\"id\"]\n                )\n                .join(\",\");\n        const name =\n          isParent || nestedFields.length >= 1\n            ? \"\"\n            : `${fieldName}${\n                selectionList\n                  ? \"\"\n                  : `${join_operator[expression]}${\n                      nameField ||\n                      (field && field.targetName) ||\n                      targetName ||\n                      \"fullName\"\n                    }`\n              }`;\n        const str = `${operator === \"notIn\" ? \"!\" : \"\"}${`[${value}]`}${\n          join_operator[expression]\n        }${map_operators[operator]}${isManyToManyField ? \"All\" : \"\"}(${prefix}${\n          join_operator[expression]\n        }${initValue.replace(/\\$\\$/g, name)})`;\n        return str;\n      } else if ([\"contains\", \"notContains\"].includes(operator)) {\n        const isManyToManyField = initValue && initValue.includes(\"{it->it$$}\");\n        const field = allField.find((f) => f.name === parent) || {};\n        const value =\n          typeof rule.fieldValue === \"string\"\n            ? rule.fieldValue\n            : rule.fieldValue\n                .map((i) =>\n                  isNumber\n                    ? `${\n                        i[\"nameField\"] ||\n                        i[\"targetName\"] ||\n                        i[\"fullName\"] ||\n                        i[\"name\"] ||\n                        i[\"id\"]\n                      }`\n                    : i[\"nameField\"] ||\n                      i[\"targetName\"] ||\n                      i[\"fullName\"] ||\n                      i[\"name\"]\n                    ? `'${\n                        i[\"nameField\"] ||\n                        i[\"targetName\"] ||\n                        i[\"fullName\"] ||\n                        i[\"name\"]\n                      }'`\n                    : i[\"id\"]\n                )\n                .join(\",\");\n        const name =\n          isParent || nestedFields.length >= 1\n            ? \"\"\n            : `${fieldName}${\n                selectionList\n                  ? \"\"\n                  : `${join_operator[expression]}${\n                      nameField ||\n                      (field && field.targetName) ||\n                      targetName ||\n                      \"fullName\"\n                    }`\n              }`;\n        const str = `${operator === \"notContains\" ? \"!\" : \"\"}(${prefix}${\n          join_operator[expression]\n        }${initValue.replace(/\\$\\$/g, name)})${join_operator[expression]}${\n          map_operators[operator]\n        }${isManyToManyField ? \"All\" : \"\"}(${`[${value}]`})`;\n        return str;\n      } else if ([\"between\", \"notBetween\"].includes(operator)) {\n        const temp = initValue.match(/it.\\$\\$/g);\n        if (temp && temp.length) {\n          const str = `(it.${prefix}${join_operator[expression]}${fieldName} >= ${fieldValue} && it.${prefix}${join_operator[expression]}${fieldName} <= ${fieldValue2})`;\n          if (\"notBetween\" === operator) {\n            return `${initValue.replace(/it.\\$\\$/g, `!${str}`)}`;\n          }\n          return initValue.replace(/it.\\$\\$/g, str);\n        } else {\n          const replace = (p1) => {\n            const field = (p1 && p1.replace(/\\$\\$/g, fieldName)) || fieldName;\n            if (\"notBetween\" === operator) {\n              return `!(${prefix}${join_operator[expression]}${field} >= ${fieldValue} && ${prefix}${join_operator[expression]}${field} <= ${fieldValue2})`;\n            }\n            return `(${prefix}${join_operator[expression]}${field} >= ${fieldValue} && ${prefix}${join_operator[expression]}${field} <= ${fieldValue2})`;\n          };\n          return replace(initValue);\n        }\n      } else if ([\"isNotNull\", \"isNull\"].includes(operator)) {\n        const str = `${fieldName} ${map_operators[operator]}`;\n        const field = allField.find((f) => f.name === parent) || {};\n        const isManyToManyField = initValue && initValue.includes(\"{it->it$$}\");\n        if (isManyToManyField) {\n          const name =\n            isParent || nestedFields.length >= 1\n              ? \"\"\n              : `${fieldName}${\n                  selectionList\n                    ? \"\"\n                    : `${join_operator[expression]}${\n                        (field && field.targetName) || targetName || \"fullName\"\n                      }`\n                }`;\n          return `${prefix}${join_operator[expression]}${initValue.replace(\n            /\\$\\$/g,\n            `${name} ${str}`\n          )}`;\n        }\n        return `${prefix}${join_operator[expression]}${initValue.replace(\n          /\\$\\$/g,\n          str\n        )}`;\n      } else if ([\"isTrue\", \"isFalse\"].includes(operator)) {\n        const value = operator === \"isTrue\" ? true : false;\n        const str = `${fieldName} ${map_operators[operator]} ${value}`;\n        return `${prefix}${join_operator[expression]}${initValue.replace(\n          /\\$\\$/g,\n          str\n        )}`;\n      } else if ([\"like\", \"notLike\"].includes(operator)) {\n        const str = `${fieldName}${join_operator[expression]}${map_operators[operator]}(${fieldValue})`;\n        return `${operator === \"notLike\" ? \"!\" : \"\"}${prefix}${\n          join_operator[expression]\n        }${initValue.replace(/\\$\\$/g, str)}`;\n      } else {\n        let fieldNew = field || allField.find((f) => f.name === parent) || {};\n        let value =\n          typeof fieldValue === \"object\" && fieldValue\n            ? `'${jsStringEscape(\n                fieldValue[nameField] ||\n                  fieldValue[targetName] ||\n                  fieldValue[\"fullName\"] ||\n                  fieldValue[\"name\"] ||\n                  fieldValue[\"id\"] ||\n                  \"\"\n              )}'`\n              ? `'${jsStringEscape(\n                  fieldValue[nameField] ||\n                    fieldValue[targetName] ||\n                    fieldValue[\"fullName\"] ||\n                    fieldValue[\"name\"] ||\n                    fieldValue[\"id\"] ||\n                    \"\"\n                )}'`\n              : fieldValue[\"name\"]\n            : fieldValue;\n        const str = `${\n          typeof fieldValue === \"object\" && fieldValue\n            ? `${fieldName}${join_operator[expression]}${\n                nameField || fieldNew.targetName || \"fullName\"\n              }`\n            : fieldName\n        } ${map_operators[operator]} ${value}`;\n        return type === \"button\"\n          ? `${initValue.replace(/\\$\\$/g, str)}`\n          : `${prefix}${join_operator[expression]}${initValue.replace(\n              /\\$\\$/g,\n              str\n            )}`;\n      }\n    }\n  }\n\n  function getDateTimeValue(type, fieldValue, isJsonField = false) {\n    if (type === \"date\") {\n      let date = `\"${moment(fieldValue, dateFormat[\"date\"]).format(\n        \"YYYY-MM-DD\"\n      )}\"`;\n      if (isJsonField) {\n        return date;\n      }\n      return `LocalDate.parse(${date})`;\n    } else if (type === \"datetime\") {\n      if (isJsonField) {\n        return `\"${moment(fieldValue, dateFormat[\"datetime\"]).toISOString()}\"`;\n      }\n      return `LocalDateTime.of(${moment(fieldValue, dateFormat[\"datetime\"])\n        .format(\"YYYY-M-D-H-m-s\")\n        .split(\"-\")})`;\n    } else {\n      let time = `\"${moment(fieldValue, dateFormat[\"time\"]).format(\n        \"HH:mm:ss\"\n      )}\"`;\n      if (isJsonField) {\n        return time;\n      }\n      return `LocalTime.parse(${time})`;\n    }\n  }\n\n  const onCancel = () => {\n    const values = generateExpressionValues();\n    if (\n      (values && values.length <= 0) ||\n      JSON.stringify(values) === JSON.stringify(initialValues)\n    ) {\n      handleClose();\n      return;\n    }\n    setClose(true);\n    setAlert(true);\n    setAlertConfig({\n      alertMessage:\n        \"Current changes will be lost. Do you really want to proceed?\",\n      alertTitle: \"Question\",\n    });\n  };\n\n  function getCondition(rules, modalName) {\n    const isBPM = isBPMQuery(parentType);\n    const prefix = isBPM\n      ? \"self\"\n      : generateWithId\n      ? `$ctx.find('${upperCaseFirstLetter(modalName)}', ${modalName}Id)`\n      : modalName;\n    const map_operators = map_operator[isBPM ? \"BPM\" : expression];\n    const values = [];\n    for (let i = 0; i < (rules && rules.length); i++) {\n      const rule = rules[i];\n      const { fieldName: propFieldName, field = {}, operator, allField } = rule;\n      const { targetName, selectionList } = field || {};\n      const type = field && field.type && field.type.toLowerCase();\n      const typeName = field && field.typeName;\n      const isNumber = [\n        \"long\",\n        \"integer\",\n        \"decimal\",\n        \"boolean\",\n        \"button\",\n        \"double\",\n      ].includes(type);\n      const isDateTime = [\"date\", \"time\", \"datetime\"].includes(type);\n      let { fieldValue, fieldValue2, isRelationalValue } = rule;\n      let fieldName = propFieldName;\n      if (isNumber && !selectionList && !isRelationalValue) {\n        if (!fieldValue && fieldValue !== false) {\n          fieldValue = 0;\n        }\n        if ([\"between\", \"notBetween\"].includes(operator) && !fieldValue2) {\n          fieldValue2 = 0;\n        }\n      }\n\n      //check relational field\n      const name = fieldName && fieldName.split(join_operator[expression])[0];\n      const f = allField && allField.find((f) => f.name === name);\n      const isRelational = [\n        \"many_to_many\",\n        \"one_to_many\",\n        \"many_to_one\",\n        \"one_to_one\",\n        \"json_many_to_many\",\n        \"json_one_to_many\",\n        \"json_many_to_one\",\n        \"json_one_to_one\",\n      ].includes(\n        f &&\n          f.type &&\n          f.type.toLowerCase() &&\n          f.type.toLowerCase().replaceAll(\"-\", \"_\")\n      );\n      if (isRelational) {\n        values.push(getRelationalCondition(rule, undefined, false, prefix));\n      } else {\n        if (!isRelationalValue && !isNumber && typeof fieldValue !== \"object\") {\n          fieldValue = `'${jsStringEscape(fieldValue)}'`;\n          fieldValue2 = `'${jsStringEscape(fieldValue2)}'`;\n        }\n        if (isDateTime) {\n          if (!isRelationalValue) {\n            fieldValue = getDateTimeValue(type, fieldValue);\n            fieldValue2 = getDateTimeValue(type, fieldValue2);\n          }\n          fieldName = typeName ? `${fieldName}?.toLocalDateTime()` : fieldName;\n        }\n        const map_type = isBPM ? map_bpm_combinator : map_combinator;\n        if ([\"in\", \"notIn\"].includes(operator)) {\n          const value = rule.fieldValue\n            .map((f) =>\n              isNumber\n                ? `${f[\"targetName\"] || f[\"fullName\"] || f[\"name\"]}`\n                : `'${f[\"targetName\"] || f[\"fullName\"] || f[\"name\"]}'`\n            )\n            .filter((f) => f !== \"\")\n            .join(\",\");\n          values.push(\n            `${operator === \"notIn\" ? \"!\" : \"\"}${`[${value}]`}${\n              join_operator[expression]\n            }${map_operators[operator]}(${prefix}${\n              join_operator[expression]\n            }${fieldName}${\n              selectionList\n                ? \" \"\n                : `${join_operator[expression]} ${targetName || \"fullName\"}`\n            })`\n          );\n        } else if ([\"between\", \"notBetween\"].includes(operator)) {\n          if (operator === \"notBetween\") {\n            values.push(\n              `!(${prefix}${join_operator[expression]}${fieldName} >= ${fieldValue} ${map_type[\"and\"]} ${prefix}${join_operator[expression]}${fieldName} <= ${fieldValue2})`\n            );\n          }\n          values.push(\n            `(${prefix}${join_operator[expression]}${fieldName} >= ${fieldValue} ${map_type[\"and\"]} ${prefix}${join_operator[expression]}${fieldName} <= ${fieldValue2})`\n          );\n        } else if ([\"isNotNull\", \"isNull\"].includes(operator)) {\n          values.push(\n            `${prefix}${join_operator[expression]}${fieldName} ${map_operators[operator]}`\n          );\n        } else if ([\"isTrue\", \"isFalse\"].includes(operator)) {\n          const value = operator === \"isTrue\" ? true : false;\n          values.push(\n            `${prefix}${join_operator[expression]}${fieldName} ${map_operators[operator]} ${value}`\n          );\n        } else if ([\"like\", \"notLike\"].includes(operator)) {\n          values.push(\n            `${operator === \"notLike\" ? \"!\" : \"\"}${prefix}${\n              join_operator[expression]\n            }${fieldName}${join_operator[expression]}${\n              map_operators[operator]\n            }(${fieldValue})`\n          );\n        } else {\n          let value =\n            typeof fieldValue === \"object\" && fieldValue\n              ? `'${jsStringEscape(\n                  fieldValue[targetName] ||\n                    fieldValue[\"fullName\"] ||\n                    fieldValue[\"name\"] ||\n                    \"\"\n                )}'`\n                ? `'${jsStringEscape(\n                    fieldValue[targetName] ||\n                      fieldValue[\"fullName\"] ||\n                      fieldValue[\"name\"] ||\n                      \"\"\n                  )}'`\n                : fieldValue[\"name\"]\n              : fieldValue;\n          values.push(\n            type === \"button\"\n              ? `${fieldName} ${map_operators[operator]} ${value}`\n              : `${prefix}${join_operator[expression]}${\n                  type === \"many_to_one\" || type === \"json_many_to_one\"\n                    ? `${fieldName}${join_operator[expression]}${\n                        field.targetName || \"fullName\"\n                      }`\n                    : fieldName\n                } ${map_operators[operator]} ${value}`\n          );\n        }\n      }\n    }\n    return values;\n  }\n\n  function getBPMCondition(rules, modalName, parentCount = 0) {\n    const isBPM = isBPMQuery(parentType);\n    const prefix = isBPM ? \"self\" : modalName;\n    const map_operators = map_operator[isBPM ? \"BPM\" : expression];\n    let count = parentCount;\n    const returnValues = [];\n    for (let i = 0; i < (rules && rules.length); i++) {\n      const rule = rules[i];\n      const { fieldName, field = {}, operator, allField } = rule;\n      const { targetName, selectionList, model, target, jsonField } =\n        field || {};\n      const type = field && field.type && field.type.toLowerCase();\n      const isNumber = [\n        \"long\",\n        \"integer\",\n        \"double\",\n        \"decimal\",\n        \"boolean\",\n      ].includes(type);\n      const isDateTime = [\"date\", \"time\", \"datetime\"].includes(type);\n      let isJsonField =\n        model === \"com.axelor.meta.db.MetaJsonRecord\" ||\n        target === \"com.axelor.meta.db.MetaJsonRecord\" ||\n        jsonField;\n      let parentCustomField;\n      const values = fieldName && fieldName.split(join_operator[expression]);\n      if (!isJsonField && values && values.length > 1) {\n        values.forEach((name) => {\n          let value =\n            allField &&\n            allField.find(\n              (field) =>\n                field.name === name &&\n                (field.model === \"com.axelor.meta.db.MetaJsonRecord\" ||\n                  field.target === \"com.axelor.meta.db.MetaJsonRecord\" ||\n                  field.jsonField)\n            );\n          if (value) {\n            isJsonField = true;\n            parentCustomField = value;\n          }\n        });\n      }\n      const jsonFieldName = isJsonField\n        ? `${getJsonExpression(\n            parentCustomField\n              ? {\n                  ...parentCustomField,\n                  targetName: field && field.targetName,\n                }\n              : field,\n            prefix,\n            fieldName\n          )}`\n        : undefined;\n      let {\n        fieldValue,\n        fieldValue2,\n        isRelationalValue,\n        relatedValueModal = {},\n        relatedElseValueModal = {},\n      } = rule || {};\n      if (isNumber && !selectionList && !isRelationalValue) {\n        if (!fieldValue) {\n          fieldValue = 0;\n        }\n        if ([\"between\", \"notBetween\"].includes(operator) && !fieldValue2) {\n          fieldValue2 = 0;\n        }\n      }\n      const relatedValueModalName = lowerCaseFirstLetter(\n        relatedValueModal && relatedValueModal.name\n      );\n      const relatedElseValueModalName = lowerCaseFirstLetter(\n        relatedElseValueModal && relatedElseValueModal.name\n      );\n\n      const isRelatedModalSame = relatedValueModalName === modalName;\n      const isRelatedElseModalSame = relatedElseValueModalName === modalName;\n      if (![\"isNotNull\", \"isNull\"].includes(operator) && !isRelatedModalSame) {\n        ++count;\n      }\n\n      if (!isRelationalValue && !isNumber && typeof fieldValue !== \"object\") {\n        fieldValue = `'${jsStringEscape(fieldValue)}'`;\n        fieldValue2 = `'${jsStringEscape(fieldValue2)}'`;\n      }\n\n      if (isDateTime) {\n        if (!isRelationalValue) {\n          fieldValue = getDateTimeValue(type, fieldValue, isJsonField);\n          fieldValue2 = getDateTimeValue(type, fieldValue2, isJsonField);\n        }\n      }\n\n      const map_type = isBPM ? map_bpm_combinator : map_combinator;\n      if ([\"in\", \"notIn\"].includes(operator)) {\n        const value =\n          rule &&\n          rule.fieldValue &&\n          rule.fieldValue\n            .map((f) =>\n              isNumber\n                ? `${f[\"targetName\"] || f[\"fullName\"] || f[\"name\"]}`\n                : `'${f[\"targetName\"] || f[\"fullName\"] || f[\"name\"]}'`\n            )\n            .filter((f) => f !== \"\");\n        returnValues.push({\n          condition: `${\n            jsonFieldName\n              ? jsonFieldName\n              : `${prefix}.${fieldName}${\n                  selectionList ? \"\" : `.${targetName || \"fullName\"}`\n                }`\n          } ${map_operators[operator]} ${\n            isRelatedModalSame ? fieldValue : `?${count}`\n          }`,\n          values: isRelatedModalSame ? undefined : [[value]],\n        });\n      } else if ([\"between\", \"notBetween\"].includes(operator)) {\n        let values =\n          isRelatedModalSame && isRelatedElseModalSame\n            ? undefined\n            : isRelatedModalSame\n            ? [fieldValue2]\n            : isRelatedElseModalSame\n            ? [fieldValue]\n            : [fieldValue, fieldValue2];\n        if (isDateTime && isBPM) {\n          if (operator === \"notBetween\") {\n            returnValues.push({\n              condition: `${\n                jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n              } NOT BETWEEN ${isRelatedModalSame ? fieldValue : `?${count}`} ${\n                map_type[\"and\"]\n              } ${isRelatedElseModalSame ? fieldValue2 : `?${++count}`}`,\n              values,\n            });\n          }\n          returnValues.push({\n            condition: `${\n              jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n            } BETWEEN ${isRelatedModalSame ? fieldValue : `?${count}`} ${\n              map_type[\"and\"]\n            } ${isRelatedElseModalSame ? fieldValue2 : `?${++count}`}`,\n            values,\n          });\n        } else {\n          if (operator === \"notBetween\") {\n            returnValues.push({\n              condition: `NOT (${\n                jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n              } >= ${isRelatedModalSame ? fieldValue : `?${count}`} ${\n                map_type[\"and\"]\n              } ${\n                jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n              } <= ${isRelatedElseModalSame ? fieldValue2 : `?${++count}`})`,\n              values,\n            });\n          }\n          returnValues.push({\n            condition: `(${\n              jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n            } >= ${isRelatedModalSame ? fieldValue : `?${count}`} ${\n              map_type[\"and\"]\n            } ${jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`} <= ${\n              isRelatedElseModalSame ? fieldValue2 : `?${++count}`\n            })`,\n            values,\n          });\n        }\n      } else if ([\"isNotNull\", \"isNull\"].includes(operator)) {\n        returnValues.push({\n          condition: `${\n            jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n          } ${map_operators[operator]}`,\n        });\n      } else if ([\"isTrue\", \"isFalse\"].includes(operator)) {\n        // --count;\n        const value = operator === \"isTrue\" ? true : false;\n        returnValues.push({\n          condition: `${\n            jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`\n          } ${map_operators[operator]} ${\n            isRelatedModalSame ? fieldValue : `?${count}`\n          }`,\n          values: isRelatedModalSame ? undefined : [value],\n        });\n      } else if ([\"contains\", \"notContains\"].includes(operator)) {\n        let value =\n          typeof fieldValue === \"object\" && fieldValue\n            ? `'${jsStringEscape(fieldValue[field.targetName] || \"\")}'`\n              ? `'${jsStringEscape(fieldValue[field.targetName] || \"\")}'`\n              : fieldValue[\"name\"]\n            : fieldValue;\n\n        returnValues.push({\n          condition: `${isRelatedModalSame ? fieldValue : `?${count}`} ${\n            map_operators[operator]\n          } ${jsonFieldName ? jsonFieldName : `${prefix}.${fieldName}`}`,\n          values: isRelatedModalSame ? undefined : [value],\n        });\n      } else {\n        let value =\n          typeof fieldValue === \"object\" && fieldValue\n            ? `'${jsStringEscape(fieldValue[field.targetName] || \"\")}'`\n              ? `'${jsStringEscape(fieldValue[field.targetName] || \"\")}'`\n              : fieldValue[\"name\"]\n            : fieldValue;\n\n        returnValues.push({\n          condition: `${\n            jsonFieldName\n              ? jsonFieldName\n              : `${prefix}.${\n                  [\n                    \"many_to_one\",\n                    \"json_many_to_one\",\n                    \"one_to_one\",\n                    \"json_one_to_one\",\n                  ].includes(type) && !isRelationalValue\n                    ? `${fieldName}.${field.targetName || \"fullName\"}`\n                    : fieldName\n                }`\n          } ${map_operators[operator]} ${\n            isRelatedModalSame\n              ? [\"like\", \"notLike\"].includes(operator)\n                ? `CONCAT('%',${fieldValue},'%')`\n                : fieldValue\n              : [\"like\", \"notLike\"].includes(operator)\n              ? `CONCAT('%',?${count},'%')`\n              : `?${count}`\n          }`,\n          values: isRelatedModalSame ? undefined : [value],\n        });\n      }\n    }\n    return returnValues;\n  }\n\n  function getBPMCriteria(rule, modalName, isChildren, count = 0) {\n    const {\n      rules,\n      combinator = \"and\",\n      children,\n      parentId,\n    } = (rule && rule[0]) || {};\n    const conditions = getBPMCondition(rules, modalName, count);\n    const condition = conditions && conditions.filter((f) => f);\n    const childrenConditions = [];\n    children &&\n      children.length > 0 &&\n      children.forEach((child) => {\n        const parentValues =\n          (condition &&\n            condition.map((co) => co && co.values).filter((f) => f)) ||\n          [];\n        const childrenValues =\n          (childrenConditions &&\n            childrenConditions.map((co) => co && co.values).filter((f) => f)) ||\n          [];\n\n        const { condition: conditions, values } =\n          getBPMCriteria(\n            [child],\n            modalName,\n            true,\n            (parentValues && parentValues.length) +\n              (childrenValues && childrenValues.length)\n          ) || {};\n        const newValues = [].concat.apply([], values);\n        childrenConditions.push({\n          condition: conditions,\n          values: newValues && newValues.length > 0 ? newValues : undefined,\n        });\n      });\n    const map_type = isBPMQuery(parentType)\n      ? map_bpm_combinator\n      : map_combinator;\n    const c = condition && condition.map((co) => co && co.condition);\n    const childConditions =\n      childrenConditions &&\n      (childrenConditions.map((co) => co && co.condition) || []).filter(\n        (f) => f\n      );\n    const childValues =\n      childrenConditions && childrenConditions.filter((val) => val !== null);\n\n    if (parentId === -1 && children.length > 0) {\n      let isChild = childConditions && childConditions.length !== 0;\n      return {\n        condition: `${isChild ? \"( \" : \"\"}(${\n          c ? c.join(\" \" + map_type[combinator] + \" \") : \"\"\n        } ${\n          isChild\n            ? ` ${map_type[combinator]} ${childConditions.join(\n                \" \" + map_type[combinator] + \" \"\n              )}`\n            : \"\"\n        })${isChild ? \" )\" : \"\"}`,\n        values: [\n          ...((condition &&\n            condition.map((co) => co && co.values).filter((f) => f)) ||\n            []),\n          ...((childValues &&\n            childValues.map((co) => co && co.values).filter((f) => f)) ||\n            []),\n        ],\n      };\n    } else if (isChildren && condition && c && c.length !== 0) {\n      return {\n        condition: `(${c.join(\" \" + map_type[combinator] + \" \")})`,\n        values:\n          condition && condition.map((co) => co && co.values).filter((f) => f),\n      };\n    } else if (c && c.length !== 0) {\n      return {\n        condition: `${c.join(\" \" + map_type[combinator] + \" \")}`,\n        values:\n          condition && condition.map((co) => co && co.values).filter((f) => f),\n      };\n    }\n  }\n\n  function getCriteria(rule, modalName, isChildren) {\n    const { rules, combinator = \"and\", children, parentId } = rule[0];\n    const conditions = getCondition(rules, modalName);\n    const condition = (conditions && conditions.filter((f) => f)) || [];\n    const childrenConditions = [];\n    children &&\n      children.length > 0 &&\n      children.forEach((child) => {\n        const conditions = getCriteria([child], modalName, true);\n        if (conditions) {\n          childrenConditions.push(conditions);\n        }\n      });\n    const map_type = isBPMQuery(parentType)\n      ? map_bpm_combinator\n      : map_combinator;\n\n    if (\n      parentId === -1 &&\n      children.length > 0 &&\n      condition &&\n      condition.length > 0\n    ) {\n      let isChild = childrenConditions && childrenConditions.length !== 0;\n      return `${isChild ? \"( \" : \"\"}(${\n        condition ? condition.join(\" \" + map_type[combinator] + \" \") : \"\"\n      } ${\n        isChild\n          ? ` ${map_type[combinator]} ${childrenConditions.join(\n              \" \" + map_type[combinator] + \" \"\n            )}`\n          : \"\"\n      })${isChild ? \")\" : \"\"}`;\n    } else if (isChildren && condition && condition.length > 0) {\n      return \" (\" + condition.join(\" \" + map_type[combinator] + \" \") + \") \";\n    } else if (condition && condition.length > 0) {\n      return condition.join(\" \" + map_type[combinator] + \" \");\n    }\n  }\n\n  function getListOfTree(list) {\n    var map = {},\n      node,\n      roots = [];\n    const rules = list.map((item, index) => {\n      map[item.id] = index;\n      return { ...item, children: [] };\n    });\n    for (let i = 0; i < rules.length; i += 1) {\n      node = rules[i];\n      if (node.parentId >= 0) {\n        rules[map[node.parentId]] &&\n          rules[map[node.parentId]].children.push(node);\n      } else {\n        roots.push(node);\n      }\n    }\n    return roots;\n  }\n\n  const onChange = React.useCallback(function onChange(value, index) {\n    setExpressionComponents(\n      produce((draft) => {\n        draft[index].value = value;\n      })\n    );\n  }, []);\n\n  const checkValidation = () => {\n    let isValid = true;\n    const nodes = [];\n    for (\n      let i = 0;\n      i < (expressionComponents && expressionComponents.length);\n      i++\n    ) {\n      const component = expressionComponents[i];\n      const { value } = component;\n      const { rules, metaModals } = value || {};\n      if (!metaModals) {\n        return isValid;\n      }\n      nodes.push(rules);\n    }\n    const parentNodes = _.flattenDeep(nodes || []);\n    const rules = parentNodes && parentNodes.map((n) => n.rules);\n    const allRules = _.flattenDeep(rules || []);\n    for (let i = 0; i < (allRules && allRules.length); i++) {\n      const rule = allRules && allRules[i];\n      const { fieldName: propFieldName, field = {}, operator } = rule || {};\n      const { selectionList } = field || {};\n      const type = field && field.type && field.type.toLowerCase();\n      const isNumber = [\n        \"long\",\n        \"integer\",\n        \"decimal\",\n        \"boolean\",\n        \"button\",\n        \"double\",\n      ].includes(type);\n      let { fieldValue, fieldValue2, isRelationalValue } = rule;\n      let fieldName = propFieldName;\n      if (isNumber && !selectionList && !isRelationalValue) {\n        if (!fieldValue && fieldValue !== false) {\n          fieldValue = 0;\n        }\n        if ([\"between\", \"notBetween\"].includes(operator) && !fieldValue2) {\n          fieldValue2 = 0;\n        }\n      }\n      const fValue = isNaN(fieldValue) ? fieldValue : `${fieldValue}`;\n      if (!fieldName) {\n        isValid = false;\n        break;\n      }\n      if (isEmpty(fValue)) {\n        if (![\"isNull\", \"isNotNull\", \"isTrue\", \"isFalse\"].includes(operator)) {\n          isValid = false;\n          break;\n        }\n      }\n      if (\n        operator === \"\" ||\n        (selectionList &&\n          !fieldValue &&\n          ![\"isNull\", \"isNotNull\", \"isTrue\", \"isFalse\"].includes(operator)) ||\n        (isNumber && isRelationalValue && !fieldValue) ||\n        (((!isNumber && !fieldValue) ||\n          (fieldValue && fieldValue.length <= 0) ||\n          ((!fieldValue2 || (fieldValue2 && fieldValue2.length <= 0)) &&\n            [\"between\", \"notBetween\"].includes(operator))) &&\n          ![\"isNull\", \"isNotNull\", \"isTrue\", \"isFalse\"].includes(operator))\n      ) {\n        isValid = false;\n        break;\n      }\n    }\n    return isValid;\n  };\n\n  function generateExpressionValues() {\n    const expressionValues = [];\n    expressionComponents &&\n      expressionComponents.forEach(({ value }) => {\n        const { rules, metaModals } = value || {};\n        const modalName = metaModals && metaModals.name;\n        if (metaModals) {\n          expressionValues.push({\n            metaModalName: modalName,\n            metaModalType: metaModals && metaModals.type,\n            rules,\n            generateWithId,\n          });\n        }\n      });\n    return expressionValues;\n  }\n\n  function generateExpression(combinator, type) {\n    const expressionValues = [];\n    let model;\n    let vals = [];\n    const expressions = [];\n    const isValid = checkValidation();\n    if (!isValid) {\n      setAlert(true);\n      setAlertConfig({\n        alertMessage: \"Add all values\",\n        alertTitle: \"Error\",\n      });\n      return;\n    }\n    for (let i = 0; i < expressionComponents.length; i++) {\n      const component = expressionComponents[i];\n      const { value } = component;\n      const { rules, metaModals } = value;\n      const modalName =\n        metaModals && metaModals.type === \"dmnModel\"\n          ? metaModals.resultVariable\n          : metaModals && metaModals.name;\n      model = modalName;\n      let str = \"\";\n      const listOfTree = getListOfTree(rules);\n      const criteria = isBPMQuery(type)\n        ? getBPMCriteria(listOfTree, lowerCaseFirstLetter(modalName), undefined)\n        : getCriteria(listOfTree, lowerCaseFirstLetter(modalName), undefined);\n      vals.push(\n        ...((criteria &&\n          ((criteria.values || []).filter((f) => Array.isArray(f)) || [])) ||\n          [])\n      );\n      if (metaModals) {\n        str += isBPMQuery(type) ? criteria && criteria.condition : criteria;\n      } else {\n        break;\n      }\n      let expressionValue = {\n        metaModalName: modalName,\n        metaModalType: metaModals.type,\n        rules,\n        generateWithId,\n      };\n      if (metaModals && metaModals.type === \"dmnModel\") {\n        expressionValue.decisionId = metaModals.decisionId;\n        expressionValue.dmnNodeId = metaModals.dmnNodeId;\n      }\n      expressionValues.push(expressionValue);\n      expressions.push(`${str}`);\n    }\n\n    const map_type = isBPMQuery(parentType)\n      ? map_bpm_combinator\n      : map_combinator;\n\n    const str = expressions\n      .filter((e) => e !== \"\")\n      .map((e) => (expressions.length > 1 ? `(${e})` : e))\n      .join(\" \" + map_type[combinator] + \" \");\n\n    let expr = str;\n    if (isBPMQuery(type)) {\n      let parameters = \"\";\n      vals &&\n        vals.forEach((v) => {\n          if (v && Array.isArray(v[0]) && v[0]) {\n            parameters = parameters + `, [${v[0]}]`;\n          } else {\n            if (v && Array.isArray(v) && v.length > 0) {\n              v = v.join(\", \");\n            }\n            parameters = parameters + \", \" + v;\n          }\n        });\n\n      expr = str\n        ? `return $ctx.createVariable($ctx.${\n            singleResult ? \"filterOne\" : \"filter\"\n          }(\"${model}\",\" ${str} \"${\n            vals && vals.length > 0 ? `${parameters}` : ``\n          }))`\n        : undefined;\n    }\n\n    setProperty({\n      expression: expr,\n      value:\n        expressionValues && expressionValues.length > 0\n          ? JSON.stringify(expressionValues)\n          : undefined,\n      combinator: isBPMQuery(type) ? singleResult : combinator,\n    });\n    handleClose();\n  }\n\n  useEffect(() => {\n    let isSubscribed = true;\n    async function fetchValue() {\n      const { values, combinator } = getExpression() || {};\n      const expressionComponents = [];\n      setInitialValues(values);\n      if (!values || values.length === 0) {\n        setExpressionComponents([\n          {\n            Component: ExpressionComponent,\n            value: undefined,\n          },\n        ]);\n        return;\n      }\n      for (let i = 0; i < values.length; i++) {\n        const ele = values[i];\n        const {\n          metaModalName,\n          decisionId,\n          dmnNodeId,\n          metaModalType,\n          generateWithId,\n        } = ele;\n        if (metaModalType === \"dmnModel\") {\n          if (!decisionId) return;\n          const dmnTables = await getDMNModels([\n            {\n              fieldName: \"decisionId\",\n              operator: \"=\",\n              value: decisionId,\n            },\n          ]);\n          if (!dmnTables || !bpmnModeler) return;\n          const elementRegistry = bpmnModeler.get(\"elementRegistry\");\n          const element =\n            elementRegistry &&\n            elementRegistry.find((el) => el.id === dmnNodeId);\n          const value = {\n            metaModals: dmnTables && {\n              ...dmnTables[0],\n              dmnNodeId: element && element.id,\n              dmnNodeNameId:\n                element &&\n                element.businessObject &&\n                element.businessObject.name,\n              resultVariable:\n                element &&\n                element.businessObject &&\n                element.businessObject.resultVariable,\n              type: \"dmnModel\",\n            },\n            rules: ele.rules,\n          };\n          expressionComponents.push({\n            Component: ExpressionComponent,\n            value,\n          });\n        } else {\n          const criteria = {\n            criteria: [\n              {\n                fieldName: \"name\",\n                operator: \"=\",\n                value: metaModalName,\n              },\n            ],\n            operator: \"and\",\n          };\n          const metaModels = await getModels(criteria, metaModalType);\n          if (!metaModels) return;\n          const value = {\n            metaModals: metaModels && metaModels[0],\n            rules: ele.rules,\n          };\n          expressionComponents.push({\n            Component: ExpressionComponent,\n            value,\n          });\n        }\n        setGenerateWithId(generateWithId);\n      }\n      if (isSubscribed) {\n        setExpressionComponents(expressionComponents);\n        if (isBPMQuery(parentType)) {\n          setSingleResult(combinator);\n        } else {\n          setCombinator(combinator || \"and\");\n        }\n      }\n    }\n    fetchValue();\n    return () => (isSubscribed = false);\n  }, [getExpression, parentType, bpmnModeler]);\n\n  return (\n    <Dialog\n      onClose={(event, reason) => {\n        if (reason !== \"backdropClick\") {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">{translate(title)}</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div style={{ height: \"100%\", width: \"100%\" }}>\n            <div className={classes.expression}>\n              {!isBPMQuery(parentType) && (\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      checked={generateWithId}\n                      onChange={(e) => setGenerateWithId(e.target.checked)}\n                      name=\"generateWithId\"\n                      className={classes.checkbox}\n                    />\n                  }\n                  style={{ color: \"#0275d8\" }}\n                  label=\"Generate with saved record\"\n                />\n              )}\n              <Timeline\n                align=\"alternate\"\n                className={classes.timeline}\n                style={{\n                  border:\n                    expression === \"BPM\"\n                      ? \"none\"\n                      : \"1px solid rgba(0, 0, 0, 0.12)\",\n                  padding: expression === \"BPM\" ? 0 : \"24px 16px\",\n                }}\n              >\n                {isBPMQuery(parentType) ? (\n                  <TimelineItem\n                    className={classes.timelineItem}\n                    style={{\n                      width: \"100%\",\n                    }}\n                  >\n                    <div\n                      style={{\n                        width: \"100%\",\n                      }}\n                    >\n                      <FormControlLabel\n                        control={\n                          <Checkbox\n                            checked={singleResult}\n                            onChange={(e) => setSingleResult(e.target.checked)}\n                            name=\"singleResult\"\n                            className={classes.checkbox}\n                          />\n                        }\n                        style={{ color: \"#0275d8\" }}\n                        label={translate(\"Single result\")}\n                      />\n                      {expressionComponents &&\n                        expressionComponents.map(\n                          ({ Component, value }, index) => {\n                            return (\n                              <div\n                                className={classes.expressionContainer}\n                                key={index}\n                              >\n                                <Component\n                                  value={value}\n                                  index={index}\n                                  setValue={onChange}\n                                  element={element}\n                                  type={parentType}\n                                  processConfigs={processConfigs}\n                                  isAllowButtons={isAllowButtons}\n                                  allowAllModels={allowAllModels}\n                                  bpmnModeler={bpmnModeler}\n                                  defaultModel={defaultModel}\n                                />\n                              </div>\n                            );\n                          }\n                        )}\n                    </div>\n                  </TimelineItem>\n                ) : (\n                  <TimelineItem style={{ minHeight: \"100%\", width: \"89%\" }}>\n                    <TimelineOppositeContent\n                      className={classes.timelineOppositeContent}\n                    >\n                      <Select\n                        name=\"expression\"\n                        options={combinators}\n                        value={combinator || \"and\"}\n                        disableUnderline={true}\n                        className={classes.combinator}\n                        onChange={(value) => {\n                          setCombinator(value);\n                        }}\n                      />\n                    </TimelineOppositeContent>\n                    <TimelineSeparator>\n                      <TimelineDot\n                        variant=\"outlined\"\n                        style={{ borderColor: \"#0275d8\" }}\n                      />\n                      <TimelineConnector\n                        className={classes.timelineConnector}\n                      />\n                    </TimelineSeparator>\n                    <TimelineContent style={{ width: \"100%\" }}>\n                      <Button\n                        title=\"Add Expression\"\n                        Icon={AddIcon}\n                        onClick={() => onAddExpressionEditor()}\n                      />\n                      <div>\n                        {expressionComponents &&\n                          expressionComponents.map(\n                            ({ Component, value }, index) => {\n                              return (\n                                <div\n                                  className={classes.expressionContainer}\n                                  key={index}\n                                >\n                                  <Component\n                                    value={value}\n                                    index={index}\n                                    setValue={onChange}\n                                    element={element}\n                                    type={parentType}\n                                    processConfigs={processConfigs}\n                                    isAllowButtons={isAllowButtons}\n                                    allowAllModels={allowAllModels}\n                                    bpmnModeler={bpmnModeler}\n                                    defaultModel={defaultModel}\n                                  />\n                                  {!isBPMQuery(parentType) && (\n                                    <Button\n                                      Icon={DeleteIcon}\n                                      onClick={() =>\n                                        onRemoveExpressionEditor(index)\n                                      }\n                                    />\n                                  )}\n                                </div>\n                              );\n                            }\n                          )}\n                      </div>\n                    </TimelineContent>\n                  </TimelineItem>\n                )}\n              </Timeline>\n            </div>\n          </div>\n        </Paper>\n        <div>\n          <Button\n            title=\"OK\"\n            className={classes.save}\n            onClick={() => generateExpression(combinator, parentType)}\n          />\n          <Button title=\"Cancel\" className={classes.save} onClick={onCancel} />\n        </div>\n      </div>\n      {openAlert && (\n        <Dialog\n          open={openAlert}\n          onClose={(event, reason) => {\n            if (reason !== \"backdropClick\") {\n              setAlert(false);\n            }\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n          classes={{\n            paper: classes.dialog,\n          }}\n        >\n          <DialogTitle id=\"alert-dialog-title\">\n            {translate(alertConfig.alertTitle)}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {translate(alertConfig.alertMessage)}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <MaterialButton\n              onClick={() => {\n                setAlert(false);\n                if (isClose) {\n                  handleClose();\n                }\n              }}\n              color=\"primary\"\n              autoFocus\n              className={classes.save}\n            >\n              {translate(\"OK\")}\n            </MaterialButton>\n            <MaterialButton\n              onClick={() => {\n                setAlert(false);\n              }}\n              color=\"primary\"\n              autoFocus\n              style={{ textTransform: \"none\" }}\n              className={classes.save}\n            >\n              {translate(\"Cancel\")}\n            </MaterialButton>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Dialog>\n  );\n}\n\nexport default ExpressionBuilder;\n","import React, {useEffect, useState} from 'react';\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n  Button,\n  Tooltip,\n} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {Edit, NotInterested} from '@material-ui/icons';\nimport {translate} from '../../utils';\nimport {Textbox} from '../components';\nimport ExpressionBuilder from '../expression-builder';\nimport { getAllModels, getMetaModels } from '../../services/api';\n\nconst useStyles = makeStyles((theme) => ({\n  expressionBuilder: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  newIcon: {\n    color: '#58B423',\n    marginLeft: 5,\n  },\n  new: {\n    cursor: 'pointer',\n    marginTop: 18.6,\n    display: 'flex',\n  },\n  textbox: {\n    width: '100%',\n    color:'white'\n  },\n  dialog: {\n    minWidth: 300,\n  },\n  title: {\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  save: {\n    'margin': theme.spacing(1),\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'textTransform': 'none',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n}));\n\nexport default function ScriptProps({element, bpmnModeler,entry}) {\n  const [openAlert, setAlert] = useState(false);\n  const [openMapper, setMapper] = useState(false);\n  const [alertTitle, setAlertTitle] = useState(null);\n  const [alertMessage, setAlertMessage] = useState(null);\n  const {name,label} = entry;\n  const [isReadOnly, setReadOnly] = useState(element?.businessObject[name]?.value ? true : false);\n  const classes = useStyles();\n  const handleMapperOpen = () => {\n    setMapper(true);\n  };\n  useEffect(()=>{\n    if(element.businessObject[name]?.value) setReadOnly(true)\n    else setReadOnly(false);\n  },[element.businessObject, name, openMapper]);\n\n  return (\n    <React.Fragment>\n      <div className={classes.expressionBuilder}>\n        <Textbox\n          element={element}\n          className={classes.textbox}\n          rows={1}\n          readOnly={isReadOnly}\n          bpmnModeler={bpmnModeler}\n          entry={{\n            id: 'script',\n            label: translate(label),\n            modelProperty: 'script',\n            name: name,\n          }}\n        />\n        <div className={classes.new}>\n          <Tooltip title=\"Enable\" aria-label=\"enable\">\n            <NotInterested\n              className={classes.newIcon}\n              onClick={() => {\n                if (element.businessObject[name].value) {\n                  setAlertMessage(\n                      'Script can\\'t be managed using builder once changed manually.',\n                  );\n                  setAlertTitle('Warning');\n                  setAlert(true);\n                }\n              }}\n            />\n          </Tooltip>\n          <Edit\n            className={classes.newIcon}\n            onClick={() => {\n              handleMapperOpen();\n            }}\n          />\n          {openAlert && (\n            <Dialog\n              open={openAlert}\n              onClose={(e, reason) => {\n                if (reason !== 'backdropClick') {\n                  setAlert(false);\n                }\n              }}\n              aria-labelledby=\"alert-dialog-title\"\n              aria-describedby=\"alert-dialog-description\"\n              classes={{\n                paper: classes.dialog,\n              }}\n            >\n              <DialogTitle id=\"alert-dialog-title\">\n                <label className={classes.title}>{translate(alertTitle)}</label>\n              </DialogTitle>\n              <DialogContent>\n                <DialogContentText id=\"alert-dialog-description\">\n                  {translate(alertMessage)}\n                </DialogContentText>\n              </DialogContent>\n              <DialogActions>\n                <Button\n                  onClick={() => {\n                    setAlert(false);\n                    setAlertMessage(null);\n                    setAlertTitle(null);\n                    setReadOnly(false);\n                    if (element.businessObject) {\n                      element.businessObject.scriptValue = undefined;\n                    }\n                  }}\n                  color=\"primary\"\n                  className={classes.save}\n                  autoFocus\n                >\n                  Ok\n                </Button>\n                <Button\n                  onClick={() => {\n                    setAlert(false);\n                  }}\n                  color=\"primary\"\n                  className={classes.save}\n                >\n                  Cancel\n                </Button>\n              </DialogActions>\n            </Dialog>\n          )}\n        </div>\n      { openMapper && <ExpressionBuilder setProperty={(val) => {\n        if(val.value != null) element.businessObject[name] = {...val}\n      }\n      }\n        getExpression={() => {\n          let values;\n          if (element.businessObject[name]?.value !== undefined) {\n            try {\n              values = JSON.parse(element.businessObject[name].value);\n            } catch (errror) { }\n          }\n          return { values: values, combinator: element.businessObject[name]?.combinator } ;\n        }} open={openMapper} handleClose={() => setMapper(false)} fetchModels={getMetaModels} /> }\n      </div>\n    </React.Fragment>\n  );\n}\n","import inherits from 'inherits';\n\nimport ContextPadProvider from '../../main/baml-js/lib/features/context-pad/ContextPadProvider';\n\nexport default function CustomContextPadProvider(config, injector) {\n  injector.invoke(ContextPadProvider, this);\n\n  this.getContextPadEntries = function(element) {\n    const actions = {};\n    return actions;\n  };\n}\n\ninherits(CustomContextPadProvider, ContextPadProvider);\n\nCustomContextPadProvider.$inject = [\n  'config.contextPad',\n  'injector',\n  'eventBus',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'connect',\n  'create',\n  'popupMenu',\n  'canvas',\n  'rules',\n  'translate',\n];\n","import {reduce} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {is} from '../../main/baml-js/lib/util/ModelUtil';\n\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nconst HIGH_PRIORITY = 1500;\n\nfunction isCustom(element) {\n  return element && /^custom:/.test(element.type);\n}\n\nexport default function CustomRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(CustomRules, RuleProvider);\n\nCustomRules.$inject = ['eventBus'];\n\nCustomRules.prototype.init = function() {\n  function canCreate(shape, target) {\n    // return true;\n    // only judge about custom elements\n    if (!isCustom(shape)) {\n      return;\n    }\n    // allow creation on processes\n    return (\n      is(target, 'bpmn:Process-action') ||\n      is(target, 'bpmn:Participant') ||\n      is(target, 'bpmn:Collaboration')\n    );\n  }\n  function canConnect(source, target) {\n    // only judge about custom elements\n    if (!isCustom(source) && !isCustom(target)) {\n      return;\n    }\n\n    // allow connection between custom shape and task\n    if (isCustom(source)) {\n      if (is(target, 'bpmn:Task')) {\n        return {type: 'custom:connection'};\n      } else {\n        return false;\n      }\n    } else if (isCustom(target)) {\n      if (is(source, 'bpmn:Task')) {\n        return {type: 'custom:connection'};\n      } else {\n        return false;\n      }\n    }\n  }\n\n  this.addRule('elements.move', HIGH_PRIORITY, function(context) {\n    const target = context.target;\n    const shapes = context.shapes;\n\n    let type;\n\n    // do not allow mixed movements of custom / BPMN shapes\n    // if any shape cannot be moved, the group cannot be moved, too\n    const allowed = reduce(\n        shapes,\n        function(result, s) {\n          if (type === undefined) {\n            type = isCustom(s);\n          }\n\n          if (type !== isCustom(s) || result === false) {\n            return false;\n          }\n\n          return canCreate(s, target);\n        },\n        undefined,\n    );\n\n    // reject, if we have at least one\n    // custom element that cannot be moved\n    return allowed;\n  });\n\n  this.addRule('shape.create', HIGH_PRIORITY, function(context) {\n    const target = context.target;\n    const shape = context.shape;\n\n    return canCreate(shape, target);\n  });\n\n  this.addRule('shape.resize', HIGH_PRIORITY, function(context) {\n    const shape = context.shape;\n\n    if (isCustom(shape)) {\n      // cannot resize custom elements\n      return false;\n    }\n  });\n\n  this.addRule('connection.create', HIGH_PRIORITY, function(context) {\n    const source = context.source;\n    const target = context.target;\n\n    return canConnect(source, target);\n  });\n\n  this.addRule('connection.reconnectStart', HIGH_PRIORITY, function(context) {\n    const connection = context.connection;\n    const source = context.hover || context.source;\n    const target = connection.target;\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.reconnectEnd', HIGH_PRIORITY, function(context) {\n    const connection = context.connection;\n    const source = connection.source;\n    const target = context.hover || context.target;\n\n    return canConnect(source, target, connection);\n  });\n};\n","import CustomContextPadProvider from './CustomContextPadProvider';\nimport CustomRules from './CustomRules';\n\nexport default {\n  __init__: ['contextPadProvider', 'customRules', 'paletteProvider'],\n  contextPadProvider: ['type', CustomContextPadProvider],\n  customRules: ['type', CustomRules],\n};\n","import inherits from 'inherits';\nimport ContextPadProvider from '../../main/baml-js/lib/features/context-pad/ContextPadProvider';\nimport {is} from '../../main/baml-js/lib/util/ModelUtil';\nimport {assign} from 'min-dash';\n\nexport default function CustomContextPadProvider(\n    config,\n    injector,\n    connect,\n    create,\n    translate,\n) {\n  injector.invoke(ContextPadProvider, this);\n\n  this.getContextPadEntries = function(element) {\n    const modeling = this._modeling;\n    const elementFactory = this._elementFactory;\n    const autoPlace = this._autoPlace;\n    const create = this._create;\n    const businessObject = element.businessObject;\n    function removeElement(e) {\n      modeling.removeElements([element]);\n    }\n\n    const actions = {};\n\n    if (element.type === 'label') {\n      return actions;\n    }\n\n    function appendAction(type, className, title, options) {\n      if (typeof title !== 'string') {\n        options = title;\n        title = 'Append ' + type.replace(/^bpmn:/, '');\n      }\n\n      function appendStart(event, element) {\n        // if (shouldConnectNode(element)) {\n        const shape = elementFactory.createShape(\n            assign({type: type}, options),\n        );\n        create.start(event, shape, {\n          source: element,\n        });\n        // }\n      }\n\n      const append = autoPlace ?\n        function(event, element) {\n          // if (shouldConnectNode(element)) {\n          const shape = elementFactory.createShape(\n              assign({type: type}, options),\n          );\n          autoPlace.append(element, shape);\n        } : // }\n        appendStart;\n\n      return {\n        group: 'model',\n        className: className,\n        title: title,\n        action: {\n          dragstart: appendStart,\n          click: append,\n        },\n      };\n    }\n    if (is(businessObject, 'bpmn:FlowNode')) {\n      if (!is(businessObject, 'bpmn:EndEvent')) {\n        assign(actions, {\n          'append.append-mapper': appendAction(\n              'bpmn:Mapper',\n              'bpmn-icon-task',\n              'Append Mapper',\n          ),\n        });\n        assign(actions, {\n          delete: {\n            group: 'edit',\n            className: 'bpmn-icon-trash',\n            title: 'Remove',\n            action: {\n              click: removeElement,\n              dragstart: removeElement,\n            },\n          },\n        });\n      }\n    }\n    return actions;\n  };\n}\n\ninherits(CustomContextPadProvider, ContextPadProvider);\n\nCustomContextPadProvider.$inject = [\n  'config.contextPad',\n  'injector',\n  'eventBus',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'connect',\n  'create',\n  'popupMenu',\n  'canvas',\n  'rules',\n  'translate',\n];\n","import {reduce} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {is} from '../../main/baml-js/lib/util/ModelUtil';\n\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nconst HIGH_PRIORITY = 1500;\n\nfunction isCustom(element) {\n  return element && /^custom:/.test(element.type);\n}\nexport default function CustomRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(CustomRules, RuleProvider);\n\nCustomRules.$inject = ['eventBus'];\n\nCustomRules.prototype.init = function() {\n  function canCreate(shape, target) {\n    // return true;\n    // only judge about custom elements\n    if (!isCustom(shape)) {\n      return;\n    }\n    // allow creation on processes\n    return (\n      is(target, 'bpmn:Process-action') ||\n      is(target, 'bpmn:Participant') ||\n      is(target, 'bpmn:Collaboration')\n    );\n  }\n  function canConnect(source, target) {\n    // only judge about custom elements\n    if (!isCustom(source) && !isCustom(target)) {\n      return;\n    }\n\n    // allow connection between custom shape and task\n    if (isCustom(source)) {\n      if (is(target, 'bpmn:Task')) {\n        return {type: 'custom:connection'};\n      } else {\n        return false;\n      }\n    } else if (isCustom(target)) {\n      if (is(source, 'bpmn:Task')) {\n        return {type: 'custom:connection'};\n      } else {\n        return false;\n      }\n    }\n  }\n\n  this.addRule('elements.move', HIGH_PRIORITY, function(context) {\n    const target = context.target;\n    const shapes = context.shapes;\n\n    let type;\n\n    // do not allow mixed movements of custom / BPMN shapes\n    // if any shape cannot be moved, the group cannot be moved, too\n    const allowed = reduce(\n        shapes,\n        function(result, s) {\n          if (type === undefined) {\n            type = isCustom(s);\n          }\n\n          if (type !== isCustom(s) || result === false) {\n            return false;\n          }\n\n          return canCreate(s, target);\n        },\n        undefined,\n    );\n\n    // reject, if we have at least one\n    // custom element that cannot be moved\n    return allowed;\n  });\n\n  this.addRule('shape.create', HIGH_PRIORITY, function(context) {\n    const target = context.target;\n    const shape = context.shape;\n\n    return canCreate(shape, target);\n  });\n\n  this.addRule('shape.resize', HIGH_PRIORITY, function(context) {\n    const shape = context.shape;\n\n    if (isCustom(shape)) {\n      // cannot resize custom elements\n      return false;\n    }\n  });\n\n  this.addRule('connection.create', HIGH_PRIORITY, function(context) {\n    const source = context.source;\n    const target = context.target;\n\n    return canConnect(source, target);\n  });\n\n  this.addRule('connection.reconnectStart', HIGH_PRIORITY, function(context) {\n    const connection = context.connection;\n    const source = context.hover || context.source;\n    const target = connection.target;\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.reconnectEnd', HIGH_PRIORITY, function(context) {\n    const connection = context.connection;\n    const source = connection.source;\n    const target = context.hover || context.target;\n\n    return canConnect(source, target, connection);\n  });\n};\n","import CustomContextPadProvider from './CustomContextPadProvider';\nimport CustomRules from './CustomRules';\n\nexport default {\n  __init__: ['contextPadProvider', 'customRules', 'paletteProvider'],\n  contextPadProvider: ['type', CustomContextPadProvider],\n  customRules: ['type', CustomRules],\n};\n","export function getBusinessObject(element) {\n  return (element && element.businessObject) || element;\n}\n\nexport function is(element, type) {\n  const bo = getBusinessObject(element);\n\n  return bo && typeof bo.$instanceOf === 'function' && bo.$instanceOf(type);\n}\n","import React, {useEffect, useState} from 'react';\nimport Ids from 'ids';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {getBusinessObject, is} from '../ModelUtil';\n\nimport {translate} from '../../utils';\nimport {ExtensionElementTable, TextField} from '../components';\n\nconst useStyles = makeStyles({\n  groupLabel: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: '#666',\n    fontSize: '120%',\n    margin: '10px 0px',\n    transition: 'margin 0.218s linear',\n    fontStyle: 'italic',\n  },\n  divider: {\n    marginTop: 15,\n    borderTop: '1px dotted #ccc',\n  },\n});\n\nconst PARAMETER_ELEMENT = 'bpmn:Parameter';\n\nconst createElement = (elementType, properties, parent, factory) => {\n  const element = factory.create(elementType, properties);\n  element.$parent = parent;\n  return element;\n};\n\nconst fetchParameterElements = (bo) => {\n  return bo.get('values');\n};\n\nconst getParameters = (bo, type) => {\n  const parameters = fetchParameterElements(bo);\n  if (typeof parameters !== 'undefined') {\n    const elements = parameters.filter(function(value) {\n      return is(value, type);\n    });\n    if (elements.length) {\n      return elements;\n    }\n  }\n};\n\nfunction getParameterElements(bo, type) {\n  return (bo && getParameters(bo, type)) || [];\n}\n\nexport default function ParameterProps({element, index, label, bpmnFactory}) {\n  const [parameterEntity, setParameterEntity] = useState(null);\n  const [parameterOptions, setParameterOptions] = useState(null);\n\n  const classes = useStyles();\n\n  const newElement = (element, type) => {\n    return function(e, extensionEle, value) {\n      const RENDERER_IDS = new Ids();\n      const rendererId = RENDERER_IDS.next();\n      const id = `parameter_${rendererId}`;\n      const props = {\n        id,\n      };\n\n      const newElem = createElement(type, props, extensionEle, bpmnFactory);\n\n      const bo = getBusinessObject(element);\n      if (bo.values) {\n        element.businessObject.values.push(newElem);\n      } else {\n        element.businessObject.values = [newElem];\n      }\n      return newElem;\n    };\n  };\n\n  const removeElement = (type) => {\n    return function(index) {\n      const bo = getBusinessObject(element);\n      const parameters = bo && bo.values;\n      let count;\n      parameters &&\n        parameters.forEach((element, ind) => {\n          if (element.$type === type) {\n            if (count > -1) {\n              count++;\n            } else {\n              count = 0;\n            }\n          }\n          if (count === Number(index)) {\n            bo.values.splice(ind, 1);\n            return;\n          }\n        });\n      addOptions(element);\n      if (parameters && !parameters.find((e) => e.$type === type)) {\n        if (type === PARAMETER_ELEMENT) {\n          setParameterEntity(null);\n        }\n      } else {\n        setParameterEntity(null);\n      }\n    };\n  };\n\n  const getBO = React.useCallback(() => {\n    let bo = getBusinessObject(element);\n    if (is(element, 'bpmn:Participant')) {\n      bo = bo.get('processRef');\n    }\n    return bo;\n  }, [element]);\n\n  const getParameterElement = React.useCallback(() => {\n    const type = PARAMETER_ELEMENT;\n    const bo = getBO();\n    const parameters = getParameterElements(bo, type);\n    const parameterElement = parameters[parameterEntity];\n    return parameterElement || (parameters && parameters[0]);\n  }, [getBO, parameterEntity]);\n\n  const showParameter = () => {\n    if (\n      is(element, 'bpmn:FlowElement') ||\n      is(element, 'bpmn:Process') ||\n      is(element, 'bpmn:Participant')\n    ) {\n      const bo = getBO();\n      if (bo) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  };\n\n  const setOptionLabelValue = (type) => {\n    const bo = getBO();\n    return function(index) {\n      const parameters = getParameterElements(bo, type);\n      const parameterElement = parameters[index];\n      if (!parameterElement) return '';\n      const label = parameterElement.id;\n      return label;\n    };\n  };\n\n  const addOptions = (element, isInitial = false) => {\n    const bo = getBusinessObject(element);\n    const parameters = getParameterElements(bo, PARAMETER_ELEMENT);\n\n    const parameterOptions =\n      parameters &&\n      parameters.map(function(l, index) {\n        return {\n          id: index,\n          text: l.id,\n        };\n      });\n    setParameterOptions(parameterOptions);\n    if (isInitial) {\n      if (parameterOptions.length > 0) {\n        setParameterEntity(parameterOptions[0]);\n      }\n    }\n  };\n\n  useEffect(() => {\n    addOptions(element, true);\n  }, [element]);\n\n  return (\n    <div>\n      <React.Fragment>\n        {index > 0 && <div className={classes.divider} />}\n      </React.Fragment>\n      <div className={classes.groupLabel}>{label}</div>\n      {showParameter() && (\n        <ExtensionElementTable\n          element={element}\n          options={parameterOptions}\n          entry={{\n            id: 'parameter',\n            label: translate('Parameter'),\n            modelProperty: 'name',\n            idGeneration: 'false',\n            reference: 'processRef',\n            createExtensionElement: newElement(element, PARAMETER_ELEMENT),\n            removeExtensionElement: removeElement(PARAMETER_ELEMENT),\n            onSelectionChange: function(value) {\n              setParameterEntity(value);\n            },\n            setOptionLabelValue: setOptionLabelValue(PARAMETER_ELEMENT),\n          }}\n        />\n      )}\n      {(parameterEntity || parameterEntity === 0) && (\n        <React.Fragment>\n          <TextField\n            element={element}\n            canRemove={true}\n            entry={{\n              id: 'target',\n              label: translate('Target'),\n              modelProperty: 'target',\n              get: function() {\n                const parameterElement = getParameterElement();\n                if (!parameterElement) return;\n                return {target: parameterElement.target};\n              },\n              set: function(e, values) {\n                const parameterElement = getParameterElement();\n                if (!parameterElement) return;\n                parameterElement['target'] = values.target;\n              },\n            }}\n          />\n          <TextField\n            element={element}\n            canRemove={true}\n            entry={{\n              id: 'expression',\n              label: translate('Expression'),\n              modelProperty: 'expression',\n              get: function() {\n                const parameterElement = getParameterElement();\n                if (!parameterElement) return;\n                return {expression: parameterElement.expression};\n              },\n              set: function(e, values) {\n                const parameterElement = getParameterElement();\n                if (!parameterElement) return;\n                parameterElement['expression'] = values.expression;\n              },\n            }}\n          />\n        </React.Fragment>\n      )}\n    </div>\n  );\n}\n","import { getApps } from \"../services/api\";\n\nexport const tabProperty = [\n  {\n    type: 'bpmn:Lane',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textField'},\n      {name: 'expression', label: 'Expression', widget: 'expression'},\n    ],\n  },\n  {\n    type: 'bpmn:Participant',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textField'},\n      {name: 'studioApp', label: 'App', widget: 'many-to-one', edit:false , onchange:false ,fetchMethod: () => getApps(),},\n      {name: 'url', label: 'URL', widget: 'textField'},\n      {\n        name: 'payLoadTypeSelect',\n        label: 'Type payload',\n        widget: 'selectBox',\n        emptyParameter: true,\n        selectOptions: [\n          {name: 'Form', value: 'form'},\n          {name: 'Json', value: 'json'},\n          {name: 'Xml', value: 'xml'},\n          {name: 'Text', value: 'text'},\n          {name: 'File Path', value: 'file'},\n          {name: 'File Link', value: 'file-link'},\n          {name: 'File Text', value: 'file-text'},\n          {name: 'Stream', value: 'stream'},\n        ],\n      },\n      {\n        name: 'type',\n        label: 'Type',\n        widget: 'selectBox',\n        emptyParameter: true,\n        selectOptions: [\n          {name: 'GET',default: 'GET', value: 'GET'},\n          {name: 'POST', value: 'POST'},\n          {name: 'PUT', value: 'PUT'},\n          {name: 'DELETE', value: 'DELETE'},\n          {name: 'PATCH', value: 'PATCH'},\n        ],\n      },\n      {name: 'callIf', label: 'Call if', widget: 'scriptBox'},\n      {name: 'repeatIf', label: 'Repeat if', widget: 'scriptBox'}\n    ],\n  },\n];\n\n/* {\n  name: \"typeRequest\", label: \"Type of Request\", widget: \"checkBoxs\",\n  boxs: [\n    { name: \"classic\", label: \"Classic\", widget: \"checkbox\" },\n    { name: \"auth\", label: \"Authentification\", widget: \"checkbox\" },\n    { name: \"encryptData\", label: \"Encrypt data\", widget: \"checkbox\" },\n  ]\n},*/\n","import React from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport {groovy} from '../../utils';\nimport {Button, Dialog, DialogTitle} from '@material-ui/core';\nimport {prettyPrintJson} from 'pretty-print-json';  \nimport '../../../node_modules/pretty-print-json/dist/pretty-print-json.dark-mode.css';\nimport classNames from 'classnames';\nconst useStyles = makeStyles({\n  table: {\n    'height': '199px !important',\n    'borderRadius': '0px !important',\n    '& .MuiTableCell-root': {\n      padding: '10px',\n      paddingLeft: '40px',\n    },\n  },\n  save: {\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'margin': 12,\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  console: {\n    margin: 0,\n    padding: 10,\n    fontSize: '1.1em',\n  },\n  box: {\n    '& > div > div > div': {\n      borderBottom: '1px solid black',\n    },\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    height: 'calc(100% - 50px)',\n    overflow: 'scroll',\n    backgroundColor:'black'\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'fontSize': 15,\n    'alignItems': 'center',\n    'width': '20%',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n      width: 'auto',\n    },\n    '& .MuiTypography-h6': {\n      fontSize: '1em',\n    },\n  },\n  dialogPaper: {\n    maxWidth: '50%',\n    height: '60%',\n    resize: 'both',\n    width: '50%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  tableBody: {\n    minWidth: '100%',\n    // backgroundColor:\"black !important\"\n  },\n});\n\nexport default function JsonViewer({showJson, models, type, setShowJson}) {\n  const classes = useStyles();\n\n  function effect() {\n    const json = {};\n    models.forEach((model) => {\n      model[type]?.forEach((element) => {\n        json[element.wsKey] = groovy(element, model.model);\n      });\n    });\n    const options = {linkUrls: true, quoteKeys: true};\n    if (document.getElementById('result') != null) {\n      document.getElementById('result').innerHTML = '';\n    }\n    document.getElementById('result').innerHTML = prettyPrintJson.toHtml(\n        json,\n        options,\n    );\n  }\n\n  return (\n    <>\n      <Dialog\n        onClose={(e, reason) => {\n          if (reason !== 'backdropClick') {\n          }\n        }}\n        onEntered={effect}\n        aria-labelledby=\"simple-dialog-title\"\n        open={showJson}\n        classes={{\n          paper: classes.dialogPaper,\n        }}\n      >\n        <DialogTitle id=\"simple-dialog-title\">Payloads json</DialogTitle>\n        <div className={classes.root}>\n          <Paper variant=\"outlined\" className={classes.paper}>\n            <pre\n              id=\"result\"\n              className={classNames(['json-container', classes.console])}\n            ></pre>\n          </Paper>\n          <div>\n            <Button\n              className={classes.save}\n              onClick={() => {\n                setShowJson(false);\n              }}\n            >\n              OK\n            </Button>\n          </div>\n        </div>\n      </Dialog>\n    </>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport {withStyles, makeStyles} from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport {useSelector} from 'react-redux';\nimport {getGroovyBasicPayload, groovy} from '../../utils';\nimport {Button} from '@material-ui/core';\nimport JsonViewer from '../views/JsonView';\nimport { COLUMNS } from '../constants';\n\nconst StyledTableCell = withStyles((theme) => ({\n  head: {\n    backgroundColor: '#A3A3A3',\n    color: theme.palette.common.white,\n    fontSize: 12,\n    fontWeight: 'bold',\n  },\n  body: {\n    fontSize: 10,\n  },\n}))(TableCell);\n\nconst StyledTableRow = withStyles((theme) => ({\n  root: {\n    '&:nth-of-type(odd)': {\n      backgroundColor: theme.palette.action.hover,\n    },\n  },\n}))(TableRow);\n\nconst useStyles = makeStyles({\n  table: {\n    'height': '199px !important',\n    'borderRadius': '0px !important',\n    '& .MuiTableCell-root': {\n      padding: '10px',\n      paddingLeft: '40px',\n    },\n  },\n  save: {\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'fontSize': 15,\n    'alignItems': 'center',\n    'width': '20%',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n      width: 'auto',\n    },\n    '& .MuiTypography-h6': {\n      fontSize: '1em',\n    },\n  },\n  dialogPaper: {\n    maxWidth: '50%',\n    maxHeight: '40%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  tableBody: {\n    minWidth: '100%',\n    // backgroundColor:\"black !important\"\n  },\n});\n\nexport default function CustomizedTables({type}) {\n  const modelParameters = useSelector(\n      (state) => state.requestReducer.modelParameters,\n  );\n  const modelPayloads = useSelector(\n      (state) => state.payloadReducer.modelPayloads,\n  );\n  const headers = useSelector((state) => state.headerReducer.headers);\n  const [models, setModels] = useState([]);\n  const [showJson, setShowJson] = useState(false);\n  const classes = useStyles();\n  useEffect(() => {\n    if (type === 'parameters') {\n      setModels(modelParameters);\n    } else if (type === 'payloads') {\n      setModels(modelPayloads);\n    } else {\n      if (type === 'headers') {\n        setModels(headers);\n      }\n    }\n  }, [headers, modelParameters, modelPayloads, type]);\n\n  return (\n    <>\n      {models?.length !== 0 && (\n        <TableContainer className={classes.table} component={Paper}>\n          <Table aria-label=\"customized table\">\n            <TableHead>\n              <TableRow>\n                {COLUMNS?.map((column, id) => {\n                  return (\n                    <StyledTableCell width=\"50%\" key={id}>\n                      <div style={{display: 'flex', alignItems: 'center'}}>\n                        <span>{column.title}</span>\n                        {id === 1 && type !== \"headers\"  && (\n                          <Button\n                            className={classes.save}\n                            onClick={() => setShowJson(true)}\n                            style={{marginLeft: 'auto'}}\n                          >\n                            Json\n                          </Button>\n                        )}\n                      </div>\n                    </StyledTableCell>\n                  );\n                })}\n              </TableRow>\n            </TableHead>\n            <TableBody className={classes.tableBody}>\n              {type !== 'headers' ?\n                type === 'payloads' ?\n                  models?.map((model) =>\n                    model[type]?.map((element) => {\n                      return (\n                        <StyledTableRow key={element.id}>\n                          <StyledTableCell component=\"th\" scope=\"row\">\n                            {element.wsKey}\n                          </StyledTableCell>\n                          <StyledTableCell>\n                            {JSON.stringify(groovy(element, model.model))}\n                          </StyledTableCell>\n                        </StyledTableRow>\n                      );\n                    }),\n                  ) :\n                  models?.map((model) =>\n                    model[type]?.map((element) => {\n                      return (\n                        <StyledTableRow key={element?.id}>\n                          <StyledTableCell component=\"th\" scope=\"row\">\n                            {element?.wsKey}\n                          </StyledTableCell>\n                          <StyledTableCell>\n                          {JSON.stringify(groovy(element, model.model))}\n                          </StyledTableCell>\n                        </StyledTableRow>\n                      );\n                    }),\n                  ) :\n                headers?.map((header) => (\n                  <StyledTableRow key={header.id}>\n                    <StyledTableCell component=\"th\" scope=\"row\">\n                      {header.wsKey}\n                    </StyledTableCell>\n                    <StyledTableCell>{header.wsValue}</StyledTableCell>\n                  </StyledTableRow>\n                ))}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      )}\n      {showJson && (\n        <JsonViewer\n          type={type}\n          models={models}\n          showJson={showJson}\n          setShowJson={setShowJson}\n        />\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    flexDirection: 'column',\n    marginTop: 5,\n  },\n  cercle: {\n    width: 12,\n    height: 12,\n    borderRadius: 50,\n    border: '1px solid #0274d7',\n  },\n  line: {\n    marginTop: 3,\n    width: 3,\n    height: '95%',\n    backgroundColor: '#0274d7',\n  },\n});\n\nexport default function Line({className}) {\n  const classes = useStyles();\n\n  return (\n    <div className={classnames(classes.root, className)}>\n      <div className={classes.cercle}></div>\n      <div className={classes.line}></div>\n    </div>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {\n  Button,\n  Dialog,\n  DialogTitle,\n  Paper,\n  TextField,\n} from '@material-ui/core';\nconst useStyles = makeStyles({\n  filter: {\n    display: 'flex',\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n  },\n  fieldSelect: {\n    width: '25%',\n  },\n  param: {\n    width: '70%',\n    marginRight: '2%',\n    justifyContent: 'center',\n    '& .MuiInputBase-input': {\n      padding: 0,\n    },\n  },\n  delete: {\n    color: '#0274d7',\n    fontSize: 25,\n    marginTop: 'auto',\n  },\n  icon: {\n    color: '#0274d7',\n    marginRight: '2%',\n    marginLeft: '2%',\n    marginTop: 'auto',\n    fontSize: '1.5em',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'paddingTop': 0,\n    'paddingBottom': 0,\n    'display': 'flex',\n    'marginTop': 'auto',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n      padding: 0,\n    },\n  },\n  dialogPaper: {\n    maxWidth: '25%',\n    maxHeight: '35%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    // alignItems:'end',\n    width: '100%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n    margin: 10,\n  },\n  save: {\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  scrollDiv: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n});\n\nexport function ParameterBuilder({id,multiArg,parametersTrans,open,onClose,handleChange\n}) {\n  const classes = useStyles();\n  const [parameters, setParemeters] = useState();\n\n  useEffect(()=>{\n    setParemeters(parametersTrans)\n  },[parametersTrans])\n  const renderComponent = (e, id) => {\n    switch (e?.type) {\n      case 'Decimal':\n        return (\n          <TextField\n            placeholder={e?.name}\n            value={parameters[id].value}\n            type={e?.type}\n            className={classes.param}\n            onChange={(e) => {\n              const p = Object.assign([],[...parameters]);\n              p[id].value = e.target.value;\n            }}\n          />\n        );\n      default:\n        return (\n          <TextField\n            placeholder={e?.name}\n            value={parameters[id].value}\n            type={e?.type}\n            className={classes.param}\n            onChange={(e) => {\n              let newP = null;\n                const p = Object.assign([],[...parameters]);\n              newP = {...p[id]};\n              newP.value = e.target.value;\n              p[id] = newP\n              setParemeters(p);\n            }}\n          />\n        );\n    }\n  };\n\n  return (\n      <Dialog\n        onClose={(e, reason) => {\n          if (reason !== 'backdropClick') {\n            onClose();\n          }\n        }}\n        aria-labelledby=\"simple-dialog-title\"\n        open={open}\n        classes={{\n          paper: classes.dialogPaper,\n        }}\n      >\n        <div style={{display:'flex',flexDirection:'row'}}>\n        <DialogTitle id=\"simple-dialog-title\">Parameters</DialogTitle>\n        {multiArg && <DialogTitle id=\"simple-dialog-title\" style={{marginLeft:'auto',color:'#0274d7',cursor:'pointer'}} onClick={()=>setParemeters([...parameters,{value:null,name:null}])}>Add parameter</DialogTitle>}\n        </div>\n        <div className={classes.root}>\n          <Paper variant=\"outlined\" className={classes.paper}>\n            <div className={classes.baseModelParams}>\n              <div className={classes.addBaseModelParams}>\n                <div className={classes.scrollDiv}>\n                  {parameters?.map((param, index) => {\n                    return (\n                      <div className={classes.baseModelParams} key={index}>\n                        <p style={{fontSize: 14,width:'30%'}}>Parameter {index + 1} : {param.isOptional ? \"(optional)\" : \"\"}</p>\n                        {renderComponent(param, index)}\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n          </Paper>\n          <div>\n            <Button\n              className={classes.save}\n              onClick={() => {\n                handleChange(parameters,id)\n                onClose();\n              }}\n            >\n              OK\n            </Button>\n            <Button\n              className={classes.save}\n              style={{textTransform: 'none'}}\n              onClick={onClose}\n            >\n              Cancel\n            </Button>\n          </div>\n        </div>\n      </Dialog>\n  );\n}\n","import React, {useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {Selection} from '../components';\nimport classNames from 'classnames';\nimport {\n  getLabraries,\n  getParams,\n  getTransformations,\n} from '../../services/api';\nimport {\n  DialogTitle,\n} from '@material-ui/core';\nimport {ArrowRightAlt, Delete, Edit} from '@material-ui/icons';\nimport { ParameterBuilder } from './ParameterBuilder';\n\nconst useStyles = makeStyles({\n  filter: {\n    display: 'flex',\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n  },\n  fieldSelect: {\n    width: '25%',\n  },\n  param: {\n    'width': '70%',\n    'marginRight': '2%',\n    'justifyContent': 'center',\n    '& .MuiInputBase-input': {\n      padding: 0,\n    },\n  },\n  delete: {\n    color: '#0274d7',\n    fontSize: 25,\n    marginTop: 'auto',\n  },\n  icon: {\n    color: '#0274d7',\n    marginRight: '2%',\n    marginLeft: '2%',\n    marginTop: 'auto',\n    fontSize: '1.5em',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'paddingTop': 0,\n    'paddingBottom': 0,\n    'display': 'flex',\n    'marginTop': 'auto',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n      padding: 0,\n    },\n  },\n  dialogPaper: {\n    maxWidth: '25%',\n    maxHeight: '35%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    // alignItems:'end',\n    width: '100%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n    margin: 10,\n  },\n  save: {\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  scrollDiv: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n});\n\nexport function Filter({\n  id,\n  trans,\n  handleChange,\n  className,\n  deleteTransformation,\n}) {\n  const classes = useStyles();\n  const [transformation, setTransformation] = useState(trans);\n  const [showParam, setShowParam] = useState(false);\n\n  const fetchParams = async (e) => {\n    const res = await getParams(e?.id);\n    return res;\n  };\n\n  return (\n    <div className={classNames(classes.filter, className)}>\n      <Selection\n        name=\"library\"\n        title=\"Library\"\n        placeholder=\"Libary\"\n        optionLabelKey=\"name\"\n        className={classes.fieldSelect}\n        fetchAPI={getLabraries}\n        onChange={(e) => {\n          setTransformation({...transformation, library: e});\n          handleChange({...trans, library: e}, id);\n        }}\n        value={transformation?.library}\n      />\n      <ArrowRightAlt className={classes.icon} style={{fontSize: 24}} />\n      <Selection\n        name=\"operation\"\n        title=\"Operation\"\n        placeholder=\"Operation\"\n        optionLabelKey=\"name\"\n        className={classes.fieldSelect}\n        value={transformation?.operation}\n        fetchAPI={() => getTransformations(transformation?.library?.id)}\n        onChange={async(e) => {\n          setTransformation({...transformation, operation: e});\n          let params = await fetchParams(e);\n          setTransformation({...trans, operation: {...e,parameters:params}})\n          handleChange({...trans, operation: {...e,parameters:params}}, id);\n          if (e?.parameters?.length !== 0) setShowParam(true);\n        }}\n      />\n      {transformation?.operation?.parameters && transformation?.operation?.parameters?.length !== 0 && (\n        <>\n          <DialogTitle\n            id=\"simple-dialog-title\"\n            className={classes.dialogTitle}\n            style={{cursor: 'pointer', marginLeft: '2%', height: '1.5em'}}\n            onClick={() => {setShowParam(true);}}\n          >\n            Parameters\n          </DialogTitle>\n          <Edit className={classes.icon} style={{marginLeft: 0}} />\n        </>\n      )}\n      <Delete\n        className={classes.icon}\n        style={{marginLeft: 'auto', marginRight: '15%', fontSize: 25}}\n        onClick={() => deleteTransformation(id)}\n      />\n    {showParam && <ParameterBuilder id={id} open={showParam} parametersTrans={transformation?.operation?.parameters} handleChange={(params,id)=>{setTransformation({...trans, operation: {...transformation.operation,parameters:params}}, id);handleChange({...trans, operation: {...transformation.operation,parameters:params}}, id)}} multiArg={transformation?.operation?.multiArg} onClose={()=>{setShowParam(false)}}/> }\n    </div>\n  );\n}\n","import React from 'react';\nimport {\n  Button,\n  Dialog,\n  DialogTitle,\n  makeStyles,\n  Paper,\n} from '@material-ui/core';\nimport {Add} from '@material-ui/icons';\nimport {useEffect, useState} from 'react';\nimport Line from '../components/Line';\nimport {Filter} from './transformation-builder';\n\nconst useStyles = makeStyles({\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    margin: 20,\n    fontSize: 30,\n  },\n  delete: {\n    color: '#0274d7',\n    margin: 'auto',\n    fontSize: 25,\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  dialogPaper: {\n    maxWidth: '50%',\n    maxHeight: '40%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n});\n\nexport const TransformationBuilder = ({\n  initialData,\n  open,\n  handleClose,\n  onSave,\n}) => {\n  const classes = useStyles();\n  const [transformation, setTransformation] = useState([]);\n\n  useEffect(() => {\n    if (initialData == null || initialData?.length === 0) {\n      setTransformation([\n        {\n          library: {},\n          operation: {name: '', value: '', parameters: null},\n        },\n      ]);\n    } else setTransformation(initialData);\n  }, [initialData]);\n\n  const addFilter = () => {\n    setTransformation([\n      ...transformation,\n      {\n        library: {},\n        operation: {name: '', value: '', parameters: null},\n      },\n    ]);\n  };\n  const deleteFilter = (id) => {\n    const newTrans = transformation.filter((value, index) => index !== id);\n    setTransformation([...newTrans]);\n  };\n  const handleTransformation = (newTrans, id) => {\n    const trans = [...transformation];\n    trans[id] = newTrans;\n    setTransformation(trans);\n  };\n\n  return (\n    <Dialog\n      onClose={(_e, reason) => {\n        if (reason !== 'backdropClick') {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Data transformation</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div className={classes.baseModelParams}>\n            <Line className={classes.line}></Line>\n            <div className={classes.addBaseModelParams}>\n              <div className={classes.dialogTitle}>\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  className={classes.dialogTitle}\n                  onClick={() => addFilter()}\n                >\n                  Add filter\n                </DialogTitle>\n                <Add />\n              </div>\n              <div>\n                {transformation?.map((filter, index) => {\n                  return (\n                    <Filter\n                      trans={filter}\n                      handleChange={(trans, id) =>\n                        handleTransformation(trans, id)\n                      }\n                      key={index}\n                      id={index}\n                      deleteTransformation={(id) => deleteFilter(id)}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </Paper>\n        <div>\n          <Button\n            className={classes.save}\n            onClick={() => {\n              onSave(transformation);\n              handleClose();\n            }}\n          >\n            OK\n          </Button>\n          <Button\n            className={classes.save}\n            style={{textTransform: 'none'}}\n            onClick={() => {\n              handleClose();\n            }}\n          >\n            Cancel\n          </Button>\n        </div>\n      </div>\n    </Dialog>\n  );\n};\n","import React, {useEffect, useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {DialogTitle, TextField} from '@material-ui/core';\nimport {Add, ArrowRightAlt, Delete, Edit} from '@material-ui/icons';\nimport {TransformationBuilder} from '../../transformation-builder/index';\nimport {Selection} from '../../components';\n\nconst useStyles = makeStyles({\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  textField: {\n    justifyContent: 'center',\n    width: '33%',\n    marginBottom: 10,\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    margin: 20,\n    fontSize: 30,\n  },\n  delete: {\n    color: '#0274d7',\n    margin: 'auto',\n    fontSize: 25,\n  },\n  fieldSelect: {\n    width: '30%',\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  dialogPaper: {\n    maxWidth: '50%',\n    maxHeight: '40%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n});\n\nexport default function Parameter({\n  deleteParam,\n  correspondingFields,\n  handleChange,\n  parameter,\n  id,\n}) {\n  const classes = useStyles();\n  const [showTransformation, setShowTransformation] = useState(false);\n  const [param, setParam] = useState(parameter);\n  useEffect(() => {\n    setParam(parameter);\n  }, [parameter]);\n  return (\n    <>\n      <div className={classes.modelParams}>\n        <TextField\n          value={param.wsKey}\n          InputLabelProps=\"Parameter name\"\n          onChange={(e) => {\n            setParam({...param, wsKey: e.target.value});\n          }}\n          onBlur={(e) => handleChange({...param, wsKey: e.target.value}, id)}\n          className={classes.textField}\n          style={{width: '20%'}}\n          placeholder=\"Parameter name\"\n        />\n        <ArrowRightAlt className={classes.icon} />\n        {correspondingFields && (\n          <Selection\n            name=\"name\"\n            title=\"Corresponding field\"\n            placeholder=\"Model\"\n            value={param.wsValue}\n            optionLabelKey=\"name\"\n            options={correspondingFields}\n            onChange={(e) => {\n              handleChange({...param, wsValue: e}, id);\n              setParam({...param, wsValue: e});\n            }}\n            className={classes.fieldSelect}\n          />\n        )}\n        {!correspondingFields && (\n          <TextField\n            value={param.wsValue}\n            InputLabelProps=\"Payload\"\n            onChange={(e) => {\n              setParam({...param, wsValue: e.target.value});\n            }}\n            onBlur={(e) =>\n              handleChange({...param, wsValue: e.target.value}, id)\n            }\n            className={classes.textField}\n            placeholder=\"Corresponding\"\n          />\n        )}\n        <ArrowRightAlt className={classes.icon} />\n        <div className={classes.dialogTitle}>\n          {(param.transformations == null ||\n            param?.transformations?.length === 0) && (\n            <>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                onClick={() => setShowTransformation(true)}\n                className={classes.dialogTitle}\n              >\n                Add data transformation\n              </DialogTitle>\n              <Add />\n            </>\n          )}\n          {param?.transformations && param?.transformations?.length !== 0 && (\n            <>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                className={classes.dialogTitle}\n                onClick={() => setShowTransformation(true)}\n              >\n                Transformations\n              </DialogTitle>\n              <Edit />\n            </>\n          )}\n        </div>\n        <Delete onClick={() => deleteParam(id)} className={classes.delete} />\n      </div>\n      {showTransformation && (\n        <TransformationBuilder\n          open={showTransformation}\n          onSave={(trans) => {\n            handleChange({...param, transformations: trans}, id);\n            setParam({...param, transformations: trans}, id);\n          }}\n          handleClose={() => setShowTransformation(false)}\n          action={true}\n          initialData={param?.transformations}\n        />\n      )}\n    </>\n  );\n}\n","import React, {useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {DialogTitle, Paper} from '@material-ui/core';\nimport {Add, Delete} from '@material-ui/icons';\nimport Line from '../../components/Line';\nimport Parameter from './Parameter';\nimport {getModels} from '../../../services/api';\nimport { Selection } from '../../components';\n\nconst useStyles = makeStyles({\n  modelParameter: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n    marginBottom:'1.5%'\n  },\n  paperParams: {\n    marginTop: 10,\n    resize: 'both',\n    width: '100%',\n    marginRight: 10,\n  },\n  inputSelect: {\n    marginLeft: '2%',\n    marginRight: '2%',\n    width: '96%',\n    marginBottom: 10,\n  },\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n  block: {\n    width: '100%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    margin: 20,\n    fontSize: 30,\n  },\n});\n\nexport default function ModelParameter({\n  handleChangeParam,\n  deleteModelParam,\n  modelParameter,\n  addParameter,\n  id,\n}) {\n  const classes = useStyles();\n  const [metaModal, setMetaModal] = useState(modelParameter?.model);\n\n  const handelAddParameter = () => {\n    addParameter(id, {wsKey: '', wsValue: null, transformations: []});\n  };\n\n  const handleParameterChange = (param, idParam) => {\n    const newModelParameter = Object.assign(\n        {},\n        {...modelParameter, model: metaModal},\n    );\n    const b = Object.assign([], newModelParameter.parameters);\n    b[idParam] = param;\n    handleChangeParam({model: metaModal, parameters: b}, id);\n  };\n\n  const handleDelete = (idParam) => {\n    let newModelParameter = [...modelParameter.parameters];\n    newModelParameter = newModelParameter.filter(\n        (par, index) => index !== idParam,\n    );\n    handleChangeParam({...modelParameter, parameters: newModelParameter}, id);\n  };\n\n  async function fetchModels() {\n    return getModels();\n  }\n\n  return (\n    <div className={classes.modelParameter}>\n      <Paper variant=\"outlined\" className={classes.paperParams}>\n        <Selection\n          name=\"metaModal\"\n          title=\"Model\"\n          placeholder=\"meta modal\"\n          fetchAPI={fetchModels}\n          optionLabelKey=\"name\"\n          onChange={(e) => {\n            setMetaModal(e);\n          }}\n          value={metaModal}\n          classes={{root: classes.inputSelect}}\n        />\n        <div className={classes.modelParams}>\n          <Line className={classes.line} />\n          <div className={classes.block}>\n            <div>\n              {modelParameter?.parameters?.map((param, index) => {\n                return (\n                  <Parameter\n                    handleChange={handleParameterChange}\n                    key={index}\n                    model={modelParameter.model}\n                    correspondingFields={metaModal?.type === \"metaModel\" ? metaModal?.metaFields : (metaModal?.type === \"metaJsonModel\" ? metaModal?.fields : metaModal?.fields )}\n                    deleteParam={handleDelete}\n                    parameter={param}\n                    id={index}\n                  />\n                );\n              })}\n            </div>\n            <div className={classes.dialogTitle}>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                onClick={() => handelAddParameter()}\n                className={classes.dialogTitle}\n              >\n                Add parameter\n              </DialogTitle>\n              <Add />\n            </div>\n          </div>\n        </div>\n      </Paper>\n      <Delete onClick={() => deleteModelParam(id)} className={classes.icon} />\n    </div>\n  );\n}\n","import {createAsyncThunk, createSlice} from '@reduxjs/toolkit';\n\nexport const sendRequest = createAsyncThunk(\n    'company/fetchCompany',\n    async function(data) {\n      return sendRequest(data)\n          .catch(function(error) {\n            console.log(error);\n          })\n          .then((response) => response.data.data);\n    },\n);\n\nexport const requestSlice = createSlice({\n  name: 'counter',\n  initialState: {\n    modelParameters: [],\n  },\n  reducers: {\n    updateModelParam: (state, action) => {\n      state.modelParameters = action.payload;\n    },\n    addModelParam: (state, action) => {\n      state.modelParameters.push({\n        ...action.payload,\n        parameters: [{id: 1, wsKey: '', wsValue: ''}],\n      });\n    },\n    deleteModelParam: (state, action) => {\n      state.modelParameters = state.modelParameters.filter(\n          (modelParam) => modelParam.id !== action.payload,\n      );\n    },\n  },\n});\n\n// Action creators are generated for each case reducer function\nexport const {updateModelParam, addModelParam, deleteModelParam} =\n  requestSlice.actions;\nconst requestReducer = requestSlice.reducer;\nexport default requestReducer;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {\n  Button,\n  Paper,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {Add} from '@material-ui/icons';\nimport Line from '../components/Line';\nimport ModelParameter from './components/ModelParameter';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {updateModelParam} from './features/requestReducer';\n\nconst useStyles = makeStyles((theme) => ({\n  saveButtonText: {\n    marginLeft: 10,\n  },\n  saveMessageAlert: {\n    width: '100%',\n    marginBottom: 10,\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  paper: {\n    margin: theme.spacing(1),\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  dialog:{\n    width:'20%'\n  },\n  dialogPaper: {\n    maxWidth: '70%',\n    maxHeight: '700px',\n    minWidth:'950px',\n    resize: 'both',\n    width: '70%',\n    height: '90%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': theme.spacing(1),\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '90%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  scrollDiv: {\n    overflow: 'auto',\n    height: 550,\n  },\n}));\n\nfunction RequestBuilder({\n  handleClose,\n  open,\n  action,\n}) {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const modelParametersStore = useSelector(\n      (state) => state.requestReducer.modelParameters,\n  );\n  const [modelParameters, setModelParameters] = useState([]);\n  const [alertConfig, setAlertConfig] = React.useState({\n    openAlert:false,\n    alertMessage: 'Add all values',\n    alertTitle: 'Error',\n  });\n  useEffect(() => {\n    if (modelParametersStore.length === 0) {\n      setModelParameters([\n        {\n          model: {},\n          parameters: [{wsKey: '', wsValue: null, transformations: []}],\n        },\n      ]);\n    } else {\n      if (action === 'ADD') {\n        setModelParameters([\n          {\n            model: {},\n            parameters: [{wsKey: '', wsValue: null, transformations: []}],\n          },\n        ]);\n      } else {\n        setModelParameters(modelParametersStore);\n      }\n    }\n  }, [action, modelParametersStore]);\n\n  const handleSave = () => {\n    if (!isAllFields()) setAlertConfig({...alertConfig,openAlert:true});\n    else {\n      dispatch(\n          updateModelParam(\n          action === 'EDIT' ?\n            modelParameters :\n            [...modelParametersStore, ...modelParameters],\n          ),\n      );\n      handleClose();\n    }\n  };\n  useEffect(() => {}, [modelParameters]);\n\n  const isAllFields = () => {\n    let empty = true;\n    modelParameters.forEach((model) => {\n      model.parameters.forEach((param) => {\n        if (param.wsKey.length === 0 || param.wsValue === null) {\n          empty = false;\n          return;\n        }\n      });\n    });\n    return empty;\n  };\n\n  const onCancel = () => {\n    handleClose();\n  };\n\n  const handelAddModelParameter = () => {\n    setModelParameters([\n      ...modelParameters,\n      {\n        model: {},\n        parameters: [{wsKey: '', wsValue: null, transformations: []}],\n      },\n    ]);\n  };\n\n  const handelDeleteModelParam = (id) => {\n    const newModelParam = modelParameters.filter(\n        (modelParam, index) => index !== id,\n    );\n    setModelParameters(newModelParam);\n  };\n  const addParameter = (id, param) => {\n    const newModelParameter = Object.assign([], modelParameters);\n    const b = Object.assign([], newModelParameter[id].parameters);\n    b.push(param);\n    newModelParameter[id] = {...newModelParameter[id], parameters: b};\n    setModelParameters(newModelParameter);\n  };\n  const handleChangeModelParam = useCallback(\n      (modelParam, id) => {\n        const newModelParam = [...modelParameters];\n        newModelParam[id] = modelParam;\n        setModelParameters(newModelParam);\n      },\n      [modelParameters],\n  );\n\n  return (\n    <Dialog\n      onClose={(e, reason) => {\n        if (reason !== 'backdropClick') {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Build Parametres</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div className={classes.baseModelParams}>\n            <Line className={classes.line}></Line>\n            <div className={classes.addBaseModelParams}>\n              <div className={classes.dialogTitle}>\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  className={classes.dialogTitle}\n                  onClick={handelAddModelParameter}\n                >\n                  Add base model parameters\n                </DialogTitle>\n                <Add />\n              </div>\n              <div className={classes.scrollDiv}>\n                {modelParameters?.map((modelParam, index) => {\n                  return (\n                    <ModelParameter\n                      handleChangeParam={handleChangeModelParam}\n                      key={index}\n                      addParameter={addParameter}\n                      modelParameter={modelParam}\n                      deleteModelParam={handelDeleteModelParam}\n                      id={index}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </Paper>\n        <div>\n          <Button className={classes.save} onClick={handleSave}>\n            OK\n          </Button>\n          <Button\n            className={classes.save}\n            onClick={onCancel}\n            style={{textTransform: 'none'}}\n          >\n            Cancel\n          </Button>\n        </div>\n      </div>\n      {alertConfig.openAlert && (\n        <Dialog\n          open={alertConfig.openAlert}\n          onClose={(e, reason) => {\n            if (reason !== 'backdropClick') {\n              setAlertConfig({...alertConfig,openAlert:false});\n            }\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n          classes={{\n            paper: classes.dialog,\n          }}\n        >\n          <DialogTitle id=\"alert-dialog-title\">\n            {alertConfig.alertTitle}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {alertConfig.alertMessage}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setAlertConfig({...alertConfig,openAlert:false});\n                if (alertConfig.openAlert) {\n                  setAlertConfig({...alertConfig,openAlert:false});\n                }\n              }}\n              color=\"primary\"\n              autoFocus\n              className={classes.save}\n            >\n              Ok\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Dialog>\n  );\n}\n\nexport default RequestBuilder;\n","import React from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {ArrowRightAlt, Delete} from '@material-ui/icons';\nimport {HEADERS_KEYS, HEADERS_VALUES} from '../../constants';\nimport {SelectionField} from '../../components'\nconst useStyles = makeStyles({\n  headers: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'self-end',\n    justifyContent: 'space-between',\n    maxWidth: '70%',\n    marginBottom: '2%',\n  },\n  delete: {\n    color: '#0274d7',\n    fontSize: 25,\n    marginTop: 'auto',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  icon:{\n   color: '#0274d7',\n   fontSize:24\n  },\n  inputSelect: {\n    marginLeft: '2%',\n    marginRight: '2%',\n    width: '96%'\n  },\n});\n\nexport default function Header({handleChange, handleDelete, header, id}) {\n  const classes = useStyles();\n  return (\n    <div className={classes.headers}>\n      <SelectionField\n        name=\"name\"\n        title=\"Header name\"\n        placeholder=\"Header name\"\n        optionLabelKey=\"name\"\n        value={{name: header.wsKey}}\n        onChange={(e) => {\n          handleChange({...header, wsKey: e?.name ? e.name : e}, id);\n        }}\n        classes={{root: classes.inputSelect}}\n        options={HEADERS_KEYS}\n      />\n      <ArrowRightAlt className={classes.icon} />\n      <SelectionField\n        name=\"name\"\n        title=\"Value\"\n        placeholder=\"Value\"\n        optionLabelKey=\"name\"\n        value={{name: header.wsValue}}\n        onChange={(e) =>\n          handleChange({...header, wsValue: e?.name ? e.name : e}, id)\n        }\n        classes={{root: classes.inputSelect}}\n        options={HEADERS_VALUES}\n      />\n      <Delete onClick={() => handleDelete(id)} className={classes.delete} />\n    </div>\n  );\n}\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nexport const headerSlice = createSlice({\n  name: \"counter\",\n  initialState: {\n    headers: [],\n  },\n  reducers: {\n    updateHeader: (state, action) => {\n      state.headers = action.payload;\n    },\n    addHeader: (state, action) => {\n      state.modelHeaders.push({\n        ...action.payload,\n        headers: [{ wsKey: \"\", wsValue: \"\" }],\n      });\n    },\n    deleteHeader: (state, action) => {\n      state.headers = state.headers.filter(\n        (header) => header.id !== action.payload\n      );\n    },\n  },\n});\n\n// Action creators are generated for each case reducer function\nexport const { updateHeader, addHeader, deleteHeader } = headerSlice.actions;\nconst headerReducer = headerSlice.reducer;\nexport default headerReducer;\n","import React, { useEffect } from \"react\";\nimport {\n  Button,\n  Paper,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n} from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Header from \"./components/Header\";\nimport { Add } from \"@material-ui/icons\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { updateHeader } from \"./features/headerReducer\";\nconst useStyles = makeStyles((theme) => ({\n  dialogTitle: {\n    color: \"#0274d7\",\n    paddingLeft: 0,\n    paddingRight: 3,\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    \"& #simple-dialog-title\": {\n      cursor: \"pointer\",\n    },\n  },\n  dialog: {\n    width: '20%'\n  },\n  paper: {\n    margin: \"1%\",\n    padding: 15,\n    width: `calc(95%)`,\n    display: \"flex\",\n    flexDirection: \"column\",\n    height: \"calc(85% - 50px)\",\n    overflow: \"hidden\",\n  },\n  save: {\n    margin: 10,\n    backgroundColor: \"#0275d8\",\n    borderColor: \"#0267bf\",\n    color: \"white\",\n    \"&:hover\": {\n      backgroundColor: \"#025aa5\",\n      borderColor: \"#014682\",\n      color: \"white\",\n    },\n  },\n  dialogPaper: {\n    maxWidth: \"70%\",\n    maxHeight: \"50%\",\n    resize: \"both\",\n    width: \"70%\",\n    height: \"90%\",\n  },\n  root: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-start\",\n    height: \"100%\",\n    overflow: \"hidden\",\n  },\n  line: {\n    width: \"10%\",\n  },\n  addHeader: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    width: \"100%\",\n    height: \"80%\"\n  },\n  buttons: {\n    marginTop: \"auto\",\n  },\n  scrollDiv: {\n    overflow: \"auto\",\n    height: \"100%\"\n  },\n}));\n\nfunction HeaderBuilder({ handleClose, open, action }) {\n  const classes = useStyles();\n  const [alertConfig, setAlertConfig] = React.useState({\n    openAlert: false,\n    alertMessage: \"Add all values\",\n    alertTitle: \"Error\",\n  });\n  const headersFromStore = useSelector((state) => state.headerReducer.headers);\n  const [headers, setHeaders] = React.useState([]);\n  const dispatch = useDispatch();\n  const handleSave = () => {\n    if (!isAllFields()) setAlertConfig({ ...alertConfig, openAlert: true });\n    else {\n      dispatch(\n        updateHeader(\n          action === \"EDIT\" ? headers : [...headersFromStore, ...headers]\n        )\n      );\n      handleClose();\n    }\n  };\n  const onCancel = () => {\n    handleClose();\n  };\n  const isAllFields = () => {\n    var empty = true;\n    headers.forEach((header) => {\n      if (header.wsKey.length === 0 || header.wsValue.length === 0) {\n        empty = false;\n        return;\n      }\n    });\n    return empty;\n  };\n\n  const handelAddHeader = () => {\n    setHeaders([...headers, { wsKey: \"\", wsValue: \"\" }]);\n  };\n  const handelDeleteHeader = (id) => {\n    let newHeaders = [...headers];\n    newHeaders.splice(id, id);\n    setHeaders(newHeaders);\n  };\n  const handleChange = (header, id) => {\n    let newHeaders = [...headers];\n    newHeaders[id] = header;\n    setHeaders(newHeaders);\n  };\n  useEffect(() => {\n    if (headersFromStore.length === 0) {\n      setHeaders([{ wsKey: \"\", wsValue: \"\" }]);\n    } else if (action === \"ADD\") {\n      setHeaders([{ wsKey: \"\", wsValue: \"\" }]);\n    } else {\n      setHeaders(headersFromStore);\n    }\n  }, [action, headersFromStore]);\n\n  return (\n    <Dialog\n      onClose={(e, reason) => {\n        if (reason !== \"backdropClick\") {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Build Headers</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div className={classes.addHeader}>\n            <div className={classes.scrollDiv}>\n              {headers.map((header, index) => {\n                return (\n                  <Header\n                    handleChange={handleChange}\n                    key={index}\n                    id={index}\n                    handleDelete={handelDeleteHeader}\n                    header={{ ...header }}\n                  />\n                );\n              })}\n            </div>\n          </div>\n          <div className={classes.dialogTitle}>\n            <DialogTitle\n              id=\"simple-dialog-title\"\n              className={classes.dialogTitle}\n              onClick={() => handelAddHeader()}\n            >\n              Add Header\n            </DialogTitle>\n            <Add />\n          </div>\n        </Paper>\n        <div className={classes.buttons}>\n          <Button className={classes.save} onClick={handleSave}>\n            OK\n          </Button>\n          <Button\n            className={classes.save}\n            onClick={onCancel}\n            style={{ textTransform: \"none\" }}\n          >\n            Cancel\n          </Button>\n        </div>\n      </div>\n      {alertConfig.openAlert && (\n        <Dialog\n          open={alertConfig.openAlert}\n          onClose={(e, reason) => {\n            if (reason !== \"backdropClick\") {\n              setAlertConfig({ ...alertConfig, openAlert: false });\n            }\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n          classes={{\n            paper: classes.dialog,\n          }}\n        >\n          <DialogTitle id=\"alert-dialog-title\">\n            {alertConfig.alertTitle}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {alertConfig.alertMessage}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setAlertConfig({ ...alertConfig, openAlert: false });\n                if (!open) {\n                  handleClose();\n                }\n              }}\n              color=\"primary\"\n              autoFocus\n              className={classes.save}\n            >\n              Ok\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Dialog>\n  );\n}\n\nexport default HeaderBuilder;\n","import React, {useEffect, useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {\n  Checkbox,\n  DialogTitle,\n  FormControlLabel,\n  TextField,\n} from '@material-ui/core';\nimport {Add, ArrowRightAlt, Clear, Delete, Edit} from '@material-ui/icons';\nimport {SelectionField} from '../../components';\nimport PayloadBuilder from '../payload-builder';\nimport {TransformationBuilder} from '../../transformation-builder/index';\n\nconst useStyles = makeStyles({\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  textField: {\n    justifyContent: 'center',\n    marginBottom: 11,\n    width: '20%',\n  },\n  Checkbox: {\n    width: '10%',\n    color: '#0274d7',\n    marginLeft: 'auto',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'fontSize': 15,\n    'alignItems': 'center',\n    'width': '20%',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n      width: 'auto',\n    },\n    '& .MuiTypography-h6': {\n      fontSize: '0.8em',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    marginTop: 20,\n    marginBottom: 20,\n    fontSize: 30,\n  },\n  delete: {\n    color: '#0274d7',\n    margin: 'auto',\n    fontSize: 25,\n  },\n  fieldSelect: {\n    width: '22%',\n  },\n  paper: {\n    margin: 10,\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  dialogPaper: {\n    maxWidth: '50%',\n    maxHeight: '40%',\n    resize: 'both',\n    width: '50%',\n    height: '40%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n});\n\nexport default function Payload({\n  deletePayload,\n  correspondingFields,\n  handleChange,\n  payload,\n  id,\n}) {\n  const classes = useStyles();\n  const [showTransformation, setShowTransformation] = useState(false);\n  const [payload_, setPayload] = useState(payload);\n  const [embedded, setShowEmbeeded] = useState(false);\n  useEffect(() => {\n    setPayload(payload);\n  }, [payload]);\n\n  const closeEmbedded = () => {\n    setShowEmbeeded(false);\n  };\n\n  const handleSaveEmbedded = (e) => {\n    setPayload({...payload_, wsValue: e});\n    handleChange({...payload_, wsValue: e}, id);\n  };\n\n  return (\n    <>\n      <div className={classes.modelParams}>\n        {embedded && (\n          <PayloadBuilder\n            handleClose={closeEmbedded}\n            open={embedded}\n            onSave={(e) => handleSaveEmbedded(e)}\n            initialData={\n              Array.isArray(payload.wsValue) && payload_?.wsValue ?\n                payload_?.wsValue :\n                []\n            }\n            action={'EDIT'}\n          />\n        )}\n        <TextField\n          value={payload_?.wsKey}\n          InputLabelProps=\"Payload\"\n          onChange={(e) => {\n            setPayload({...payload_, wsKey: e.target.value});\n          }}\n          onBlur={(e) =>\n            handleChange({...payload_, wsKey: e.target.value}, id)\n          }\n          className={classes.textField}\n          placeholder=\"Payalod key\"\n        />\n        <ArrowRightAlt className={classes.icon} style={{width: '7%'}} />\n        {correspondingFields && !payload_?.isList && (\n          <SelectionField\n            name=\"name\"\n            title=\"Corresponding field\"\n            placeholder=\"Model\"\n            value={payload_?.wsValue}\n            optionLabelKey=\"name\"\n            options={correspondingFields}\n            onChange={(e) => {\n              handleChange({...payload_, wsValue: e}, id);\n              setPayload({...payload_, wsValue: e});\n            }}\n            className={classes.fieldSelect}\n          />\n        )}\n        {payload_?.isList && (\n          <div className={classes.dialogTitle}>\n            <>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                onClick={() => setShowEmbeeded(true)}\n                className={classes.dialogTitle}\n              >\n                Add embedded payloads\n              </DialogTitle>\n              {payload_?.wsValue == null ||\n              payload_?.wsValue?.length === 0 ||\n              !Array.isArray(payload_?.wsValue) ? (\n                <Add />\n              ) : (\n                <Edit />\n              )}\n            </>\n          </div>\n        )}\n        {!correspondingFields && !payload_.isList && (\n          <TextField\n            value={payload_?.wsValue}\n            InputLabelProps=\"Payload\"\n            onChange={(e) => {\n              setPayload({...payload_, wsValue: e.target.value});\n            }}\n            onBlur={(e) =>\n              handleChange({...payload_, wsValue: e.target.value}, id)\n            }\n            className={classes.textField}\n            placeholder=\"Payalod value\"\n          />\n        )}\n        {!payload_?.isList && (\n          <ArrowRightAlt className={classes.icon} style={{width: '7%'}} />\n        )}\n        <div className={classes.dialogTitle}>\n          {(payload_?.transformations == null ||\n            payload_?.transformations?.length === 0) &&\n            !payload_?.isList && (\n            <>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                onClick={() => setShowTransformation(true)}\n                className={classes.dialogTitle}\n              >\n                  Add data transformation\n              </DialogTitle>\n              <Add style={{width: '10%'}} />\n            </>\n          )}\n          {payload_?.transformations &&\n            payload_?.transformations?.length !== 0 && (\n            <>\n              <DialogTitle\n                id=\"simple-dialog-title\"\n                className={classes.dialogTitle}\n                onClick={() => setShowTransformation(true)}\n              >\n                  Transformations\n              </DialogTitle>\n              <Edit />\n            </>\n          )}\n        </div>\n        <FormControlLabel\n          className={classes.Checkbox}\n          control={\n            <Checkbox\n              style={{color:\"#0274d7\"}}\n              onClick={() => {\n                handleChange({...payload_, isList: !payload_?.isList}, id);\n                setPayload({...payload_, isList: !payload_?.isList});\n              }}\n              checked={payload_?.isList}\n            />\n          }\n          label=\"List\"\n        />\n        <Clear onClick={() => deletePayload(id)} className={classes.delete} />\n      </div>\n      {showTransformation && (\n        <TransformationBuilder\n          open={showTransformation}\n          handleClose={() => setShowTransformation(false)}\n          action={true}\n          onSave={(trans) => {\n            handleChange({...payload_, transformations: trans}, id);\n            setPayload({...payload_, transformations: trans}, id);\n          }}\n          initialData={payload?.transformations}\n        />\n      )}\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport { DialogTitle, Paper, TextField } from '@material-ui/core';\nimport { Add, Delete } from '@material-ui/icons';\nimport Line from '../../components/Line';\nimport { getModels } from '../../../services/api';\nimport { Selection } from '../../components';\nimport Payload from './Payload';\n\nconst useStyles = makeStyles({\n  modelPayload: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n  },\n  paperParams: {\n    marginTop: 10,\n    resize: 'both',\n    width: '100%',\n    marginRight: 10,\n  },\n  textField: {\n    justifyContent: 'center',\n    marginBottom: 11,\n    width: '47%',\n  },\n  inputSelect: {\n    marginLeft: '2%',\n    marginRight: '2%',\n    width: '95%',\n    marginBottom: 10,\n  },\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n  block: {\n    width: '100%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n    '& .MuiTypography-h6': {\n      fontSize: '0.9em',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    margin: 20,\n    fontSize: 30,\n  },\n});\n\nexport default function ModelPayload({\n  handleChangePayload,\n  deleteModelPayload,\n  modelPayload,\n  addPayload,\n  id,\n}) {\n  const classes = useStyles();\n  const [metaModal, setMetaModal] = useState(modelPayload?.model);\n\n  const handelAddPayload = () => {\n    const newModelPayload = Object.assign(\n      {},\n      { ...modelPayload, model: metaModal },\n    );\n    const payloads = Object.assign([], newModelPayload.payloads);\n    payloads.push({ wsKey: null, wsValue: null, isList: false, type: 'Basic' });\n    handleChangePayload(\n      { ...modelPayload, model: metaModal, payloads: payloads },\n      id,\n    );\n  };\n  const handelAddEmbeddedPayload = () => {\n    const newModelPayload = Object.assign(\n      {},\n      { ...modelPayload, model: metaModal },\n    );\n    const payloads = Object.assign([], newModelPayload.payloads);\n    payloads.push({\n      wsKey: null,\n      model: {},\n      type: 'Embedded',\n      payloads: [{ wsKey: null, wsValue: null, isList: false, type: 'Basic' }],\n    });\n    handleChangePayload(\n      { ...modelPayload, model: metaModal, payloads: payloads },\n      id,\n    );\n  };\n\n  const handlePayloadChange = (payload, idPayload) => {\n    const newModelPayload = Object.assign(\n      {},\n      { ...modelPayload, model: metaModal },\n    );\n    const payloads = Object.assign([], newModelPayload.payloads);\n    payloads[idPayload] = payload;\n    handleChangePayload(\n      { ...modelPayload, model: metaModal, payloads: payloads },\n      id,\n    );\n  };\n\n  const handleEmbeddedPayloadChange = (emPayload, idPayload) => {\n    const newModelPayload = Object.assign(\n      {},\n      { ...modelPayload, model: metaModal },\n    );\n    const payloads = Object.assign([], newModelPayload.payloads);\n    payloads[idPayload] = emPayload;\n    handleChangePayload(\n      { ...modelPayload, model: metaModal, payloads: payloads },\n      id,\n    );\n  };\n  const resetCorrespondingFields = (e) => {\n    const newModelPayload = Object.assign(\n      {},\n      { ...modelPayload, model: metaModal },\n    );\n    const payloads = Object.assign([], newModelPayload.payloads);\n    payloads.forEach(payload => {\n      if (payload?.wsValue?.name) payload.wsValue = null\n    });\n    handleChangePayload(\n      { ...modelPayload, model: e, payloads: payloads },\n      id,\n    );\n  }\n\n  const handleDelete = (idPay) => {\n    let newModelPayload = [...modelPayload.payloads];\n    newModelPayload = newModelPayload.filter((pay, index) => index !== idPay);\n    handleChangePayload({ ...modelPayload, payloads: newModelPayload }, id);\n  };\n  async function fetchModels() {\n    return getModels();\n  }\n\n  return (\n    <div className={classes.modelPayload}>\n      <Paper variant=\"outlined\" className={classes.paperParams}>\n        <div style={{ display: \"flex\", flexDirection: 'row', alignItems: 'center' }}>\n          <Selection\n            name=\"metaModal\"\n            title=\"Model\"\n            placeholder=\"meta modal\"\n            fetchAPI={fetchModels}\n            optionLabelKey=\"name\"\n            onChange={(e) => {\n              setMetaModal(e);\n              resetCorrespondingFields(e);\n            }}\n            value={metaModal}\n            classes={{ root: classes.inputSelect }}\n          />\n        </div>\n        <div className={classes.modelParams}>\n          <Line className={classes.line} />\n          <div className={classes.block}>\n            <div>\n              {modelPayload?.payloads?.map((payload, index) => {\n                if (!payload.payloads) {\n                  return (\n                    <Payload\n                      handleChange={handlePayloadChange}\n                      key={index}\n                      correspondingFields={metaModal?.type === \"metaModel\" ? metaModal?.metaFields : (metaModal?.type === \"metaJsonModel\" ? metaModal?.fields : metaModal?.fields )}\n                      deletePayload={handleDelete}\n                      payload={payload}\n                      id={index}\n                    />\n                  );\n                } else {\n                  return (\n                    <>\n                      <TextField\n                        InputLabelProps=\"Payload\"\n                        className={classes.textField}\n                        placeholder=\"Key\"\n                        value={payload.wsKey}\n                        onChange={(e) =>\n                          handleEmbeddedPayloadChange(\n                            { ...payload, wsKey: e.target.value },\n                            index,\n                          )\n                        }\n                      />\n                      <ModelPayload\n                        key={index}\n                        addPayload={addPayload}\n                        modelPayload={payload}\n                        id={index}\n                        handleChangePayload={handleEmbeddedPayloadChange}\n                        deleteModelPayload={handleDelete}\n                      />\n                    </>\n                  );\n                }\n              })}\n            </div>\n            <div className={classes.dialogTitle} style={{ marginTop: 20 }}>\n              <div\n                style={{\n                  display: 'flex',\n                  flexDirection: 'row',\n                  alignItems: 'center',\n                  marginRight: 20,\n                }}\n              >\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  onClick={() => handelAddPayload()}\n                  className={classes.dialogTitle}\n                >\n                  Add payload\n                </DialogTitle>\n                <Add />\n              </div>\n              <div\n                style={{\n                  display: 'flex',\n                  flexDirection: 'row',\n                  alignItems: 'center',\n                  marginRight: 20,\n                }}\n              >\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  onClick={() => handelAddEmbeddedPayload()}\n                  className={classes.dialogTitle}\n                >\n                  Add embedded payload\n                </DialogTitle>\n                <Add />\n              </div>\n            </div>\n          </div>\n        </div>\n      </Paper>\n      <Delete onClick={() => deleteModelPayload(id)} className={classes.icon} />\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport {\n  Button,\n  Paper,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Add } from '@material-ui/icons';\nimport Line from '../components/Line';\nimport ModelPayload from './components/ModelPayload';\nimport { useDispatch, useSelector } from 'react-redux';\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    margin: theme.spacing(1),\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  dialog:{\n    width:'20%'\n  },\n  dialogPaper: {\n    maxWidth: '70%',\n    maxHeight: '80%',\n    resize: 'both',\n    width: '70%',\n    height: '90%',\n    minWidth:950\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': theme.spacing(1),\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '90%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  scrollDiv: {\n    overflow: 'auto',\n    height: 550,\n  },\n}));\n\nfunction PayloadBuilder({\n  onSave,\n  initialData,\n  handleClose,\n  open,\n  action,\n}) {\n  const classes = useStyles();\n  const [modelPayloads, setModelPayloads] = useState([]);\n  const [alertConfig, setAlertConfig] = React.useState({\n    openAlert:false,\n    alertMessage: 'Add all values',\n    alertTitle: 'Error',\n  });\n  const [queryBuilder, setQueryBuilder] = useState(false);\n  const dispatch = useDispatch();\n  const queryCriteria = useSelector((state) => state.payloadReducer.queryCriteria);\n  const handleSave = () => {\n    if (!isAllFields()) setAlertConfig({...alertConfig,openAlert:true});\n    else {\n      onSave(modelPayloads);\n      handleClose();\n    }\n  };\n\n  const isAllFields = () => {\n    let empty = true;\n    modelPayloads.forEach((model) => {\n      model.payloads.forEach((payload) => {\n        if ((payload?.wsKey?.length === 0  || payload?.wsKey === null ) && (payload?.wsValue || payload?.wsValue) === null) {\n          empty = false;\n          return;\n        }\n      });\n    });\n    return empty;\n  };\n\n  const onCancel = () => {\n    handleClose();\n  };\n\n  const handelAddModelPayload = () => {\n    setModelPayloads([\n      ...modelPayloads,\n      {\n        model: {},\n        payloads: [\n          {\n            wsKey: null,\n            wsValue: null,\n            isList: false,\n            subKeyValues: [],\n            type: 'Basic',\n          },\n        ],\n      },\n    ]);\n  };\n  const handelDeleteModelPayload = (id) => {\n    const newModelPayload = modelPayloads.filter(\n      (modelPayload, index) => index !== id,\n    );\n    setModelPayloads(newModelPayload);\n  };\n  const addPayload = (id, payload) => {\n    const newModelPayload = Object.assign([], modelPayloads);\n    const b = Object.assign([], newModelPayload[id].payloads);\n    b.push(payload);\n    newModelPayload[id] = { ...newModelPayload[id], payloads: b };\n    setModelPayloads(newModelPayload);\n  };\n  const addEmbeededPayload = (id, payload) => {\n    const newModelPayload = Object.assign([], modelPayloads);\n    const b = Object.assign([], newModelPayload[id].payloads);\n    b.push(payload);\n    newModelPayload[id] = { ...newModelPayload[id], payloads: b };\n    setModelPayloads(newModelPayload);\n  };\n  const handleChangeModelPayload = (modelPayload, id) => {\n    const newModelParam = [...modelPayloads];\n    newModelParam[id] = modelPayload;\n    setModelPayloads(newModelParam);\n  };\n  useEffect(() => {\n    if (action === 'EDIT') {\n      if (initialData?.length === 0) {\n        setModelPayloads([\n          {\n            model: {},\n            payloads: [\n              { wsKey: null, wsValue: null, isList: false, type: 'Basic' },\n            ],\n          },\n        ]);\n      } else setModelPayloads(initialData);\n    } else {\n      setModelPayloads([\n        {\n          model: {},\n          payloads: [\n            { wsKey: null, wsValue: null, isList: false, type: 'Basic' },\n          ],\n        },\n      ]);\n    }\n  }, [action, initialData]);\n\n  return (\n    <Dialog\n      onClose={(e, reason) => {\n        if (reason !== 'backdropClick') {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Build payloads</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div className={classes.baseModelParams}>\n            <Line className={classes.line}></Line>\n            <div className={classes.addBaseModelParams}>\n              <div className={classes.dialogTitle}>\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  className={classes.dialogTitle}\n                  onClick={handelAddModelPayload}\n                >\n                  Add base model Payloads\n                </DialogTitle>\n                <Add />\n              </div>\n              <div className={classes.scrollDiv}>\n                {modelPayloads?.map((modelPayload, index) => {\n                  return (\n                    <ModelPayload\n                      handleChangePayload={handleChangeModelPayload}\n                      addEmbeededPayload={addEmbeededPayload}\n                      key={index}\n                      addPayload={addPayload}\n                      modelPayload={modelPayload}\n                      deleteModelPayload={handelDeleteModelPayload}\n                      id={index}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </Paper>\n        <div>\n          <Button className={classes.save} onClick={handleSave}>\n            OK\n          </Button>\n          <Button\n            className={classes.save}\n            onClick={onCancel}\n            style={{ textTransform: 'none' }}\n          >\n            Cancel\n          </Button>\n        </div>\n      </div>\n      {alertConfig.openAlert && (\n        <Dialog\n          open={alertConfig.openAlert}\n          onClose={(e, reason) => {\n            if (reason !== 'backdropClick') {\n              setAlertConfig({...alertConfig,openAlert:false});\n            }\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n          classes={{\n            paper: classes.dialog,\n          }}\n        >\n          <DialogTitle id=\"alert-dialog-title\">\n            {alertConfig.alertTitle}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {alertConfig.alertMessage}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setAlertConfig({...alertConfig,openAlert:false});\n              }}\n              color=\"primary\"\n              autoFocus\n              className={classes.save}\n            >\n              Ok\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Dialog>\n  );\n}\n\nexport default PayloadBuilder;\n","import {createSlice} from '@reduxjs/toolkit';\n\nexport const payloadSlice = createSlice({\n  name: 'counter',\n  initialState: {\n    modelPayloads: [],\n    queryCriteria:{}\n  },\n  reducers: {\n    updateModelPayload: (state, action) => {\n      state.modelPayloads = action.payload;\n    },\n    addModelPayload: (state, action) => {\n      state.modelPayloads.push({\n        ...action.payload,\n        payloads: [\n          {\n            id: 1,\n            wsKey: '',\n            wsValue: '',\n            isList: false,\n            subKeyValues: [],\n            type: 'Basic',\n          },\n        ],\n      });\n    },\n    deleteModelPayload: (state, action) => {\n      state.modelPayloads = state.modelPayloads.filter(\n          (modelPayload) => modelPayload.id !== action.payload,\n      );\n    },\n    updateCriteria: (state, action) => {\n      state.queryCriteria = action.payload;\n    },\n  },\n});\nexport const {updateModelPayload, addModelPayload, deleteModelPayload,updateCriteria} =\n  payloadSlice.actions;\nconst payloadReducer = payloadSlice.reducer;\nexport default payloadReducer;\n","import React, {useEffect, useState} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {Add, Edit} from '@material-ui/icons';\nimport CustomizedTables from '../components/Table';\nimport RequestBuilder from '../request-builder/request-builder';\nimport HeaderBuilder from '../header-builder/header-builder';\nimport PayloadBuilder from '../payloads-builder/payload-builder';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {updateModelPayload} from '../payloads-builder/features/payloadReducer';\n\nconst useStyles = makeStyles({\n  root: {\n    marginTop: 5,\n    width: '100%',\n  },\n  error: {\n    color: '#CC3333',\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: '#666',\n    marginBottom: 3,\n  },\n  containerTable: {\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  newIcon: {\n    color: '#58B423',\n    marginLeft: 5,\n  },\n  empty: {\n    backgroundColor: 'white',\n    border: '1px solid #CCCCCC',\n    height: '200px',\n    width: '100%',\n  },\n});\n\nexport default function Expression({element, entry}) {\n  const {label} = entry || {};\n  const classes = useStyles();\n  const modelParameters = useSelector(\n      (state) => state.requestReducer.modelParameters,\n  );\n  const modelPayloads = useSelector(\n      (state) => state.payloadReducer.modelPayloads,\n  );\n  const headers = useSelector((state) => state.headerReducer.headers);\n  const [models, setModels] = useState([]);\n  const [builder, setBuilder] = useState('');\n  const [openMapper, setMapper] = useState(false);\n  const [action, setAction] = useState();\n  const dispatch = useDispatch();\n  const handleCloseMapper = () => {\n    setMapper(false);\n  };\n\n  const handleSave = (models) => {\n    dispatch(\n        updateModelPayload(\n        action === 'EDIT' ? models : [...modelPayloads, ...models],\n        ),\n    );\n  };\n  useEffect(() => {\n    if (element?.parent?.children[0].id === element?.id) {\n      setBuilder('REQUEST');\n      setModels(modelParameters);\n    } else if (element?.parent?.children[1].id === element?.id) {\n      setBuilder('HEADER');\n      setModels(headers);\n    } else if (element?.parent?.children[2].id === element?.id) {\n      setBuilder('PAYLOAD');\n      setModels(modelPayloads);\n    }\n  }, [element, builder, modelParameters, modelPayloads, headers]);\n\n  const requestType = () => {\n    if (builder === 'REQUEST') {\n      return (\n        <RequestBuilder\n          open={openMapper}\n          handleClose={handleCloseMapper}\n          action={action}\n        />\n      );\n    } else if (builder === 'HEADER') {\n      return (\n        <HeaderBuilder\n          open={openMapper}\n          handleClose={handleCloseMapper}\n          action={action}\n        />\n      );\n    } else if (builder === 'PAYLOAD') {\n      return (\n        <PayloadBuilder\n          open={openMapper}\n          handleClose={handleCloseMapper}\n          action={action}\n          onSave={handleSave}\n          initialData={modelPayloads}\n        />\n      );\n    } else return '';\n  };\n  return (\n    <div className={classnames(classes.root, false && classes.error)}>\n      {label && <label className={classnames(classes.label)}>{label}</label>}\n      <div className={classnames(classes.containerTable)}>\n        {models.length === 0 ? (\n          <div className={classes.empty}></div>\n        ) : (\n          <CustomizedTables\n            type={\n              builder === 'REQUEST' ?\n                'parameters' :\n                builder === 'PAYLOAD' ?\n                'payloads' :\n                'headers'\n            }\n          />\n        )}\n        <Edit\n          className={classes.newIcon}\n          onClick={() => {\n            setMapper(true);\n            setAction('EDIT');\n          }}\n        />\n        <Add\n          className={classes.newIcon}\n          onClick={() => {\n            setMapper(true);\n            setAction('ADD');\n          }}\n        />\n        {openMapper && requestType()}\n      </div>\n    </div>\n  );\n}\n","import React, {useEffect} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport Checkbox from './Checkbox';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    marginTop: 5,\n  },\n  label: {\n    fontWeight: \"bolder\",\n    color: \"#666\",\n  },\n  checkbox: {\n    margin: '3px 3px 3px 0px',\n  },\n});\n\nexport default function Checkboxs({entry, element, className, onChange}) {\n  const classes = useStyles();\n  const {boxs, label} = entry || {};\n\n  useEffect(() => {}, [element.businessObject]);\n\n  return (\n    <div className={classnames(classes.root, className)}>\n      <label className={classnames(classes.label)}>{label}</label>\n      {boxs &&\n        boxs.map((option, index) => {\n          return (\n            <Checkbox\n              key={index}\n              entry={option}\n              element={element}\n              onChange={onChange}\n            />\n          );\n        })}\n    </div>\n  );\n}\n","import {createSlice} from '@reduxjs/toolkit';\n\nexport const contextSlice = createSlice({\n  name: 'terget',\n  initialState: {\n    targets: [],\n  },\n  reducers: {\n    updateTarget: (state, action) => {\n      state.targets = action.payload;\n    },\n    addTarget: (state) => {\n      state.targets.push({model: null, target: null});\n    },\n    deleteTarget: (state, action) => {\n      state.targets = state.targets.filter(\n          (target) => target.id !== action.payload,\n      );\n    },\n  },\n});\n\n// Action creators are generated for each case reducer function\nexport const {updateTarget, addTarget, deleteTarget} = contextSlice.actions;\nconst contextReducer = contextSlice.reducer;\nexport default contextReducer;\n","import {configureStore} from '@reduxjs/toolkit';\nimport requestReducer from './request-builder/features/requestReducer';\nimport payloadReducer from './payloads-builder/features/payloadReducer';\nimport headerReducer from './header-builder/features/headerReducer';\nimport contextReducer from './context-builder/features/contextReducer';\n\nexport const store = configureStore({\n  reducer: {\n    requestReducer,\n    payloadReducer,\n    headerReducer,\n    contextReducer,\n  },\n});\n","import {getAllRequest, getApps} from '../services/api';\n\nexport const tabPropertyAuth = [\n  {\n    type: 'bpmn:Task',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textField'},\n      {\n        name: 'authRequest',\n        isAttr: true,\n        label: 'Auth request',\n        widget: 'many-to-one',\n        onchange:false,\n        fetchMethod: () => getAllRequest(),\n      },\n    ],\n  },\n  {\n    type: 'bpmn:Process-action',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textField'},\n      {name: 'studioApp', label: 'App', widget: 'many-to-one', edit:false , onchange:false ,fetchMethod: () => getApps()},\n      {\n        name: 'type',\n        label: 'Auth Type',\n        widget: 'selectBox',\n        emptyParameter: false,\n        selectOptions: [\n          {name: 'Basic', default: 'basic', value: 'basic'},\n          {name: 'Qauth 2', default: 'ouath2', value: 'oauth2'},\n        ],\n      },\n      {\n        name: 'isAuthenticated',\n        label: '',\n        widget: 'authentificationAction',\n      },\n    ],\n  },\n  {\n    type: 'label',\n    properties: [{name: 'name', label: 'Name', widget: 'textBox'}],\n  },\n  {\n    type: 'bpmn:SequenceFlow',\n    properties: [{name: 'name', label: 'Name', widget: 'textBox'}],\n  },\n];\n","import {getAllAuthentication, getAllRequest, getApps} from '../services/api';\nexport const tabPropertyConnector = [\n  {\n    type: 'bpmn:Process-action',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textField'},\n      {name: 'app', label: 'App', widget: 'many-to-one', edit:false , onchange:false ,fetchMethod: () => getApps()},\n      {name: 'baseUrl', label: 'Base Url', widget: 'textField'},\n      {\n        name: 'defaultWsAuthenticator',\n        isAttr: true,\n        label: 'Authentification to use',\n        widget: 'many-to-one',\n        fetchMethod: () => getAllAuthentication(),\n      },\n    ],\n  },\n  {\n    type: 'bpmn:Query',\n    properties: [\n      {name: 'name', label: 'Name', widget: 'textBox'},\n      {name: 'target', label: 'Var', widget: 'textField'},\n      {\n        name: 'extendedQueryProperties',\n        label: '',\n        widget: 'extendedQueryProperties',\n      },\n      {\n        name: 'returnType',\n        label: 'Return type',\n        widget: 'selectBox',\n        emptyParameter: true,\n        selectOptions: [\n          {name: 'Map', value: 'MAP'},\n          {name: 'Single', value: 'SINGLE'},\n          {name: 'Multiple', value: 'MULTIPLE'},\n        ],\n      },\n    ],\n  },\n  {\n    type: 'bpmn:Mapper',\n    properties: [\n      {\n        name: 'authRequest',\n        isAttr: true,\n        label: 'Request',\n        widget: 'many-to-one',\n        fetchMethod: () => getAllRequest(),\n      },\n      {name: 'name', label: 'Name', widget: 'textField', readOnly: true},\n      {\n        name: 'requestTypeSelect',\n        label: 'Type',\n        widget: 'selectBox',\n        canBeDisabled: true,\n        emptyParameter: true,\n        selectOptions: [\n          {name: 'Post', default: 'Post', value: 'POST'},\n          {name: 'Get', value: 'GET'},\n          {name: 'Put', value: 'PUT'},\n        ],\n      },\n      {name: 'test', label: '', widget: 'testConnector'},\n    ],\n  },\n  {\n    type: 'label',\n    properties: [{name: 'name', label: 'Name', widget: 'textBox'}],\n  },\n  {\n    type: 'bpmn:SequenceFlow',\n    properties: [{name: 'name', label: 'Name', widget: 'textBox'}],\n  },\n];\n","import React from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {Add, Edit} from '@material-ui/icons';\nimport {TextField} from '../components';\n\nconst useStyles = makeStyles({\n  root: {\n    marginTop: 5,\n    width: '100%',\n  },\n  error: {\n    color: '#CC3333',\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: 'white',\n    marginBottom: 3,\n  },\n  containerTable: {\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  newIcon: {\n    color: '#58B423',\n    marginLeft: 5,\n  },\n});\n\nexport default function AuthentificationField({element, entry}) {\n  const {label} = entry || {};\n  const classes = useStyles();\n\n  return (\n    <div className={classnames(classes.root, false && classes.error)}>\n      {label && <label className={classnames(classes.label)}>{label}</label>}\n      <div className={classnames(classes.containerTable)}>\n        <TextField />\n        <Edit className={classes.newIcon} />\n        <Add className={classes.newIcon} />\n      </div>\n    </div>\n  );\n}\n","import React, {useEffect, useState} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {Button} from '@material-ui/core';\nimport {PlayArrow, RotateLeft} from '@material-ui/icons';\nimport {runTestConnector} from '../../services/api';\nimport {useSelector} from 'react-redux';\n\nconst useStyles = makeStyles({\n  desciption: {\n    marginTop: 5,\n    minHeight: '400px',\n    backgroundColor: '#656565',\n    borderRadius: '15px',\n  },\n  title: {\n    backgroundColor: '#424242',\n    color: 'white',\n    padding: '7px',\n    borderTopRightRadius: '10px',\n    borderTopLeftRadius: '10px',\n  },\n  testArea: {},\n  success: {\n    backgroundColor: 'white',\n    color: 'green',\n    padding: 5,\n    margin: 15,\n  },\n  error: {\n    backgroundColor: 'white',\n    color: 'red',\n    padding: 5,\n    margin: 15,\n  },\n  console: {\n    'color': 'white',\n    'borderRadius': 20,\n    'margin': 15,\n    'minHeight': '40%',\n    'fontWeight': 'bold !important',\n    '& .json-formatter-key': {\n      color: '#EBC456 !important',\n      marginRight: 5,\n    },\n    '& .json-formatter-string': {\n      color: 'white !important',\n      // display:'none'\n      width: '100%',\n      display: 'block',\n    },\n    '& .json-formatter-boolean': {\n      color: 'white !important',\n    },\n    '& .json-formatter-number': {\n      color: 'white !important',\n    },\n    '& .json-formatter-function': {\n      color: 'white !important',\n    },\n    '& .json-formatter-row': {\n      marginBottom: 8,\n    },\n  },\n  buttons: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  btn: {\n    'display': 'flex',\n    'flexDirection': 'column',\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    'alignItems': 'center',\n    'lineHeight': 0,\n    'justifyContent': 'center',\n    'textTransform': 'none',\n    'textDecoration': 'none',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  result: {\n    padding: 10,\n    color: 'white',\n  },\n});\nconst Sucess = () => {\n  const classes = useStyles();\n  return (\n    <div className={classes.success}>Success, Your query run Successfully</div>\n  );\n};\nconst Error = () => {\n  const classes = useStyles();\n  return <div className={classes.error}>Error, Your query is incorrect</div>;\n};\n\nexport default function TestConnector({type, connector, element}) {\n  const classes = useStyles();\n  const [result, setResult] = useState({status: null, data: 'no data'});\n  const targets = useSelector((state) => state.contextReducer.targets);\n  const runTest = async () => {\n    const actionRequest = {\n      model: 'com.axelor.studio.db.WsConnector',\n      action: 'action-ws-connector-method-call-connector',\n      data: {\n        context: {\n          connector: connector,\n          authenticator: element.parent.businessObject.defaultWsAuthenticator,\n          _recordId: targets[0]?.target?.id,\n          _recordModel: targets[0]?.model?.fullName,\n        },\n      },\n    };\n    const res = await runTestConnector(actionRequest);\n    console.log(res)\n    if (res?.status === 0 && res?.data) {\n      setResult({status: true, data: res?.data[0]?.values ? res?.data[0].values : res?.data[0]});\n    } else {\n      setResult({status: false, data: res?.data instanceof Array ? res?.data[0] : res?.data});\n    }\n  };\n  const runQueryTest = () => {\n    if (targets?.length === 0) {\n      setResult({\n        status: false,\n        data: 'please provide a context to be executed !',\n      });\n    } else runTest();\n  };\n  useEffect(() => {\n    if (document.getElementById('result') != null) {\n      document.getElementById('result').innerHTML = '';\n    }\n    document.getElementById('result').innerHTML = JSON.stringify(\n      result?.data ? result?.data : \"Error while parsing result ! make sure you made the right request's specifications\", undefined, 2\n    ).replace(/\\\\n/g,'<br/>');\n  }, [result?.data]);\n\n  return (\n    <>\n      <div className={classnames(classes.desciption, type && classes.error)}>\n        <div className={classes.title}>Query Trace</div>\n        <div className={classes.testArea}>\n          {result?.status && result?.status !== null && (\n            <>\n              <Sucess />\n            </>\n          )}\n          {!result?.status && result?.status !== null && <Error />}\n          <div className={classes.console} id=\"result\"></div>\n        </div>\n      </div>\n      <div>\n        <div className={classes.buttons}>\n          {result?.status != null && (\n            <Button\n              onClick={() => {\n                setResult({status: null, data: 'no data'});\n              }}\n              className={classes.btn}\n            >\n              <RotateLeft />\n              <div>Reset</div>\n            </Button>\n          )}\n          <Button onClick={() => runQueryTest()} className={classes.btn}>\n            <PlayArrow />\n            <div>Run query test</div>\n          </Button>\n        </div>\n      </div>\n    </>\n  );\n}\n","import Service from '../../../services/Service';\n\nexport async function addRequest(criteria = {}) {\n  const res = await Service.add('com.axelor.studio.db.WsRequest', criteria);\n  if (res && !res.ok) {\n    return res;\n  }\n  const {data = []} = res || {};\n  return data;\n}\nexport async function editRequest(criteria = {}, id) {\n  const res = await Service.update(\n      'com.axelor.studio.db.WsRequest',\n      criteria,\n      id,\n  );\n  if (res && !res.ok) {\n    return res;\n  }\n  const {data = []} = res || {};\n  return data;\n}\n","import React, {useState, useEffect} from 'react';\nimport classnames from 'classnames';\nimport {makeStyles} from '@material-ui/styles';\nimport {Check, Close, Delete, Edit} from '@material-ui/icons';\nimport Description from './Description';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {updateModelPayload} from '../payloads-builder/features/payloadReducer';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    marginTop: 5,\n    width: '100%',\n  },\n  error: {\n    'borderColor': '#cc3333 !important',\n    'background': '#f0c2c2',\n    '&:focus': {\n      boxShadow: 'rgba(204,58,51, 0.2) 0px 0px 1px 2px !important',\n      outline: 'none',\n      borderColor: '#cc3333 !important',\n    },\n  },\n  label: {\n    fontWeight: 'bolder',\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    color: \"#666\",\n    marginBottom: 3,\n  },\n  fieldWrapper: {\n    position: 'relative',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'center',\n  },\n  input: {\n    'width': 'calc(100% - 35px)',\n    'padding': '3px 28px 3px 6px ',\n    'border': '1px solid #ccc',\n    '&:focus': {\n      boxShadow: 'rgba(82, 180, 21, 0.2) 0px 0px 1px 2px',\n      outline: 'none',\n      borderColor: 'rgb(82, 180, 21)',\n    },\n  },\n  clearButton: {\n    background: 'transparent',\n    border: 'none',\n    top: 0,\n    right: 0,\n    position: 'absolute',\n    height: 23,\n    width: 24,\n    overflow: 'hidden',\n    cursor: 'pointer',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  newIcon: {\n    color: '#58B423',\n    marginLeft: 5,\n  },\n  clear: {\n    fontSize: '1rem',\n  },\n  readOnly: {\n    'borderColor': '#ccc !important',\n    'background': '#E3E3E3',\n    '&:focus': {\n      boxShadow: 'none !important',\n      outline: 'none',\n      borderColor: '#ccc !important',\n    },\n  },\n});\n\nexport default function TextFieldMapper({\n  entry,\n  element,\n  canRemove = false,\n  rootClass,\n  labelClass,\n  type = 'text',\n  isLabel = true,\n  readOnly = false,\n  bpmnModeler,\n}) {\n  const classes = useStyles();\n  const {label, description, name, modelProperty, set, get} = entry || {};\n  const [value, setValue] = useState(null);\n  const [readOnlyEdit, setReadOnly] = useState(readOnly);\n  const dispatch = useDispatch();\n  const modelPayloadsStore = useSelector(\n      (state) => state.payloadReducer.modelPayloads,\n  );\n\n  const setProperty = (value) => {\n    if (!bpmnModeler) return;\n    const modeling = bpmnModeler.get('modeling');\n    modeling.updateProperties(element, {\n      [name]: value,\n    });\n\n    element[name] = value;\n    const newPayloads = [...modelPayloadsStore];\n    if (element.businessObject.name === 'Username') {\n      newPayloads[0] = {id: null, wsKey: 'username', wsValue: value};\n      dispatch(updateModelPayload(newPayloads));\n    } else if (element.businessObject.name === 'Password') {\n      newPayloads[1] = {id: null, wsKey: 'password', wsValue: value};\n      dispatch(updateModelPayload(newPayloads));\n    }\n  };\n\n  const getProperty = React.useCallback(() => {\n    return element.businessObject[name];\n  }, [element, name]);\n\n  const updateProperty = (value) => {\n    if (set) {\n      set(element, {\n        [modelProperty]: value,\n      });\n    } else {\n      setProperty(value);\n    }\n  };\n\n  const handleClear = () => {\n    setValue('');\n    updateProperty(undefined);\n  };\n\n  useEffect(() => {\n    if (!element) return;\n    let value;\n    if (get) {\n      const property = get();\n      value = property && property[modelProperty];\n    } else {\n      value = getProperty();\n    }\n    setValue(value);\n  }, [element, get, getProperty, modelProperty]);\n\n  return (\n    <div className={classnames(classes.root, rootClass)}>\n      {isLabel && (\n        <label className={classnames(classes.label, labelClass)}>{label}</label>\n      )}\n      <div className={classes.fieldWrapper}>\n        <input\n          id={`camunda-${name}_${Date()}`}\n          type={\n            element.businessObject.name === 'Password' ? 'password' : 'text'\n          }\n          readOnly={readOnlyEdit}\n          name={name}\n          value={value || ''}\n          onChange={(e) => setValue(e.target.value)}\n          className={classnames(classes.input, readOnly && classes.readOnly)}\n          onBlur={(e) => updateProperty(e.target.value)}\n        />\n        {canRemove && value && (\n          <button onClick={handleClear} className={classes.clearButton}>\n            <Close className={classes.clear} />\n          </button>\n        )}\n        {readOnlyEdit && (\n          <Edit\n            className={classes.newIcon}\n            onClick={() => setReadOnly(!readOnlyEdit)}\n          />\n        )}\n        {!readOnlyEdit && (\n          <Check\n            className={classes.newIcon}\n            onClick={() => {\n              setReadOnly(!readOnlyEdit);\n            }}\n          />\n        )}\n        <Delete className={classes.newIcon} />\n      </div>\n      {description && <Description desciption={description} />}\n    </div>\n  );\n}\n","import React, {useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {Button, Checkbox, FormControlLabel} from '@material-ui/core';\n\nconst useStyles = makeStyles({\n  desciption: {\n    marginTop: 5,\n    minHeight: '400px',\n    backgroundColor: '#656565',\n    borderRadius: '15px',\n  },\n  title: {\n    backgroundColor: '#424242',\n    color: '#676767',\n    padding: '7px',\n    borderTopRightRadius: '10px',\n    borderTopLeftRadius: '10px',\n  },\n  checkbox: {\n    'color': '#676767',\n    'fontSize': 50,\n    '&.Mui-checked': {\n      color: '#0275d8',\n    },\n    '& .MuiSvgIcon-root': {fontSize: 22},\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  success: {\n    backgroundColor: 'white',\n    color: 'green',\n    padding: 5,\n    margin: 15,\n  },\n  error: {\n    backgroundColor: 'white',\n    color: 'red',\n    padding: 5,\n    margin: 15,\n  },\n  btn: {\n    'display': 'flex',\n    'flexDirection': 'column',\n    'margin': 10,\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    'alignItems': 'center',\n    'justifyContent': 'center',\n    'textDecoration': 'none',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  formControlLabel: {\n    'marginLeft': '1%',\n    '&.MuiFormControlLabel-root': {\n      color: '#676767',\n    },\n  },\n  notAuth: {\n    color: 'red',\n  },\n});\n\nexport default function AuthentificationAction({\n  label,\n  element,\n  bpmnModeler,\n  entry,\n  action,\n}) {\n  const classes = useStyles();\n  const [error, setError] = useState(false);\n  const [isAuth, setAuth] = useState(element.businessObject.isAuthenticated);\n  const {name} = entry || {};\n\n  return (\n    <div className={classes.root}>\n      {!isAuth && (\n        <Button\n          className={classes.btn}\n          onClick={async () => {\n            const res = await action();\n            if (res === false) {\n              setError(true);\n              setTimeout(() => {\n                setError(false);\n              }, 3000);\n            } else {\n              const modeling = bpmnModeler.get('modeling');\n              modeling.updateProperties(element, {\n                [name]: true,\n              });\n              element.businessObject[name] = true;\n              setAuth(true);\n            }\n          }}\n        >\n          Authentificate\n        </Button>\n      )}\n      <FormControlLabel\n        className={classes.formControlLabel}\n        control={\n          <Checkbox\n            onClick={() => {\n              if (isAuth === true) {\n                setAuth(false);\n                element.businessObject[name] = false;\n              }\n            }}\n            className={classes.checkbox}\n          />\n        }\n        checked={isAuth}\n        label={label}\n      />\n      {error && <p className={classes.notAuth}>Not authorized</p>}\n    </div>\n  );\n}\n","import React, {useState} from 'react';\nimport {makeStyles} from '@material-ui/styles';\nimport {Paper} from '@material-ui/core';\nimport {Delete} from '@material-ui/icons';\nimport {getModels, getRecords} from '../../../services/api';\nimport { Selection } from '../../components';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n  },\n  paperParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    marginTop: 10,\n    marginRight: 10,\n    padding: 10,\n    resize: 'both',\n    width: '90%',\n  },\n  inputSelect: {\n    marginLeft: '2%',\n    marginRight: '2%',\n    width: '96%',\n    marginBottom: 10,\n  },\n  line: {\n    width: '10%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  icon: {\n    color: '#0274d7',\n    margin: 20,\n    fontSize: 30,\n  },\n});\n\nexport default function ModelTarget({\n  deleteModelTarget,\n  modelTarget,\n  id,\n  handleChange,\n}) {\n  const classes = useStyles();\n  const [metaModal, setMetaModal] = useState(modelTarget.model);\n  const [target, setTarget] = useState(modelTarget.target);\n\n  async function fetchModels() {\n    return getModels();\n  }\n\n  return (\n    <div className={classes.root}>\n      <Paper variant=\"outlined\" className={classes.paperParams}>\n        <Selection\n          name=\"metaModal\"\n          title=\"Model\"\n          placeholder=\"meta modal\"\n          fetchAPI={fetchModels}\n          optionLabelKey=\"name\"\n          onChange={(e) => {\n            setMetaModal(e);\n            handleChange({...modelTarget, model: e}, id);\n          }}\n          value={metaModal}\n          classes={{root: classes.inputSelect}}\n        />\n        <Selection\n          name=\"name\"\n          title=\"name\"\n          placeholder=\"Target\"\n          optionLabelKey=\"name\"\n          classes={{root: classes.inputSelect}}\n          value={target}\n          onChange={(e) => {\n            setTarget(e);\n            handleChange({...modelTarget, target: e}, id);\n          }}\n          fetchAPI={() =>\n            metaModal?.fullName ? getRecords(metaModal?.fullName) : []\n          }\n        />\n      </Paper>\n      <Delete onClick={() => deleteModelTarget(id)} className={classes.icon} />\n    </div>\n  );\n}\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {\n  Button,\n  Paper,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  DialogContentText,\n} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {Add} from '@material-ui/icons';\nimport Line from '../components/Line';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {updateTarget} from './features/contextReducer';\nimport ModelTarget from './components/ModelTarget';\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    margin: theme.spacing(1),\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n\n  dialogPaper: {\n    maxWidth: '70%',\n    maxHeight: '80%',\n    resize: 'both',\n    width: '70%',\n    height: '60%',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    height: '100%',\n    overflow: 'hidden',\n  },\n  save: {\n    'margin': theme.spacing(1),\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  baseModelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  modelParams: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '90%',\n  },\n  addBaseModelParams: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflow:\"auto\",\n    height: '100%',\n    width: '100%',\n  },\n  line: {\n    width: '10%',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  scrollDiv: {\n    marginBottom:20\n  },\n}));\n\nfunction ContextBuilder({handleClose, open}) {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const targetsFromStore = useSelector((state) => state.contextReducer.targets);\n  const [openAlert, setAlert] = React.useState(false);\n  const [alertConfig] = React.useState({\n    alertMessage: 'Add all values',\n    alertTitle: 'Error',\n  });\n  // const [isClose, setClose] = React.useState(false);\n  const [targets, setTargets] = useState([]);\n\n  useEffect(() => {\n    if (targetsFromStore?.length === 0) {\n      setTargets([{model: null, target: null}]);\n    } else {\n      setTargets(targetsFromStore);\n    }\n  }, [targetsFromStore]);\n  const handleSave = () => {\n    if (!isAllFields()) {\n      setAlert(true);\n    } else {\n      dispatch(updateTarget(targets));\n      handleClose();\n    }\n  };\n  const isAllFields = () => {\n    let empty = true;\n    targets.forEach((target) => {\n      if (target.model == null || target.target == null) {\n        empty = false;\n        return;\n      }\n    });\n    return empty;\n  };\n\n  const onCancel = () => {\n    handleClose();\n  };\n\n  const handelAddModelParameter = () => {\n    setTargets([...targets, {model: null, target: null}]);\n  };\n\n  const deleteModelTarget = (id) => {\n    const targetsModel = targets.filter((modelTarget, index) => index !== id);\n    setTargets(targetsModel);\n  };\n\n  const handleChange = useCallback(\n      (target, id) => {\n        const modelTargets = [...targets];\n        modelTargets[id] = target;\n        setTargets(modelTargets);\n      },\n      [targets],\n  );\n\n  return (\n    <Dialog\n      onClose={(e, reason) => {\n        if (reason !== 'backdropClick') {\n          handleClose();\n        }\n      }}\n      aria-labelledby=\"simple-dialog-title\"\n      open={open}\n      classes={{\n        paper: classes.dialogPaper,\n      }}\n    >\n      <DialogTitle id=\"simple-dialog-title\">Build Contexts</DialogTitle>\n      <div className={classes.root}>\n        <Paper variant=\"outlined\" className={classes.paper}>\n          <div className={classes.baseModelParams}>\n            <Line className={classes.line}></Line>\n            <div className={classes.addBaseModelParams}>\n              <div className={classes.dialogTitle}>\n                <DialogTitle\n                  id=\"simple-dialog-title\"\n                  className={classes.dialogTitle}\n                  onClick={handelAddModelParameter}\n                >\n                  Add model context\n                </DialogTitle>\n                <Add />\n              </div>\n              <div className={classes.scrollDiv}>\n                {targets?.map((modelTarget, index) => {\n                  return (\n                    <ModelTarget\n                      key={index}\n                      deleteModelTarget={deleteModelTarget}\n                      handleChange={handleChange}\n                      id={index}\n                      modelTarget={modelTarget}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </Paper>\n        <div>\n          <Button className={classes.save} onClick={handleSave}>\n            OK\n          </Button>\n          <Button\n            className={classes.save}\n            onClick={onCancel}\n            style={{textTransform: 'none'}}\n          >\n            Cancel\n          </Button>\n        </div>\n      </div>\n      {openAlert && (\n        <Dialog\n          open={openAlert}\n          onClose={(e, reason) => {\n            if (reason !== 'backdropClick') {\n              setAlert(false);\n            }\n          }}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n          classes={{\n            paper: classes.dialog,\n          }}\n        >\n          <DialogTitle id=\"alert-dialog-title\">\n            {alertConfig.alertTitle}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">\n              {alertConfig.alertMessage}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={() => {\n                setAlert(false);\n              }}\n              color=\"primary\"\n              autoFocus\n              className={classes.save}\n            >\n              Ok\n            </Button>\n            <Button\n              onClick={() => {\n                setAlert(false);\n              }}\n              color=\"primary\"\n              autoFocus\n              style={{textTransform: 'none'}}\n              className={classes.save}\n            >\n              Cancel\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Dialog>\n  );\n}\n\nexport default ContextBuilder;\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport {\n  Drawer,\n  IconButton,\n  Tooltip,\n  Box,\n  Tabs,\n  Tab,\n  colors,\n  DialogTitle,\n  DialogContentText,\n  DialogContent,\n  Dialog,\n  DialogActions,\n  Button,\n  Snackbar,\n} from '@material-ui/core';\nimport { Resizable } from 're-resizable';\nimport BpmnModeler from './main/baml-js/lib/Modeler';\nimport ScriptBox from './views/ScriptBox';\nimport customControlsModuleRequest from './custom/custom request';\nimport customControlsModuleAuth from './custom/custom auth';\nimport ParameterTable from './views/ParameterProps';\nimport {\n  Textbox,\n  TextField,\n  SelectBox,\n  Checkbox,\n  Select,\n  Description,\n  NewSelect,\n} from './components';\nimport { tabProperty } from './tabProperty';\nimport { fromPayloadsToPayloads, getGroovyBasicPayload } from '../utils';\nimport {\n  Save,\n  Delete,\n  AddBox,\n  PlayCircleFilled,\n  Menu,\n  Add,\n  Edit,\n} from '@material-ui/icons';\nimport { makeStyles } from '@material-ui/core/styles';\nimport './main/baml-js/assets/diagram-js.css';\nimport './main/baml-font/css/bpmn.css';\nimport './css/bpmn.css';\nimport Expression from './views/Expression';\nimport { Alert, TabContext, TabPanel } from '@material-ui/lab';\nimport Checkboxs from './components/CheckBoxs';\nimport CustomizedTables from './components/Table';\nimport { Provider, useDispatch, useSelector } from 'react-redux';\nimport { getChildLanes } from './main/baml-js/lib/features/modeling/util/LaneUtil';\nimport ReactDOM from 'react-dom';\nimport { store } from './store';\nimport { Selection } from './components';\nimport { tabPropertyAuth } from './tabPropertyAuth';\nimport { is } from './ModelUtil';\nimport { FILL_COLORS, STROKE_COLORS } from './constants';\nimport { tabPropertyConnector } from './tabPropertyConnector';\nimport AuthentificationField from './views/AuthentificationField';\nimport TestConnector from './components/TestConnector';\nimport { addRequest } from './payloads-builder/services/api';\nimport TextFieldMapper from './components/textBoxMapper';\nimport JSONFormatter from 'json-formatter-js';\nimport { updateModelPayload } from './payloads-builder/features/payloadReducer';\nimport { updateHeader } from './header-builder/features/headerReducer';\nimport {\n  addAuth,\n  addConnector,\n  autheticate,\n  deleteAuth,\n  deleteConnector,\n  deleteRequest,\n  getAllAuthentication,\n  getAllConnector,\n  getAllRequest,\n  getAuthById,\n  getConnectorById,\n  getkeys,\n  getRequestById,\n} from '../services/api';\nimport AuthentificationAction from './components/AuthentificationAction';\nimport { updateModelParam } from './request-builder/features/requestReducer';\nimport ContextBuilder from './context-builder/context-builder';\nimport classNames from 'classnames';\nconst resizeStyle = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  borderLeft: \"solid 1px #ddd\",\n  background: \"#f0f0f0\"\n};\n\nconst useStyles = makeStyles((theme) => ({\n  drawer: {\n    width: DRAWER_WIDTH,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    background: \"#F8F8F8\",\n    width: \"100%\",\n    position: \"absolute\",\n    borderLeft: \"1px solid #ccc\",\n    overflow: \"auto\",\n    height: \"100%\",\n  },\n  drawerContainer: {\n    height: '100%',\n    width: '100%',\n  },\n  nodeTitle: {\n    fontSize: '120%',\n    fontWeight: 'bolder',\n  },\n  propertyLable: {\n    fontSize: 13,\n    fontWeight: 'bolder',\n    margin: '10px 0px',\n  },\n  toolTip: {\n    display: 'flex',\n    flexDirection: 'row',\n    width:'100%',\n    '& > p':{\n      '@media (max-width: 20px)': {\n        display: 'none',\n      },\n  }\n  },\n  toolTipFont: {\n    fontSize: 10,\n    flex:\"none\",\n    paddingLeft: 5,\n  },\n  save: {\n    'margin': theme.spacing(1),\n    'backgroundColor': '#0275d8',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    '&:hover': {\n      backgroundColor: '#025aa5',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  icon: {\n    color: 'green',\n    width: '1.6em',\n    height: '1.2em',\n  },\n  dialogTitle: {\n    'color': '#0274d7',\n    'paddingLeft': 0,\n    'paddingRight': 3,\n    'display': 'flex',\n    'flexDirection': 'row',\n    'alignItems': 'center',\n    '& #simple-dialog-title': {\n      cursor: 'pointer',\n    },\n  },\n  btnContainer: {\n    border: '1px solid #dcdc',\n    background: '#F8F8F8',\n    width: '20%',\n  },\n  consoleHeader: {\n    display: 'flex',\n    flexDirection: 'row',\n    marginTop: 5,\n    alignItems: 'center',\n    backgroundColor:\"#424242\",\n    paddingInline:\"inherit\",\n    borderRadius:'15px 15px 0px 0px'\n  },\n  copy: {\n    'marginLeft': 'auto',\n    'backgroundColor': '#025aa5',\n    'borderColor': '#0267bf',\n    'color': 'white',\n    'padding':'2',\n    fontSize:10,\n    '&:hover': {\n      backgroundColor: '#0267ba',\n      borderColor: '#014682',\n      color: 'white',\n    },\n  },\n  console: {\n    'backgroundColor': '#656565',\n    'padding': 10,\n    'minHeight': '40%',\n    borderRadius:'0px 0px 15px 15px',\n    'fontWeight': 'bold !important',\n    '& .json-formatter-key': {\n      color: '#EBC456 !important',\n      marginRight: 5,\n    },\n    '& .json-formatter-string': {\n      color: 'white !important',\n    },\n    '& .json-formatter-boolean': {\n      color: 'white !important',\n    },\n    '& .json-formatter-number': {\n      color: 'white !important',\n    },\n    '& .json-formatter-function': {\n      color: 'white !important',\n    },\n    '& .json-formatter-row': {\n      marginBottom: 8,\n    },\n  },\n  box: {\n    '& > div > div > div': {\n      borderBottom: '1px solid black',\n    },\n  },\n  saveButtonText: {\n    marginLeft: 10,\n  },\n  saveMessageAlert: {\n    width: '100%',\n    marginBottom: 10,\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  paper: {\n    margin: theme.spacing(1),\n    width: `calc(100% - 16px)`,\n    display: 'flex',\n    height: 'calc(100% - 50px)',\n    overflow: 'hidden',\n  },\n  dialogPaper: {\n    maxWidth: '70%',\n    maxHeight: '80%',\n    resize: 'both',\n    width: '70%',\n    height: '90%',\n  },\n  iconButton: {\n    padding: 0,\n    paddingLeft: 5,\n  },\n  iconParams: {\n    backgroundColor: '#30363D',\n  },\n  inputSelect: {\n    width: '22%',\n    marginLeft: '2%',\n    display: 'flex',\n    alignItems: 'end',\n  },\n  tabNav: {\n    'marginTop': 20,\n    '& .MuiTabs-indicator': {\n      display: 'none',\n    },\n    '& .Mui-selected': { \n      backgroundColor: '#E3E3E3',\n    },\n  },\n  messageResponseSuccess: {\n    backgroundColor: '#D6E9DC',\n    color: '#4f8758',\n    padding: 15,\n    fontWeight: 'bold',\n    borderRadius: 10,\n  },\n  messageResponseError: {\n    backgroundColor: '#D70038',\n    color: 'white',\n    padding: 15,\n    fontWeight: 'bold',\n    borderRadius: 10,\n  },\n  tabPanel: {\n    padding: 10,\n    backgroundColor: 'rgb(248, 248, 248)',\n    height: '100%',\n  },\n  tabPanelConsole: {\n    padding: 10,\n    height: '100%',\n    borderRadius:\"15px\"\n  },\n  tabStyle: {\n    border: ' 0.1px solid #ccc !important',\n    borderBottom:'none',\n    backgroundColor:\"white\",\n    minHeight: 10,\n    width: '33.33%',\n    minWidth: '33.33%',\n  },\n  toolbarButtons: {\n    display: 'flex',\n    padding: '20px 20px 0px 20px',\n    position: 'relative',\n    width: '48%',\n  },\n  header: {\n    display: 'flex',\n    flexDirection: 'row',\n    width: '100%',\n  },\n  active: {\n    backgroundColor: '#a3a3a3',\n  },\n  property: {\n    marginBottom: '5%',\n  },\n}));\n\nconst DRAWER_WIDTH = 480;\n\nconst REQUEST_XML = `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<process-actions \n  xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\" \n  xs:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" \n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" \n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" \n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" \n  id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\">\n  <process-action id=\"ProcessAction_1\">\n  </process-action>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</process-actions>`;\n\nconst CONNECTOR_XML = `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<process-actions \n  xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\" \n  xs:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" \n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" \n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" \n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" \n  id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\">\n  <process-action id=\"ProcessAction_2\">\n  </process-action>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_2\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_2\" bpmnElement=\"Process_2\">\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</process-actions>`;\n\nconst AUTH_XML = `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<process-actions \n  xmlns:xs=\"http://www.w3.org/2001/XMLSchema-instance\" \n  xs:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" \n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" \n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" \n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" \n  id=\"sample-diagram\" targetNamespace=\"http://bpmn.io/schema/bpmn\">\n  <process-action id=\"ProcessAction_3\">\n  </process-action>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_3\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_3\" bpmnElement=\"Process_3\">\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</process-actions>`;\nconst REQUEST = 1;\nconst AUTHENTICATION = 2;\nconst CONNECTOR = 3;\n\nlet bpmnModeler = null;\nlet bpmnModelerAuth = null;\nlet bpmnModelerConnector = null;\nlet bpmnModelerGlobal = null;\nconst MODELS = [\n  { name: 'Request', title: 'Request' },\n  { name: 'Authentification', title: 'Authentification' },\n  { name: 'Connector', title: 'Connector' },\n];\n\nfunction WebServiceEditor() {\n  const [width, setWidth] = useState(DRAWER_WIDTH);\n  const [height, setHeight] = useState('100%');\n  const [drawerOpen, setDrawerOpen] = useState(true);\n  const [element, setElement] = useState(null);\n  const [model, setModel] = useState(1);\n  const [consoleResponse, setConsole] = useState(null);\n  const [request, setRequest] = useState(null);\n  const [authRequest, setAuthRequest] = useState(null);\n  const [connector, setConnector] = useState(null);\n  const formatter = useRef(null);\n  const [openSnackbar, setSnackbar] = useState({\n    open: false,\n    messageType: null,\n    message: null,\n  });\n  const [parametersMenu, showParametersMenu] = useState(false);\n  const [openAlert, setAlert] = React.useState({\n    state: false,\n    action: null,\n    alertConfig: {\n      alertMessage:\n        'Current changes will be lost. Do you really want to proceed?',\n      alertTitle: 'New',\n    },\n  });\n  const dispatch = useDispatch();\n  const criteriaQuery = useSelector((state) => state.payloadReducer.queryCriteria)\n  const modelPayloadsStore = useSelector(\n    (state) => state.payloadReducer.modelPayloads,\n  );\n  const modelParamStore = useSelector(\n    (state) => state.requestReducer.modelParameters,\n  );\n  const headersStore = useSelector((state) => state.headerReducer.headers);\n  const classes = useStyles();\n  const setCSSWidth = (width) => {\n    document.documentElement.style.setProperty(\n      '--bpmn-container-width',\n      `${width}px`,\n    );\n    setDrawerOpen(width === '0px' ? false : true);\n  };\n\n  const handleSnackbarClick = (messageType, message) => {\n    setSnackbar({\n      open: true,\n      messageType,\n      message,\n    });\n  };\n\n  const handleSnackbarClose = (event, reason) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setSnackbar({\n      open: false,\n      messageType: null,\n      message: null,\n    });\n  };\n\n  // BPM Build Functions\n  const createParticipant = (\n    request\n  ) => {\n    const elementFactory = bpmnModeler.get('elementFactory');\n    const elementRegistry = bpmnModeler.get('elementRegistry');\n    const modeling = bpmnModeler.get('modeling');\n    const definitions = bpmnModeler.getDefinitions();\n    const Nelement =\n      definitions && definitions.rootElements && definitions.rootElements[0];\n    if (!Nelement) return;\n    const rootElement = elementRegistry.get(Nelement.id);\n    if (!rootElement) return;\n    const process = rootElement;\n    const participant = elementFactory.createParticipantShape({\n      type: 'bpmn:Participant',\n    });\n    participant.businessObject.name = request?.name;\n    participant.businessObject.studioApp = request?.studioApp;\n    participant.businessObject.type = request?.requestTypeSelect;\n    participant.businessObject.url = request?.wsUrl;\n    participant.businessObject.idRequest = request?.id;\n    participant.businessObject.callIf = { expression: request?.callIf };\n    participant.businessObject.repeatIf = { expression: request?.repeatIf };\n    participant.businessObject.payLoadTypeSelect = request?.payLoadTypeSelect;\n    participant.businessObject.versionRequest = request?.version;\n    participant.businessObject.description = request?.description;\n\n    colors.stroke = STROKE_COLORS['bpmn:Task'];\n    colors.fill = FILL_COLORS['bpmn:Task'];\n    participant.businessObject.di.set('stroke', 'black');\n    participant.businessObject.di.set('fill', 'white');\n    modeling.createShape(\n      participant,\n      { x: 150, y: 50, width: 900, height: 600 },\n      process,\n    );\n    modeling.splitLane(participant, 3);\n    const childLanes = getChildLanes(participant);\n    childLanes.forEach((child, id) => {\n      // add tables to Requests / Payloads / Headers\n      const overlays = bpmnModeler.get('overlays');\n      child.businessObject.name =\n        id === 0 ? 'Parameters' : id === 1 ? 'Headers' : 'Payloads';\n        // child.businessObject.$parent = participant?.businessObject?.processRef?.laneSets[0]\n      overlays.add(child.id, {\n        position: {\n          bottom: child.height,\n          left: 30,\n        },\n        html: `<div id=${child.id} style=\"width:${child.width - 30}px\"></div>`,\n      });\n      modeling &&\n      modeling.updateProperties(child, {\n        name:  id === 0 ? 'Parameters' : id === 1 ? 'Headers' : 'Payloads',\n      });\n      ReactDOM.render(\n        <Provider store={store}>\n          <CustomizedTables\n            type={id === 0 ? 'parameters' : id === 2 ? 'payloads' : 'headers'}\n          />\n        </Provider>,\n        document.getElementById(child.id),\n      );\n    });\n    participant.bpmnModeler = bpmnModeler;\n\n    setElement(participant);\n    return participant;\n  };\n\n  const removeElement = (children) => {\n    const elementRegistry = bpmnModelerGlobal.get('elementRegistry');\n    const definitions = bpmnModelerGlobal.getDefinitions();\n    const Nelement =\n      definitions && definitions.rootElements && definitions.rootElements[0];\n    const rootElement = elementRegistry.get(Nelement.id);\n    const modeling = bpmnModelerGlobal.get('modeling');\n    if (children) {\n      modeling.removeElements([...children]);\n    } else modeling.removeElements([...rootElement.children]);\n    // setElement(rootElement);\n    return rootElement;\n  };\n\n  const createMapper = (request) => {\n    const elementFactory = bpmnModelerAuth.get('elementFactory');\n    const elementRegistry = bpmnModelerAuth.get('elementRegistry');\n    const modeling = bpmnModelerAuth.get('modeling');\n    const process = elementRegistry.get('ProcessAction_3');\n    const mapper = elementFactory.createParticipantShape({ type: 'bpmn:Task' });\n    mapper.businessObject.name = 'Auth Request';\n    mapper.businessObject.authRequest = request?.authWsRequest ?\n      request.authWsRequest :\n      null;\n    modeling.createShape(\n      mapper,\n      { x: 220, y: 80, width: 130, height: 120 },\n      process,\n    );\n    mapper.bpmnModeler = bpmnModelerAuth;\n    if (is(mapper, ['bpmn:Task'])) {\n      colors.stroke = STROKE_COLORS['bpmn:Task'];\n      colors.fill = FILL_COLORS['bpmn:Task'];\n      mapper.businessObject.di.set('stroke', STROKE_COLORS['bpmn:Task']);\n      mapper.businessObject.di.set('fill', FILL_COLORS['bpmn:Task']);\n    }\n    modeling.setColor(mapper, colors);\n  };\n\n  const createConnectorMapper = async (connector) => {\n    const elementFactory = bpmnModelerConnector.get('elementFactory');\n    const elementRegistry = bpmnModelerConnector.get('elementRegistry');\n    const modeling = bpmnModelerConnector.get('modeling');\n    const process = elementRegistry.get('ProcessAction_2');\n    if (connector) {\n      let mapper = null;\n      if (connector?.wsRequestList && connector?.wsRequestList?.length > 0) {\n        connector.wsRequestList.forEach((request, id) => {\n          mapper = elementFactory.createParticipantShape({\n            type: 'bpmn:Mapper',\n          });\n          mapper.businessObject.name = request.name;\n          mapper.businessObject.requestTypeSelect = request.requestTypeSelect;\n          mapper.businessObject.authRequest = request;\n          modeling.createShape(\n            mapper,\n            { x: 220 + id * 180, y: 80, width: 130, height: 120 },\n            process,\n          );\n        });\n        let mappers =  [...process.children];\n        for(let i = 0 ; i < mappers.length ; i++) {\n          if(i === mappers.length - 1  ) return;\n          modeling.connect(mappers[i], mappers[i+1]);\n        }\n      } else {\n        const mapper = elementFactory.createParticipantShape({\n          type: 'bpmn:Mapper',\n        });\n        mapper.businessObject.name = null;\n        mapper.businessObject.requestTypeSelect = null;\n        mapper.businessObject.authRequest = null;\n        modeling.createShape(\n          mapper,\n          { x: 220, y: 80, width: 130, height: 120 },\n          process,\n        );\n      }\n    } else {\n      const mapper = elementFactory.createParticipantShape({\n        type: 'bpmn:Mapper',\n      });\n      mapper.businessObject.name = null;\n      mapper.businessObject.requestTypeSelect = null;\n      mapper.businessObject.authRequest = null;\n      modeling.createShape(\n        mapper,\n        { x: 220, y: 80, width: 130, height: 120 },\n        process,\n      );\n    }\n  };\n\n  const createMapperQauth = (request) => {\n    const elementFactory = bpmnModelerAuth.get('elementFactory');\n    const elementRegistry = bpmnModelerAuth.get('elementRegistry');\n    const modeling = bpmnModelerAuth.get('modeling');\n    const process = elementRegistry.get('ProcessAction_3');\n    const mapper2 = elementFactory.createParticipantShape({\n      type: 'bpmn:Task',\n    });\n    const mapper3 = elementFactory.createParticipantShape({\n      type: 'bpmn:Task',\n    });\n    modeling.createShape(\n      mapper2,\n      { x: 420, y: 80, width: 130, height: 120 },\n      process,\n    );\n    modeling.createShape(\n      mapper3,\n      { x: 620, y: 80, width: 130, height: 120 },\n      process,\n    );\n    mapper2.businessObject.name = 'Token request';\n    mapper2.businessObject.authRequest = request?.tokenWsRequest ?\n      request.tokenWsRequest :\n      null;\n    mapper3.businessObject.name = 'Refresh Token request';\n    mapper3.businessObject.authRequest = request?.refreshTokenWsRequest ?\n      request.refreshTokenWsRequest :\n      null;\n    if (is(mapper2, ['bpmn:Task'])) {\n      colors.stroke = STROKE_COLORS['bpmn:Task'];\n      colors.fill = FILL_COLORS['bpmn:Task'];\n      mapper2.businessObject.di.set('stroke', STROKE_COLORS['bpmn:Task']);\n      mapper2.businessObject.di.set('fill', FILL_COLORS['bpmn:Task']);\n    }\n    modeling.setColor(mapper2, colors);\n    if (is(mapper3, ['bpmn:Task'])) {\n      colors.stroke = STROKE_COLORS['bpmn:Task'];\n      colors.fill = FILL_COLORS['bpmn:Task'];\n      mapper3.businessObject.di.set('stroke', STROKE_COLORS['bpmn:Task']);\n      mapper3.businessObject.di.set('fill', FILL_COLORS['bpmn:Task']);\n    }\n    modeling.setColor(mapper3, colors);\n  };\n\n  // from connector / authentification => Request\n\n  const editButton = async () => {\n    if (element.type === 'bpmn:Mapper' || element.type === 'bpmn:Task') {\n      bpmnModelerGlobal = bpmnModeler;\n      const authRequest = await getRequestById(\n        element.businessObject.authRequest.id,\n      );\n      setModel(REQUEST);\n      getRequest(authRequest?.id); // /////// here some ???\n    } else if (element.type === 'bpmn:Process-action' && model === CONNECTOR) {\n      bpmnModelerGlobal = bpmnModelerAuth;\n      setModel(AUTHENTICATION);\n      const authRequest = await getAuthById(\n        element?.businessObject?.defaultWsAuthenticator?.id,\n      );\n      getAuth(authRequest?.id); // /////// here some ???\n    }\n  };\n\n  const addButton = () => {\n    if (element.type === 'bpmn:Mapper' || element.type === 'bpmn:Task') {\n      bpmnModelerGlobal = bpmnModeler;\n      setModel(REQUEST);\n      createNewRequest();\n    } else if (element.type === 'bpmn:Process-action') {\n      bpmnModelerGlobal = bpmnModelerAuth;\n      setModel(AUTHENTICATION);\n      if (bpmnModelerGlobal !== null) {\n        createNewAuth();\n      }\n    }\n  };\n\n  // Request Model\n  const getRequest = async (id) => {\n    let res = await getRequestById(id, {\n      fields: [\n        'name',\n        'studioApp',\n        'id',\n        'payLoadTypeSelect',\n        'requestTypeSelect',\n        'wsConnector',\n        'payLoadWsKeyValueList',\n        'headerWsKeyValueList',\n        'version',\n        'wsUrl',\n        'description',\n        'repeatIf',\n        'callIf',\n        'parameterWsKeyValueList',\n      ],\n    });\n    removeElement();\n    createParticipant(res);\n    const req = {};\n    req.name = res.name;\n    req.studioApp = res.studioApp;\n    req.requestTypeSelect = res.requestTypeSelect;\n    req.payLoadTypeSelect = res.payLoadTypeSelect;\n    req.wsUrl = res.wsUrl;\n    req.callIf = res.callIf;\n    req.repeatIf = res.repeatIf;\n    req.id = res.id;\n    req.version = res.version;\n    req.description = res.desciption;\n    let headers;\n    let payloads;\n    let parameters;\n    headers =\n      res.headerWsKeyValueList?.length !== 0 ?\n        (headers = await getkeys(res.headerWsKeyValueList)) :\n        [];\n    payloads =\n      res.payLoadWsKeyValueList?.length !== 0 ?\n        (payloads = await getkeys(res.payLoadWsKeyValueList)) :\n        [];\n    parameters =\n      res.parameterWsKeyValueList?.length !== 0 ?\n        (parameters = await getkeys(res.parameterWsKeyValueList)) :\n        [];\n    dispatch(updateHeader(headers));\n    const list =\n      payloads?.length === 0 ? [] : await fromPayloadsToPayloads(payloads);\n    dispatch(\n      updateModelPayload(\n        list.length === 0 ? [] : [{ model: '', payloads: list }],\n      ),\n    );\n    dispatch(\n      updateModelParam(\n        parameters?.length !== 0 ?\n          [{ id: 1, model: {}, parameters: [...parameters] }] :\n          [],\n      ),\n    );\n    req.parameterWsKeyValueList =\n      parameters?.length !== 0 ?\n        [{ id: 1, model: {}, parameters: [...parameters] }] :\n        [];\n    req.payLoadWsKeyValueList =\n      list.length === 0 ? [] : [{ model: '', payloads: list }];\n    req.headerWsKeyValueList = headers;\n    setRequest(req);\n  };\n\n  const removeRequest = async () => {\n    const res = await deleteRequest(request.id);\n    setConsole(res);\n    setValue(2);\n  };\n\n  const onChangeSelect = (e) => {\n    if (verifySaveRequest() === true) {\n      getRequest(e?.id);\n    } else {\n      setAlert({\n        state: true,\n        action: 'onChange',\n        data: e,\n        alertConfig: {\n          alertMessage:\n            'Current changes will be lost. Do you really want to proceed?',\n          alertTitle: 'New',\n        },\n      });\n      return;\n    }\n  };\n\n  const buildPay = (payloads, model) => {\n    const list = [];\n    payloads?.forEach((payload) => {\n      let resultPay = {};\n      if (payload?.wsValue?.name) {\n        resultPay = {\n          wsKey: payload.wsKey ? payload.wsKey : null,\n          isList: false,\n          id: payload.id ? payload.id : null,\n          version: payload?.version != null ? payload?.version : null,\n          wsValue: getGroovyBasicPayload(\n            payload.transformations,\n            model,\n            payload?.wsValue,\n          ),\n        };\n        list.push(resultPay);\n      } else if (payload.wsValue && !payload.isList) {\n        resultPay = {\n          wsKey: payload.wsKey ? payload.wsKey : null,\n          isList: false,\n          id: payload.id ? payload.id : null,\n          version: payload?.version != null ? payload?.version : null,\n          wsValue: getGroovyBasicPayload(\n            payload.transformations,\n            model?.model,\n            payload?.wsValue,\n          ),\n        };\n        list.push(resultPay);\n      } else if (payload.isList) {\n        let subList = [];\n        payload.wsValue.forEach((pay) => {\n          subList = [...buildPay(pay.payloads, pay.model)];\n        });\n        resultPay = {\n          wsKey: payload.wsKey ? payload.wsKey : null,\n          id: payload.id ? payload.id : null,\n          wsValue: null,\n          isList: true,\n          subWsKeyValueList: subList,\n          version: payload?.version != null ? payload?.version : null,\n        };\n        list.push(resultPay);\n      } else {\n        resultPay = {\n          wsKey: payload.wsKey ? payload.wsKey : null,\n          id: payload.id ? payload.id : null,\n          wsValue: null,\n          isList: false,\n          version: payload?.version != null ? payload?.version : null,\n          subWsKeyValueList: buildPay(payload.payloads, payload.model),\n        };\n        list.push(resultPay);\n      }\n    });\n    return list;\n  };\n\n  const saveRequest = async () => {\n    let req = {};\n    if (element.type === 'bpmn:Participant') {\n      req = element?.businessObject;\n    } else if (element?.type === 'bpmn:Lane') {\n      req = element?.parent?.businessObject;\n    } else if (element?.type === 'bpmn:Collaboration') {\n      req = element.children[0].businessObject;\n    } else return;\n    if (!verificationFieldsRequest(req)) return;\n\n    const headers = [];\n    headersStore.forEach((header) => {\n      header = { ...header, id: header.id ? header.id : null };\n      headers.push(header);\n    });\n    let payloads = [];\n    modelPayloadsStore.forEach((modelPayload) => {\n      payloads = [\n        ...payloads,\n        ...buildPay(modelPayload.payloads, modelPayload.model),\n      ];\n    });\n    const url = '';\n    const parameters = [];\n    modelParamStore.forEach((param) => {\n      param.parameters.forEach((p) => {\n        p = {\n          ...p,\n          id: p.id ? p.id : null,\n          wsValue: getGroovyBasicPayload(\n            p.transformations,\n            param.model,\n            p.wsValue?.name ? p.wsValue?.name : p.wsValue,\n          ),\n        };\n        parameters.push(p);\n      });\n    });\n    let res = null;\n    res = await addRequest({\n      payLoadWsKeyValueList: payloads,\n      wsUrl: req.url + url,\n      studioApp:req.studioApp,\n      requestTypeSelect: req.type ? req.type : null,\n      name: req.name,\n      payLoadTypeSelect: req.payLoadTypeSelect ? req.payLoadTypeSelect : null,\n      headerWsKeyValueList: headers,\n      parameterWsKeyValueList: parameters,\n      description: req.description ? req.description : null,\n      callIf: req.callIf?.expression ? req.callIf?.expression : null,\n      repeatIf: req.repeatIf?.expression ? req.repeatIf?.expression : null,\n      id: request?.id ? request?.id : null,\n      version: request?.version != null ? request?.version : null,\n    });\n    setConsole(res);\n    setValue(2);\n    if (res?.data[0]?.id) setRequest(res.data[0]);\n  };\n\n  const verifyHeadersChanges = () => {\n    if (\n      request !== {} &&\n      request?.headerWsKeyValueList?.length !== 0 &&\n      headersStore?.length === request?.headerWsKeyValueList?.length\n    ) {\n      var res = true;\n      for(let index = 0; index < request.headerWsKeyValueList.length ; index++){\n        if (\n          !(\n            request.headerWsKeyValueList[index].wsKey === headersStore[index].wsKey &&\n            request.headerWsKeyValueList[index].wsValue === headersStore[index].wsValue\n          )\n        ) {\n          res =  false;\n          break;\n        }\n      }\n      return res;\n    } else if (headersStore?.length === 0){ \n      return true;\n    }\n    return false;\n  };\n\n  const verifyParamsChanges = () => {\n    if (\n      modelParamStore?.length === (request?.parameterWsKeyValueList?.length ? request?.parameterWsKeyValueList?.length : 0)\n    ) {\n      let res = true;\n      for(let index = 0; index < request?.parameterWsKeyValueList.length ; index++ ){\n        if (\n          request?.parameterWsKeyValueList[index].model?.name !== modelParamStore[index].model?.name ||\n          request?.parameterWsKeyValueList[index].parameters?.length !==\n          modelParamStore[index].parameters?.length\n        ) {\n          res = false;\n          break;\n        }\n        for(let i = 0; i < request?.parameterWsKeyValueList[index].parameters.length ; i++){\n          if (\n            request?.parameterWsKeyValueList[index].parameters[i].wsKey !== modelParamStore[index].parameters[i].wsKey ||\n            request?.parameterWsKeyValueList[index].parameters[i].wsValue !== modelParamStore[index].parameters[i].wsValue\n          ) {\n            res = false;\n            break;\n          }\n        }\n      }\n      return res;\n      }\n      return false;\n\n    }\n\n  const verifyPayloadsChanges = () => {\n    if (\n      modelPayloadsStore?.length === request?.payloadWsKeyValueList?.length &&\n      request?.payloadWsKeyValueList?.length !== 0\n    ) {\n      let res = true;\n      res = request?.payloadWsKeyValueList.forEach((modelPayload, index) => {\n        if (\n          modelPayload.model?.name !== modelParamStore[index].model?.name ||\n          modelPayload.parameters?.length !==\n          modelParamStore[index].parameters?.length\n        ) {\n          return false;\n        }\n        modelPayload.parameters.forEach((param, id) => {\n          if (\n            param.wsKey !== modelParamStore[index].parameters[id].wsKey ||\n            param.wsValue !== modelParamStore[index].parameters[id].wsValue\n          ) {\n            return false;\n          }\n        });\n      });\n      return res;\n    }\n    return false;\n  };\n\n  const createNewRequest = () => {\n    removeElement();\n    dispatch(updateModelParam([]));\n    dispatch(updateModelPayload([]));\n    dispatch(updateHeader([]));\n    createParticipant();\n    setRequest(null);\n  };\n\n  const verifySaveRequest = () => {\n    let ele = null;\n    if (element.type === 'bpmn:Participant') ele = element?.businessObject;\n    else if (element?.type === 'bpmn:Lane') {\n      ele = element?.parent?.businessObject;\n    } else if (element?.type === 'bpmn:Collaboration') {\n      ele = element.children[0].businessObject;\n    }\n    if (request !== null && JSON.stringify(request) !== '{}') {\n      if (\n        ele.name === request.name &&\n        ele.url === request.wsUrl &&\n        ele.type === request.requestTypeSelect &&\n        verifyParamsChanges() &&\n        verifyHeadersChanges()\n        //  verifyPayloadsChanges()\n      ) {\n        return true;   // true means the verification is valid => nothing change\n      }\n      return false;    // false means the verification is failed => there is  changes in the request\n    }\n    else if (\n      ele.name ||\n      ele.url ||\n      ele.type ||\n      ele.callIf.expression ||\n      ele.repeatIf.expression ||\n      ele.payLoadTypeSelect ||\n      modelParamStore.length !== 0 ||\n      modelPayloadsStore.length !== 0 ||\n      headersStore.length !== 0\n    ) {\n      return false;\n    }\n    return true;\n  };\n\n  // Connector Functions\n  const verifySaveConnector = () => {\n    var res = true;\n    if (connector !== null) {\n      const ele =\n        element.type === 'bpmn:Process-action' ? element : element.parent;\n        var children =  ele.children.filter((child)=> is(child,\"bpmn:Mapper\"));\n      if (\n        ele.businessObject.name === connector.name &&\n        connector.baseUrl === ele.businessObject.baseUrl &&\n        ele.businessObject?.defaultWsAuthenticator?.id ===\n        connector.defaultWsAuthenticator?.id\n      ) {\n        for (let index = 0; index < connector.wsRequestList.length; index++) {\n          if (\n            connector.wsRequestList[index].id !==\n            children[index].businessObject.authRequest.id\n          ) {\n            res = false;\n            break;\n          }\n        }\n      }\n      else res = false;\n    }\n    return res;\n  };\n\n  const getConnector = async (id) => {\n    let res = await getConnectorById(id, {\n      fields: [\n        'defaultWsAuthenticator',\n        'name',\n        'studioApp',\n        'id',\n        'wsRequestList',\n        'baseUrl',\n        'version',\n        'wsConnector',\n      ],\n      related: {\n        wsRequestList: ['name', 'requestTypeSelect', 'id'],\n      },\n    });\n    setConnector(res);\n    let ele;\n    if (element.type === 'bpmn:Process-action') ele = element;\n    else ele = element.parent;\n    removeElement();\n    ele.businessObject.baseUrl = res.baseUrl;\n    ele.businessObject.name = res.name;\n    ele.businessObject.studioApp = res.studioApp;\n    ele.businessObject.defaultWsAuthenticator = res.defaultWsAuthenticator;\n    await createConnectorMapper(res);\n    setElement(ele);\n  };\n  const removeConnector = async () => {\n    const res = await deleteConnector(connector.id);\n    setConsole(res);\n    setValue(2);\n  };\n\n  const onChangeSelectConnector = (e) => {\n    if (!verifySaveConnector()) {\n      setAlert({\n        state: true,\n        data: e,\n        action: 'onChange',\n        alertConfig: {\n          alertMessage:\n            'Current changes will be lost. Do you really want to proceed?',\n          alertTitle: 'New',\n        },\n      });\n    } else {\n      getConnector(e?.id);\n    }\n  };\n\n  const verificationFieldsConnector = () => {\n    const ele =\n      element.type === 'bpmn:Process-action' ? element : element.parent;\n    if (!ele.businessObject.name) {\n      handleSnackbarClick(\n        'error',\n        !ele.businessObject.name ? 'Name is required !' : '',\n      );\n      return false;\n    }\n    return true;\n  };\n  const verificationFieldsRequest = (ele) => {\n      if (\n        !ele.name &&\n        !ele.url && \n        !ele.type\n      ) {\n        handleSnackbarClick(\n          'error',\n          `<b>Les champs suivants sont invalides</b>: <li>Name</li>\n            <li>Url</li>\n            <li>Type</li>`,\n        );\n        return false;\n      }\n      else if(  (!ele.name &&\n        !ele.url ) || (!ele.name && !ele.type) || (!ele.url && !ele.type)\n){\n  handleSnackbarClick(\n    'error',\n    !ele.name &&\n      !ele.url ?\n      'Name and Url  are required !' :\n      !ele.name && !ele.type ?\n      'Name and Type  are required !' :\n      !ele.url && !ele.type  ?\n      'Url and Type  are required !' :\n          '',\n  );\n  return false;\n}\nelse if(ele.name && ele.url && ele.type) {\n  return true;\n}\nelse{\n  handleSnackbarClick(\n    'error',\n    !ele.name ?\n      'Name is  required !' :\n      !ele.type ?\n      'Type is required !' :\n      !ele.url ?\n      'Url is required !' :\n          '',\n  );\n  return false;\n}\n   \n  };\n\n  const saveConnector = async () => {\n    const ele =\n      element.type === 'bpmn:Process-action' ? element : element.parent;\n    if (!verificationFieldsConnector()) return;\n    const requests = [];\n    ele?.children.forEach((child) => {\n      if (\n        child.type === 'bpmn:Mapper' &&\n        child.businessObject.authRequest != null\n      ) {\n        requests.push(child.businessObject.authRequest);\n      }\n    });\n    const result = await addConnector({\n      name: ele.businessObject.name,\n      studioApp:ele.businessObject.studioApp,\n      baseUrl: ele.businessObject.baseUrl,\n      defaultWsAuthenticator: ele.businessObject.defaultWsAuthenticator,\n      wsRequestList: requests,\n      id: connector?.id ? connector?.id : null,\n      version: connector?.version != null ? connector?.version : null,\n    });\n    setConsole(result);\n    setValue(2);\n    if (result?.data[0]?.id) {\n      setConnector(result.data[0]);\n      return result?.data[0];\n    }\n    return null;\n  };\n\n  const createNewConnector = async () => {\n    let ele;\n    if (element.type === 'bpmn:Process-action') ele = element;\n    else ele = element.parent;\n    ele.businessObject.name = null;\n    ele.businessObject.studioApp = null;\n    ele.businessObject.baseUrl = null;\n    ele.businessObject.defaultWsAuthenticator = null;\n    ele.businessObject.authRequest = null;\n    removeElement(ele.children);\n    await createConnectorMapper();\n    setConnector(null);\n    setElement(ele);\n  };\n\n  // Authentication Functions\n\n  const changeRequestAuth = async (e) => {\n    if (!e) {\n      if (model === CONNECTOR && element.type === 'bpmn:Mapper') {\n        const modeling = bpmnModelerConnector.get('modeling');\n        modeling.updateProperties(element, {\n          name: null,\n          requestTypeSelect: null,\n        });\n        element.businessObject.requestTypeSelect = null;\n        element.businessObject.authRequest = null;\n      }\n    } else {\n      e = await getRequestById(e.id, {\n        fields: [\n          'name',\n          'id',\n          'payLoadTypeSelect',\n          'requestTypeSelect',\n          'wsConnector',\n          'version',\n        ],\n      });\n      if (model === CONNECTOR && element.type === 'bpmn:Mapper') {\n        const modeling = bpmnModelerConnector.get('modeling');\n        modeling.updateProperties(element, {\n          name: e.name,\n          requestTypeSelect: e.requestTypeSelect,\n        });\n        element.businessObject.requestTypeSelect = e.requestTypeSelect;\n        if (\n          e?.wsConnector?.id != null &&\n          connector &&\n          e?.wsConnector?.id !== connector?.id\n        ) {\n          element.businessObject.authRequest = {\n            ...e,\n            id: null,\n            wsConnector: null,\n            version: null,\n          };\n        }\n      }\n    }\n    const ele = Object.assign({}, element);\n    ele.businessObject = element.businessObject;\n    ele.parent = element.parent;\n    setElement(ele);\n  };\n\n  const getAuth = async (id) => {\n    let res = await getAuthById(id);\n    const ele = removeElement();\n    ele.businessObject.type = res?.authTypeSelect;\n    ele.businessObject.name = res?.name;\n    ele.businessObject.studioApp = res?.studioApp;\n    ele.businessObject.isAuthenticated = res?.isAuthenticated;\n    if (res?.authTypeSelect === 'oauth2') {\n      createMapper(res);\n      createMapperQauth(res);\n    } else {\n      createMapper(res);\n    }\n    setAuthRequest(res);\n    setElement(ele);\n  };\n\n  const removeAuth = async () => {\n    const res = await deleteAuth(authRequest.id);\n    setConsole(res);\n    setValue(2);\n  };\n\n  const onChangeSelectAuth = async (e) => {\n    if (!verifySaveAuth()) {\n      setAlert({\n        state: true,\n        data: e,\n        action: 'onChange',\n        alertConfig: {\n          alertMessage:\n            'Current changes will be lost. Do you really want to proceed?',\n          alertTitle: 'New',\n        },\n      });\n    } else {\n      getAuth(e?.id);\n    }\n  };\n\n  const verifySaveAuth = () => {\n    if (authRequest != null) {\n      const ele =\n        element.type === 'bpmn:Process-action' ? element : element.parent;\n      switch (ele.businessObject.type) {\n        case 'basic':\n          if (\n            ele.businessObject.type === authRequest.authTypeSelect &&\n            ele.children[0].businessObject.authRequest.id ===\n            authRequest.authWsRequest.id &&\n            ele.businessObject.name === authRequest.name &&\n            ele.businessObject.isAuthenticated === authRequest.isAuthenticated\n          ) {\n            return true;\n          }\n          return false;\n        case 'oauth2':\n          if (\n            ele.businessObject.type === authRequest.authTypeSelect &&\n            ele.children[0].businessObject.authRequest.id ===\n            authRequest.authWsRequest.id &&\n            ele.businessObject.name === authRequest.name &&\n            ele.businessObject.isAuthenticated ===\n            authRequest.isAuthenticated &&\n            ele.children[1].businessObject.authRequest.id ===\n            authRequest.tokenWsRequest.id &&\n            ele.children[2].businessObject.authRequest.id ===\n            authRequest.refreshTokenWsRequest.id\n          ) {\n            return true;\n          }\n          return false;\n        default:\n          break;\n      }\n    }\n    return true;\n  };\n\n  const verificationFieldsAuth = () => {\n    const ele =\n      element.type === 'bpmn:Process-action' ? element : element.parent;\n    if (ele.businessObject.type === 'basic') {\n      if (\n        !ele.businessObject.name ||\n        !ele.children[0].businessObject.authRequest\n      ) {\n        handleSnackbarClick(\n          'error',\n          !ele.businessObject.name &&\n            !ele.children[0].businessObject.authRequest ?\n            'Name and auth Request are required !' :\n            !ele.businessObject.name ?\n              'Name is required !' :\n              !ele.children[0].businessObject.authRequest ?\n                'Auth request is required !' :\n                '',\n        );\n        return false;\n      }\n      return true;\n    } else {\n      if (\n        !ele.businessObject.name ||\n        !ele.children[0].businessObject.authRequest ||\n        !ele.children[1].businessObject.authRequest ||\n        !ele.children[2].businessObject.authRequest\n      ) {\n        handleSnackbarClick(\n          'error',\n          `<b>Les champs suivants sont invalides</b>: ${!ele.businessObject.name ? '<li>Name</li>' : ''\n          }${!ele.children[0].businessObject.authRequest ?\n            '<li>auth Request</li>' :\n            ''\n          }\n        ${!ele.children[1].businessObject.authRequest ?\n            '<li>Token request</li>' :\n            ''\n          }${!ele.children[2].businessObject.authRequest ?\n            '<li>Refresh token request</li>' :\n            ''\n          } `,\n        );\n        return false;\n      }\n      return true\n    }\n  };\n\n  const saveAuthentification = async (transition) => {\n    if (!verificationFieldsAuth()) return;\n    const ele =\n      element.type === 'bpmn:Process-action' ? element : element.parent;\n    const result = await addAuth({\n      name: ele.businessObject.name,\n      studioApp:ele.businessObject.studioApp,\n      authWsRequest: ele.children[0].businessObject.authRequest,\n      tokenWsRequest:\n        ele.businessObject.type !== 'basic' ?\n          ele.children[1].businessObject.authRequest :\n          null,\n      refreshTokenWsRequest:\n        ele.businessObject.type !== 'basic' ?\n          ele.children[2].businessObject.authRequest :\n          null,\n      authTypeSelect: ele.businessObject.type,\n      id: authRequest?.id ? authRequest.id : null,\n      version: authRequest?.version != null ? authRequest?.version : null,\n      isAuthenticated: ele.businessObject.isAuthenticated,\n    });\n    setConsole(result);\n    !transition && setValue(2);\n    if (result?.data[0]?.id) {\n      setAuthRequest(result?.data[0]);\n      return result?.data[0];\n    }\n    return null;\n  };\n\n  const createNewAuth = async () => {\n    let ele;\n    element.type === 'bpmn:Process-action' ?\n      (ele = element) :\n      (ele = element.parent);\n    ele.businessObject.name = null;\n    ele.businessObject.studioApp = null;\n    ele.businessObject.type = 'basic';\n    ele.businessObject.isAuthenticated = false;\n    removeElement(ele.children);\n    await createMapper();\n    setAuthRequest(null);\n    setElement(ele);\n  };\n\n  const runTest = () => {\n    let ele;\n    let result;\n    switch (model) {\n      case REQUEST:\n        let req = {};\n        if (element.type === 'bpmn:Participant') {\n          req = element?.businessObject;\n        } else if (element?.type === 'bpmn:Lane') {\n          req = element?.parent?.businessObject;\n        } else if (element?.type === 'bpmn:Collaboration') {\n          req = element.children[0].businessObject;\n        } else return;\n        const headers = [];\n        headersStore.forEach((header) => {\n          header = { ...header, id: header.id ? header.id : null };\n          headers.push(header);\n        });\n        let payloads = [];\n        modelPayloadsStore.forEach((modelPayload) => {\n          payloads = [...buildPay(modelPayload.payloads, modelPayload.model)];\n        });\n        if (criteriaQuery?.expression) {\n          let id = null;\n          const found = payloads.some((el, index) => { id = index; return el.wsKey === \"data\" });\n          if (found) {\n            if (!payloads[id].subWsKeyValueList.some((ele) => ele.wsKey === \"_domain\"))\n              payloads[id].subWsKeyValueList.push({ wsKey: \"_domain\", wsValue: criteriaQuery?.expression?.split(', ')[1], isList: false, id: null })\n          }\n          else {\n            payloads.push({\n              wsKey: \"data\",\n              wsValue: null,\n              isList: false,\n              $version: null,\n              subWsKeyValueList: [{ wsKey: \"_domain\", wsValue: criteriaQuery?.expression?.split(', ')[1], isList: false, id: null }]\n            })\n          }\n        }\n        const url = '';\n        const parameters = [];\n        modelParamStore.forEach((param) => {\n          param.parameters.forEach((p) => {\n            p = {\n              ...p,\n              id: p.id ? p.id : null,\n              wsValue: getGroovyBasicPayload(\n                p.transformations,\n                param.model,\n                p.wsValue?.name ? p.wsValue?.name : p.wsValue,\n              ),\n            };\n            parameters.push(p);\n          });\n        });\n        result = {\n          payLoadWsKeyValueList: payloads,\n          wsUrl: req.url + url,\n          requestTypeSelect: req.type,\n          name: req.name,\n          payLoadTypeSelect: req.payLoadTypeSelect,\n          headerWsKeyValueList: headers,\n          parameterWsKeyValueList: parameters,\n          description: req.description,\n          callIf: req.callIf?.expression,\n          repeatIf: req.repeatIf?.expression,\n          id: request?.id ? request?.id : null,\n          version: request?.version != null ? request?.version : null,\n        };\n        setConsole(result);\n        setValue(2);\n        break;\n      case CONNECTOR:\n        ele = element.type === 'bpmn:Process-action' ? element : element.parent;\n        const requests = [];\n        ele.children.forEach((child) => {\n          if (child.type === 'bpmn:Mapper') {\n            requests.push(child.businessObject.authRequest);\n          }\n        });\n        result = {\n          name: ele.businessObject.name,\n          baseUrl: ele.businessObject.baseUrl,\n          defaultWsAuthenticator: ele.businessObject.defaultWsAuthenticator,\n          wsRequestList: requests,\n          id: connector?.id ? connector?.id : null,\n          version: connector?.version != null ? connector?.version : null,\n        };\n        setConsole(result);\n        setValue(2);\n        break;\n      case AUTHENTICATION:\n        ele = element.type === 'bpmn:Process-action' ? element : element.parent;\n        result = {\n          name: ele.businessObject.name,\n          authWsRequest: ele.children[0].businessObject.authRequest,\n          tokenWsRequest:\n            ele.businessObject.type !== 'basic' ?\n              ele.children[1].businessObject.authRequest :\n              null,\n          refreshTokenWsRequest:\n            ele.businessObject.type !== 'basic' ?\n              ele.children[2].businessObject.authRequest :\n              null,\n          authTypeSelect: ele.businessObject.type,\n          id: authRequest?.id ? authRequest.id : null,\n          version: authRequest?.version != null ? authRequest?.version : null,\n          isAuthenticated: ele.businessObject.isAuthenticated,\n        };\n        setConsole(result);\n        setValue(2);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const toolBarButtons = [\n    {\n      name: 'New',\n      icon: <AddBox className={classes.icon} style={{ color: 'green' }} />,\n      tooltipText: 'New',\n      onClick: async () => {\n        switch (model) {\n          case REQUEST:\n            if (verifySaveRequest() === true) {\n              createNewRequest();\n            } else {\n              setAlert({\n                state: true,\n                action: 'new',\n                alertConfig: {\n                  alertMessage:\n                    'Current changes will be lost. Do you really want to proceed?',\n                  alertTitle: 'New',\n                },\n              });\n              return;\n            }\n            break;\n          case CONNECTOR:\n            if (!verifySaveConnector()) {\n              setAlert({\n                state: true,\n                action: 'new',\n                alertConfig: {\n                  alertMessage:\n                    'Current changes will be lost. Do you really want to proceed?',\n                  alertTitle: 'New',\n                },\n              });\n            } else {\n              createNewConnector();\n            }\n            break;\n          case AUTHENTICATION:\n            if (!verifySaveAuth()) {\n              setAlert({\n                state: true,\n                action: 'new',\n                alertConfig: {\n                  alertMessage:\n                    'Current changes will be lost. Do you really want to proceed?',\n                  alertTitle: 'New',\n                },\n              });\n            } else {\n              createNewAuth();\n            }\n            return;\n          default:\n            break;\n        }\n      },\n    },\n    {\n      name: 'Save',\n      icon: <Save className={classes.icon} style={{ color: '#4DB6AC ' }} />,\n      tooltipText: 'Save',\n      onClick: () => {\n        switch (model) {\n          case REQUEST:\n            return saveRequest();\n          case CONNECTOR:\n            return saveConnector();\n          case AUTHENTICATION:\n            return saveAuthentification();\n          default:\n            break;\n        }\n      },\n    },\n    {\n      name: 'Delete',\n      icon: <i className={classNames(\"fa fa-trash-o\",classes.icon)} style={{ fontSize: 18,color:\"red\" }}></i>,\n      tooltipText: 'Delete',\n      onClick: async () => {\n        switch (model) {\n          case REQUEST:\n            if (request != null) {\n              setAlert({\n                state: true,\n                action: 'delete',\n                alertConfig: {\n                  alertMessage: 'Are you sure you want to delete this record ?',\n                  alertTitle: 'Warning',\n                },\n              });\n              return;\n            }\n            break;\n          case CONNECTOR:\n            if (connector != null) {\n              setAlert({\n                state: true,\n                action: 'delete',\n                alertConfig: {\n                  alertMessage: 'Are you sure you want to delete this record ?',\n                  alertTitle: 'Warning',\n                },\n              });\n            }\n            break;\n          case AUTHENTICATION:\n            if (authRequest != null) {\n              setAlert({\n                state: true,\n                action: 'delete',\n                alertConfig: {\n                  alertMessage: 'Are you sure you want to delete this record ?',\n                  alertTitle: 'Warning',\n                },\n              });\n            }\n            break;\n          default:\n            break;\n        }\n      },\n    },\n    {\n      name: 'Run test',\n      icon: (\n        <PlayCircleFilled\n          className={classes.icon}\n          style={{ color: '#007BC5' }}\n        />\n      ),\n      tooltipText: 'Run test',\n      onClick: () => {\n        runTest();\n      },\n    },\n    {\n      name: 'Parametres',\n      icon: <Menu className={classes.icon} style={{ color: 'black' }} />,\n      tooltipText: 'Context',\n      onClick: () => {\n        showParametersMenu(true);\n      },\n    },\n  ];\n\n  const getProperties = useCallback(() => {\n    const tab =\n      model === REQUEST ?\n        tabProperty :\n        model === CONNECTOR ?\n          tabPropertyConnector :\n          tabPropertyAuth;\n    const ele = tab.find((p) => p.type === (element && element.type));\n    if (!ele) return [];\n    if (ele.properties) {\n      return ele.properties;\n    }\n  }, [element, model]);\n\n  const onChange = () => {\n    switch (model) {\n      case REQUEST:\n        if (element?.businessObject.classic === 'true') {\n          ReactDOM.render(\n            <Provider store={store}>\n              <CustomizedTables type={'payloads'} />\n            </Provider>,\n            document.getElementById(element.children[2].id),\n          );\n        } else if (element?.businessObject.auth === 'true') {\n          dispatch(\n            updateModelPayload([\n              { id: 1, wsKey: 'username', wsValue: '' },\n              { id: 2, wsKey: 'password', wsValue: '' },\n            ]),\n          );\n          const elementFactory = bpmnModeler.get('elementFactory');\n          const modeling = bpmnModeler.get('modeling');\n          const mapper = elementFactory.createParticipantShape({\n            type: 'bpmn:Task',\n          });\n          const mapper2 = elementFactory.createParticipantShape({\n            type: 'bpmn:Task',\n          });\n          mapper.businessObject.name = 'Username';\n          mapper2.businessObject.name = 'Password';\n          modeling.createShape(\n            mapper,\n            {\n              x: element.children[2].x + 190,\n              y: element.children[2].y + 45,\n              width: 130,\n              height: 120,\n            },\n            element,\n          );\n          colors.stroke = '#009688';\n          colors.fill = '#B2DFDB';\n          mapper.businessObject.di.set('stroke', STROKE_COLORS['bpmn:Task']);\n          mapper.businessObject.di.set('fill', FILL_COLORS['bpmn:Task']);\n          modeling.createShape(\n            mapper2,\n            {\n              x: element.children[2].x + 390,\n              y: element.children[2].y + 45,\n              width: 130,\n              height: 120,\n            },\n            element,\n          );\n          colors.stroke = '#009688';\n          colors.fill = '#B2DFDB';\n          mapper2.businessObject.di.set('stroke', STROKE_COLORS['bpmn:Task']);\n          mapper2.businessObject.di.set('fill', FILL_COLORS['bpmn:Task']);\n          modeling.setColor(mapper, colors);\n          modeling.setColor(mapper2, colors);\n        }\n        break;\n      case AUTHENTICATION:\n        if (element?.businessObject.type === 'oauth2') {\n          createMapperQauth();\n          setElement(element);\n        } else {\n          removeElement([element.children[1], element.children[2]]);\n        }\n        break;\n      case CONNECTOR:\n        break;\n      default:\n    }\n  };\n\n  const autheticateAction = async () => {\n    // error when save is error\n    let requestAuth = null;\n    if (authRequest === null || !verifySaveAuth()) {\n      requestAuth = await saveAuthentification(true);\n      if (!requestAuth) return false;\n    } else requestAuth = authRequest;\n    const actionRequest = {\n      model: 'com.axelor.studio.db.WsAuthenticator',\n      action: 'action-studio-ws-authenticator-authenticate',\n      data: { context: requestAuth },\n    };\n    const res = await autheticate(actionRequest);\n    if (res?.status === 0) {\n      if(res?.data[0]?.view){\n        window.open(res.data[0]?.view?.views[0]?.name,res.data[0]?.view?.params?.target);\n      }\n      else{\n      const result = await getAuthById(requestAuth?.id);\n      setAuthRequest(result);\n      return result?.isAuthenticated;\n      }\n    }\n    return false;\n  };\n\n  const renderComponent = (entry) => {\n    if (!entry && entry.widget) return;\n    switch (entry.widget) {\n      case 'expression':\n        return (\n          <Expression\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n          />\n        );\n      case 'textField':\n        return (\n          <TextField\n            entry={entry}\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n            canRemove={true}\n            readOnly={entry.readOnly}\n          />\n        );\n      case 'textBox':\n        return (\n          <Textbox\n            entry={entry}\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n          />\n        );\n      case 'button':\n        return (\n          <Button\n            entry={entry}\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n            className={classes.save}\n          >\n            Authentificated\n          </Button>\n        );\n      case 'selectBox':\n        return (\n          <SelectBox\n            onChange={onChange}\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n          />\n        );\n      case 'authentificationAction':\n        return (\n          <AuthentificationAction\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n            requestAuth={authRequest}\n            entry={entry}\n            action={autheticateAction}\n            label=\"Authentificated\"\n          />\n        );\n      case 'authField':\n        return (\n          <AuthentificationField\n            entry={entry}\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n          />\n        );\n      case 'testConnector':\n        return (\n          <TestConnector\n            entry={entry}\n            bpmnModeler={bpmnModelerGlobal}\n            element={element}\n            connector={connector}\n          />\n        );\n      case 'checkbox':\n        return (\n          <Checkbox\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n          />\n        );\n      case 'checkBoxs':\n        return (\n          <Checkboxs\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n            onChange={onChange}\n          />\n        );\n      case 'many-to-one':\n        return (\n          <NewSelect \n          entry={entry}\n          element={element}\n          bpmnModeler={bpmnModelerGlobal}\n          onChange={changeRequestAuth} addButton={addButton} editButton={editButton} />\n        );\n      case 'scriptBox':\n        return (\n          <ScriptBox\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n            bpmnFactory={\n              bpmnModelerGlobal && bpmnModelerGlobal.get('bpmnFactory')\n            }\n            readOnly={element.businessObject[entry.name]?.expression?.value}\n          />\n        );\n      case 'textFieldMapper':\n        return (\n          <TextFieldMapper\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n            bpmnFactory={\n              bpmnModelerGlobal && bpmnModelerGlobal.get('bpmnFactory')\n            }\n          />\n        );\n      case 'parameterTable':\n        return (\n          <ParameterTable\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n            bpmnFactory={\n              bpmnModelerGlobal && bpmnModelerGlobal.get('bpmnFactory')\n            }\n          />\n        );\n      default:\n        return (\n          <Textbox\n            entry={entry}\n            element={element}\n            bpmnModeler={bpmnModelerGlobal}\n          />\n        );\n    }\n  };\n\n  const [value, setValue] = useState(0);\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  function a11yProps(index) {\n    return {\n      'id': `simple-tab-${index}`,\n      'aria-controls': `simple-tabpanel-${index}`,\n    };\n  }\n  const openDiagramImage = useCallback(async (bamlXml) => {\n    let canvas;\n    let element;\n    switch (model) {\n      case REQUEST:\n        canvas = bpmnModeler.get('canvas');\n        element = canvas.getRootElement();\n        if (element.type === 'bpmn:Collaboration') {\n          setElement(element.children[0]);\n        } else {\n          bpmnModeler.importXML(bamlXml, (err) => {\n            if (err) {\n              return console.error('could not import BPMN 2.0 diagram', err);\n            }\n            const canvas = bpmnModeler.get('canvas');\n            canvas.zoom('fit-viewport');\n            const element = canvas.getRootElement();\n            setElement(element);\n            createParticipant();\n          });\n        }\n        break;\n      case CONNECTOR:\n        canvas = bpmnModelerConnector.get('canvas');\n        element = canvas.getRootElement();\n        if (element.type === 'bpmn:Process-action') {\n          setElement(element);\n        } else {\n          bpmnModelerConnector.importXML(bamlXml, (err) => {\n            if (err) {\n              return console.error('could not import BPMN 2.0 diagram', err);\n            }\n            const canvas = bpmnModelerConnector.get('canvas');\n            canvas.zoom('fit-viewport');\n            const element = canvas.getRootElement();\n            createConnectorMapper();\n            setElement(element);\n          });\n        }\n        break;\n      case AUTHENTICATION:\n        canvas = bpmnModelerAuth.get('canvas');\n        element = canvas.getRootElement();\n        if (element.type === 'bpmn:Process-action') {\n          setElement(element);\n        } else {\n          bpmnModelerAuth.importXML(bamlXml, (err) => {\n            if (err) {\n              return console.error('could not import BPMN 2.0 diagram', err);\n            }\n            const canvas = bpmnModelerAuth.get('canvas');\n            canvas.zoom('fit-viewport');\n            const element = canvas.getRootElement();\n            element.businessObject.type = 'basic';\n            element.businessObject.isAuthenticated = false;\n            createMapper();\n            setElement(element);\n          });\n        }\n        break;\n      default:\n        return;\n    }\n  }, [model]);\n  const fetchDiagram = React.useCallback(\n    async function fetchDiagram(id) {\n      if (model === REQUEST) openDiagramImage(REQUEST_XML);\n      if (model === CONNECTOR) openDiagramImage(CONNECTOR_XML);\n      if (model === AUTHENTICATION) openDiagramImage(AUTH_XML);\n    },\n    [model, openDiagramImage],\n  );\n\n  useEffect(() => {\n    switch (model) {\n      case REQUEST:\n        if (!bpmnModeler) {\n          bpmnModeler = new BpmnModeler({\n            container: '#bpmnview',\n            additionalModules: [customControlsModuleRequest],\n          });\n        }\n        fetchDiagram();\n        bpmnModelerGlobal = bpmnModeler;\n        break;\n      case CONNECTOR:\n        if (!bpmnModelerConnector) {\n          bpmnModelerConnector = new BpmnModeler({\n            container: '#bpmnview2',\n            additionalModules: [customControlsModuleAuth],\n          });\n        }\n        bpmnModelerGlobal = bpmnModelerConnector;\n        fetchDiagram();\n        break;\n      case AUTHENTICATION:\n        if (!bpmnModelerAuth) {\n          bpmnModelerAuth = new BpmnModeler({\n            container: '#bpmnview3',\n            additionalModules: [customControlsModuleRequest],\n          });\n        }\n        bpmnModelerGlobal = bpmnModelerAuth;\n        fetchDiagram();\n        break;\n      default:\n        return;\n    }\n  }, [fetchDiagram, model]);\n\n  const setColors = useCallback((element, forceUpdate = false) => {\n    if (\n      element.businessObject &&\n      element.businessObject.di &&\n      (element.businessObject.di.stroke || element.businessObject.di.fill) &&\n      !forceUpdate\n    ) {\n      return;\n    }\n    const modeling = bpmnModelerGlobal.get('modeling');\n    const colors = {};\n    if (is(element, ['bpmn:Mapper'])) {\n      colors.stroke = STROKE_COLORS['bpmn:Task'];\n      colors.fill = FILL_COLORS['bpmn:Task'];\n    } else {\n      colors.stroke = STROKE_COLORS[element.type];\n    }\n    modeling.setColor(element, colors);\n    if (model === CONNECTOR) {\n      if (element.type === 'bpmn:Mapper') {\n        modeling.resizeShape(element, {\n          x: element.x,\n          y: element.y - (130 - 110),\n          width: 130,\n          height: 120,\n        });\n      }\n    }\n  }, [model])\n\n  useEffect(() => {\n    formatter.current = new JSONFormatter(\n      consoleResponse != null ? consoleResponse : 'No data',\n      Infinity,\n      {\n        hoverPreviewEnabled: false,\n        hoverPreviewArrayCount: 100,\n        hoverPreviewFieldCount: 5,\n        theme: 'dark',\n        animateOpen: true,\n        animateClose: true,\n        useToJSON: true,\n      },\n    );\n    if (value === 2) {\n      if (document.getElementById('console') != null) {\n        document.getElementById('console').innerHTML = '';\n      }\n      document\n        .getElementById('console')\n        ?.appendChild(formatter.current.render());\n    }\n  }, [consoleResponse, value]);\n\n  useEffect(() => {\n    switch (model) {\n      case REQUEST:\n        bpmnModelerGlobal = bpmnModeler;\n        document.getElementById('bpmnview2').style.display = 'none';\n        document.getElementById('bpmnview3').style.display = 'none';\n        document.getElementById('bpmnview').style.display = 'block';\n        break;\n      case CONNECTOR:\n        bpmnModelerGlobal = bpmnModelerConnector;\n        document.getElementById('bpmnview').style.display = 'none';\n        document.getElementById('bpmnview3').style.display = 'none';\n        document.getElementById('bpmnview2').style.display = 'block';\n        break;\n      case AUTHENTICATION:\n        bpmnModelerGlobal = bpmnModelerAuth;\n        document.getElementById('bpmnview').style.display = 'none';\n        document.getElementById('bpmnview2').style.display = 'none';\n        document.getElementById('bpmnview3').style.display = 'block';\n        break;\n      default:\n        break;\n    }\n    bpmnModelerGlobal.on('element.click', (event) => {\n      setElement(event.element);\n      setValue(0);\n    });\n    bpmnModelerGlobal.on('commandStack.shape.create.postExecuted', (event) => {\n      setColors(event && event.context && event.context.shape);\n    });\n    bpmnModelerGlobal.on('shape.changed', (event) => {\n      setElement(event.element);\n    });\n    bpmnModelerGlobal.on('resize.end',1500, (event) => {\n      if(is(event.shape,\"bpmn:Participant\") || is(event.shape,\"bpmn:Lane\")){\n        let shape = null;\n        if(is(event.shape,\"bpmn:Participant\"))  shape = event.shape;\n        else shape = event.shape.parent;\n        shape.children.forEach(element => {\n          document.getElementById(element.id).style.width = `${document.getElementById(element.id).getBoundingClientRect().width + event.dx}px`\n        });\n      }\n     });\n    bpmnModelerGlobal.on('shape.removed', () => {\n      const elementRegistry = bpmnModelerGlobal.get('elementRegistry');\n      const definitions = bpmnModelerGlobal.getDefinitions();\n      const element =\n        definitions && definitions.rootElements && definitions.rootElements[0];\n      if (!element) return;\n      const rootElement = elementRegistry.get(element.id);\n      if (!rootElement) return;\n      setElement(rootElement);\n    });\n  }, [model, setColors]);\n\n  return (\n    <div id=\"container\">\n      <div id=\"bpmncontainer\">\n        {parametersMenu && (\n          <ContextBuilder\n            open={parametersMenu}\n            handleClose={() => {\n              showParametersMenu(false);\n            }}\n          />\n        )}\n        {true && (\n          <div id=\"bpmnview\">\n            <div className={classes.header}>\n              <div className={classes.toolbarButtons}>\n                {toolBarButtons.map((btn) => (\n                  <div key={btn.name} className={classes.btnContainer}>\n                    <Tooltip\n                      title={btn.tooltipText}\n                      className={classes.toolTip}\n                    >\n                      <div\n                        className={\n                          btn.tooltipText === 'Parametres' ?\n                            [classes.toolTip, classes.active] :\n                            classes.toolTip\n                        }\n                      >\n                        <IconButton\n                          fontSize=\"large\"\n                          onClick={btn.onClick}\n                          className={classes.iconButton}\n                        >\n                          {btn.icon}\n                        </IconButton>\n                        <p className={classes.toolTipFont}>{btn.tooltipText}</p>\n                      </div>\n                    </Tooltip>\n                  </div>\n                ))}\n              </div>\n              <Selection\n                name=\"name\"\n                title=\"Model\"\n                placeholder=\"Model\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                options={MODELS}\n                value={MODELS[REQUEST - 1]}\n                onChange={(e) => {\n                  switch (e.name) {\n                    case 'Connector':\n                      setModel(CONNECTOR);\n                      break;\n                    case 'Authentification':\n                      setModel(AUTHENTICATION);\n                      break;\n                    default:\n                      return;\n                  }\n                }}\n              />\n              <Selection\n                name=\"name\"\n                title=\"target\"\n                placeholder=\"Target Request\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                value={request}\n                fetchAPI={getAllRequest}\n                onChange={(e) => {\n                  onChangeSelect(e);\n                }}\n              />\n            </div>\n            {model === REQUEST && openAlert.state && (\n              <Dialog\n                open={openAlert.state}\n                onClose={(e, reason) => {\n                  if (reason !== 'backdropClick') {\n                    setAlert(false);\n                  }\n                }}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n                classes={{\n                  paper: classes.dialog,\n                }}\n              >\n                <DialogTitle id=\"alert-dialog-title\">\n                  {openAlert.alertConfig.alertTitle}\n                </DialogTitle>\n                <DialogContent>\n                  <DialogContentText id=\"alert-dialog-description\">\n                    {openAlert.alertConfig.alertMessage}\n                  </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button\n                    onClick={() => {\n                      switch (openAlert.action) {\n                        case 'new':\n                          createNewRequest();\n                          break;\n                        case 'delete':\n                          createNewRequest();\n                          removeRequest();\n                          break;\n                        case 'onChange':\n                          getRequest(openAlert?.data?.id);\n                          break;\n                        default:\n                          break;\n                      }\n                      setAlert({ ...openAlert, state: false });\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    className={classes.save}\n                  >\n                    Ok\n                  </Button>\n                  <Button\n                    onClick={() => {\n                      setAlert(false);\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    style={{ textTransform: 'none' }}\n                    className={classes.save}\n                  >\n                    Cancel\n                  </Button>\n                </DialogActions>\n              </Dialog>\n            )}\n          </div>\n        )}\n        {true && (\n          <div id=\"bpmnview3\">\n            <div className={classes.header}>\n              <div className={classes.toolbarButtons}>\n                {toolBarButtons.map((btn) => (\n                  <div key={btn.name} className={classes.btnContainer}>\n                    <Tooltip\n                      title={btn.tooltipText}\n                      className={classes.toolTip}\n                    >\n                      <div\n                        className={\n                          btn.tooltipText === 'Parametres' ?\n                            [classes.toolTip, classes.active] :\n                            classes.toolTip\n                        }\n                      >\n                        <IconButton\n                          fontSize=\"large\"\n                          onClick={btn.onClick}\n                          className={classes.iconButton}\n                        >\n                          {btn.icon}\n                        </IconButton>\n                        <p className={classes.toolTipFont}>{btn.tooltipText}</p>\n                      </div>\n                    </Tooltip>\n                  </div>\n                ))}\n              </div>\n              <Selection\n                name=\"name\"\n                title=\"Model\"\n                placeholder=\"Model\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                options={MODELS}\n                value={MODELS[AUTHENTICATION - 1]}\n                onChange={(e) => {\n                  switch (e.name) {\n                    case 'Request':\n                      setModel(REQUEST);\n                      break;\n                    case 'Connector':\n                      setModel(CONNECTOR);\n                      break;\n                    default:\n                      return;\n                  }\n                }}\n              />\n              <Selection\n                name=\"name\"\n                title=\"target\"\n                placeholder=\"Target Request\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                value={authRequest}\n                fetchAPI={getAllAuthentication}\n                onChange={(e) => {\n                  onChangeSelectAuth(e);\n                  // SetRequest(e)\n                }}\n              />\n            </div>\n            {model === AUTHENTICATION && openAlert.state && (\n              <Dialog\n                open={openAlert.state}\n                onClose={(e, reason) => {\n                  if (reason !== 'backdropClick') {\n                    setAlert(false);\n                  }\n                }}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n                classes={{\n                  paper: classes.dialog,\n                }}\n              >\n                <DialogTitle id=\"alert-dialog-title\">\n                  {openAlert.alertConfig.alertTitle}\n                </DialogTitle>\n                <DialogContent>\n                  <DialogContentText id=\"alert-dialog-description\">\n                    {openAlert.alertConfig.alertMessage}\n                  </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button\n                    onClick={() => {\n                      switch (openAlert.action) {\n                        case 'new':\n                          createNewAuth();\n                          break;\n                        case 'delete':\n                          createNewAuth();\n                          removeAuth();\n                          break;\n                        case 'onChange':\n                          getAuth(openAlert.data.id);\n                          break;\n                        default:\n                          break;\n                      }\n                      setAlert({ ...openAlert, state: false });\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    className={classes.save}\n                  >\n                    Ok\n                  </Button>\n                  <Button\n                    onClick={() => {\n                      setAlert(false);\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    style={{ textTransform: 'none' }}\n                    className={classes.save}\n                  >\n                    Cancel\n                  </Button>\n                </DialogActions>\n              </Dialog>\n            )}\n          </div>\n        )}\n        {true && (\n          <div id=\"bpmnview2\">\n            <div className={classes.header}>\n              <div className={classes.toolbarButtons}>\n                {toolBarButtons.map((btn) => (\n                  <div key={btn.name} className={classes.btnContainer}>\n                    <Tooltip\n                      title={btn.tooltipText}\n                      className={classes.toolTip}\n                    >\n                      <div\n                        className={\n                          btn.tooltipText === 'Parametres' ?\n                            [classes.toolTip, classes.active] :\n                            classes.toolTip\n                        }\n                      >\n                        <IconButton\n                          fontSize=\"large\"\n                          onClick={btn.onClick}\n                          className={classes.iconButton}\n                        >\n                          {btn.icon}\n                        </IconButton>\n                        <p className={classes.toolTipFont}>{btn.tooltipText}</p>\n                      </div>\n                    </Tooltip>\n                  </div>\n                ))}\n              </div>\n              <Selection\n                name=\"name\"\n                title=\"Model\"\n                placeholder=\"Model\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                options={MODELS}\n                value={MODELS[CONNECTOR - 1]}\n                onChange={(e) => {\n                  switch (e.name) {\n                    case 'Authentification':\n                      setModel(AUTHENTICATION);\n                      break;\n                    case 'Request':\n                      setModel(REQUEST);\n                      break;\n                    default:\n                      return;\n                  }\n                }}\n              />\n              <Selection\n                name=\"name\"\n                title=\"target\"\n                placeholder=\"Target Request\"\n                optionLabelKey=\"name\"\n                className={classes.inputSelect}\n                value={connector}\n                fetchAPI={getAllConnector}\n                onChange={(e) => {\n                  onChangeSelectConnector(e);\n                }}\n              />\n            </div>\n            {model === CONNECTOR && openAlert.state && (\n              <Dialog\n                open={openAlert.state}\n                onClose={(e, reason) => {\n                  if (reason !== 'backdropClick') {\n                    setAlert(false);\n                  }\n                }}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n                classes={{\n                  paper: classes.dialog,\n                }}\n              >\n                <DialogTitle id=\"alert-dialog-title\">\n                  {openAlert.alertConfig.alertTitle}\n                </DialogTitle>\n                <DialogContent>\n                  <DialogContentText id=\"alert-dialog-description\">\n                    {openAlert.alertConfig.alertMessage}\n                  </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button\n                    onClick={() => {\n                      switch (openAlert.action) {\n                        case 'new':\n                          createNewConnector();\n                          break;\n                        case 'delete':\n                          createNewConnector();\n                          removeConnector();\n                          break;\n                        case 'onChange':\n                          getConnector(openAlert.data?.id);\n                          break;\n                        default:\n                          break;\n                      }\n                      setAlert({ ...openAlert, state: false });\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    className={classes.save}\n                  >\n                    Ok\n                  </Button>\n                  <Button\n                    onClick={() => {\n                      setAlert(false);\n                    }}\n                    color=\"primary\"\n                    autoFocus\n                    style={{ textTransform: 'none' }}\n                    className={classes.save}\n                  >\n                    Cancel\n                  </Button>\n                </DialogActions>\n              </Dialog>\n            )}\n          </div>\n        )}\n      </div>\n      <div>\n        <Resizable\n          style={resizeStyle}\n          size={{ width: width, height }}\n          onResizeStop={(e, direction, ref, d) => {\n            setWidth((width) => width + d.width);\n            setHeight(height + d.height);\n            setCSSWidth(width + d.width);\n          }}\n          maxWidth={window.innerWidth - 150}\n        >\n          <Drawer\n            variant=\"persistent\"\n            anchor=\"right\"\n            open={drawerOpen}\n            style={{\n              width: DRAWER_WIDTH,\n            }}\n            classes={{\n              paper: classes.drawerPaper,\n            }}\n            id=\"drawer\"\n          >\n            <div className={classes.drawerContainer}>\n              <TabContext value={value.toString()}>\n                <Box className={classes.box}>\n                  <Tabs\n                    value={value}\n                    onChange={handleChange}\n                    aria-label=\"basic tabs example\"\n                    className={classes.tabNav}\n                  >\n                    <Tab\n                      className={classes.tabStyle}\n                      label=\"Generality\"\n                      {...a11yProps(0)}\n                    />\n                    <Tab\n                      className={classes.tabStyle}\n                      label=\"Description\"\n                      {...a11yProps(1)}\n                    />\n                    <Tab\n                      className={classes.tabStyle}\n                      label=\"Consol\"\n                      {...a11yProps(2)}\n                    />\n                  </Tabs>\n                </Box>\n                <TabPanel className={classes.tabPanel} value={\"0\"} index={0}>\n                  {getProperties().map((t, index) => (\n                    <div className={classes.property} key={index}>\n                      {renderComponent(t)}\n                    </div>\n                  ))}\n                </TabPanel>\n                <TabPanel className={classes.tabPanel} value={\"1\"} index={1}>\n                  <Description desciption={'Description'} element={element} />\n                </TabPanel>\n                <TabPanel\n                  className={classes.tabPanelConsole}\n                  value={\"2\"}\n                  index={2}\n                >\n                  {consoleResponse &&\n                    consoleResponse?.ok == null &&\n                    consoleResponse?.status === 0 && (\n                      <div className={classes.messageResponseSuccess}>\n                        Success, everything run Successfully\n                      </div>\n                    )}\n                  {(consoleResponse?.ok === false ||\n                    consoleResponse?.status === -1) && (\n                      <div className={classes.messageResponseError}>\n                        Error , something went wrong !\n                      </div>\n                    )}\n                  <div className={classes.consoleHeader}>\n                    <h3 style={{ color: 'white',margin:0,padding:10 }}>Result</h3>\n                    <Button\n                      className={classes.copy}\n                      title=\"Copy result as Json\"\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                  <div id=\"console\" className={classes.console}></div>\n                </TabPanel>\n              </TabContext>\n            </div>\n          </Drawer>\n          <div\n              className=\"bpmn-property-toggle\"\n              onClick={() => {\n                setWidth((width) => (width === 0 ? DRAWER_WIDTH : 0));\n                setCSSWidth(width === 0 ? DRAWER_WIDTH : 0);\n              }}\n            >\n              Properties panel\n            </div>\n        </Resizable>\n        <div\n            className=\"properties-panel-parent\"\n            id=\"js-properties-panel\"\n          ></div>\n      </div>\n      {openSnackbar.open && (\n        <Snackbar\n          open={openSnackbar.open}\n          autoHideDuration={3000}\n          onClose={handleSnackbarClose}\n        >\n          <Alert\n            elevation={6}\n            variant=\"filled\"\n            onClose={handleSnackbarClose}\n            className=\"snackbarAlert\"\n            style={{ alignItems: 'flex-start' }}\n            severity={openSnackbar.messageType}\n          >\n            <div\n              dangerouslySetInnerHTML={{\n                __html: openSnackbar.message,\n              }}\n            ></div>\n          </Alert>\n        </Snackbar>\n      )}\n    </div>\n  );\n}\n\nexport default WebServiceEditor;\n","import React from 'react';\nimport {Provider} from 'react-redux';\nimport WebServiceEditor from './WEB-SERVICE';\nimport {store} from './WEB-SERVICE/store';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Provider store={store}>\n        <WebServiceEditor />\n      </Provider>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}